<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å°æåšå®¢</title>
  
  
  <link href="http://xiaoliblog.cn/atom.xml" rel="self"/>
  
  <link href="http://xiaoliblog.cn/"/>
  <updated>2021-07-03T06:54:24.173Z</updated>
  <id>http://xiaoliblog.cn/</id>
  
  <author>
    <name>å°æåšå®¢</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>DockerğŸ³Dockeræ¦‚è¿°åŠå®‰è£…</title>
    <link href="http://xiaoliblog.cn/page/Docker01.html"/>
    <id>http://xiaoliblog.cn/page/Docker01.html</id>
    <published>2021-07-03T06:43:53.368Z</published>
    <updated>2021-07-03T06:54:24.173Z</updated>
    
    
    
    
    <category term="Linuxè¿ç»´" scheme="http://xiaoliblog.cn/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    <category term="Docker" scheme="http://xiaoliblog.cn/categories/Linux%E8%BF%90%E7%BB%B4/Docker/"/>
    
    
    <category term="Docker" scheme="http://xiaoliblog.cn/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearchğŸ¯Jsoupçˆ¬è™«è·å–æ•°æ®</title>
    <link href="http://xiaoliblog.cn/page/ElasticSearch05.html"/>
    <id>http://xiaoliblog.cn/page/ElasticSearch05.html</id>
    <published>2021-07-02T14:43:16.041Z</published>
    <updated>2021-07-03T05:16:51.794Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é¡¹ç›®æ­å»º"><a href="#é¡¹ç›®æ­å»º" class="headerlink" title="é¡¹ç›®æ­å»º"></a>é¡¹ç›®æ­å»º</h1><ul><li>åˆ›å»ºSpringBootæ¨¡å—ï¼Œå‹¾é€‰Webã€Thymeleafã€Lombokã€ElasticSearchå’Œçƒ­éƒ¨ç½²</li><li>å¦‚æœæ²¡æœ‰éœ€è¦æ‰‹åŠ¨å¯¼å…¥</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.76<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é…ç½®ç‰ˆæœ¬å·ï¼Œä¿è¯ElasticSearchå’Œæœ¬åœ°å®‰è£…ç‰ˆæœ¬ä¸€è‡´</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--è¿™è¾¹é…ç½®ä¸‹è‡ªå·±å¯¹åº”çš„ç‰ˆæœ¬--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">elasticsearch.version</span>&gt;</span>7.6.1<span class="tag">&lt;/<span class="name">elasticsearch.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å…³é—­Thymeleafçš„ç¼“å­˜</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­Themeleafç¼“å­˜</span></span><br><span class="line"><span class="meta">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure><ul><li>ç„¶åå¯¼å…¥é™æ€é¡µé¢ï¼Œæ§åˆ¶å™¨è®¿é—®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&#123;&quot;/&quot;,&quot;/index&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/20210703094359.png"></p><h1 id="çˆ¬å–æ•°æ®"><a href="#çˆ¬å–æ•°æ®" class="headerlink" title="çˆ¬å–æ•°æ®"></a>çˆ¬å–æ•°æ®</h1><h2 id="Jsuop"><a href="#Jsuop" class="headerlink" title="Jsuop"></a>Jsuop</h2><ul><li><code>Jsoup</code> æ˜¯ä¸€æ¬¾Java çš„HTMLè§£æå™¨ï¼Œå¯ç›´æ¥è§£ææŸä¸ªURLåœ°å€ã€HTMLæ–‡æœ¬å†…å®¹ã€‚å®ƒæä¾›äº†ä¸€å¥—éå¸¸çœåŠ›çš„APIï¼Œå¯é€šè¿‡DOMï¼ŒCSSä»¥åŠç±»ä¼¼äºjQueryçš„æ“ä½œæ–¹æ³•æ¥å–å‡ºå’Œæ“ä½œæ•°æ®ã€‚</li><li><code>Jsoup</code>åªèƒ½æŠ“å–HTMLï¼Œä¸èƒ½è·å–ç”µå½±å’ŒéŸ³ä¹ã€‚å¯ä»¥ä½¿ç”¨<code>Tika</code>ï¼Œå…¶å¯ä»¥ä½¿ç”¨å„ç§è§£æå™¨åº“ä»ç»™å®šçš„è§£æå™¨ä¸­æå–å†…å®¹ï¼Œå‚è€ƒï¼š<a href="http://www.vue5.com/tika/tika_extracting_mp4_files.html">TIKA - æå–mp4æ–‡ä»¶</a></li><li>å¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jsoup<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsoup<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®å·¥å…·ç±»"><a href="#é…ç½®å·¥å…·ç±»" class="headerlink" title="é…ç½®å·¥å…·ç±»"></a>é…ç½®å·¥å…·ç±»</h2><ul><li>è¯·æ±‚åœ°å€ï¼š<a href="https://search.jd.com/Search?keyword=java">https://search.jd.com/Search?keyword=java</a></li><li>ç®€å•æµ‹è¯•å·¥å…·ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HtmlParseUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚https://search.jd.com/Search?keyword=java</span></span><br><span class="line">        String url = <span class="string">&quot;https://search.jd.com/Search?keyword=java&quot;</span>;</span><br><span class="line">        <span class="comment">// è§£æç½‘é¡µ (Jsoupè¿”å›Decumentå¯¹è±¡å°±æ˜¯æµè§ˆå™¨é¡µé¢Documentå¯¹è±¡)</span></span><br><span class="line">        Document document = Jsoup.parse(<span class="keyword">new</span> URL(url), <span class="number">30000</span>);</span><br><span class="line">        <span class="comment">// æ‰€æœ‰åœ¨JSä¸­ä½¿ç”¨çš„æ–¹æ³•éƒ½èƒ½ç”¨</span></span><br><span class="line">        Element element = document.getElementById(<span class="string">&quot;J_goodsList&quot;</span>);</span><br><span class="line">        <span class="comment">//System.out.println(element.html()); // æŠ“å–idä¸ºJ_goodsListçš„HTML</span></span><br><span class="line">        <span class="comment">// è·å–æ‰€æœ‰çš„liæ ‡ç­¾</span></span><br><span class="line">        Elements li = element.getElementsByTag(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">        <span class="comment">// è·å–å…ƒç´ ä¸­çš„å†…å®¹</span></span><br><span class="line">        <span class="keyword">for</span> (Element element1 : li) &#123;</span><br><span class="line">            <span class="comment">// è·å–å›¾ç‰‡åœ°å€src æ³¨æ„ï¼šå¯¹äºå›¾ç‰‡ç‰¹åˆ«å¤šçš„ç½‘ç«™ï¼Œæ‰€æœ‰å›¾ç‰‡çš„å»¶è¿ŸåŠ è½½çš„</span></span><br><span class="line">            <span class="comment">// å›¾ç‰‡çœŸå®åœ°å€åœ¨data-lazy-imgå±æ€§ä¸‹</span></span><br><span class="line">            String img = element1.getElementsByTag(<span class="string">&quot;img&quot;</span>).eq(<span class="number">0</span>).attr(<span class="string">&quot;data-lazy-img&quot;</span>);</span><br><span class="line">            <span class="comment">// è·å–å•†å“ä»·æ ¼</span></span><br><span class="line">            String price = element1.getElementsByClass(<span class="string">&quot;p-price&quot;</span>).eq(<span class="number">0</span>).text();</span><br><span class="line">            <span class="comment">// è·å–æ ‡é¢˜</span></span><br><span class="line">            String title = element1.getElementsByClass(<span class="string">&quot;p-name&quot;</span>).eq(<span class="number">0</span>).text();</span><br><span class="line">            <span class="comment">// Jsoupæ˜¯é’ˆå¯¹è¯·æ±‚è§£æHTML,åªä¼šçˆ¬å–è¯·æ±‚ä¸‹ä¸€é¡µçš„æ•°æ®</span></span><br><span class="line">            System.out.println(<span class="string">&quot;=====================&quot;</span>);</span><br><span class="line">            System.out.println(img);</span><br><span class="line">            System.out.println(price);</span><br><span class="line">            System.out.println(title);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/20210703102030.png"></p><ul><li>ç„¶åæˆ‘ä»¬è¦æŠŠç­›é€‰å‡ºæ¥çš„æ•°æ®å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªå®ä½“ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Content</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String img;</span><br><span class="line">    <span class="keyword">private</span> String price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»§ç»­å¯¹å·¥å…·ç±»è¿›è¡Œå®Œå–„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> <span class="comment">// åŠ å…¥Springå®¹å™¨é‡Œ</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HtmlParseUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;Content&gt; <span class="title">parseJD</span><span class="params">(String keywords)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚https://search.jd.com/Search</span></span><br><span class="line">        String url = <span class="string">&quot;https://search.jd.com/Search?keyword=&quot;</span> + keywords;</span><br><span class="line">        <span class="comment">// è§£æç½‘é¡µ (Jsoupè¿”å›Decumentå¯¹è±¡å°±æ˜¯æµè§ˆå™¨é¡µé¢Documentå¯¹è±¡)</span></span><br><span class="line">        Document document = Jsoup.parse(<span class="keyword">new</span> URL(url), <span class="number">30000</span>);</span><br><span class="line">        <span class="comment">// æ‰€æœ‰åœ¨JSä¸­ä½¿ç”¨çš„æ–¹æ³•éƒ½èƒ½ç”¨</span></span><br><span class="line">        Element element = document.getElementById(<span class="string">&quot;J_goodsList&quot;</span>);</span><br><span class="line">        <span class="comment">//System.out.println(element.html()); // æŠ“å–idä¸ºJ_goodsListçš„HTML</span></span><br><span class="line">        <span class="comment">// è·å–æ‰€æœ‰çš„liæ ‡ç­¾</span></span><br><span class="line">        Elements li = element.getElementsByTag(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªArrayListå­˜æ”¾å¤šä¸ªå¯¹è±¡</span></span><br><span class="line">        ArrayList&lt;Content&gt; goodsList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">// è·å–å…ƒç´ ä¸­çš„å†…å®¹</span></span><br><span class="line">        <span class="keyword">for</span> (Element element1 : li) &#123;</span><br><span class="line">            <span class="comment">// è·å–å›¾ç‰‡åœ°å€src æ³¨æ„ï¼šå¯¹äºå›¾ç‰‡ç‰¹åˆ«å¤šçš„ç½‘ç«™ï¼Œæ‰€æœ‰å›¾ç‰‡çš„å»¶è¿ŸåŠ è½½çš„</span></span><br><span class="line">            <span class="comment">// å›¾ç‰‡çœŸå®åœ°å€åœ¨data-lazy-imgå±æ€§ä¸‹</span></span><br><span class="line">            String img = element1.getElementsByTag(<span class="string">&quot;img&quot;</span>).eq(<span class="number">0</span>).attr(<span class="string">&quot;data-lazy-img&quot;</span>);</span><br><span class="line">            <span class="comment">// è·å–å•†å“ä»·æ ¼</span></span><br><span class="line">            String price = element1.getElementsByClass(<span class="string">&quot;p-price&quot;</span>).eq(<span class="number">0</span>).text();</span><br><span class="line">            <span class="comment">// è·å–æ ‡é¢˜</span></span><br><span class="line">            String title = element1.getElementsByClass(<span class="string">&quot;p-name&quot;</span>).eq(<span class="number">0</span>).text();</span><br><span class="line">            <span class="comment">// å°è£…ä¸ºContentå¯¹è±¡</span></span><br><span class="line">            Content content = <span class="keyword">new</span> Content();</span><br><span class="line">            content.setTitle(title);</span><br><span class="line">            content.setPrice(price);</span><br><span class="line">            content.setImg(img);</span><br><span class="line">            goodsList.add(content);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›å¯¹è±¡é›†åˆ</span></span><br><span class="line">        <span class="keyword">return</span> goodsList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿›è¡Œæµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ElasticsearchJdshopApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    HtmlParseUtil htmlParseUtil;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">       ArrayList&lt;Content&gt; contents = htmlParseUtil.parseJD(<span class="string">&quot;java&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/20210703103130.png"></p><h1 id="ä¸šåŠ¡ç¼–å†™"><a href="#ä¸šåŠ¡ç¼–å†™" class="headerlink" title="ä¸šåŠ¡ç¼–å†™"></a>ä¸šåŠ¡ç¼–å†™</h1><h2 id="è¿æ¥å®¢æˆ·ç«¯"><a href="#è¿æ¥å®¢æˆ·ç«¯" class="headerlink" title="è¿æ¥å®¢æˆ·ç«¯"></a>è¿æ¥å®¢æˆ·ç«¯</h2><ul><li>å¯åŠ¨ElasticSearchæœåŠ¡å’Œheadå¯è§†åŒ–ï¼Œå¹¶ç¼–å†™é…ç½®ç±»è¿æ¥</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElasticSearchClientConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ³¨å…¥åˆ°Springå®¹å™¨å¾…ç”¨</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestHighLevelClient <span class="title">restHighLevelClient</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// ä¿è¯æœ¬åœ°ElasticSearchæœåŠ¡å¼€å¯</span></span><br><span class="line">        RestHighLevelClient client = <span class="keyword">new</span> RestHighLevelClient(</span><br><span class="line">                RestClient.builder(</span><br><span class="line">                        <span class="keyword">new</span> HttpHost(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">9200</span>,<span class="string">&quot;http&quot;</span>))</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> client;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®å­˜å…¥ElasticSearch"><a href="#æ•°æ®å­˜å…¥ElasticSearch" class="headerlink" title="æ•°æ®å­˜å…¥ElasticSearch"></a>æ•°æ®å­˜å…¥ElasticSearch</h2><ul><li>åˆ›å»ºContentServiceä¸šåŠ¡ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RestHighLevelClient restHighLevelClient;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    HtmlParseUtil htmlParseUtil;</span><br><span class="line">    <span class="comment">// 1. è§£ææ•°æ®æ”¾å…¥ElasticSearchç´¢å¼•ä¸­</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">parseContent</span><span class="params">(String keywords)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        List&lt;Content&gt; contents = htmlParseUtil.parseJD(keywords);</span><br><span class="line">        <span class="comment">// æŠŠæŸ¥è¯¢çš„æ•°æ®æ”¾å…¥ElasticSearchä¸­</span></span><br><span class="line">        BulkRequest bulkRequest = <span class="keyword">new</span> BulkRequest();</span><br><span class="line">        bulkRequest.timeout(<span class="string">&quot;2m&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; contents.size(); i++) &#123;</span><br><span class="line">            <span class="comment">// æ”¾å…¥jd_goodsç´¢å¼•ä¸­</span></span><br><span class="line">            bulkRequest.add(</span><br><span class="line">                    <span class="keyword">new</span> IndexRequest(<span class="string">&quot;jd_goods&quot;</span>)</span><br><span class="line">                    .source(JSON.toJSONString(contents.get(i)), XContentType.JSON));</span><br><span class="line">        &#125;</span><br><span class="line">        BulkResponse bulkResponse = restHighLevelClient.bulk(bulkRequest, RequestOptions.DEFAULT);</span><br><span class="line">        <span class="comment">// å–åè¡¨ç¤ºè¿”å›trueè¡¨ç¤ºæˆåŠŸ</span></span><br><span class="line">        <span class="keyword">return</span> !bulkResponse.hasFailures();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™æ§åˆ¶å™¨è¯·æ±‚ï¼Œé‡‡ç”¨Restfulé£æ ¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ContentService contentService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/parse/&#123;keywords&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">parse</span><span class="params">(<span class="meta">@PathVariable(&quot;keywords&quot;)</span> String keywords)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> contentService.parseContent(keywords);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/20210703110955.png"></p><ul><li>å†æŸ¥çœ‹Headå¯è§†åŒ–ç•Œé¢ä¸­ï¼Œ<code>jd_goods</code>ç´¢å¼•æœ‰äº†æ•°æ®</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/20210703110502.png"></p><h2 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h2><ul><li>æ ¹æ®è¯·æ±‚è·å–äº†æ•°æ®å¹¶å­˜å…¥äº†ElasticSearchç´¢å¼•ä¸­ï¼Œç°åœ¨éœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆ†é¡µå¤„ç†</li><li>åœ¨<code>ContentService</code>ä¸­æ–°å»ºæ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–æ•°æ®å®ç°æœç´¢åŠŸèƒ½</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String,Object&gt;&gt; searchPage(String keyword,<span class="keyword">int</span> pageNo,<span class="keyword">int</span> pageSize) <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">   <span class="keyword">if</span>(pageNo&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">      pageNo = <span class="number">1</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// æ¡ä»¶æœç´¢</span></span><br><span class="line">   SearchRequest searchRequest = <span class="keyword">new</span> SearchRequest(<span class="string">&quot;jd_goods&quot;</span>);</span><br><span class="line">   SearchSourceBuilder searchSourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line">   <span class="comment">// åˆ†é¡µ</span></span><br><span class="line">   searchSourceBuilder.from(pageNo);</span><br><span class="line">   searchSourceBuilder.size(pageSize);</span><br><span class="line">   <span class="comment">// ç²¾å‡†åŒ¹é…å…³é”®å­—</span></span><br><span class="line">   QueryBuilder termQueryBuilder = QueryBuilders.matchQuery(<span class="string">&quot;title&quot;</span>,keyword);</span><br><span class="line">   searchSourceBuilder.query(termQueryBuilder);</span><br><span class="line">   searchSourceBuilder.timeout(<span class="keyword">new</span> TimeValue(<span class="number">60</span>, TimeUnit.SECONDS));</span><br><span class="line">   <span class="comment">// æ‰§è¡Œæœç´¢</span></span><br><span class="line">   searchRequest.source(searchSourceBuilder);</span><br><span class="line">   SearchResponse searchResponse = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);</span><br><span class="line">   <span class="comment">// è§£æç»“æœ</span></span><br><span class="line">   ArrayList&lt;Map&lt;String,Object&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">   <span class="keyword">for</span> (SearchHit documentFields : searchResponse.getHits().getHits()) &#123;</span><br><span class="line">      list.add(documentFields.getSourceAsMap());</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™æ§åˆ¶å±‚è¯·æ±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/search/&#123;keyword&#125;/&#123;pageNo&#125;/&#123;pageSize&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String,Object&gt;&gt; search(<span class="meta">@PathVariable(&quot;keyword&quot;)</span> String keyword,<span class="meta">@PathVariable(&quot;pageNo&quot;)</span> <span class="keyword">int</span> pageNo,<span class="meta">@PathVariable(&quot;pageSize&quot;)</span> <span class="keyword">int</span> pageSize)<span class="keyword">throws</span> IOException&#123;</span><br><span class="line">   <span class="keyword">return</span> contentService.searchPage(keyword, pageNo, pageSize);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/20210703115455.png"></p><h1 id="å‰åç«¯äº¤äº’"><a href="#å‰åç«¯äº¤äº’" class="headerlink" title="å‰åç«¯äº¤äº’"></a>å‰åç«¯äº¤äº’</h1><h2 id="å¯¼å…¥Vue"><a href="#å¯¼å…¥Vue" class="headerlink" title="å¯¼å…¥Vue"></a>å¯¼å…¥Vue</h2><ul><li>éšä¾¿å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹è½½Vueå’Œaxios</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install vue</span><br><span class="line">npm install axios</span><br></pre></td></tr></table></figure><ul><li>ç„¶åæŠŠä¸¤ä¸ªæ–‡ä»¶å¯¼å…¥IDEAçš„é¡¹ç›®<code>static</code>æ–‡ä»¶å¤¹ä¸­</li><li>åœ¨<code>index.html</code>é¡µé¢ä¸­å¯¼å…¥</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/js/axios.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/js/vue.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å¼•å…¥åå¦‚æœå‡ºç°æ‰¾ä¸åˆ°èµ„æºï¼Œå¯ä»¥<code>maven clean</code>ä¸€ä¸‹å†é‡å¯</li></ul><h2 id="æœç´¢äº‹ä»¶"><a href="#æœç´¢äº‹ä»¶" class="headerlink" title="æœç´¢äº‹ä»¶"></a>æœç´¢äº‹ä»¶</h2><ul><li>é¦–å…ˆå®šä¹‰Idç”¨äºç»‘å®šVue</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;page&quot;</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--çœç•¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºVueå®ä¾‹ï¼Œå®šä¹‰åŒå‘ç»‘å®šçš„æ•°æ®</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">   el:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">   data:&#123;</span><br><span class="line">      keyword: <span class="string">&#x27;&#x27;</span>, <span class="comment">//æœç´¢å…³é”®å­—</span></span><br><span class="line">      results:[]  <span class="comment">//æœç´¢ç»“æœ</span></span><br><span class="line">   &#125;,</span><br><span class="line">   methods:&#123;</span><br><span class="line">      <span class="function"><span class="title">searchKey</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">var</span> keyword = <span class="built_in">this</span>.keyword;</span><br><span class="line">         <span class="built_in">console</span>.log(keyword);</span><br><span class="line">         <span class="comment">// å¯¹æ¥åç«¯æ¥å£</span></span><br><span class="line">         axios.get(<span class="string">&#x27;search/&#x27;</span>+keyword+<span class="string">&quot;/1/10&quot;</span>)</span><br><span class="line">                  .then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">                     <span class="built_in">console</span>.log(response);</span><br><span class="line">                     <span class="built_in">this</span>.results = response.data; <span class="comment">//ç»‘å®šæ•°æ®</span></span><br><span class="line">                  &#125;)</span><br><span class="line">         &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>ç„¶åç»™è¾“å…¥æ¡†åŒå‘ç»‘å®šæ•°æ®ï¼Œç»™æŒ‰é’®æ·»åŠ äº‹ä»¶</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;keyword&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> @<span class="attr">click.prevent</span>=<span class="string">&quot;searchKey&quot;</span>&gt;</span>æœç´¢<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡reslutséå†ç»“æœ</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;product&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;result in results&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;product-iWrap&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--å•†å“å°é¢--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;productImg-wrap&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;productImg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">&quot;result.img&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--ä»·æ ¼--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;productPrice&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">em</span>&gt;</span>&#123;&#123;result.price&#125;&#125;<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--æ ‡é¢˜--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;productTitle&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">a</span>&gt;</span> &#123;&#123;result.title&#125;&#125; <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- åº—é“ºå --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;productShop&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">span</span>&gt;</span>åº—é“ºï¼š ç‹‚ç¥è¯´Java <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- æˆäº¤ä¿¡æ¯ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;productStatus&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">span</span>&gt;</span>æœˆæˆäº¤<span class="tag">&lt;<span class="name">em</span>&gt;</span>999ç¬”<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">span</span>&gt;</span>è¯„ä»· <span class="tag">&lt;<span class="name">a</span>&gt;</span>3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/20210703130028.png"></p><h2 id="é«˜äº®æ˜¾ç¤º"><a href="#é«˜äº®æ˜¾ç¤º" class="headerlink" title="é«˜äº®æ˜¾ç¤º"></a>é«˜äº®æ˜¾ç¤º</h2><ul><li>åœ¨<code>ContentService</code>ä¸­æ–°å»ºæ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–æ•°æ®å®ç°é«˜äº®</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String,Object&gt;&gt; highLight(String keyword,<span class="keyword">int</span> pageNo,<span class="keyword">int</span> pageSize) <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">   <span class="keyword">if</span>(pageNo&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">      pageNo = <span class="number">1</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// æ¡ä»¶æœç´¢</span></span><br><span class="line">   SearchRequest searchRequest = <span class="keyword">new</span> SearchRequest(<span class="string">&quot;jd_goods&quot;</span>);</span><br><span class="line">   SearchSourceBuilder searchSourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line">   <span class="comment">// åˆ†é¡µ</span></span><br><span class="line">   searchSourceBuilder.from(pageNo);</span><br><span class="line">   searchSourceBuilder.size(pageSize);</span><br><span class="line">   <span class="comment">// ç²¾å‡†åŒ¹é…å…³é”®å­—</span></span><br><span class="line">   QueryBuilder termQueryBuilder = QueryBuilders.matchQuery(<span class="string">&quot;title&quot;</span>,keyword);</span><br><span class="line">   searchSourceBuilder.query(termQueryBuilder);</span><br><span class="line">   searchSourceBuilder.timeout(<span class="keyword">new</span> TimeValue(<span class="number">60</span>, TimeUnit.SECONDS));</span><br><span class="line">   <span class="comment">// é«˜äº®è®¾ç½®</span></span><br><span class="line">   HighlightBuilder highlightBuilder = <span class="keyword">new</span> HighlightBuilder();</span><br><span class="line">   highlightBuilder.field(<span class="string">&quot;title&quot;</span>);</span><br><span class="line">   highlightBuilder.requireFieldMatch(<span class="keyword">false</span>); <span class="comment">// ä¸éœ€è¦å…¨éƒ¨å¤šä¸ªé«˜äº®</span></span><br><span class="line">   highlightBuilder.preTags(<span class="string">&quot;&lt;span style=&#x27;color:red&#x27;&gt;&quot;</span>);</span><br><span class="line">   highlightBuilder.postTags(<span class="string">&quot;&lt;/span&gt;&quot;</span>);</span><br><span class="line">   searchSourceBuilder.highlighter(highlightBuilder);</span><br><span class="line">   <span class="comment">// æ‰§è¡Œæœç´¢</span></span><br><span class="line">   searchRequest.source(searchSourceBuilder);</span><br><span class="line">   SearchResponse searchResponse = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);</span><br><span class="line">   <span class="comment">// è§£æç»“æœ</span></span><br><span class="line">   ArrayList&lt;Map&lt;String,Object&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">   <span class="keyword">for</span> (SearchHit hit : searchResponse.getHits().getHits()) &#123;</span><br><span class="line">      <span class="comment">// è§£æé«˜äº®å­—æ®µ</span></span><br><span class="line">      Map&lt;String, HighlightField&gt; highlightFields = hit.getHighlightFields();</span><br><span class="line">      HighlightField title = highlightFields.get(<span class="string">&quot;title&quot;</span>);</span><br><span class="line">      Map&lt;String, Object&gt; sourceAsMap = hit.getSourceAsMap();<span class="comment">// åŸæ¥çš„ç»“æœ</span></span><br><span class="line">      <span class="comment">// è§£æé«˜äº®å­—æ®µ å°†åŸæ¥çš„å­—æ®µæ›¿æ¢ä¸ºæˆ‘ä»¬é«˜äº®çš„å­—æ®µå³å¯</span></span><br><span class="line">      <span class="keyword">if</span>(title!=<span class="keyword">null</span>)&#123;</span><br><span class="line">         Text[] fragments = title.fragments();</span><br><span class="line">         String new_title = <span class="string">&quot;&quot;</span>;</span><br><span class="line">         <span class="keyword">for</span> (Text text : fragments) &#123;</span><br><span class="line">            new_title += text;</span><br><span class="line">         &#125;</span><br><span class="line">         sourceAsMap.put(<span class="string">&quot;title&quot;</span>,new_title); <span class="comment">//é«˜äº®å­—æ®µæ›¿æ¢ä¸ºåŸå†…å®¹å³å¯</span></span><br><span class="line">      &#125;</span><br><span class="line">      list.add(sourceAsMap);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ§åˆ¶å±‚æ›¿æ¢ä¸‹æ–¹æ³•å³å¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/search/&#123;keyword&#125;/&#123;pageNo&#125;/&#123;pageSize&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String,Object&gt;&gt; search(<span class="meta">@PathVariable(&quot;keyword&quot;)</span> String keyword,<span class="meta">@PathVariable(&quot;pageNo&quot;)</span> <span class="keyword">int</span> pageNo,<span class="meta">@PathVariable(&quot;pageSize&quot;)</span> <span class="keyword">int</span> pageSize)<span class="keyword">throws</span> IOException&#123;</span><br><span class="line">   <span class="keyword">return</span> contentService.highLight(keyword, pageNo, pageSize);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é‡å¯å‘ç°æ–°å®¶çš„é«˜äº®HTMLå¹¶æ²¡æœ‰åœ¨é¡µé¢ä¸Šè§£æé™¤äº†ï¼Œéœ€è¦æ”¹æˆ<code>v-html</code>æŒ‡ä»¤</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--æ ‡é¢˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;productTitle&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">a</span> <span class="attr">v-html</span>=<span class="string">&quot;result.title&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/20210703131640.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;é¡¹ç›®æ­å»º&quot;&gt;&lt;a href=&quot;#é¡¹ç›®æ­å»º&quot; class=&quot;headerlink&quot; title=&quot;é¡¹ç›®æ­å»º&quot;&gt;&lt;/a&gt;é¡¹ç›®æ­å»º&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;åˆ›å»ºSpringBootæ¨¡å—ï¼Œå‹¾é€‰Webã€Thymeleafã€Lombokã€ElasticSearchå’Œçƒ­éƒ¨ç½²&lt;</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/ElasticSearch/"/>
    
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/tags/ElasticSearch/"/>
    
    <category term="Jsoup" scheme="http://xiaoliblog.cn/tags/Jsoup/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearchğŸ¯SpringBooté›†æˆElasticSearch</title>
    <link href="http://xiaoliblog.cn/page/ElasticSearch04.html"/>
    <id>http://xiaoliblog.cn/page/ElasticSearch04.html</id>
    <published>2021-07-02T12:50:37.020Z</published>
    <updated>2021-07-02T14:41:34.835Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SpringBooté›†æˆ"><a href="#SpringBooté›†æˆ" class="headerlink" title="SpringBooté›†æˆ"></a>SpringBooté›†æˆ</h1><ul><li>ElasticSearchæ–‡æ¡£ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/index.html">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/index.html</a> ï¼Œä½¿ç”¨é«˜çº§å®¢æˆ·ç«¯å¼€å‘</li></ul><h2 id="ç›¸å…³ä¾èµ–"><a href="#ç›¸å…³ä¾èµ–" class="headerlink" title="ç›¸å…³ä¾èµ–"></a>ç›¸å…³ä¾èµ–</h2><ul><li>åˆ›å»ºä¸€ä¸ª<code>SpringBoot</code>çš„é¡¹ç›®ï¼ŒåŒæ—¶å‹¾é€‰ä¸Š<code>SpringBoot-Web</code>çš„åŒ…ä»¥åŠNosqlçš„<code>elasticsearch</code>çš„åŒ…</li><li>æ²¡æœ‰å°±æ‰‹åŠ¨å¯¼å…¥</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--eså®¢æˆ·ç«¯--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.elasticsearch.client<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>elasticsearch-rest-high-level-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--springbootçš„elasticsearchæœåŠ¡--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--faskjsonç”¨äºJSONå¤„ç†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.76<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning simple"><p>æ³¨æ„ä¸‹Spring-Bootçš„parentåŒ…å†…çš„ä¾èµ–çš„ElasticSearchçš„ç‰ˆæœ¬æ˜¯ä¸æ˜¯å’Œæœ¬åœ°å®‰è£…çš„ç‰ˆæœ¬ä¸€è‡´</p></div><ul><li>ä¸æ˜¯çš„è¯å°±åœ¨pomæ–‡ä»¶ä¸‹å†™ä¸ªpropertiesçš„ç‰ˆæœ¬</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--è¿™è¾¹é…ç½®ä¸‹è‡ªå·±å¯¹åº”çš„ç‰ˆæœ¬--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">elasticsearch.version</span>&gt;</span>7.6.1<span class="tag">&lt;/<span class="name">elasticsearch.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å®¢æˆ·ç«¯é…ç½®ç±»"><a href="#å®¢æˆ·ç«¯é…ç½®ç±»" class="headerlink" title="å®¢æˆ·ç«¯é…ç½®ç±»"></a>å®¢æˆ·ç«¯é…ç½®ç±»</h2><ul><li>åˆ›å»º<code>config</code>æ–‡ä»¶å¤¹ï¼Œæ–°å»º<code>ElasticSearchClientConfig</code>é…ç½®ç±»Â·</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElasticSearchClientConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ³¨å…¥åˆ°Springå®¹å™¨å¾…ç”¨</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestHighLevelClient <span class="title">restHighLevelClient</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// ä¿è¯æœ¬åœ°ElasticSearchæœåŠ¡å¼€å¯</span></span><br><span class="line">        RestHighLevelClient client = <span class="keyword">new</span> RestHighLevelClient(</span><br><span class="line">                RestClient.builder(</span><br><span class="line">                        <span class="keyword">new</span> HttpHost(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">9200</span>,<span class="string">&quot;http&quot;</span>))</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> client;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç´¢å¼•æ“ä½œ"><a href="#ç´¢å¼•æ“ä½œ" class="headerlink" title="ç´¢å¼•æ“ä½œ"></a>ç´¢å¼•æ“ä½œ</h1><h2 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h2><ul><li>é€šè¿‡SpringBootå•å…ƒæµ‹è¯•è¿›è¡Œæµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ElasticsearchDemo01ApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å˜é‡åè¦å’ŒBeanä¸€è‡´ï¼Œä¸ä¸€è‡´éœ€è¦ç”¨Qualifier(&quot;æ–¹æ³•å&quot;)æŒ‡å®šï¼Œç„¶åå†è‡ªå®šä¹‰</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;restHighLevelClient&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> RestHighLevelClient client;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æµ‹è¯•ç´¢å¼•çš„åˆ›å»º</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">testCreateIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 1. åˆ›å»ºç´¢å¼•è¯·æ±‚</span></span><br><span class="line">        CreateIndexRequest request = <span class="keyword">new</span> CreateIndexRequest(<span class="string">&quot;blog_index&quot;</span>);</span><br><span class="line">        <span class="comment">// 2. å®¢æˆ·ç«¯æ‰§è¡Œè¯·æ±‚ï¼Œè¯·æ±‚åè·å¾—å“åº”</span></span><br><span class="line">        CreateIndexResponse response = client.indices().create(request, RequestOptions.DEFAULT);</span><br><span class="line">        System.out.println(response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·å–ç´¢å¼•"><a href="#è·å–ç´¢å¼•" class="headerlink" title="è·å–ç´¢å¼•"></a>è·å–ç´¢å¼•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–ç´¢å¼•</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testExistIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">   <span class="comment">// 1. è·å–ç´¢å¼•è¯·æ±‚  æ³¨æ„å¯¼åŒ…ä¸ºclientçš„åŒ…</span></span><br><span class="line">   GetIndexRequest request = <span class="keyword">new</span> GetIndexRequest(<span class="string">&quot;blog_index&quot;</span>);</span><br><span class="line">   <span class="keyword">boolean</span> exists = client.indices().exists(request,RequestOptions.DEFAULT);</span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•ç´¢å¼•æ˜¯å¦å­˜åœ¨-----&quot;</span>+exists);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤ç´¢å¼•"></a>åˆ é™¤ç´¢å¼•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤ç´¢å¼•</span></span><br><span class="line"><span class="meta">@Test</span> <span class="function"><span class="keyword">void</span> <span class="title">testDelIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">   DeleteIndexRequest request = <span class="keyword">new</span> DeleteIndexRequest(<span class="string">&quot;blog_index&quot;</span>);</span><br><span class="line">   AcknowledgedResponse delete = client.indices().delete(request, RequestOptions.DEFAULT);</span><br><span class="line">   System.out.println(<span class="string">&quot;åˆ é™¤ç´¢å¼•--------&quot;</span>+delete.isAcknowledged());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–‡æ¡£æ“ä½œ"><a href="#æ–‡æ¡£æ“ä½œ" class="headerlink" title="æ–‡æ¡£æ“ä½œ"></a>æ–‡æ¡£æ“ä½œ</h1><h2 id="æ·»åŠ æ–‡æ¡£"><a href="#æ·»åŠ æ–‡æ¡£" class="headerlink" title="æ·»åŠ æ–‡æ¡£"></a>æ·»åŠ æ–‡æ¡£</h2><ul><li>åˆ›å»ºå®ä½“ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ElasticsearchDemo01ApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å˜é‡åè¦å’ŒBeanä¸€è‡´ï¼Œä¸ä¸€è‡´éœ€è¦ç”¨Qualifier(&quot;æ–¹æ³•å&quot;)æŒ‡å®šï¼Œç„¶åå†è‡ªå®šä¹‰</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;restHighLevelClient&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> RestHighLevelClient client;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æµ‹è¯•æ·»åŠ æ–‡æ¡£</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAddDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        <span class="comment">// 1. åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="string">&quot;å¼ ä¸‰&quot;</span>,<span class="number">21</span>);</span><br><span class="line">        <span class="comment">// 2. åˆ›å»ºç´¢å¼•</span></span><br><span class="line">        IndexRequest request = <span class="keyword">new</span> IndexRequest(<span class="string">&quot;blog_index&quot;</span>);</span><br><span class="line">        <span class="comment">// 3. åˆ›å»ºè§„åˆ™ /user_index/_doc/1</span></span><br><span class="line">        request.id(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        request.timeout(TimeValue.timeValueSeconds(<span class="number">1</span>));</span><br><span class="line">        request.timeout(<span class="string">&quot;1s&quot;</span>);  <span class="comment">// é…ç½®æœ€å¤§è¶…æ—¶æ—¶é—´</span></span><br><span class="line">        <span class="comment">// 4. å°†æ•°æ®æ”¾å…¥è¯·æ±‚JSON</span></span><br><span class="line">        request.source(JSON.toJSONString(user), XContentType.JSON);</span><br><span class="line">        <span class="comment">// 5. å®¢æˆ·ç«¯å‘é€è¯·æ±‚</span></span><br><span class="line">        IndexResponse indexResponse = client.index(request, RequestOptions.DEFAULT);</span><br><span class="line">        System.out.println(indexResponse.toString());</span><br><span class="line">        System.out.println(indexResponse.status());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·å–æ–‡æ¡£"><a href="#è·å–æ–‡æ¡£" class="headerlink" title="è·å–æ–‡æ¡£"></a>è·å–æ–‡æ¡£</h2><ul><li>åˆ¤æ–­æ–‡æ¡£æ˜¯å¦å­˜åœ¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ¤æ–­æ–‡æ¡£æ˜¯å¦å­˜åœ¨Â·</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testIsExists</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">   <span class="comment">// 1. åˆ›å»ºè¯·æ±‚ï¼ŒæŒ‡å®šidä¸º1</span></span><br><span class="line">   GetRequest getRequest = <span class="keyword">new</span> GetRequest(<span class="string">&quot;blog_index&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">   <span class="comment">// 2. ä¸è·å–è¿”å›çš„_source çš„ä¸Šä¸‹æ–‡</span></span><br><span class="line">   getRequest.fetchSourceContext(<span class="keyword">new</span> FetchSourceContext(<span class="keyword">false</span>));</span><br><span class="line">   getRequest.storedFields(<span class="string">&quot;_none_&quot;</span>);</span><br><span class="line">   <span class="comment">// 3. åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">   <span class="keyword">boolean</span> exists = client.exists(getRequest, RequestOptions.DEFAULT);</span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•æ–‡æ¡£æ˜¯å¦å­˜åœ¨-----&quot;</span>+exists);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è·å–æ–‡æ¡£ä¿¡æ¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–æ–‡æ¡£</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetDocment</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">   GetRequest request = <span class="keyword">new</span> GetRequest(<span class="string">&quot;blog_index&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">   GetResponse response = client.get(request,RequestOptions.DEFAULT);</span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•è·å–æ–‡æ¡£-----&quot;</span>+response.getSourceAsString()); <span class="comment">// æ‰“å°æ–‡æ¡£ä¿¡æ¯</span></span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•è·å–æ–‡æ¡£-----&quot;</span>+response); <span class="comment">// è¿”å›çš„å…¨éƒ¨å†…å®¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ç»“æœ</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æµ‹è¯•è·å–æ–‡æ¡£-----&#123;&quot;age&quot;:21,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;</span><br><span class="line">æµ‹è¯•è·å–æ–‡æ¡£-----&#123;&quot;_index&quot;:&quot;blog_index&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;1&quot;,&quot;_version&quot;:1,&quot;_seq_no&quot;:0,&quot;_primary_term&quot;:1,&quot;found&quot;:true,&quot;_source&quot;:&#123;&quot;age&quot;:21,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°æ–‡æ¡£"><a href="#æ›´æ–°æ–‡æ¡£" class="headerlink" title="æ›´æ–°æ–‡æ¡£"></a>æ›´æ–°æ–‡æ¡£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°æ–‡æ¡£</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">   User user = <span class="keyword">new</span> User(<span class="string">&quot;å¼ ä¸‰&quot;</span>,<span class="number">99</span>);</span><br><span class="line">   <span class="comment">// ä¿®æ”¹IDä¸º1çš„</span></span><br><span class="line">   UpdateRequest request = <span class="keyword">new</span> UpdateRequest(<span class="string">&quot;blog_index&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">   request.timeout(<span class="string">&quot;1s&quot;</span>);</span><br><span class="line">   request.doc(JSON.toJSONString(user),XContentType.JSON);</span><br><span class="line">   UpdateResponse response = client.update(request,RequestOptions.DEFAULT);</span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•ä¿®æ”¹æ–‡æ¡£-----&quot;</span>+response);</span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•ä¿®æ”¹æ–‡æ¡£-----&quot;</span>+response.status());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ç»“æœ</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æµ‹è¯•ä¿®æ”¹æ–‡æ¡£-----UpdateResponse[index=blog_index,type=_doc,id=1,version=2,seqNo=1,primaryTerm=1,result=updated,shards=ShardInfo&#123;total=2, successful=1, failures=[]&#125;]</span><br><span class="line">æµ‹è¯•ä¿®æ”¹æ–‡æ¡£-----OK</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤æ–‡æ¡£"><a href="#åˆ é™¤æ–‡æ¡£" class="headerlink" title="åˆ é™¤æ–‡æ¡£"></a>åˆ é™¤æ–‡æ¡£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤æ–‡æ¡£</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tetsDelDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">   <span class="comment">// åˆ é™¤idä¸º1çš„</span></span><br><span class="line">   DeleteRequest request = <span class="keyword">new</span> DeleteRequest(<span class="string">&quot;blog_index&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">   request.timeout(<span class="string">&quot;1s&quot;</span>);</span><br><span class="line">   DeleteResponse response = client.delete(request,RequestOptions.DEFAULT);</span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•åˆ é™¤æ–‡æ¡£------&quot;</span>+response.status());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ‰¹é‡æ·»åŠ "><a href="#æ‰¹é‡æ·»åŠ " class="headerlink" title="æ‰¹é‡æ·»åŠ "></a>æ‰¹é‡æ·»åŠ </h2><ul><li>å®ç°æ‰¹é‡æ·»åŠ </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æµ‹è¯•æ‰¹é‡æ·»åŠ æ–‡æ¡£</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testBulkAddDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">   ArrayList&lt;User&gt; userArrayList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">   userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;user1&quot;</span>,<span class="number">50</span>));</span><br><span class="line">   userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;user2&quot;</span>,<span class="number">51</span>));</span><br><span class="line">   userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;user3&quot;</span>,<span class="number">52</span>));</span><br><span class="line">   userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;user4&quot;</span>,<span class="number">53</span>));</span><br><span class="line">   userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;user5&quot;</span>,<span class="number">54</span>));</span><br><span class="line">   userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;user6&quot;</span>,<span class="number">55</span>));</span><br><span class="line"></span><br><span class="line">   <span class="comment">// æ‰¹é‡æ“ä½œçš„Request</span></span><br><span class="line">   BulkRequest request = <span class="keyword">new</span> BulkRequest();</span><br><span class="line">   request.timeout(<span class="string">&quot;1s&quot;</span>);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// æ‰¹é‡å¤„ç†è¯·æ±‚</span></span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;userArrayList.size();i++)&#123;</span><br><span class="line">      request.add(</span><br><span class="line">          <span class="keyword">new</span> IndexRequest(<span class="string">&quot;blog_index&quot;</span>)</span><br><span class="line">               .id(<span class="string">&quot;&quot;</span>+(i+<span class="number">1</span>))</span><br><span class="line">               .source(JSON.toJSONString(userArrayList.get(i)),XContentType.JSON)</span><br><span class="line">         );</span><br><span class="line">      &#125;</span><br><span class="line">   BulkResponse response = client.bulk(request,RequestOptions.DEFAULT);</span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•æ‰¹é‡æ·»åŠ æ–‡æ¡£æ˜¯å¦å¤±è´¥-----&quot;</span>+response.hasFailures());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ç»“æœfalseä¸ºæ²¡æœ‰å¤±è´¥ï¼Œå³æˆåŠŸï¼</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æµ‹è¯•æ‰¹é‡æ·»åŠ æ–‡æ¡£æ˜¯å¦å¤±è´¥-----false</span><br></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢æ–‡æ¡£"><a href="#æŸ¥è¯¢æ–‡æ¡£" class="headerlink" title="æŸ¥è¯¢æ–‡æ¡£"></a>æŸ¥è¯¢æ–‡æ¡£</h2><ul><li>å®é™…å¼€å‘ä¸­ï¼Œåƒ<code>blog_index</code>è¿™ç§å¸¸é‡æœ€å¥½å°è£…ä¸ºä¸€ä¸ªå¸¸é‡ç±»æ“ä½œ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ESconst</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ES_INDEX = <span class="string">&quot;blog_index&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰¹é‡æŸ¥è¯¢</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSearchDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">   SearchRequest request = <span class="keyword">new</span> SearchRequest(ESconst.ES_INDEX);</span><br><span class="line">   <span class="comment">// æ„å»ºæœç´¢æ¡ä»¶</span></span><br><span class="line">   SearchSourceBuilder sourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line">   <span class="comment">// è®¾ç½®é«˜äº®</span></span><br><span class="line">   sourceBuilder.highlighter();</span><br><span class="line">   <span class="comment">// æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨QueryBuilderså·¥å…·ç±»å®ç°</span></span><br><span class="line">   <span class="comment">// 1. QueryBuilders.termQuery ç²¾ç¡®æŸ¥è¯¢</span></span><br><span class="line">   <span class="comment">// 2. QueryBuilders.matchAllQuery() åŒ¹é…æ‰€æœ‰</span></span><br><span class="line">   <span class="comment">// termç²¾ç¡®æŸ¥è¯¢ nameä¸ºuser1çš„</span></span><br><span class="line">   TermQueryBuilder termQueryBuilder = QueryBuilders.termQuery(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;user1&quot;</span> );</span><br><span class="line">   <span class="comment">//MatchAllQueryBuilder matchAllQueryBuilder = QueryBuilders.matchAllQuery();</span></span><br><span class="line">   sourceBuilder.query(termQueryBuilder);</span><br><span class="line">   sourceBuilder.timeout(<span class="keyword">new</span> TimeValue(<span class="number">60</span>, TimeUnit.SECONDS));</span><br><span class="line"></span><br><span class="line">   request.source(sourceBuilder);</span><br><span class="line">   SearchResponse response = client.search(request, RequestOptions.DEFAULT);</span><br><span class="line">   System.out.println(<span class="string">&quot;æµ‹è¯•æŸ¥è¯¢æ–‡æ¡£-----&quot;</span>+JSON.toJSONString(response.getHits()));</span><br><span class="line">   System.out.println(<span class="string">&quot;=====================&quot;</span>);</span><br><span class="line">   <span class="keyword">for</span> (SearchHit documentFields : response.getHits().getHits()) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;æµ‹è¯•æŸ¥è¯¢æ–‡æ¡£--éå†å‚æ•°--&quot;</span>+documentFields.getSourceAsMap());</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ç»“æœ</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æµ‹è¯•æŸ¥è¯¢æ–‡æ¡£-----&#123;&quot;fragment&quot;:true,&quot;hits&quot;:[&#123;&quot;fields&quot;:&#123;&#125;,&quot;fragment&quot;:false,&quot;highlightFields&quot;:&#123;&#125;,&quot;id&quot;:&quot;1&quot;,&quot;matchedQueries&quot;:[],&quot;primaryTerm&quot;:0,&quot;rawSortValues&quot;:[],&quot;score&quot;:1.540445,&quot;seqNo&quot;:-2,&quot;sortValues&quot;:[],&quot;sourceAsMap&quot;:&#123;&quot;name&quot;:&quot;user1&quot;,&quot;age&quot;:50&#125;,&quot;sourceAsString&quot;:&quot;&#123;\&quot;age\&quot;:50,\&quot;name\&quot;:\&quot;user1\&quot;&#125;&quot;,&quot;sourceRef&quot;:&#123;&quot;fragment&quot;:true&#125;,&quot;type&quot;:&quot;_doc&quot;,&quot;version&quot;:-1&#125;],&quot;maxScore&quot;:1.540445,&quot;totalHits&quot;:&#123;&quot;relation&quot;:&quot;EQUAL_TO&quot;,&quot;value&quot;:1&#125;&#125;</span><br><span class="line">=====================</span><br><span class="line">æµ‹è¯•æŸ¥è¯¢æ–‡æ¡£--éå†å‚æ•°--&#123;name=user1, age=50&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SpringBooté›†æˆ&quot;&gt;&lt;a href=&quot;#SpringBooté›†æˆ&quot; class=&quot;headerlink&quot; title=&quot;SpringBooté›†æˆ&quot;&gt;&lt;/a&gt;SpringBooté›†æˆ&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ElasticSearchæ–‡æ¡£ï¼š&lt;a href=</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/ElasticSearch/"/>
    
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/tags/ElasticSearch/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearchğŸ¯Restfulé£æ ¼æ“ä½œ</title>
    <link href="http://xiaoliblog.cn/page/ElasticSearch03.html"/>
    <id>http://xiaoliblog.cn/page/ElasticSearch03.html</id>
    <published>2021-07-01T13:32:25.684Z</published>
    <updated>2021-07-02T12:50:05.640Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Restfulé£æ ¼æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œè€Œä¸æ˜¯æ ‡å‡†ï¼Œåªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ã€‚å®ƒä¸»è¦ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’ç±»çš„è½¯ä»¶ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/_MPO9BWB%7BWEF73%7BJ8%40%5B%7EJ23.png"></p><h1 id="ç´¢å¼•æ“ä½œ"><a href="#ç´¢å¼•æ“ä½œ" class="headerlink" title="ç´¢å¼•æ“ä½œ"></a>ç´¢å¼•æ“ä½œ</h1><h2 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h2><ul><li>å¯åŠ¨ElasticSearchï¼ˆ9200ï¼‰ã€Kibanaï¼ˆ5601ï¼‰å’ŒHeadå¯è§†åŒ–ï¼ˆ9100ï¼‰</li><li>åˆ›å»ºä¸€ä¸ªç´¢å¼•</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PUT &#x2F;ç´¢å¼•å&#x2F;ç±»å‹å&#x2F;æ–‡æ¡£id</span><br><span class="line">&#123;</span><br><span class="line">   è¯·æ±‚ä½“</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/%40G%5DG25YX9S0I%28D%7B%40%400B1MRS.png"></p><ul><li>åˆ·æ–°Headå¯è§†åŒ–ç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°åˆ›å»ºäº†æ–°ç´¢å¼•test1ï¼Œåœ¨æ•°æ®æµè§ˆé‚£å¯ä»¥æŸ¥çœ‹å­—æ®µ</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/M%29K2MS04%25PY%24A7_DA_4CKGC.png"><br><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/ZVKLBJCY%40%4071I%60KZ07%2513CK.png"></p><ul><li>ElasticSearchå·²å¼ƒç”¨<code>type</code>ï¼Œé»˜è®¤éƒ½ä¸º<code>doc</code>ç±»å‹Â·</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PUT /test3/_doc/1</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å°æåšå®¢&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;age&quot;</span>:<span class="number">22</span>,</span><br><span class="line">   <span class="attr">&quot;birthday&quot;</span>:<span class="string">&quot;1999-11-12&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><ul><li>é‚£nameå’Œagaå­—æ®µéœ€ä¸éœ€è¦æŒ‡å®šç±»å‹å‘¢ï¼ElasticSearchä¸€å…±æœ‰ä»¥ä¸‹æ•°æ®ç±»å‹<ul><li>å­—ç¬¦ä¸²ç±»å‹ï¼štextã€ keyword</li><li>æ•°å€¼ç±»å‹ï¼šlongã€ integerã€ shortã€ byteã€ doubleã€ floatã€ half floatã€ scaled float</li><li>æ—¥æœŸç±»å‹ï¼šdate</li><li>å¸ƒå°”å€¼ç±»å‹ï¼šboolean</li><li>äºŒè¿›åˆ¶ç±»å‹ï¼šbinary</li></ul></li><li>æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè§„åˆ™ï¼ŒæŒ‡å®šå­—æ®µçš„ç±»å‹propertiesï¼Œå°±æ¯”å¦‚sqlåˆ›è¡¨</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PUT /test2</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;text&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;age&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;long&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;birthday&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;date&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è·å¾—è¿™ä¸ªè§„åˆ™ï¼å¯ä»¥é€šè¿‡<code>GET</code>è¯·æ±‚è·å¾—å…·ä½“çš„ä¿¡æ¯</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/4%5D%5DW0QPFAR5%5BX5JBKTEF6A8.png"></p><ul><li>å¦‚æœè‡ªå·±ä¸è®¾ç½®æ–‡æ¡£å­—æ®µç±»å‹ï¼Œé‚£ä¹ˆesä¼šè‡ªåŠ¨ç»™é»˜è®¤ç±»å‹</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/QBMOT%40FS4SG6SP%5DHR%7D6HA_N.png"></p><h2 id="catå‘½ä»¤"><a href="#catå‘½ä»¤" class="headerlink" title="catå‘½ä»¤"></a>catå‘½ä»¤</h2><ul><li>è·å–å¥åº·å€¼</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET _cat/health</span><br></pre></td></tr></table></figure><ul><li>è·å–æ‰€æœ‰çš„ä¿¡æ¯</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET _cat/indices?v</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/HYFK8G28O%5DH%24C16NMT_%60%28QW.png"></p><h2 id="ä¿®æ”¹ç´¢å¼•"><a href="#ä¿®æ”¹ç´¢å¼•" class="headerlink" title="ä¿®æ”¹ç´¢å¼•"></a>ä¿®æ”¹ç´¢å¼•</h2><ul><li>ä¿®æ”¹æˆ‘ä»¬å¯ä»¥è¿˜æ˜¯ç”¨åŸæ¥çš„<code>PUT</code>çš„å‘½ä»¤ï¼Œæ ¹æ®<code>id</code>æ¥ä¿®æ”¹</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PUT /test1/type/1</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å°æåšå®¢1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;age&quot;</span>:<span class="number">23</span>,</span><br><span class="line">  <span class="attr">&quot;birthday&quot;</span>:<span class="string">&quot;1999-11-12&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;test1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;type&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;_version&quot;</span> : <span class="number">2</span>,   <span class="comment">// ç‰ˆæœ¬å·å˜ä¸º1</span></span><br><span class="line">  <span class="attr">&quot;result&quot;</span> : <span class="string">&quot;updated&quot;</span>,  <span class="comment">// æ›´æ–°</span></span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;_seq_no&quot;</span> : <span class="number">1</span>,</span><br><span class="line">  <span class="attr">&quot;_primary_term&quot;</span> : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½†æ˜¯å¦‚æœæ²¡æœ‰å¡«å†™çš„å­—æ®µä¼šé‡ç½®ä¸ºç©ºäº†ï¼Œç›¸å½“äºjavaæ¥å£ä¼ å¯¹è±¡ä¿®æ”¹ï¼Œå¦‚æœåªæ˜¯ä¼ <code>id</code>çš„æŸäº›å­—æ®µï¼Œé‚£å…¶ä»–æ²¡ä¼ çš„å€¼éƒ½ä¸ºç©ºäº†</li><li>è¿˜æœ‰ä¸€ç§<code>update</code>æ–¹æ³• è¿™ç§ä¸è®¾ç½®æŸäº›å€¼ æ•°æ®ä¸ä¼šä¸¢å¤±</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /test1/type/1</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å°æåšå®¢3&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;test1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;type&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;_version&quot;</span> : <span class="number">3</span>,    <span class="comment">// ç‰ˆæœ¬å˜ä¸º3</span></span><br><span class="line">  <span class="attr">&quot;result&quot;</span> : <span class="string">&quot;updated&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;_seq_no&quot;</span> : <span class="number">2</span>,</span><br><span class="line">  <span class="attr">&quot;_primary_term&quot;</span> : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¸¦<code>doc</code>ä¿®æ”¹å¦‚ä¸‹ï¼ŒæŸ¥è¯¢ä¹Ÿæ˜¯å¸¦docçš„ï¼ˆdocumentï¼‰</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /test3/_doc/1</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;doc&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å°æåšå®¢4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;age&quot;</span>:<span class="number">23</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤ç´¢å¼•"></a>åˆ é™¤ç´¢å¼•</h2><ul><li>é€šè¿‡<code>DELETE</code>å‘½ä»¤å®ç°åˆ é™¤ï¼Œæ ¹æ®ä½ çš„è¯·æ±‚æ¥åˆ¤æ–­æ˜¯åˆ é™¤ç´¢å¼•è¿˜æ˜¯åˆ é™¤æ–‡æ¡£è®°å½•</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DELETE test2  // åˆ é™¤ç´¢å¼•test2</span><br><span class="line">DELETE /test3/_doc/1  // åˆ é™¤ç´¢å¼•test3ä¸‹çš„æ–‡æ¡£1</span><br></pre></td></tr></table></figure><h1 id="æ–‡æ¡£æ“ä½œ"><a href="#æ–‡æ¡£æ“ä½œ" class="headerlink" title="æ–‡æ¡£æ“ä½œ"></a>æ–‡æ¡£æ“ä½œ</h1><h2 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h2><ul><li>é¦–å…ˆæ·»åŠ ä¸‰ä¸ªæ•°æ®</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">PUT /blog/user/1</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å¼ ä¸‰&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;age&quot;</span>:<span class="number">23</span>,</span><br><span class="line">  <span class="attr">&quot;desc&quot;</span>:<span class="string">&quot;åŠªåŠ›åŠªåŠ›å†åŠªåŠ›&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;tags&quot;</span>:[<span class="string">&quot;æŠ€æœ¯&quot;</span>,<span class="string">&quot;æ¸©æŸ”&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line">PUT /blog/user/2</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;æå››&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;age&quot;</span>:<span class="number">21</span>,</span><br><span class="line">  <span class="attr">&quot;desc&quot;</span>:<span class="string">&quot;æˆ‘æ˜¯æä¸‰çš„å¤§å“¥&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;tags&quot;</span>:[<span class="string">&quot;æŠ€æœ¯ç‹‚&quot;</span>,<span class="string">&quot;æ—…æ¸¸&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line">PUT /blog/user/3</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ç‹äº”&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;age&quot;</span>:<span class="number">20</span>,</span><br><span class="line">  <span class="attr">&quot;desc&quot;</span>:<span class="string">&quot;æ­¤äººå¾ˆæ‡’&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;tags&quot;</span>:[<span class="string">&quot;éŸ³ä¹&quot;</span>,<span class="string">&quot;æ—…æ¸¸&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/MZAPM%5DEI%24U65G%7B7P75WJWYV.png"></p><ul><li>æœ€ç®€å•çš„æœç´¢æ˜¯GETï¼Œæœç´¢åŠŸèƒ½<code>search</code></li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/1  // ç®€å•æœç´¢</span><br><span class="line">GET /blog/user/_search?q=name:æå››  // å¸¦æ¡ä»¶æŸ¥è¯¢</span><br></pre></td></tr></table></figure><div class="note success simple"><p>è¿™è¾¹nameæ˜¯<code>text</code>æ‰€ä»¥åšäº†åˆ†è¯çš„æŸ¥è¯¢ï¼Œå¦‚æœæ˜¯<code>keyword</code>å°±ä¸ä¼šåˆ†è¯æœç´¢äº†</p></div><ul><li>æ›´æ–°æ•°æ® PUTï¼Œæˆ–è€…ä½¿ç”¨POST <code>update</code>ã€æ¨èã€‘</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PUT /blog/user/3</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ç‹äº”3&quot;</span> <span class="comment">//ä½¿ç”¨PUTå…¶ä»–å­—æ®µæ²¡æœ‰èµ‹å€¼ä¼šç½®ç©º</span></span><br><span class="line">&#125;</span><br><span class="line">POST /blog/user/3/_update </span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;doc&quot;</span>:&#123;</span><br><span class="line">   <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ç‹äº”3&quot;</span>     <span class="comment">// å…¶ä»–å­—æ®µä¸ä¼šä¸ºç©ºï¼Œæ¨èä½¿ç”¨</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚æŸ¥è¯¢"><a href="#å¤æ‚æŸ¥è¯¢" class="headerlink" title="å¤æ‚æŸ¥è¯¢"></a>å¤æ‚æŸ¥è¯¢</h2><ul><li>å¸¦æŸ¥è¯¢å‚æ•°ä½“æŸ¥è¯¢</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;   <span class="comment">// æŸ¥è¯¢å‚æ•°ä½“</span></span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;æå››&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/RW23L30_T2I7B7%5D%25Q3%7DM_CR.png"></p><h3 id="ç»“æœè¿‡æ»¤"><a href="#ç»“æœè¿‡æ»¤" class="headerlink" title="ç»“æœè¿‡æ»¤"></a>ç»“æœè¿‡æ»¤</h3><ul><li>å¦‚æœåªæŸ¥è¯¢éƒ¨åˆ†ä¿¡æ¯ï¼Œæ¯”å¦‚åªæŸ¥è¯¢å§“åå’Œæè¿°ã€‚ç»“æœè¿‡æ»¤ï¼Œåªå±•ç¤ºåˆ—è¡¨ä¸­æŸäº›å­—æ®µ</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;_source&quot;</span>: [<span class="string">&quot;name&quot;</span>,<span class="string">&quot;desc&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/4XIAP9C%282%5BZ%24K7%40%5BT%7DXC%6013.png"></p><ul><li>ä¹Ÿå¯ä»¥ä½¿ç”¨åŒ…å«æ¥è¿›è¡Œè¿‡æ»¤ï¼Œåªæ˜¾ç¤ºåŒ…å«å‚æ•°é‡Œçš„å­—æ®µ</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;_source&quot;</span>: &#123;<span class="attr">&quot;includes&quot;</span>: [<span class="string">&quot;name&quot;</span>,<span class="string">&quot;age&quot;</span>]&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ä¸åŒ…å«æ’åºå­—æ®µï¼Œä¸è¿›è¡Œæ˜¾ç¤º</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;_source&quot;</span>: &#123;<span class="attr">&quot;excludes&quot;</span>: [<span class="string">&quot;name&quot;</span>,<span class="string">&quot;age&quot;</span>]&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ’åºæŸ¥è¯¢"><a href="#æ’åºæŸ¥è¯¢" class="headerlink" title="æ’åºæŸ¥è¯¢"></a>æ’åºæŸ¥è¯¢</h3><ul><li>æŒ‰å¹´é¾„æ’åºæŸ¥è¯¢</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;sort&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;age&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;order&quot;</span>: <span class="string">&quot;desc&quot;</span>  <span class="comment">// å€’åº</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h3><ul><li>åˆ†é¡µæŸ¥è¯¢æœ‰ä¸¤ä¸ªå‚æ•°<code>form</code>ï¼šä»ç¬¬å‡ ä¸ªæ•°æ®å¼€å§‹å’Œ<code>size</code>ï¼šè¿”å›å¤šå°‘æ¡æ•°æ®ï¼Œå³å½“å‰é¡µé¢æ•°æ®æ¡æ•°</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;from&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;size&quot;</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤šæ¡ä»¶æŸ¥è¯¢"><a href="#å¤šæ¡ä»¶æŸ¥è¯¢" class="headerlink" title="å¤šæ¡ä»¶æŸ¥è¯¢"></a>å¤šæ¡ä»¶æŸ¥è¯¢</h2><h3 id="å¸ƒå°”å€¼æŸ¥è¯¢"><a href="#å¸ƒå°”å€¼æŸ¥è¯¢" class="headerlink" title="å¸ƒå°”å€¼æŸ¥è¯¢"></a>å¸ƒå°”å€¼æŸ¥è¯¢</h3><ul><li><code>must</code>å‘½ä»¤ç›¸å½“äº<code>and</code>ï¼Œæ‰€æœ‰çš„æ¡ä»¶éƒ½è¦ç¬¦åˆï¼Œæ¯”å¦‚æŸ¥è¯¢åå­—åŒ…å«ç‹äº”ï¼Œå¹´é¾„ä¸º23çš„ä¿¡æ¯</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;must&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;age&quot;</span>: <span class="string">&quot;20&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>should</code>ç›¸å½“äº<code>or</code>ï¼Œæ»¡è¶³ä¸€ä¸ªæ¡ä»¶å³å¯</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;should&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;age&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>must_not</code>ç›¸å½“äº<code>not</code>ï¼Œéï¼Œæ¯”å¦‚æŸ¥è¯¢å¹´é¾„ä¸ä¸º3çš„ä¿¡æ¯</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;must_not&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;age&quot;</span>: <span class="string">&quot;3&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¡ä»¶åŒºé—´"><a href="#æ¡ä»¶åŒºé—´" class="headerlink" title="æ¡ä»¶åŒºé—´"></a>æ¡ä»¶åŒºé—´</h3><ul><li>å¯ä»¥å¯¹æŸ¥è¯¢è¿›è¡ŒåŒºé—´æŸ¥è¯¢ï¼Œå¯¹ç»“æœè¿›è¡Œè¿‡æ»¤æ“ä½œ<ul><li><code>gt</code>å¤§äº</li><li><code>gte</code>å¤§äºç­‰äº</li><li><code>lte</code>å°äº</li><li><code>lte</code>å°äºç­‰äº</li></ul></li><li>æ¯”å¦‚æŸ¥è¯¢å§“åå«ç‹äº”ï¼Œä¸”å¹´é¾„åœ¨åŒºé—´[10,20]ä¹‹é—´çš„ä¿¡æ¯</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;must&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;filter&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;range&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;age&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;gte&quot;</span>: <span class="number">10</span>, </span><br><span class="line">            <span class="attr">&quot;lte&quot;</span>: <span class="number">20</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤šæ¡ä»¶åŒ¹é…"><a href="#å¤šæ¡ä»¶åŒ¹é…" class="headerlink" title="å¤šæ¡ä»¶åŒ¹é…"></a>å¤šæ¡ä»¶åŒ¹é…</h3><ul><li>é…ç½®å¤šä¸ªæ¡ä»¶ã€‚æ¯”å¦‚å¯¹æ ‡ç­¾è¿›è¡Œå¤šæ¡ä»¶æŸ¥è¯¢</li><li><code>tags</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¤šä¸ªæ¡ä»¶ç”¨ç©ºæ ¼éš”å¼€ï¼Œåªè¦æ»¡è¶³å…¶ä¸€å°±å¯ä»¥åŒ¹é…åˆ°ï¼Œåˆ†è¯åŒ¹é…ã€‚åŒ¹é…ç»“æœè¶Šå¤šï¼Œå…¶æƒé‡<code>score</code>è¶Šå¤§</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;tags&quot;</span>: <span class="string">&quot;éŸ³ä¹ æ—…æ¸¸&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å…³äºåˆ†è¯"><a href="#å…³äºåˆ†è¯" class="headerlink" title="å…³äºåˆ†è¯"></a>å…³äºåˆ†è¯</h1><h2 id="ç²¾ç¡®æŸ¥è¯¢"><a href="#ç²¾ç¡®æŸ¥è¯¢" class="headerlink" title="ç²¾ç¡®æŸ¥è¯¢"></a>ç²¾ç¡®æŸ¥è¯¢</h2><ul><li><code>term</code>ç›´æ¥æŸ¥è¯¢ç²¾ç¡®çš„å€¼ï¼Œä½¿ç”¨äº†å€’æ’ç´¢å¼•ï¼Œå…¶æ•ˆç‡é«˜ï¼</li><li><code>match</code>ä¼šä½¿ç”¨åˆ†è¯å™¨è§£æï¼ï¼ˆå…ˆåˆ†ææ–‡æ¡£ï¼Œç„¶åé€šè¿‡åˆ†æçš„æ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢ï¼‰</li><li><code>text</code>ç±»å‹å¯ä»¥è¢«åˆ†è¯å™¨è§£æï¼Œ<code>keyword</code>ä¸èƒ½è¢«åˆ†è¯å™¨è§£æ</li><li>æ­å»ºä¸€ä¸ªæµ‹è¯•ç¯å¢ƒï¼Œè®¾ç½®<code>name</code>ä¸ºÂ·<code>text</code>ç±»å‹Â·ï¼Œ<code>desc</code>ä¸º<code>keyword</code>ç±»å‹Â·</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">PUT testdb</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;text&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;desc&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;keyword&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">PUT testdb/_doc/1</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å°æåšå®¢name&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;desc&quot;</span>:<span class="string">&quot;å°æåšå®¢desc&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">PUT testdb/_doc/2</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;å°æåšå®¢name&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;desc&quot;</span>:<span class="string">&quot;å°æåšå®¢desc2&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>name</code>ä¸ºÂ·<code>text</code>ç±»å‹Â·ï¼Œå¯ä»¥Â·è¢«åˆ†è¯å™¨è§£æï¼Œèƒ½æŸ¥å‡ºå«<code>æ</code>çš„ä¿¡æ¯ï¼Œå› ä¸ºè¢«åˆ†è¯äº†ï¼Œå­—ç¬¦ä¸²æ‹†åˆ†</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET testdb/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;term&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;æ&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>desc</code>ä¸ºÂ·<code>keyword</code>ç±»å‹Â·ï¼Œä¸å¯ä»¥è¢«åˆ†è¯å™¨è§£æï¼Œä¸èƒ½æŸ¥å‡ºå«<code>æ</code>çš„ä¿¡æ¯ï¼Œå› ä¸ºæ˜¯ä¸€ä¸ªæ•´ä½“</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET testdb/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;term&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;desc&quot;</span>:<span class="string">&quot;æ&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤šå€¼ç²¾ç¡®æŸ¥è¯¢"><a href="#å¤šå€¼ç²¾ç¡®æŸ¥è¯¢" class="headerlink" title="å¤šå€¼ç²¾ç¡®æŸ¥è¯¢"></a>å¤šå€¼ç²¾ç¡®æŸ¥è¯¢</h2><ul><li>æ·»åŠ æ•°æ®</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PUT /testdb/_doc/3</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;t1&quot;</span>:<span class="string">&quot;22&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;t2&quot;</span>:<span class="string">&quot;2020-7-2&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">PUT /testdb/_doc/4</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;t1&quot;</span>:<span class="string">&quot;23&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;t2&quot;</span>:<span class="string">&quot;2020-7-3&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç²¾ç¡®æŸ¥è¯¢t1=22æˆ–è€…t1=23çš„ä¿¡æ¯</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">GET /testdb/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;should&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;term&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;t1&quot;</span>: <span class="string">&quot;22&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;term&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;t1&quot;</span>:<span class="string">&quot;23&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»“æœé«˜äº®"><a href="#ç»“æœé«˜äº®" class="headerlink" title="ç»“æœé«˜äº®"></a>ç»“æœé«˜äº®</h2><ul><li>åŒ¹é…é«˜äº®çš„å­—æ®µä¼šè¢«è‡ªåŠ¨æ·»åŠ æ ·å¼ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GET blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;highlight&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;fields&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>:&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/NED91K6S%60ASJV6I%5BVTPN78Y.png"></p><ul><li>è‡ªå®šä¹‰æ ‡ç­¾</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET blog/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ç‹äº”&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;highlight&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;pre_tags&quot;</span>:<span class="string">&quot;&lt;span class=&#x27;key&#x27; style=&#x27;color:red&#x27;&gt;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;post_tags&quot;</span>: <span class="string">&quot;&lt;/span&gt;&quot;</span>, </span><br><span class="line">    <span class="attr">&quot;fields&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>:&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch2/9HTI3%5D%29SNBVW%5D0S3%5D%60HZFS3.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;Restfulé£æ ¼æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œè€Œä¸æ˜¯æ ‡å‡†ï¼Œåªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ã€‚å®ƒä¸»è¦ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’ç±»çš„è½¯ä»¶ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://origi</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/ElasticSearch/"/>
    
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearchğŸ¯ElasticSearchæ ¸å¿ƒæ¦‚å¿µåŠIKåˆ†è¯å™¨</title>
    <link href="http://xiaoliblog.cn/page/ElasticSearch02.html"/>
    <id>http://xiaoliblog.cn/page/ElasticSearch02.html</id>
    <published>2021-07-01T10:54:47.038Z</published>
    <updated>2021-07-01T13:52:38.459Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ESæ ¸å¿ƒæ¦‚å¿µ"><a href="#ESæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="ESæ ¸å¿ƒæ¦‚å¿µ"></a>ESæ ¸å¿ƒæ¦‚å¿µ</h1><div class="note success simple"><p>ElasticSearchæ˜¯é¢å‘æ–‡æ¡£ï¼Œå…³ç³»å‹æ•°æ®åº“å’ŒElasticSearchå®¢è§‚çš„å¯¹æ¯”ï¼ä¸€åˆ‡éƒ½æ˜¯<code>json</code></p></div><table><thead><tr><th align="center">Relational DB</th><th align="center">Elasticsearch</th></tr></thead><tbody><tr><td align="center">æ•°æ®åº“ï¼ˆdatabaseï¼‰</td><td align="center">ç´¢å¼•ï¼ˆindicesï¼‰</td></tr><tr><td align="center">è¡¨ï¼ˆtablesï¼‰</td><td align="center">ç±»å‹typesï¼ˆå·²å¼ƒç”¨ï¼‰</td></tr><tr><td align="center">è¡Œï¼ˆrowsï¼‰</td><td align="center">æ–‡æ¡£ï¼ˆdocumentsï¼‰</td></tr><tr><td align="center">å­—æ®µï¼ˆcolumnsï¼‰</td><td align="center">å­—æ®µï¼ˆfieldsï¼‰</td></tr></tbody></table><ul><li>ElasticSearchï¼ˆé›†ç¾¤ï¼‰ä¸­å¯ä»¥åŒ…å«å¤šä¸ªç´¢å¼•ï¼ˆæ•°æ®åº“ï¼‰ï¼Œ,æ¯ä¸ªç´¢å¼•ä¸­å¯ä»¥åŒ…å«å¤šä¸ªç±»å‹ï¼ˆè¡¨ï¼‰ ï¼Œæ¯ä¸ªç±»å‹ä¸‹åˆåŒ…å«å¤šä¸ªæ–‡æ¡£ï¼ˆè¡Œï¼‰ï¼Œæ¯ä¸ªæ–‡æ¡£ä¸­åˆåŒ…å«å¤šä¸ªå­—æ®µï¼ˆåˆ—ï¼‰</li><li><strong>ç‰©ç†è®¾è®¡</strong><ul><li>ElasticSearchåœ¨åå°æŠŠæ¯ä¸ª<strong>ç´¢å¼•åˆ’åˆ†æˆå¤šä¸ªåˆ†ç‰‡</strong>ï¼Œæ¯åˆ†åˆ†ç‰‡å¯ä»¥åœ¨é›†ç¾¤ä¸­çš„ä¸åŒæœåŠ¡å™¨é—´è¿ç§»</li><li>ä¸€ä¸ªäººå°±æ˜¯ä¸€ä¸ªé›†ç¾¤ï¼é»˜è®¤çš„é›†ç¾¤åå­—å°±æ˜¯<code>elasticsearch</code></li></ul></li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/K3DZ%7D4BGFOBGJE_%29NDXFUBV.png"></p><ul><li><strong>é€»è¾‘è®¾è®¡</strong><ul><li>ä¸€ä¸ªç´¢å¼•ç±»å‹ä¸­ï¼ŒåŒ…å«å¤šä¸ªæ–‡æ¡£ï¼Œæ¯”å¦‚è¯´æ–‡æ¡£1 ï¼Œæ–‡æ¡£2ã€‚å½“æˆ‘ä»¬ç´¢å¼•ä¸€ç¯‡æ–‡æ¡£æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿™æ ·çš„ä¸€ä¸ªé¡ºåºæ‰¾åˆ°å®ƒï¼šç´¢å¼•ğŸ—¡ç±»å‹ğŸ—¡æ–‡æ¡£IDï¼Œé€šè¿‡è¿™ä¸ªç»„åˆæˆ‘ä»¬å°±èƒ½ç´¢å¼•åˆ°æŸä¸ªå…·ä½“çš„æ–‡æ¡£ã€‚æ³¨æ„ï¼šIDä¸å¿…æ˜¯æ•´æ•° ï¼Œå®é™…ä¸Šå®ƒæ˜¯ä¸ªå­—ç¬¦ä¸²ã€‚</li></ul></li></ul><h2 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h2><ul><li>ElasticSearchæ˜¯é¢å‘æ–‡æ¡£çš„ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ç´¢å¼•å’Œæœç´¢æ•°æ®çš„<strong>æœ€å°å•ä½æ˜¯æ–‡æ¡£</strong>ï¼ŒElasticSearchä¸­ï¼Œæ–‡æ¡£æœ‰å‡ ä¸ªé‡è¦å±æ€§:<ul><li>ESçš„æ–‡æ¡£å°±åƒMySqlä¸­çš„ä¸€æ¡è®°å½•ï¼Œåªæ˜¯ESçš„æ–‡æ¡£ä¼šè¢«åºåˆ—åŒ–æˆjsonæ ¼å¼ï¼Œä¿å­˜åœ¨Elasticsearchä¸­ï¼›</li><li>è¿™ä¸ªjsonå¯¹è±¡æ˜¯ç”±å­—æ®µç»„æˆï¼Œå­—æ®µå°±ç›¸å½“äºMysqlçš„åˆ—ï¼Œæ¯ä¸ªå­—æ®µéƒ½æœ‰è‡ªå·±çš„ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”ã€äºŒè¿›åˆ¶ã€æ—¥æœŸèŒƒå›´ç±»å‹ï¼‰ï¼›</li><li>å½“æˆ‘ä»¬åˆ›å»ºæ–‡æ¡£æ—¶ï¼Œå¦‚æœä¸æŒ‡å®šå­—æ®µçš„ç±»å‹ï¼ŒElasticsearchä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨åŒ¹é…ç±»å‹</li><li>æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸€ä¸ªIDï¼Œç±»ä¼¼MySqlçš„ä¸»é”®ï¼Œå’±ä»¬å¯ä»¥è‡ªå·±æŒ‡å®šï¼Œä¹Ÿå¯ä»¥è®©Elasticsearchè‡ªåŠ¨ç”Ÿæˆï¼›</li><li>æ–‡æ¡£çš„jsonæ ¼å¼æ”¯æŒæ•°ç»„/åµŒå¥—ï¼Œåœ¨ä¸€ä¸ªç´¢å¼•ï¼ˆæ•°æ®åº“ï¼‰æˆ–ç±»å‹ï¼ˆè¡¨ï¼‰é‡Œé¢ï¼Œä½ å¯ä»¥å­˜å‚¨ä»»æ„å¤šçš„æ–‡æ¡£ã€‚</li><li>å…·æœ‰çµæ´»çš„ç»“æ„ï¼Œæ–‡æ¡£ä¸ä¾èµ–é¢„å…ˆå®šä¹‰çš„æ¨¡å¼ï¼Œæˆ‘ä»¬çŸ¥é“å…³ç³»å‹æ•°æ®åº“ä¸­è¦æå‰å®šä¹‰å­—æ®µæ‰èƒ½ä½¿ç”¨ï¼Œåœ¨elasticsearchä¸­ï¼Œå¯¹äºå­—æ®µæ˜¯éå¸¸çµæ´»çš„ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥è¯¥å­—æ®µï¼Œæˆ–è€…åŠ¨æ€çš„æ·»åŠ ä¸€ä¸ªæ–°çš„å­—æ®µ</li></ul></li><li>å°½ç®¡æˆ‘ä»¬å¯ä»¥éšæ„çš„æ–°å¢æˆ–è€…å¿½ç•¥æŸä¸ªå­—æ®µï¼Œä½†æ˜¯ï¼Œæ¯ä¸ªå­—æ®µçš„ç±»å‹éå¸¸é‡è¦ï¼Œæ¯”å¦‚ä¸€ä¸ªå¹´é¾„å­—æ®µç±»å‹ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯æ•´å½¢ã€‚å› ä¸ºelasticsearchä¼šä¿å­˜å­—æ®µå’Œç±»å‹ä¹‹é—´çš„æ˜ å°„åŠå…¶ä»–çš„è®¾ç½®ã€‚è¿™ç§æ˜ å°„å…·ä½“åˆ°æ¯ä¸ªæ˜ å°„çš„æ¯ç§ç±»å‹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨elasticsearchä¸­ç±»å‹æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºæ˜ å°„ç±»å‹</li></ul><h2 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h2><ul><li>ç±»å‹æ˜¯æ–‡æ¡£çš„é€»è¾‘å®¹å™¨ï¼Œå°±åƒå…³ç³»å‹æ•°æ®åº“ä¸€æ ·ï¼Œè¡¨æ ¼æ˜¯è¡Œçš„å®¹å™¨</li><li>ç±»å‹ä¸­å¯¹äºå­—æ®µçš„å®šä¹‰ç§°ä¸ºæ˜ å°„ï¼Œæ¯”å¦‚nameæ˜ å°„ä¸ºå­—ç¬¦ä¸²ç±»å‹</li><li>æˆ‘ä»¬è¯´æ–‡æ¡£æ˜¯æ— æ¨¡å¼çš„ï¼Œå®ƒä»¬ä¸éœ€è¦æ‹¥æœ‰æ˜ å°„ä¸­æ‰€å®šä¹‰çš„æ‰€æœ‰å­—æ®µï¼Œæ¯”å¦‚æ–°å¢ä¸€ä¸ªå­—æ®µï¼Œé‚£ä¹ˆelasticsearchæ˜¯æ€ä¹ˆåšçš„å‘¢?<ul><li>elasticsearchä¼šè‡ªåŠ¨çš„å°†æ–°å­—æ®µåŠ å…¥æ˜ å°„ï¼Œä½†æ˜¯è¿™ä¸ªå­—æ®µçš„ä¸ç¡®å®šå®ƒæ˜¯ä»€ä¹ˆç±»å‹ï¼Œelasticsearchå°±å¼€å§‹çŒœï¼Œå¦‚æœè¿™ä¸ªå€¼æ˜¯18ï¼Œé‚£ä¹ˆelasticsearchä¼šè®¤ä¸ºå®ƒæ˜¯æ•´å½¢</li><li>ä½†æ˜¯elasticsearchä¹Ÿå¯èƒ½çŒœä¸å¯¹ ï¼Œæ‰€ä»¥æœ€å®‰å…¨çš„æ–¹å¼å°±æ˜¯æå‰å®šä¹‰å¥½æ‰€éœ€è¦çš„æ˜ å°„ï¼Œè¿™ç‚¹è·Ÿå…³ç³»å‹æ•°æ®åº“æ®Šé€”åŒå½’äº†ï¼Œå…ˆå®šä¹‰å¥½å­—æ®µï¼Œç„¶åå†ä½¿ç”¨ï¼Œåˆ«æ•´ä»€ä¹ˆå¹ºè›¾å­</li></ul></li></ul><h2 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h2><ul><li>ç´¢å¼•å°±ç›¸å½“äºMySqlé‡Œçš„æ•°æ®åº“ï¼Œå®ƒæ˜¯å…·æœ‰æŸç§ç›¸ä¼¼ç‰¹æ€§çš„æ–‡æ¡£é›†åˆã€‚åè¿‡æ¥è¯´ä¸åŒç‰¹æ€§çš„æ–‡æ¡£ä¸€èˆ¬éƒ½æ”¾åœ¨ä¸åŒçš„ç´¢å¼•é‡Œï¼›</li><li>ç´¢å¼•å…·æœ‰mappingå’Œsettingçš„æ¦‚å¿µï¼Œ<code>mapping</code>ç”¨æ¥å®šä¹‰æ–‡æ¡£å­—æ®µçš„ç±»å‹ï¼Œ<code>setting</code>ç”¨æ¥å®šä¹‰ä¸åŒæ•°æ®çš„åˆ†å¸ƒ</li><li>ç´¢å¼•æ˜¯æ˜ å°„ç±»å‹çš„å®¹å™¨ï¼Œelasticsearchä¸­çš„ç´¢å¼•æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ–‡æ¡£é›†åˆã€‚ ç´¢å¼•å­˜å‚¨äº†æ˜ å°„ç±»å‹çš„å­—æ®µå’Œå…¶ä»–è®¾ç½®ã€‚ç„¶åå®ƒä»¬è¢«å­˜å‚¨åˆ°äº†å„ä¸ªåˆ†ç‰‡ä¸Šäº†ï¼Œæˆ‘ä»¬æ¥ç ”ç©¶ä¸‹åˆ†ç‰‡æ˜¯å¦‚ä½•å·¥ä½œçš„</li><li>ç‰©ç†è®¾è®¡ï¼šèŠ‚ç‚¹å’Œåˆ†ç‰‡å¦‚ä½•å·¥ä½œ<ul><li>ä¸€ä¸ªé›†ç¾¤è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªelasricsearchè¿›ç¨‹ï¼ŒèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªç´¢å¼•é»˜è®¤çš„ï¼Œå¦‚æœä½ åˆ›å»ºç´¢å¼•ï¼Œé‚£ä¹ˆç´¢å¼•å°†ä¼šæœ‰ä¸ª5ä¸ªåˆ†ç‰‡ï¼ˆprimary shardï¼Œåˆç§°ä¸»åˆ†ç‰‡ï¼‰æ„æˆçš„ï¼Œæ¯ä¸€ä¸ªä¸»åˆ†ç‰‡ä¼šæœ‰ä¸€ä¸ªå‰¯æœ¬ï¼ˆreplica shardï¼Œåˆç§°å¤åˆ¶åˆ†ç‰‡ï¼‰</li></ul></li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/3M0M%29SQWC0CIC%259%7DS4%5DFK33.png"></p><ul><li>ä¸Šå›¾æ˜¯ä¸€ä¸ªæœ‰3ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œå¯ä»¥çœ‹åˆ°ä¸»åˆ†ç‰‡å’Œå¯¹åº”çš„å¤åˆ¶åˆ†ç‰‡éƒ½ä¸ä¼šåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹å†…ï¼Œè¿™æ ·æœ‰åˆ©äºæŸä¸ªèŠ‚ç‚¹æŒ‚æ‰äº†, æ•°æ®ä¹Ÿä¸è‡³äºä¸¢å¤±</li><li>å®é™…ä¸Šï¼Œä¸€ä¸ªåˆ†ç‰‡æ˜¯ä¸€ä¸ªLuceneç´¢å¼• ï¼Œä¸€ä¸ªåŒ…å«å€’æ’ç´¢å¼•çš„æ–‡ä»¶ç›®å½•ï¼Œå€’æ’ç´¢å¼•çš„ç»“æ„ä½¿å¾—elasticsearchåœ¨ä¸æ‰«æå…¨éƒ¨æ–‡æ¡£çš„æƒ…å†µä¸‹ï¼Œå°±èƒ½å‘Šè¯‰ä½ å“ªäº›æ–‡æ¡£åŒ…å«ç‰¹å®šçš„å…³é”®å­—</li></ul><h2 id="å€’æ’ç´¢å¼•"><a href="#å€’æ’ç´¢å¼•" class="headerlink" title="å€’æ’ç´¢å¼•"></a>å€’æ’ç´¢å¼•</h2><ul><li>elasticsearchä½¿ç”¨çš„æ˜¯ä¸€ç§ç§°ä¸ºå€’æ’ç´¢å¼•çš„ç»“æ„ï¼Œé‡‡ç”¨Luceneå€’æ’ç´¢ä½œä¸ºåº•å±‚ã€‚è¿™ç§ç»“æ„é€‚ç”¨äºå¿«é€Ÿçš„å…¨æ–‡æœç´¢ï¼Œä¸€ä¸ªç´¢å¼•ç”±æ–‡æ¡£ä¸­æ‰€æœ‰ä¸é‡å¤çš„åˆ—è¡¨æ„æˆï¼Œå¯¹äºæ¯ä¸€ä¸ªè¯ï¼Œéƒ½æœ‰ä¸€ä¸ªåŒ…å«å®ƒçš„æ–‡æ¡£åˆ—è¡¨</li><li>ä¾‹å¦‚ï¼Œç°åœ¨æœ‰ä¸¤ä¸ªæ–‡æ¡£ï¼Œæ¯ä¸ªæ–‡æ¡£åŒ…å«å¦‚ä¸‹å†…å®¹:</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Study every day, good good up to forever  #æ–‡æ¡£1åŒ…å«çš„å†…å®¹</span><br><span class="line">To forever, study every day, good good up #æ–‡æ¡£2åŒ…å«çš„å†…å®¹</span><br></pre></td></tr></table></figure><ul><li>ä¸ºäº†åˆ›å»ºå€’æ’ç´¢å¼•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å°†æ¯ä¸ªæ–‡æ¡£æ‹†åˆ†æˆç‹¬ç«‹çš„è¯ï¼ˆæˆ–ç§°ä¸ºè¯æ¡æˆ–è€…tokensï¼‰ ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¸é‡å¤çš„è¯æ¡çš„æ’åºåˆ—è¡¨ï¼Œç„¶ååˆ—å‡ºæ¯ä¸ªè¯æ¡å‡ºç°åœ¨å“ªä¸ªæ–‡æ¡£</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/XPZ5KWLBUHPQ4C%60QYFV%25%40QG.png"></p><ul><li>ç°åœ¨ï¼Œæˆ‘ä»¬è¯•å›¾æœç´¢ <code>to forever</code>ï¼Œåªéœ€è¦æŸ¥çœ‹åŒ…å«æ¯ä¸ªè¯æ¡çš„æ–‡æ¡£</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/HD%7EHR7Y28C_VTVIH%299A%40HZ4.png"></p><ul><li>ä¸¤ä¸ªæ–‡æ¡£éƒ½åŒ¹é…ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªæ–‡æ¡£æ¯”ç¬¬äºŒä¸ªåŒ¹é…ç¨‹åº¦æ›´é«˜ã€‚å¦‚æœæ²¡æœ‰åˆ«çš„æ¡ä»¶ï¼Œç°åœ¨è¿™ä¸¤ä¸ªåŒ…å«å…³é”®å­—çš„æ–‡æ¡£éƒ½å°†è¿”å›ã€‚</li><li>å†æ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼Œæ¯”å¦‚æˆ‘ä»¬é€šè¿‡åšå®¢æ ‡ç­¾æ¥æœç´¢åšå®¢æ–‡ç« ã€‚é‚£ä¹ˆå€’æ’ç´¢å¼•åˆ—è¡¨å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªç»“æ„:</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/%4010%7BGBSH%29%7B27LT2NUA%28ZYZR.png"></p><ul><li>å¦‚æœè¦æœç´¢å«æœ‰pythonæ ‡ç­¾çš„æ–‡ç« ï¼Œé‚£ç›¸å¯¹äºæŸ¥æ‰¾æ‰€æœ‰åŸå§‹æ•°æ®è€Œè¨€ï¼ŒæŸ¥æ‰¾å€’æ’ç´¢å¼•åçš„æ•°æ®å°†ä¼šå¿«çš„å¤šã€‚åªéœ€è¦æŸ¥çœ‹æ ‡ç­¾è¿™ä¸€æ ï¼Œç„¶åè·å–ç›¸å…³çš„æ–‡ç« IDå³å¯ã€‚å®Œå…¨è¿‡æ»¤æ‰æ— å…³çš„æ‰€æœ‰æ•°æ®ï¼Œæé«˜æ•ˆç‡!</li><li>elasticsearchçš„ç´¢å¼•å’ŒLuceneçš„ç´¢å¼•å¯¹æ¯”<ul><li>åœ¨elasticsearchä¸­ï¼Œç´¢å¼•ï¼ˆåº“ï¼‰è¿™ä¸ªè¯è¢«é¢‘ç¹ä½¿ç”¨ï¼Œè¿™å°±æ˜¯æœ¯è¯­çš„ä½¿ç”¨</li><li>åœ¨elasticsearchä¸­ ï¼Œç´¢å¼•è¢«åˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼Œæ¯ä»½åˆ†ç‰‡æ˜¯ä¸€ä¸ªLuceneçš„ç´¢å¼•ã€‚<strong>æ‰€ä»¥ä¸€ä¸ªelasticsearchç´¢å¼•æ˜¯ç”±å¤š ä¸ªLuceneç´¢å¼•ç»„æˆçš„</strong></li><li>åˆ«é—®ä¸ºä»€ä¹ˆï¼Œè°è®©elasticsearchä½¿ç”¨Luceneä½œä¸ºåº•å±‚å‘¢ã€‚å¦‚æ— ç‰¹æŒ‡ï¼Œè¯´èµ·ç´¢å¼•éƒ½æ˜¯æŒ‡elasticsearchçš„ç´¢å¼•</li></ul></li></ul><h1 id="IKåˆ†è¯å™¨"><a href="#IKåˆ†è¯å™¨" class="headerlink" title="IKåˆ†è¯å™¨"></a>IKåˆ†è¯å™¨</h1><h2 id="IKåˆ†è¯å™¨æ¦‚è¿°"><a href="#IKåˆ†è¯å™¨æ¦‚è¿°" class="headerlink" title="IKåˆ†è¯å™¨æ¦‚è¿°"></a>IKåˆ†è¯å™¨æ¦‚è¿°</h2><ul><li>åˆ†è¯ï¼šå³æŠŠä¸€æ®µä¸­æ–‡æˆ–è€…åˆ«çš„åˆ’åˆ†æˆä¸€ä¸ªä¸ªçš„å…³é”®å­—ï¼Œæˆ‘ä»¬åœ¨æœç´¢æ—¶å€™ä¼šæŠŠè‡ªå·±çš„ä¿¡æ¯è¿›è¡Œåˆ†è¯ï¼Œä¼šæŠŠæ•°æ®åº“ä¸­æˆ–è€…ç´¢å¼•åº“ä¸­çš„æ•°æ®è¿›è¡Œåˆ†è¯ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªåŒ¹é…æ“ä½œ</li><li>é»˜è®¤çš„ä¸­æ–‡åˆ†è¯å™¨æ˜¯å°†æ¯ä¸ªå­—çœ‹æˆä¸€ä¸ªè¯ï¼Œæ¯”å¦‚â€œå°æåšå®¢â€ä¼šè¢«åˆ†ä¸ºâ€å°â€ï¼Œâ€œæâ€ï¼Œâ€œåšâ€ï¼Œâ€œå®¢â€ ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç¬¦åˆè¦æ±‚çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£…ä¸­æ–‡åˆ†è¯å™¨<code>IK</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜</li><li>IKæä¾›äº†ä¸¤ä¸ªåˆ†è¯ç®—æ³•: <code>ik_ smart</code>å’Œ<code>ik_ max_ word</code> ,å…¶ä¸­<code>ik_ smart</code>ä¸ºæœ€å°‘åˆ‡åˆ†, <code>ik_ max_ _word</code>ä¸ºæœ€ç»†ç²’åº¦åˆ’åˆ†!</li></ul><h2 id="IKåˆ†è¯å™¨å®‰è£…"><a href="#IKåˆ†è¯å™¨å®‰è£…" class="headerlink" title="IKåˆ†è¯å™¨å®‰è£…"></a>IKåˆ†è¯å™¨å®‰è£…</h2><ul><li>ikåˆ†è¯å™¨ï¼š<a href="https://github.com/medcl/elasticsearch-analysis-ik">https://github.com/medcl/elasticsearch-analysis-ik</a></li><li>ä¸‹è½½å®Œæˆè§£å‹åˆ°ElasticSearchçš„æ’ä»¶<code>plugins</code>æ–‡ä»¶å¤¹ä¸­</li><li>ç„¶åé‡å¯ElasticSearchï¼Œå¯ä»¥çœ‹åˆ°IKåˆ†è¯å™¨æ’ä»¶å·²ç»è¢«åŠ è½½</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/Q9%5DN%5B9CMZGT5%60%29H0V0%7E%7DGTI.png"></p><ul><li>å¯ä»¥ä½¿ç”¨<code>elasticsearch-plugin list</code>å‘½ä»¤æŸ¥çœ‹æ‰€å®‰è£…çš„æ’ä»¶åŠç‰ˆæœ¬</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/7D%29SWSUINGTMTFAPNMX3TM3.png"></p><h2 id="Kibanaæµ‹è¯•"><a href="#Kibanaæµ‹è¯•" class="headerlink" title="Kibanaæµ‹è¯•"></a>Kibanaæµ‹è¯•</h2><ul><li>åŒå‡»å¯åŠ¨<code>kibana.bat</code>å¯åŠ¨Kibanaè®¿é—®<code>localhost:5601</code>è¿›è¡Œæµ‹è¯•</li><li>ç‚¹å‡»Kibanaå¼€å‘å·¥å…·è¿›è¡Œæµ‹è¯•</li><li>ã€<code>ik_smart</code>ã€‘æµ‹è¯•ï¼š</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/ICHIOA5_B%60%28%28C1%601%7B%28%602%28%5B3.png"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET _analyze </span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;ik_smart&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;ä¸­å›½å…±äº§å…š&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;tokens&quot;</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;ä¸­å›½å…±äº§å…š&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">5</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ã€<code>ik_max_word</code>ã€‘æµ‹è¯•ï¼š</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ik_max_wordå°†æ‰€æœ‰ç»„åˆéƒ½ä¾‹å‡ºæ¥</span></span><br><span class="line">GET _analyze </span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;ik_max_word&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;ä¸­å›½å…±äº§å…š&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;tokens&quot;</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;ä¸­å›½å…±äº§å…š&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">5</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;ä¸­å›½&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;å›½å…±&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">3</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">2</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;å…±äº§å…š&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">5</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">3</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;å…±äº§&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">4</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">4</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;å…š&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">4</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">5</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_CHAR&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">5</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰é…ç½®"><a href="#è‡ªå®šä¹‰é…ç½®" class="headerlink" title="è‡ªå®šä¹‰é…ç½®"></a>è‡ªå®šä¹‰é…ç½®</h2><ul><li>ä½†æ˜¯å½“æˆ‘è¾“å…¥æˆ‘çš„åå­—çš„æ—¶å€™ï¼Œå‘ç°æŠŠæˆ‘çš„åå­—æ‹†å¼€äº†ï¼Œè¿™å°±æ— æ³•ç²¾ç¡®æœç´¢ä¸€äº›ç‰¹å®šçš„æ¶ˆæ¯ã€‚è¿™ç§ç‰¹å®šéœ€è¦çš„è¯ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ åˆ°IKåˆ†è¯å™¨çš„å­—å…¸ä¸­ï¼</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/%60RY35CTKC431LFAA%29A2%5D%40FY.png"></p><ul><li>æ‰“å¼€ElasticSearchçš„<code>plugins</code>ç›®å½•ï¼Œæ‰¾åˆ°IKåˆ†è¯å™¨çš„<code>config</code>æ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢å¾ˆå¤šå¸¦<code>.dic</code>çš„å­—å…¸æ–‡ä»¶ï¼Œè¿™éƒ½æ˜¯é»˜è®¤çš„ã€‚æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ª<code>xiaoliblog.dic</code>å­—å…¸ï¼Œå¾€é‡Œé¢æ·»åŠ å†…å®¹ï¼Œæ³¨æ„ç¼–ç ä¸ºUTF-8</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ææŒ¯ä¸š</span><br></pre></td></tr></table></figure><ul><li>ç„¶ååœ¨<code>config</code>ç›®å½•ä¸‹çš„<code>IKAnalyzer.cfg.xml</code>é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">properties</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span>IK Analyzer æ‰©å±•é…ç½®<span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;ext_dict&quot;</span>&gt;</span>xiaoliblog.dic<span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;ext_stopwords&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;entry key=&quot;remote_ext_dict&quot;&gt;words_location&lt;/entry&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;entry key=&quot;remote_ext_stopwords&quot;&gt;words_location&lt;/entry&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç„¶åé‡å¯ElasticSearchå’ŒKibanaï¼Œå¯ä»¥çœ‹åˆ°<code>ææŒ¯ä¸š</code>ä¸¤ä¸ªå­—ä¸å†è¢«æ‹†åˆ†</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET _analyze </span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;ik_max_word&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;ä¸€ç›´åŠªåŠ›çš„ææŒ¯ä¸š&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;tokens&quot;</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;ä¸€ç›´&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;ä¸€&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;TYPE_CNUM&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;ç›´&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_CHAR&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">2</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;åŠªåŠ›&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">4</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">3</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;çš„&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">4</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">5</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_CHAR&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">4</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;token&quot;</span> : <span class="string">&quot;ææŒ¯ä¸š&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start_offset&quot;</span> : <span class="number">5</span>,</span><br><span class="line">      <span class="attr">&quot;end_offset&quot;</span> : <span class="number">8</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;position&quot;</span> : <span class="number">5</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ESæ ¸å¿ƒæ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#ESæ ¸å¿ƒæ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;ESæ ¸å¿ƒæ¦‚å¿µ&quot;&gt;&lt;/a&gt;ESæ ¸å¿ƒæ¦‚å¿µ&lt;/h1&gt;&lt;div class=&quot;note success simple&quot;&gt;&lt;p&gt;ElasticSearchæ˜¯é¢å‘æ–‡æ¡£ï¼Œå…³ç³»</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/ElasticSearch/"/>
    
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearchğŸ¯ElasticSearchæ¦‚è¿°åŠå®‰è£…</title>
    <link href="http://xiaoliblog.cn/page/ElasticSearch01.html"/>
    <id>http://xiaoliblog.cn/page/ElasticSearch01.html</id>
    <published>2021-06-30T11:38:46.205Z</published>
    <updated>2021-07-01T10:53:40.188Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ElasticSearch"><a href="#ElasticSearch" class="headerlink" title="ElasticSearch"></a>ElasticSearch</h1><h2 id="ElasticSearchæ¦‚è¿°"><a href="#ElasticSearchæ¦‚è¿°" class="headerlink" title="ElasticSearchæ¦‚è¿°"></a>ElasticSearchæ¦‚è¿°</h2><ul><li><code>ElasticSearch</code>ç®€ç§°ä¸ºesï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ï¼Œé«˜æ€§èƒ½ã€é«˜å¯ç”¨ã€å¯ä¼¸ç¼©ã€RESTful é£æ ¼çš„æœç´¢å’Œæ•°æ®åˆ†æå¼•æ“ã€‚é€šå¸¸ä½œä¸ºElastic Stackçš„æ ¸å¿ƒæ¥ä½¿ç”¨ï¼ŒElastic Stackå¤§è‡´æ˜¯å¦‚ä¸‹è¿™æ ·ç»„æˆçš„</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/ISVF%29I%5BX%609ATX%5B%7EC%282Y3E%5BH.png"></p><ul><li>ElasticSearchä¹Ÿä½¿ç”¨Javaå¼€å‘å¹¶ä½¿ç”¨<code>Lucene</code>ä½œä¸ºå…¶æ ¸å¿ƒæ¥å®ç°æ‰€æœ‰ç´¢å¼•å’Œæœç´¢çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒçš„ç›®çš„æ˜¯é€šè¿‡ç®€å•çš„<code>RESTful API</code>æ¥éšè—Luceneçš„å¤æ‚æ€§ï¼Œä»è€Œè®©å…¨æ–‡æœç´¢å˜å¾—ç®€å•</li><li>åœ¨Javaå¼€å‘ç¯å¢ƒé‡ŒLuceneæ˜¯ ä¸€ä¸ªæˆç†Ÿçš„å…è´¹å¼€æºå·¥å…·ã€‚å°±å…¶æœ¬èº«è€Œè¨€ï¼ŒLuceneæ˜¯å½“å‰ä»¥åŠæœ€è¿‘å‡ å¹´æœ€å—æ¬¢è¿çš„å…è´¹lavaä¿¡æ¯æ£€ç´¢ç¨‹åºåº“</li><li>ElasticSearchä¸­æ–‡å®˜ç½‘ï¼š<a href="https://www.elastic.co/cn/">https://www.elastic.co/cn/</a></li><li>ESæ˜¯ä¸€ä¸ªè¿‘å®æ—¶ï¼ˆNRTï¼‰çš„æœç´¢å¼•æ“ï¼Œä¸€èˆ¬ä»æ·»åŠ æ•°æ®åˆ°èƒ½è¢«æœç´¢åˆ°åªæœ‰å¾ˆå°‘çš„å»¶è¿Ÿï¼ˆå¤§çº¦æ˜¯1sï¼‰ï¼Œè€ŒæŸ¥è¯¢æ•°æ®æ˜¯å®æ—¶çš„ã€‚ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥æŠŠESé…åˆlogstashï¼Œkibanaæ¥åšæ—¥å¿—åˆ†æç³»ç»Ÿï¼Œæˆ–è€…æ˜¯æœç´¢æ–¹é¢çš„ç³»ç»ŸåŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨ç½‘ä¸Šå•†åŸç³»ç»Ÿé‡Œå®ç°æœç´¢å•†å“çš„åŠŸèƒ½ä¹Ÿä¼šç”¨åˆ°ES</li><li>æœç´¢å•†å“çš„æ—¶å€™ä¸ºå•¥è¦ç”¨ESè€Œä¸æ¨èç”¨sqlçš„likeè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢å‘¢ï¼Ÿ<ul><li>æˆ‘ä»¬å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼šæˆ‘ä»¬è¦ä¹°è‹¹æœåƒï¼Œå’±ä»¬æƒ³ä¹°ã€å¤©æ°´ç‰¹äº§çš„èŠ±ç‰›è‹¹æœã€‘ï¼Œç„¶ååœ¨æœç´¢æ¡†è¾“å…¥ã€å¤©æ°´èŠ±ç‰›è‹¹æœã€‘ï¼Œè¿™æ—¶å€™å’±ä»¬å¸Œæœ›æœç´¢åˆ°æ‰€æœ‰çš„å”®å–å¤©æ°´èŠ±ç‰›è‹¹æœçš„å•†å®¶ï¼Œä½†æ˜¯å¦‚æœå’±ä»¬æŠ€æœ¯ä¸Šæ ¹æ®è¿™ä¸ªå¤©æ°´èŠ±ç‰›è‹¹æœä½¿ç”¨sqlçš„likeæ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ˜¯ä¸èƒ½åŒ¹é…åˆ°è¯¸å¦‚ã€å¤©æ°´ç‰¹äº§èŠ±ç‰›è‹¹æœã€‘ï¼Œã€å¤©æ°´æ­£å®—ã€‘ï¼Œã€æœå›­ç›´é€ç²¾å“èŠ±ç‰›è‹¹æœã€‘è¿™ç±»çš„ä¸è¿ç»­çš„åº—é“ºçš„ã€‚æ‰€ä»¥sqlçš„likeè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢æ¥æœç´¢å•†å“å¹¶ä¸æ¨èï¼</li></ul></li></ul><h2 id="Elasticsearchå’ŒSolrå¯¹æ¯”"><a href="#Elasticsearchå’ŒSolrå¯¹æ¯”" class="headerlink" title="Elasticsearchå’ŒSolrå¯¹æ¯”"></a>Elasticsearchå’ŒSolrå¯¹æ¯”</h2><ul><li><code>Solr</code>æ˜¯Apacheä¸‹çš„ä¸€ä¸ªé¡¶çº§å¼€æºé¡¹ç›®ï¼Œé‡‡ç”¨Javaå¼€å‘ï¼Œå®ƒæ˜¯åŸºäºLuceneçš„å…¨æ–‡æœç´¢æœåŠ¡å™¨ã€‚Solræä¾› äº†æ¯”Luceneæ›´ä¸ºä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€ï¼ŒåŒæ—¶å®ç°äº†å¯é…ç½®ã€å¯æ‰©å±•ï¼Œå¹¶å¯¹ç´¢å¼•ã€æœç´¢æ€§èƒ½è¿›è¡Œäº†ä¼˜åŒ–</li><li>Solrå¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œè¿è¡Œåœ¨lettyã€Tomcatç­‰è¿™äº›Servletå®¹å™¨ä¸­ï¼ŒSolrç´¢å¼•çš„å®ç°æ–¹æ³•å¾ˆç®€å•ï¼Œ<strong>ç”¨POSTæ–¹æ³•å‘SolræœåŠ¡å™¨å‘é€ä¸€ä¸ªæè¿°FieldåŠå…¶å†…å®¹çš„XMLæ–‡æ¡£ï¼Œ Solræ ¹æ®xmlæ–‡æ¡£æ·»åŠ ã€åˆ é™¤ã€æ›´æ–°ç´¢å¼•</strong></li><li>Solr æœç´¢åªéœ€è¦å‘é€HTTP GETè¯·æ±‚,ç„¶åå¯¹Solrè¿”å›<code>Xml</code>ã€<code>json</code>ç­‰æ ¼å¼çš„æŸ¥è¯¢ç»“æœè¿›è¡Œè§£æï¼Œç»„ç»‡é¡µé¢å¸ƒå±€ã€‚Solrä¸æä¾›æ„å»ºUIçš„åŠŸèƒ½ï¼ŒSolræä¾›äº†ä¸€ä¸ªç®¡ç†ç•Œé¢ï¼Œé€šè¿‡ç®¡ç†ç•Œé¢å¯ä»¥æŸ¥è¯¢Solrçš„é…ç½®å’Œè¿è¡Œæƒ…å†µ</li><li>Solræ˜¯åŸºäºluceneå¼€å‘ä¼ä¸šçº§æœç´¢æœåŠ¡å™¨ï¼Œå®é™…ä¸Šå°±æ˜¯å°è£…äº†lucene</li><li>Solræ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¼ä¸šçº§æœç´¢åº”ç”¨æœåŠ¡å™¨ï¼Œå®ƒå¯¹å¤–æä¾›ç±»ä¼¼äº<code>Web-service</code>çš„APIæ¥å£ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡httpè¯·æ±‚ï¼Œå‘æœç´¢å¼•æ“æœåŠ¡å™¨æäº¤ä¸€å®šæ ¼å¼çš„æ–‡ä»¶ç”Ÿæˆç´¢å¼•ï¼›ä¹Ÿå¯ä»¥é€šè¿‡æå‡ºæŸ¥æ‰¾è¯·æ±‚ï¼Œå¹¶å¾—åˆ°è¿”å›ç»“æœ</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/%7D2%256RTH58UOY1WIL0%25TYX0X.png"><br><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/L%28NN%7DE%5DL%7B550S1MKF%7DNW%7BDH.png"><br><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/YUK3%7E%5B%7BF6N9TIU%60%409RUW%7BTS.png"></p><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/%40G%7E6G08NPZ4%5B%7BRR2S%7E%25KYUR.png"></p><ul><li>ElasticSearch vs Solr æ€»ç»“<ul><li>esåŸºæœ¬æ˜¯å¼€ç®±å³ç”¨ï¼Œéå¸¸ç®€å•ã€‚Solrå®‰è£…ç•¥å¾®å¤æ‚ä¸€ä¸¢ä¸¢</li><li>Solr åˆ©ç”¨ Zookeeper è¿›è¡Œåˆ†å¸ƒå¼ç®¡ç†ï¼Œè€Œ Elasticsearch è‡ªèº«å¸¦æœ‰åˆ†å¸ƒå¼åè°ƒç®¡ç†åŠŸèƒ½ã€‚</li><li>Solr æ”¯æŒæ›´å¤šæ ¼å¼çš„æ•°æ®ï¼Œæ¯”å¦‚JSONã€XMLã€CSVï¼Œè€Œ Elasticsearch ä»…æ”¯æŒjsonæ–‡ä»¶æ ¼å¼</li><li>Solr å®˜æ–¹æä¾›çš„åŠŸèƒ½æ›´å¤šï¼Œè€Œ Elasticsearch æœ¬èº«æ›´æ³¨é‡äºæ ¸å¿ƒåŠŸèƒ½ï¼Œé«˜çº§åŠŸèƒ½å¤šæœ‰ç¬¬ä¸‰æ–¹æ’ä»¶æä¾›ï¼Œä¾‹å¦‚å›¾å½¢åŒ–ç•Œé¢éœ€è¦kibanaå‹å¥½æ”¯æ’‘</li><li>Solr æŸ¥è¯¢å¿«ï¼Œä½†æ›´æ–°ç´¢å¼•æ—¶æ…¢ï¼ˆå³æ’å…¥åˆ é™¤æ…¢ï¼‰ï¼Œç”¨äºç”µå•†ç­‰æŸ¥è¯¢å¤šçš„åº”ç”¨ï¼›</li><li>ESå»ºç«‹ç´¢å¼•å¿«ï¼ˆå³æŸ¥è¯¢æ…¢ï¼‰ï¼Œå³å®æ—¶æ€§æŸ¥è¯¢å¿«ï¼Œç”¨äºfacebookæ–°æµªç­‰æœç´¢ã€‚</li><li>Solr æ˜¯ä¼ ç»Ÿæœç´¢åº”ç”¨çš„æœ‰åŠ›è§£å†³æ–¹æ¡ˆï¼Œä½† Elasticsearch æ›´é€‚ç”¨äºæ–°å…´çš„å®æ—¶æœç´¢åº”ç”¨ã€‚</li><li>Solræ¯”è¾ƒæˆç†Ÿï¼Œæœ‰ä¸€ä¸ªæ›´å¤§ï¼Œæ›´æˆç†Ÿçš„ç”¨æˆ·ã€å¼€å‘å’Œè´¡çŒ®è€…ç¤¾åŒºï¼Œè€Œ Elasticsearchç›¸å¯¹å¼€å‘ç»´æŠ¤è€…è¾ƒå°‘ï¼Œæ›´æ–°å¤ªå¿«ï¼Œå­¦ä¹ ä½¿ç”¨æˆæœ¬è¾ƒé«˜ã€‚</li></ul></li></ul><div class="note success simple"><p>Elasticsearchå’ŒSolræ¯”è¾ƒæ›´å¤šå‚è€ƒï¼š<a href="https://www.cnblogs.com/blueskyli/p/8326229.html">https://www.cnblogs.com/blueskyli/p/8326229.html</a></p></div><h1 id="ElasticSearchå®‰è£…"><a href="#ElasticSearchå®‰è£…" class="headerlink" title="ElasticSearchå®‰è£…"></a>ElasticSearchå®‰è£…</h1><h2 id="ElasticSearchå®‰è£…-1"><a href="#ElasticSearchå®‰è£…-1" class="headerlink" title="ElasticSearchå®‰è£…"></a>ElasticSearchå®‰è£…</h2><div class="note warning simple"><p>æ³¨æ„jdkå¿…é¡»æ˜¯<code>1.8</code>åŠä»¥ä¸Šçš„ç‰ˆæœ¬</p></div><ul><li>ElasticSearché•œåƒä¸‹è½½åœ°å€ï¼š<a href="https://mirrors.huaweicloud.com/elasticsearch/?C=N&amp;O=D">https://mirrors.huaweicloud.com/elasticsearch/?C=N&amp;O=D</a></li><li>logstashï¼š <a href="https://mirrors.huaweicloud.com/logstash/?C=N&amp;O=D">https://mirrors.huaweicloud.com/logstash/?C=N&amp;O=D</a></li><li>å¯è§†åŒ–ç•Œé¢elasticsearch-headï¼š<a href="https://github.com/mobz/elasticsearch-head">https://github.com/mobz/elasticsearch-head</a></li><li>kibanaï¼š<a href="https://mirrors.huaweicloud.com/kibana/?C=N&amp;O=D">https://mirrors.huaweicloud.com/kibana/?C=N&amp;O=D</a></li><li>ikåˆ†è¯å™¨ï¼š<a href="https://github.com/medcl/elasticsearch-analysis-ik">https://github.com/medcl/elasticsearch-analysis-ik</a></li></ul><div class="btns rounded center grid5">            <a href="https://pan.baidu.com/s/1oriKmGdjER3jP-9sybetrg" title="æå–ç nf1z"><i class="fas fa-download"></i>æå–ç nf1z</a>          </div><ul><li>ä¸‹è½½åè§£å‹ElasticSearchå³å¯ä½¿ç”¨ï¼Œå…¶æ¶æ„ç›®å½•å¦‚ä¸‹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">|--bin                   # äºŒè¿›åˆ¶æ–‡ä»¶</span><br><span class="line">   |--elasticsearch.bat  # å¯åŠ¨æ–‡ä»¶</span><br><span class="line">|--config                # é…ç½®æ–‡ä»¶</span><br><span class="line">   |--log4j2.properties  # æ—¥å¿—é…ç½®æ–‡ä»¶</span><br><span class="line">   |--jvm.options        # javaè™šæ‹Ÿæœºç›¸å…³é…ç½®</span><br><span class="line">   |--elasticsearch.yml  # ElasticSearché…ç½®æ–‡ä»¶ï¼Œé»˜è®¤9200ç«¯å£</span><br><span class="line">|--lib                   # ç›¸å…³jaråŒ…</span><br><span class="line">|--logs                  # æ—¥å¿—</span><br><span class="line">|--modules               # åŠŸèƒ½æ¨¡å—</span><br><span class="line">|--plugins               # æ’ä»¶</span><br></pre></td></tr></table></figure><ul><li>ç”µè„‘é…ç½®ä½çš„éœ€è¦ä¿®æ”¹<code>config</code>ä¸­çš„<code>jvm.options</code>å¯åŠ¨å†…å­˜ï¼Œé»˜è®¤å¯åŠ¨éœ€è¦<code>-Xms1g</code>ï¼Œå³1Gå†…å­˜</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-Xms256m</span><br><span class="line">-Xmx256m</span><br></pre></td></tr></table></figure><ul><li>åŒå‡»<code>bin/elasticsearch.bat</code>å³å¯ï¼Œç„¶åç­‰å¾…å¯åŠ¨ï¼Œè®¿é—®<code>localhost:9200</code>ï¼Œå¦‚ä¸‹æ‰€ç¤º</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/24JSZUIF%7D5WH%7D%29%5B_%60KTKTTL.png"></p><h2 id="å¯è§†åŒ–ç•Œé¢headå®‰è£…"><a href="#å¯è§†åŒ–ç•Œé¢headå®‰è£…" class="headerlink" title="å¯è§†åŒ–ç•Œé¢headå®‰è£…"></a>å¯è§†åŒ–ç•Œé¢headå®‰è£…</h2><ul><li>æ¥ä¸‹æ¥å®‰è£…å¯è§†åŒ–ç•Œé¢<code>elasticsearch-head</code>ï¼Œæ˜¯ä¸€æ¬¾ä¸“é—¨é’ˆå¯¹äºelasticsearchçš„å®¢æˆ·ç«¯å·¥å…·ã€‚åŸºäºNode.jsçš„å‰ç«¯å·¥ç¨‹ï¼Œéœ€è¦é…ç½®Node.jsç¯å¢ƒ</li><li>å¯è§†åŒ–ç•Œé¢elasticsearch-headï¼š<a href="https://github.com/mobz/elasticsearch-head">https://github.com/mobz/elasticsearch-head</a></li><li>ä¸‹è½½å…‹éš†å‹ç¼©åŒ…å¹¶è§£å‹åï¼ˆæœ€åè§£å‹åˆ°ElasticSearchåŒä¸€æ–‡ä»¶å¤¹ä¸‹ï¼‰ï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br><span class="line">npm run start</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨è®¿é—®<code>localhost:9200</code>åå¦‚ä¸‹æ‰€ç¤ºï¼Œç”±äºä¸åŒçš„ç«¯å£è®¿é—®ä¼šå‡ºç°è·¨åŸŸé—®é¢˜</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/5%7EE%60NCM%284%60%24ND%60%7BA%256NC6%5DJ.png"></p><ul><li>å…ˆåœæ‰ElasticSearchçš„æœåŠ¡ï¼Œä¿®æ”¹<code>elasticsearch.yml</code>é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç </li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cluster.initial_master_nodes:</span> [<span class="string">&quot;node-1&quot;</span>]  <span class="comment"># è¿™é‡Œçš„node-1ä¸ºnode-nameé…ç½®çš„å€¼</span></span><br><span class="line"><span class="attr">xpack.ml.enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment"># å‘ç°è¿æ¥ä¸ä¸Šï¼Œè·¨åŸŸé—®é¢˜ï¼ˆè·¨ç«¯å£ï¼Œè·¨ç½‘ç«™ç­‰ï¼‰ä¿®æ”¹é…ç½®ï¼Œè®¾ç½®è·¨åŸŸ</span></span><br><span class="line"><span class="attr">http.cors.enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">http.cors.allow-origin:</span> <span class="string">&quot;*&quot;</span> </span><br></pre></td></tr></table></figure><ul><li>ç„¶åé‡å¯å¯åŠ¨ElasticSearchï¼Œç„¶åé‡å¯è®¿é—®</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/H5VN%249S%60JXA60%24%40ORAN1%2463.png"></p><h2 id="ELKåŠkibanaå®‰è£…"><a href="#ELKåŠkibanaå®‰è£…" class="headerlink" title="ELKåŠkibanaå®‰è£…"></a>ELKåŠkibanaå®‰è£…</h2><ul><li><code>ELK</code>æ˜¯Elasticsearch.ã€Logstashã€Kibanaä¸‰å¤§å¼€æºæ¡†æ¶é¦–å­—æ¯å¤§å†™ç®€ç§°ã€‚å¸‚é¢ä¸Šä¹Ÿè¢«æˆä¸ºElastic Stack</li><li>å…¶ä¸­<code>Elasticsearch</code>æ˜¯ä¸€ä¸ªåŸºäºLuceneã€åˆ†å¸ƒå¼ã€é€šè¿‡Restfulæ–¹å¼è¿›è¡Œäº¤äº’çš„è¿‘å®æ—¶æœç´¢å¹³å°æ¡†æ¶</li><li><code>Logstash</code>æ˜¯ELKçš„ä¸­å¤®æ•°æ®æµå¼•æ“Šï¼Œç”¨äºä»ä¸åŒç›®æ ‡ï¼ˆæ–‡ä»¶/æ•°æ®å­˜å‚¨/MQ ï¼‰æ”¶é›†çš„ä¸åŒæ ¼å¼æ•°æ®ï¼Œç»è¿‡è¿‡æ»¤åæ”¯æŒè¾“å‡ºåˆ°ä¸åŒç›®çš„åœ°(æ–‡ä»¶/MQ/redis/elasticsearch/kafkaç­‰)</li><li><code>Kibana</code>å¯ä»¥å°†elasticsearchçš„æ•°æ®é€šè¿‡å‹å¥½çš„é¡µé¢å±•ç¤ºå‡ºæ¥ï¼Œæä¾›å®æ—¶åˆ†æçš„åŠŸèƒ½</li><li>å¸‚é¢ä¸Šå¾ˆå¤šå¼€å‘åªè¦æåˆ°ELKèƒ½å¤Ÿä¸€è‡´è¯´å‡ºå®ƒæ˜¯ä¸€ä¸ªæ—¥å¿—åˆ†ææ¶æ„æŠ€æœ¯æ ˆæ€»ç§°ï¼Œä½†å®é™…ä¸ŠELKä¸ä»…ä»…é€‚ç”¨äºæ—¥å¿—åˆ†æï¼Œå®ƒè¿˜å¯ä»¥æ”¯æŒå…¶å®ƒä»»ä½•æ•°æ®åˆ†æå’Œæ”¶é›†çš„åœºæ™¯ï¼Œæ—¥å¿—åˆ†æå’Œæ”¶é›†åªæ˜¯æ›´å…·æœ‰ä»£è¡¨æ€§ã€‚å¹¶éå”¯ä¸€æ€§</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/RR51B%25T%5BI614G3XTQ%7B2GUDL.png"></p><ul><li><code>Kibana</code>æ˜¯ä¸€ä¸ªé’ˆå¯¹Elasticsearchçš„å¼€æºåˆ†æåŠå¯è§†åŒ–å¹³å°ï¼Œç”¨æ¥æœç´¢ã€æŸ¥çœ‹äº¤äº’å­˜å‚¨åœ¨Elasticsearchç´¢å¼•ä¸­çš„æ•°æ®ã€‚ ä½¿ç”¨Kibana ,å¯ä»¥é€šè¿‡å„ç§å›¾è¡¨è¿›è¡Œé«˜çº§æ•°æ®åˆ†æåŠå±•ç¤º</li><li>Kibanaè®©æµ·é‡æ•°æ®æ›´å®¹ æ˜“ç†è§£ã€‚å®ƒæ“ä½œç®€å•ï¼ŒåŸºäºæµè§ˆå™¨çš„ç”¨æˆ·ç•Œé¢å¯ä»¥å¿«é€Ÿåˆ›å»ºä»ªè¡¨æ¿( dashboard )å®æ—¶æ˜¾ç¤ºElasticsearchæŸ¥è¯¢åŠ¨æ€</li><li>è®¾ç½®Kibanaéå¸¸ç®€å•ã€‚ æ— éœ€ç¼–ç æˆ–è€…é¢å¤–çš„åŸºç¡€æ¶æ„ï¼Œå‡ åˆ†é’Ÿå†…å°±å¯ä»¥å®ŒæˆKibanaå®‰è£…å¹¶å¯åŠ¨Elasticsearchç´¢å¼•ç›‘æµ‹</li><li>Kibanaå®˜ç½‘ï¼š<a href="https://www.elastic.co/cn/kibana/">https://www.elastic.co/cn/kibana/</a></li><li>kibanaä¸‹è½½åœ°å€ï¼š<a href="https://mirrors.huaweicloud.com/kibana/?C=N&amp;O=D">https://mirrors.huaweicloud.com/kibana/?C=N&amp;O=D</a></li></ul><div class="note warning simple"><p>Kibanaç‰ˆæœ¬è¦å’ŒElasticSearchä¸€è‡´</p></div><ul><li>ä¸‹è½½ä¹‹åè§£å‹ï¼Œè§£å‹éœ€è¦ä¸€å®šæ—¶é—´ã€‚å…¶ä¹Ÿæ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‰ç«¯åŒ–å·¥å…·</li><li>è§£å‹ä¹‹ååŒå‡»æ‰“å¼€<code>bin/kibana.bat</code>ï¼Œç„¶åç­‰å¾…å¯åŠ¨ï¼Œå¡ä½å¯ä»¥æŒ‰å›è½¦</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/8O%7E%24OH4Z%29%7E0VNCH%29_%5D%25%5B%28_D.png"></p><ul><li>è®¿é—®åœ°å€<code>localhost:5601</code>ï¼Œç»“æœå¦‚ä¸‹</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/ElasticSearch/_5GMT71D%7BUBIVTZQG_%28%5BRSK.png"></p><ul><li>é…ç½®æ±‰åŒ–ï¼Œä¿®æ”¹<code>config/kibana.yml</code>ï¼Œç„¶åé‡å¯<code>kibana.bat</code></li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">i18n.locale:</span> <span class="string">&quot;zh-CN&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ElasticSearch&quot;&gt;&lt;a href=&quot;#ElasticSearch&quot; class=&quot;headerlink&quot; title=&quot;ElasticSearch&quot;&gt;&lt;/a&gt;ElasticSearch&lt;/h1&gt;&lt;h2 id=&quot;ElasticSearchæ¦‚è¿°&quot;&gt;&lt;a h</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/ElasticSearch/"/>
    
    
    <category term="ElasticSearch" scheme="http://xiaoliblog.cn/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯Redisç¼“å­˜ç©¿é€å’Œé›ªå´©</title>
    <link href="http://xiaoliblog.cn/page/Redis09.html"/>
    <id>http://xiaoliblog.cn/page/Redis09.html</id>
    <published>2021-06-30T10:59:05.291Z</published>
    <updated>2021-06-30T11:26:46.161Z</updated>
    
    <content type="html"><![CDATA[<div class="note warning simple"><p>æœåŠ¡å™¨é«˜å¯ç”¨é—®é¢˜</p></div><ul><li>Redisç¼“å­˜çš„ä½¿ç”¨ï¼Œæå¤§çš„æå‡äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œæ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯æ•°æ®æŸ¥è¯¢æ–¹é¢ã€‚ä½†åŒæ—¶ï¼Œå®ƒä¹Ÿå¸¦æ¥äº†ä¸€ äº›é—®é¢˜ã€‚å…¶ä¸­ï¼Œæœ€è¦å®³çš„é—®é¢˜ï¼Œå°±æ˜¯æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œä»ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œè¿™ä¸ªé—®é¢˜æ— è§£ã€‚å¦‚æœå¯¹æ•°æ® çš„ä¸€è‡´æ€§è¦æ±‚å¾ˆé«˜ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨ç¼“å­˜ã€‚</li><li>å¦å¤–çš„ä¸€äº›å…¸å‹é—®é¢˜å°±æ˜¯ï¼Œç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©å’Œç¼“å­˜å‡»ç©¿ã€‚ç›®å‰ï¼Œä¸šç•Œä¹Ÿéƒ½æœ‰æ¯”è¾ƒæµè¡Œçš„è§£å†³æ–¹æ¡ˆ</li></ul><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/3OYQU2%5BZ_%60%7E%7B%5DS5M8NTPVSB.png" width="70%"><h1 id="ç¼“å­˜ç©¿é€"><a href="#ç¼“å­˜ç©¿é€" class="headerlink" title="ç¼“å­˜ç©¿é€"></a>ç¼“å­˜ç©¿é€</h1><h2 id="ç¼“å­˜ç©¿é€æ¦‚å¿µ"><a href="#ç¼“å­˜ç©¿é€æ¦‚å¿µ" class="headerlink" title="ç¼“å­˜ç©¿é€æ¦‚å¿µ"></a>ç¼“å­˜ç©¿é€æ¦‚å¿µ</h2><ul><li>ç¼“å­˜ç©¿é€çš„æ¦‚å¿µå¾ˆç®€å•ï¼Œç”¨æˆ·æƒ³è¦æŸ¥è¯¢ä¸€ä¸ªæ•°æ®ï¼Œå‘ç°rediså†…å­˜æ•°æ®åº“æ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œäº æ˜¯å‘æŒä¹…å±‚æ•°æ®åº“æŸ¥è¯¢ã€‚å‘ç°ä¹Ÿæ²¡æœ‰ï¼Œäºæ˜¯æœ¬æ¬¡æŸ¥è¯¢å¤±è´¥ã€‚å½“ç”¨æˆ·å¾ˆå¤šçš„æ—¶å€™ï¼Œç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­ï¼ˆç§’ æ€ï¼ï¼‰ï¼Œäºæ˜¯éƒ½å»è¯·æ±‚äº†æŒä¹…å±‚æ•°æ®åº“ã€‚è¿™ä¼šç»™æŒä¹…å±‚æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œè¿™æ—¶å€™å°±ç›¸å½“äºå‡ºç°äº† ç¼“å­˜ç©¿é€ã€‚</li><li>ç¼“å­˜ç©¿é€è§£å†³æ–¹æ¡ˆ<ul><li>å¸ƒéš†è¿‡æ»¤å™¨</li><li>ç¼“å­˜ç©ºå¯¹è±¡</li></ul></li></ul><h2 id="å¸ƒéš†è¿‡æ»¤å™¨"><a href="#å¸ƒéš†è¿‡æ»¤å™¨" class="headerlink" title="å¸ƒéš†è¿‡æ»¤å™¨"></a>å¸ƒéš†è¿‡æ»¤å™¨</h2><ul><li>å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ ¡éªŒï¼Œä¸ç¬¦åˆåˆ™ ä¸¢å¼ƒï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢å‹åŠ›ï¼›</li></ul><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/OA%7DR%400%5D4W%5BD%5DXJ9ABD%29%5D%7D3B.png" width="60%"><h2 id="ç¼“å­˜ç©ºå¯¹è±¡"><a href="#ç¼“å­˜ç©ºå¯¹è±¡" class="headerlink" title="ç¼“å­˜ç©ºå¯¹è±¡"></a>ç¼“å­˜ç©ºå¯¹è±¡</h2><ul><li>å½“å­˜å‚¨å±‚ä¸å‘½ä¸­åï¼Œå³ä½¿è¿”å›çš„ç©ºå¯¹è±¡ä¹Ÿå°†å…¶ç¼“å­˜èµ·æ¥ï¼ŒåŒæ—¶ä¼šè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹‹åå†è®¿é—®è¿™ä¸ªæ•° æ®å°†ä¼šä»ç¼“å­˜ä¸­è·å–ï¼Œä¿æŠ¤äº†åç«¯æ•°æ®æºï¼›</li></ul><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/OD32Z0A14AIXY%7DFD6W%5BC%29C5.png" width="60%"><ul><li>ä½†æ˜¯è¿™ç§æ–¹æ³•ä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š<ul><li>å¦‚æœç©ºå€¼èƒ½å¤Ÿè¢«ç¼“å­˜èµ·æ¥ï¼Œè¿™å°±æ„å‘³ç€ç¼“å­˜éœ€è¦æ›´å¤šçš„ç©ºé—´å­˜å‚¨æ›´å¤šçš„é”®ï¼Œå› ä¸ºè¿™å½“ä¸­å¯èƒ½ä¼šæœ‰å¾ˆå¤š çš„ç©ºå€¼çš„é”®ï¼›</li><li>å³ä½¿å¯¹ç©ºå€¼è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œè¿™å¯¹äº éœ€è¦ä¿æŒä¸€è‡´æ€§çš„ä¸šåŠ¡ä¼šæœ‰å½±å“ã€‚</li></ul></li></ul><h1 id="ç¼“å­˜å‡»ç©¿"><a href="#ç¼“å­˜å‡»ç©¿" class="headerlink" title="ç¼“å­˜å‡»ç©¿"></a>ç¼“å­˜å‡»ç©¿</h1><h2 id="ç¼“å­˜å‡»ç©¿æ¦‚å¿µ"><a href="#ç¼“å­˜å‡»ç©¿æ¦‚å¿µ" class="headerlink" title="ç¼“å­˜å‡»ç©¿æ¦‚å¿µ"></a>ç¼“å­˜å‡»ç©¿æ¦‚å¿µ</h2><ul><li>è¿™é‡Œéœ€è¦æ³¨æ„å’Œç¼“å­˜å‡»ç©¿çš„åŒºåˆ«ï¼Œç¼“å­˜å‡»ç©¿ï¼Œæ˜¯æŒ‡ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­ å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚</li><li>å½“æŸä¸ªkeyåœ¨è¿‡æœŸçš„ç¬é—´ï¼Œæœ‰å¤§é‡çš„è¯·æ±‚å¹¶å‘è®¿é—®ï¼Œè¿™ç±»æ•°æ®ä¸€èˆ¬æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œç”±äºç¼“å­˜è¿‡æœŸï¼Œä¼šåŒæ—¶è®¿ é—®æ•°æ®åº“æ¥æŸ¥è¯¢æœ€æ–°æ•°æ®ï¼Œå¹¶ä¸”å›å†™ç¼“å­˜ï¼Œä¼šå¯¼ä½¿æ•°æ®åº“ç¬é—´å‹åŠ›è¿‡å¤§ã€‚</li></ul><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><ul><li>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ ä»ç¼“å­˜å±‚é¢æ¥çœ‹ï¼Œæ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°çƒ­ç‚¹ key è¿‡æœŸåäº§ç”Ÿçš„é—®é¢˜ã€‚</li><li>åŠ äº’æ–¥é”</li><li>åˆ†å¸ƒå¼é”ï¼šä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œä¿è¯å¯¹äºæ¯ä¸ªkeyåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å»æŸ¥è¯¢åç«¯æœåŠ¡ï¼Œå…¶ä»–çº¿ç¨‹æ²¡æœ‰è·å¾—åˆ†å¸ƒ å¼é”çš„æƒé™ï¼Œå› æ­¤åªéœ€è¦ç­‰å¾…å³å¯ã€‚è¿™ç§æ–¹å¼å°†é«˜å¹¶å‘çš„å‹åŠ›è½¬ç§»åˆ°äº†åˆ†å¸ƒå¼é”ï¼Œå› æ­¤å¯¹åˆ†å¸ƒå¼é”çš„è€ƒ éªŒå¾ˆå¤§ã€‚</li></ul><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/FXC%7DUHJS%40%2545%296%5D06%28ESKBA.png" width="60%"><h1 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h1><h2 id="ç¼“å­˜é›ªå´©æ¦‚å¿µ"><a href="#ç¼“å­˜é›ªå´©æ¦‚å¿µ" class="headerlink" title="ç¼“å­˜é›ªå´©æ¦‚å¿µ"></a>ç¼“å­˜é›ªå´©æ¦‚å¿µ</h2><ul><li>ç¼“å­˜é›ªå´©ï¼Œæ˜¯æŒ‡åœ¨æŸä¸€ä¸ªæ—¶é—´æ®µï¼Œç¼“å­˜é›†ä¸­è¿‡æœŸå¤±æ•ˆã€‚Redis å®•æœºï¼</li><li>äº§ç”Ÿé›ªå´©çš„åŸå› ä¹‹ä¸€ï¼Œæ¯”å¦‚åœ¨å†™æœ¬æ–‡çš„æ—¶å€™ï¼Œé©¬ä¸Šå°±è¦åˆ°åŒåäºŒé›¶ç‚¹ï¼Œå¾ˆå¿«å°±ä¼šè¿æ¥ä¸€æ³¢æŠ¢è´­ï¼Œè¿™æ³¢å•† å“æ—¶é—´æ¯”è¾ƒé›†ä¸­çš„æ”¾å…¥äº†ç¼“å­˜ï¼Œå‡è®¾ç¼“å­˜ä¸€ä¸ªå°æ—¶ã€‚é‚£ä¹ˆåˆ°äº†å‡Œæ™¨ä¸€ç‚¹é’Ÿçš„æ—¶å€™ï¼Œè¿™æ‰¹å•†å“çš„ç¼“å­˜å°±éƒ½ è¿‡æœŸäº†ã€‚è€Œå¯¹è¿™æ‰¹å•†å“çš„è®¿é—®æŸ¥è¯¢ï¼Œéƒ½è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå¯¹äºæ•°æ®åº“è€Œè¨€ï¼Œå°±ä¼šäº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›æ³¢ å³°ã€‚äºæ˜¯æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¾¾åˆ°å­˜å‚¨å±‚ï¼Œå­˜å‚¨å±‚çš„è°ƒç”¨é‡ä¼šæš´å¢ï¼Œé€ æˆå­˜å‚¨å±‚ä¹Ÿä¼šæŒ‚æ‰çš„æƒ…å†µ</li></ul><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/%5DYX%7D%290%5DYU2E1PFQPK%40C%25JOG.png" width="70%"><ul><li>å…¶å®é›†ä¸­è¿‡æœŸï¼Œå€’ä¸æ˜¯éå¸¸è‡´å‘½ï¼Œæ¯”è¾ƒè‡´å‘½çš„ç¼“å­˜é›ªå´©ï¼Œæ˜¯ç¼“å­˜æœåŠ¡å™¨æŸä¸ªèŠ‚ç‚¹å®•æœºæˆ–æ–­ç½‘ã€‚å› ä¸ºè‡ªç„¶ å½¢æˆçš„ç¼“å­˜é›ªå´©ï¼Œä¸€å®šæ˜¯åœ¨æŸä¸ªæ—¶é—´æ®µé›†ä¸­åˆ›å»ºç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ•°æ®åº“ä¹Ÿæ˜¯å¯ä»¥é¡¶ä½å‹åŠ›çš„ã€‚æ— éå°± æ˜¯å¯¹æ•°æ®åº“äº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›è€Œå·²ã€‚è€Œç¼“å­˜æœåŠ¡èŠ‚ç‚¹çš„å®•æœºï¼Œå¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆçš„å‹åŠ›æ˜¯ä¸å¯é¢„çŸ¥ çš„ï¼Œå¾ˆæœ‰å¯èƒ½ç¬é—´å°±æŠŠæ•°æ®åº“å‹å®</li></ul><h2 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><ul><li><strong>Redisé«˜å¯ç”¨</strong><ul><li>è¿™ä¸ªæ€æƒ³çš„å«ä¹‰æ˜¯ï¼Œæ—¢ç„¶redisæœ‰å¯èƒ½æŒ‚æ‰ï¼Œé‚£æˆ‘å¤šå¢è®¾å‡ å°redisï¼Œè¿™æ ·ä¸€å°æŒ‚æ‰ä¹‹åå…¶ä»–çš„è¿˜å¯ä»¥ç»§ç»­ å·¥ä½œï¼Œå…¶å®å°±æ˜¯æ­å»ºçš„é›†ç¾¤ã€‚ï¼ˆå¼‚åœ°å¤šæ´»ï¼ï¼‰</li></ul></li><li><strong>é™æµé™çº§</strong><ul><li>è¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„æ€æƒ³æ˜¯ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æ•°æ®åº“å†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ã€‚æ¯”å¦‚å¯¹ æŸä¸ªkeyåªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚</li></ul></li><li><strong>æ•°æ®é¢„çƒ­</strong><ul><li>æ•°æ®åŠ çƒ­çš„å«ä¹‰å°±æ˜¯åœ¨æ­£å¼éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠå¯èƒ½çš„æ•°æ®å…ˆé¢„å…ˆè®¿é—®ä¸€éï¼Œè¿™æ ·éƒ¨åˆ†å¯èƒ½å¤§é‡è®¿é—®çš„æ•° æ®å°±ä¼šåŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ä¸åŒçš„keyï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®© ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ã€‚</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;note warning simple&quot;&gt;&lt;p&gt;æœåŠ¡å™¨é«˜å¯ç”¨é—®é¢˜&lt;/p&gt;
&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Redisç¼“å­˜çš„ä½¿ç”¨ï¼Œæå¤§çš„æå‡äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œæ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯æ•°æ®æŸ¥è¯¢æ–¹é¢ã€‚ä½†åŒæ—¶ï¼Œå®ƒä¹Ÿå¸¦æ¥äº†ä¸€ äº›é—®é¢˜ã€‚å…¶ä¸­ï¼Œæœ€è¦å®³çš„é—®é¢˜ï¼Œå°±æ˜¯æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œ</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯Redisä¸»ä»å¤åˆ¶åŠå“¨å…µæ¨¡å¼</title>
    <link href="http://xiaoliblog.cn/page/Redis08.html"/>
    <id>http://xiaoliblog.cn/page/Redis08.html</id>
    <published>2021-06-30T08:37:07.153Z</published>
    <updated>2021-06-30T10:58:43.823Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redisä¸»ä»å¤åˆ¶"><a href="#Redisä¸»ä»å¤åˆ¶" class="headerlink" title="Redisä¸»ä»å¤åˆ¶"></a>Redisä¸»ä»å¤åˆ¶</h1><h2 id="ä¸»ä»å¤åˆ¶æ¦‚å¿µ"><a href="#ä¸»ä»å¤åˆ¶æ¦‚å¿µ" class="headerlink" title="ä¸»ä»å¤åˆ¶æ¦‚å¿µ"></a>ä¸»ä»å¤åˆ¶æ¦‚å¿µ</h2><ul><li>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹ï¼ˆMaster/Leaderï¼‰ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹ï¼ˆSlave/Followerï¼‰ï¼Œ <strong>æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼åªèƒ½ç”±ä¸»èŠ‚ç‚¹å¤åˆ¶åˆ°ä»èŠ‚ç‚¹</strong>ï¼ˆä¸»èŠ‚ç‚¹ä»¥å†™ä¸ºä¸»ã€ä»èŠ‚ç‚¹ä»¥è¯»ä¸ºä¸»ï¼‰</li><li><strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹</strong></li><li>ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥æœ‰0ä¸ªæˆ–è€…å¤šä¸ªä»èŠ‚ç‚¹ï¼Œä½†æ¯ä¸ªä»èŠ‚ç‚¹åªèƒ½ç”±ä¸€ä¸ªä¸»èŠ‚ç‚¹</li><li>ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š<ul><li>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™çš„æ–¹å¼ã€‚</li><li><strong>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹æ•…éšœæ—¶ï¼Œä»èŠ‚ç‚¹å¯ä»¥æš‚æ—¶æ›¿ä»£ä¸»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œæ˜¯ä¸€ç§æœåŠ¡å†—ä½™çš„æ–¹å¼</strong></li><li>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œç”±ä¸»èŠ‚ç‚¹è¿›è¡Œå†™æ“ä½œï¼Œä»èŠ‚ç‚¹è¿›è¡Œè¯»æ“ä½œï¼Œåˆ†æ‹…æœåŠ¡å™¨çš„è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å¤šè¯»å°‘å†™çš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è´Ÿè½½ï¼Œæé«˜å¹¶å‘é‡ã€‚</li><li>é«˜å¯ç”¨åŸºçŸ³ï¼šä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ã€‚</li></ul></li><li>ä¸€èˆ¬æ¥è¯´ï¼Œè¦å°†Redisè¿ç”¨äºå·¥ç¨‹é¡¹ç›®ä¸­ï¼Œåªä½¿ç”¨ä¸€å°Redisæ˜¯ä¸‡ä¸‡ä¸èƒ½çš„ï¼ˆå®•æœºï¼‰ï¼ŒåŸå› å¦‚ä¸‹ï¼š<ul><li>ä»ç»“æ„ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨ä¼šå‘ç”Ÿå•ç‚¹æ•…éšœï¼Œå¹¶ä¸”ä¸€å°æœåŠ¡å™¨éœ€è¦å¤„ç†æ‰€æœ‰çš„è¯·æ±‚è´Ÿè½½ï¼Œå‹åŠ›è¾ƒ å¤§ï¼›</li><li>ä»å®¹é‡ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨å†…å­˜å®¹é‡æœ‰é™ï¼Œå°±ç®—ä¸€å°RedisæœåŠ¡å™¨å†…å­˜å®¹é‡ä¸º256Gï¼Œä¹Ÿä¸èƒ½å°†æ‰€æœ‰ å†…å­˜ç”¨ä½œRediså­˜å‚¨å†…å­˜ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå•å°Rediså¤§ä½¿ç”¨å†…å­˜ä¸åº”è¯¥è¶…è¿‡20Gã€‚</li><li>ç”µå•†ç½‘ç«™ä¸Šçš„å•†å“ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸€æ¬¡ä¸Šä¼ ï¼Œæ— æ•°æ¬¡æµè§ˆçš„ï¼Œè¯´ä¸“ä¸šç‚¹ä¹Ÿå°±æ˜¯â€å¤šè¯»å°‘å†™â€ã€‚</li></ul></li><li>å¯¹äºè¿™ç§åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å¦‚ä¸‹è¿™ç§æ¶æ„ï¼š</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/AP0YP%24U%7BS4R8%283%7D_4S66HIW.png"></p><ul><li><strong>ä¸»ä»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»</strong>ï¼80%çš„æƒ…å†µä¸‹éƒ½æ˜¯åœ¨è¿›è¡Œè¯»æ“ä½œï¼å‡ç¼“æœåŠ¡å™¨çš„å‹åŠ›ï¼æ¶æ„ä¸­ç»å¸¸ä½¿ç”¨ï¼ ä¸€ä¸»äºŒä»ï¼</li><li>åªè¦åœ¨å…¬å¸ä¸­ï¼Œä¸»ä»å¤åˆ¶å°±æ˜¯å¿…é¡»è¦ä½¿ç”¨çš„ï¼Œå› ä¸ºåœ¨çœŸå®çš„é¡¹ç›®ä¸­ä¸å¯èƒ½å•æœºä½¿ç”¨Redisï¼</li></ul><h2 id="é›†ç¾¤ç¯å¢ƒæ­å»º"><a href="#é›†ç¾¤ç¯å¢ƒæ­å»º" class="headerlink" title="é›†ç¾¤ç¯å¢ƒæ­å»º"></a>é›†ç¾¤ç¯å¢ƒæ­å»º</h2><ul><li>åªé…ç½®ä»åº“ï¼Œä¸ç”¨é…ç½®ä¸»åº“!</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication   <span class="comment"># æŸ¥çœ‹å½“å‰åº“çš„ä¿¡æ¯ # Replication </span></span><br><span class="line">role:master  <span class="comment"># è§’è‰²  </span></span><br><span class="line">master connected_slaves:0 <span class="comment">#  æ²¡æœ‰ä»æœº</span></span><br><span class="line">master_replid:b63c90e6c501143759cb0e7f450bd1eb0c70882a</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:0 </span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:0 </span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:0 </span><br><span class="line">repl_backlog_histlen:0</span><br></pre></td></tr></table></figure><div class="note success simple"><p>æ‰©å±•ï¼šä¿®æ”¹xshellä¸­çš„ä¸»æœºåï¼Œ<code>cd /etc</code> è¿›å…¥etcæ–‡ä»¶å¤¹ï¼Œ<code>vi hostname</code> è¿›å…¥hostnameæ–‡ä»¶ï¼Œè¿›è¡Œä¿®æ”¹ç„¶å<code>reboot</code>é‡å¯æœåŠ¡å™¨å³å¯</p></div><ul><li>å¤åˆ¶3ä¸ªé…ç½®æ–‡ä»¶ï¼ŒæŒ‰<code>redis-ç«¯å£</code>å¯†ç ï¼Œç„¶åä¿®æ”¹å¯¹åº”çš„ä¿¡æ¯<ul><li>ç«¯å£</li><li>pid åå­—</li><li>logæ–‡ä»¶åå­—</li><li>dump.rdb åå­—</li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@xiaoliblog config]<span class="comment"># cp redis.conf redis-79.conf</span></span><br><span class="line">[root@xiaoliblog config]<span class="comment"># cp redis.conf redis-80.conf</span></span><br><span class="line">[root@xiaoliblog config]<span class="comment"># cp redis.conf redis-81.conf</span></span><br><span class="line">[root@xiaoliblog config]<span class="comment"># ls</span></span><br><span class="line">appendonly.aof  dump.rdb redis.conf</span><br><span class="line">redis-79.conf  redis-81.conf redis-80.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹redis-79.conf</span></span><br><span class="line">daemonize yes   <span class="comment"># åå°è¿è¡Œå¼€å¯</span></span><br><span class="line">logfile <span class="string">&quot;6379.log&quot;</span></span><br><span class="line">dbfilename dump6379.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹redis-80.conf</span></span><br><span class="line">port 6380</span><br><span class="line">pidfile /var/run/redis_6380.pid</span><br><span class="line">logfile <span class="string">&quot;6380.log&quot;</span></span><br><span class="line">dbfilename dump6380.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹redis-81.conf</span></span><br><span class="line">port 6381</span><br><span class="line">pidfile /var/run/redis_6381.pid</span><br><span class="line">logfile <span class="string">&quot;6381.log&quot;</span></span><br><span class="line">dbfilename dump6381.rdb</span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹å®Œæ¯•ä¹‹åï¼Œå¯åŠ¨æˆ‘ä»¬çš„3ä¸ªredisæœåŠ¡å™¨ï¼Œå¯ä»¥é€šè¿‡è¿›ç¨‹ä¿¡æ¯æŸ¥çœ‹ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@xiaoliblog config]<span class="comment"># redis-server redis-79.conf</span></span><br><span class="line">[root@xiaoliblog config]<span class="comment"># redis-server redis-80.conf</span></span><br><span class="line">[root@xiaoliblog config]<span class="comment"># redis-server redis-81.conf</span></span><br><span class="line">[root@xiaoliblog config]<span class="comment"># ps -ef|grep redis</span></span><br><span class="line">root      3096     1  0 17:10 ?        00:00:00 redis-server *:6379</span><br><span class="line">root      3131     1  0 17:10 ?        00:00:00 redis-server *:6380</span><br><span class="line">root      3165     1  0 17:11 ?        00:00:00 redis-server *:6381</span><br><span class="line">root      3188  2238  0 17:11 pts/0    00:00:00 grep --color=auto redis</span><br></pre></td></tr></table></figure><h1 id="ä¸€ä¸»äºŒä»"><a href="#ä¸€ä¸»äºŒä»" class="headerlink" title="ä¸€ä¸»äºŒä»"></a>ä¸€ä¸»äºŒä»</h1><div class="tip faa-horizontal">    <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼›æˆ‘ä»¬ä¸€èˆ¬æƒ…å†µä¸‹åªç”¨é…ç½®ä»å°±å¥½äº†ï¼</p></div><h2 id="é…ç½®ç¯å¢ƒ"><a href="#é…ç½®ç¯å¢ƒ" class="headerlink" title="é…ç½®ç¯å¢ƒ"></a>é…ç½®ç¯å¢ƒ</h2><ul><li>é…ç½®ä¸€ä¸» ï¼ˆ79ï¼‰äºŒä»ï¼ˆ80ï¼Œ81ï¼‰</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿è¯ä¸»æœºhostå¼€æ”¾</span></span><br><span class="line">127.0.0.1:6380&gt; SLAVEOF 127.0.0.1 6379   <span class="comment">#  SLAVEOF host 6379  æ‰¾è°å½“è‡ªå·±çš„è€å¤§ï¼</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; info replication </span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave  <span class="comment"># å½“å‰è§’è‰²æ˜¯ä»æœº</span></span><br><span class="line">master_host:127.0.0.1   <span class="comment"># å¯ä»¥çš„çœ‹åˆ°ä¸»æœºçš„ä¿¡æ¯ </span></span><br><span class="line">master_port:6379 </span><br><span class="line">master_link_status:up </span><br><span class="line">master_last_io_seconds_ago:3 </span><br><span class="line">master_sync_in_progress:0 </span><br><span class="line">slave_repl_offset:14 </span><br><span class="line">slave_priority:100 </span><br><span class="line">slave_read_only:1 </span><br><span class="line">connected_slaves:0 master_replid:a81be8dd257636b2d3e7a9f595e69d73ff03774e</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:14</span><br><span class="line">second_repl_offset:-1 </span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1 </span><br><span class="line">repl_backlog_histlen:14</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ä¸»æœºä¸­æŸ¥çœ‹ï¼</span></span><br><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="comment"># Replication </span></span><br><span class="line">role:master connected_slaves:1  <span class="comment"># å¤šäº†ä»æœºçš„é…ç½®</span></span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=42,lag=1    <span class="comment"># å¤šäº†ä»æœºçš„é…ç½®</span></span><br><span class="line">master_replid:a81be8dd257636b2d3e7a9f595e69d73ff03774e</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:42</span><br><span class="line">second_repl_offset:-1 </span><br><span class="line">repl_backlog_active:1 </span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1 </span><br><span class="line">repl_backlog_histlen:42 </span><br></pre></td></tr></table></figure><ul><li>å¦‚æœä¸¤ä¸ªéƒ½é…ç½®å®Œäº†ï¼Œå°±æ˜¯æœ‰ä¸¤ä¸ªä»æœº</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/M%25NG40THP%40%7E%28AT3E%7BU4%24RUH.png"></p><ul><li>çœŸå®çš„ä»ä¸»é…ç½®åº”è¯¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œè¿™æ ·çš„è¯æ˜¯æ°¸ä¹…çš„ï¼Œæˆ‘ä»¬è¿™é‡Œç”¨çš„æ˜¯å‘½ä»¤ï¼Œæš‚æ—¶çš„ï¼</li></ul><h2 id="ç»†èŠ‚æµ‹è¯•"><a href="#ç»†èŠ‚æµ‹è¯•" class="headerlink" title="ç»†èŠ‚æµ‹è¯•"></a>ç»†èŠ‚æµ‹è¯•</h2><ul><li>ä¸»æœºå¯ä»¥å†™ï¼Œä»æœºä¸èƒ½å†™åªèƒ½è¯»ï¼ä¸»æœºä¸­çš„æ‰€æœ‰ä¿¡æ¯å’Œæ•°æ®ï¼Œéƒ½ä¼šè‡ªåŠ¨ä»æœºä¿å­˜ï¼ ä¸»æœºå†™ï¼š</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/D53BJI_M29%29_%7E%5D9T5_YJ7%295.png"></p><ul><li>ä»æœºåªèƒ½è¯»å–å†…å®¹ï¼</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/%5B85%603G%7D%60_%7B409J%257%7BJHR_%28B.png"></p><ul><li>æµ‹è¯•ï¼šä¸»æœºæ–­å¼€è¿æ¥ï¼Œæ²¡æœ‰é…ç½®å“¨å…µæ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œä»æœºä¾æ—§è¿æ¥åˆ°ä¸»æœºï¼Œä½†æ˜¯æ²¡æœ‰å†™æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¸»æœºå¦‚æœå›æ¥äº†ï¼Œä»æœºä¾æ—§å¯ä»¥ç›´æ¥è·å–åˆ°ä¸»æœºå†™çš„ä¿¡æ¯ï¼</li><li>å¦‚æœæ˜¯ä½¿ç”¨å‘½ä»¤è¡Œï¼Œæ¥é…ç½®çš„ä¸»ä»ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœé‡å¯äº†ï¼Œå°±ä¼šå˜å›ä¸»æœºï¼åªè¦å˜ä¸ºä»æœºï¼Œç«‹é©¬å°±ä¼šä»ä¸»æœºä¸­è·å–å€¼ï¼</li></ul><h2 id="ä¸»ä»å¤åˆ¶åŸç†"><a href="#ä¸»ä»å¤åˆ¶åŸç†" class="headerlink" title="ä¸»ä»å¤åˆ¶åŸç†"></a>ä¸»ä»å¤åˆ¶åŸç†</h2><ul><li>Slave å¯åŠ¨æˆåŠŸè¿æ¥åˆ° master åä¼šå‘é€ä¸€ä¸ªsyncåŒæ­¥å‘½ä»¤</li><li>Master æ¥åˆ°å‘½ä»¤ï¼Œå¯åŠ¨åå°çš„å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰æ¥æ”¶åˆ°çš„ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œåœ¨åå°è¿›ç¨‹æ‰§è¡Œ å®Œæ¯•ä¹‹åï¼Œmasterå°†ä¼ é€æ•´ä¸ªæ•°æ®æ–‡ä»¶åˆ°slaveï¼Œå¹¶å®Œæˆä¸€æ¬¡å®Œå…¨åŒæ­¥ã€‚</li><li><strong>å…¨é‡å¤åˆ¶</strong>ï¼šè€ŒslaveæœåŠ¡åœ¨æ¥æ”¶åˆ°æ•°æ®åº“æ–‡ä»¶æ•°æ®åï¼Œå°†å…¶å­˜ç›˜å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</li><li><strong>å¢é‡å¤åˆ¶</strong>ï¼šMaster ç»§ç»­å°†æ–°çš„æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿®æ”¹å‘½ä»¤ä¾æ¬¡ä¼ ç»™slaveï¼Œå®ŒæˆåŒæ­¥</li><li>ä½†æ˜¯åªè¦æ˜¯é‡æ–°è¿æ¥masterï¼Œä¸€æ¬¡å®Œå…¨åŒæ­¥ï¼ˆå…¨é‡å¤åˆ¶ï¼‰å°†è¢«è‡ªåŠ¨æ‰§è¡Œï¼ æˆ‘ä»¬çš„æ•°æ®ä¸€å®šå¯ä»¥åœ¨ä»æœºä¸­ çœ‹åˆ°ï¼</li></ul><h2 id="å±‚å±‚é“¾è·¯"><a href="#å±‚å±‚é“¾è·¯" class="headerlink" title="å±‚å±‚é“¾è·¯"></a>å±‚å±‚é“¾è·¯</h2><ul><li>ä¸Šä¸€ä¸ªMé“¾æ¥ä¸‹ä¸€ä¸ª Sï¼80æ—¢æ˜¯ä¸»èŠ‚ç‚¹ä¹Ÿæ˜¯ä»èŠ‚ç‚¹</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/3%24UAULLQCH%7E%7D9%25%5D9N%7D49P%5DT.png"></p><ul><li>è¿™æ—¶å€™ä¹Ÿå¯ä»¥å®Œæˆæˆ‘ä»¬çš„ä¸»ä»å¤åˆ¶ï¼</li><li>å¦‚æœæ²¡æœ‰è€å¤§äº†ï¼Œè¿™ä¸ªæ—¶å€™èƒ½ä¸èƒ½é€‰æ‹©ä¸€ä¸ªè€å¤§å‡ºæ¥å‘¢ï¼Ÿ æ‰‹åŠ¨ï¼</li><li>è°‹æœç¯¡ä½ï¼šå¦‚æœä¸»æœºæ–­å¼€äº†è¿æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>SLAVEOF no one</code> è®©è‡ªå·±å˜æˆä¸»æœºï¼å…¶ä»–çš„èŠ‚ç‚¹å°±å¯ä»¥æ‰‹åŠ¨è¿ æ¥åˆ°æœ€æ–°çš„è¿™ä¸ªä¸»èŠ‚ç‚¹ï¼ˆæ‰‹åŠ¨ï¼‰ï¼å¦‚æœè¿™ä¸ªæ—¶å€™è€å¤§ä¿®å¤äº†ï¼Œé‚£å°±é‡æ–°è¿æ¥ï¼</li><li>æ‰‹åŠ¨å¾ˆéº»çƒ¦ï¼Œå¯ä»¥ä½¿ç”¨è‡ªåŠ¨é€‰ä¸¾è€å¤§çš„æ¨¡å¼ï¼ˆå“¨å…µæ¨¡å¼ï¼‰</li></ul><h1 id="å“¨å…µæ¨¡å¼"><a href="#å“¨å…µæ¨¡å¼" class="headerlink" title="å“¨å…µæ¨¡å¼"></a>å“¨å…µæ¨¡å¼</h1><h2 id="å“¨å…µæ¨¡å¼æ¦‚è¿°"><a href="#å“¨å…µæ¨¡å¼æ¦‚è¿°" class="headerlink" title="å“¨å…µæ¨¡å¼æ¦‚è¿°"></a>å“¨å…µæ¨¡å¼æ¦‚è¿°</h2><ul><li>ä¸»ä»åˆ‡æ¢æŠ€æœ¯çš„æ–¹æ³•æ˜¯ï¼šå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°ä»æœåŠ¡å™¨åˆ‡ä¸ºä¸»æœåŠ¡å™¨ï¼Œè¿™å°±éœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘å“¨å…µæ¨¡å¼ã€‚Redisä»2.8å¼€å§‹æ­£å¼æä¾›äº†Sentinelï¼ˆå“¨å…µï¼‰ æ¶æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</li><li>è°‹æœç¯¡ä½çš„è‡ªåŠ¨ç‰ˆï¼Œèƒ½å¤Ÿåå°ç›‘æ§ä¸»æœºæ˜¯å¦æ•…éšœï¼Œå¦‚æœæ•…éšœäº†æ ¹æ®æŠ•ç¥¨æ•°è‡ªåŠ¨å°†ä»åº“è½¬æ¢ä¸ºä¸»åº“ã€‚</li><li>å“¨å…µï¼ˆSentinelï¼‰æ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼ï¼Œé¦–å…ˆRedisæä¾›äº†å“¨å…µçš„å‘½ä»¤ï¼Œå“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½œä¸ºè¿›ç¨‹ï¼Œå®ƒä¼šç‹¬ ç«‹è¿è¡Œã€‚<strong>å…¶åŸç†æ˜¯å“¨å…µé€šè¿‡å‘é€å‘½ä»¤ï¼Œç­‰å¾…RedisæœåŠ¡å™¨å“åº”ï¼Œä»è€Œç›‘æ§è¿è¡Œçš„å¤šä¸ªRediså®ä¾‹</strong></li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/9UUQ%7BC0922ZGG%603ILCO%7EWA5.png"></p><ul><li>è¿™é‡Œçš„å“¨å…µæœ‰ä¸¤ä¸ªä½œç”¨<ul><li>é€šè¿‡å‘é€å‘½ä»¤ï¼Œè®©RedisæœåŠ¡å™¨è¿”å›ç›‘æ§å…¶è¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨ã€‚</li><li>å½“å“¨å…µç›‘æµ‹åˆ°masterå®•æœºï¼Œä¼šè‡ªåŠ¨å°†slaveåˆ‡æ¢æˆmasterï¼Œç„¶åé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼é€šçŸ¥å…¶ä»–çš„ä»æœ åŠ¡å™¨ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®©å®ƒä»¬åˆ‡æ¢ä¸»æœºã€‚</li></ul></li><li>ç„¶è€Œä¸€ä¸ªå“¨å…µè¿›ç¨‹å¯¹RedisæœåŠ¡å™¨è¿›è¡Œç›‘æ§ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªå“¨å…µè¿›è¡Œç›‘æ§ã€‚ å„ä¸ªå“¨å…µä¹‹é—´è¿˜ä¼šè¿›è¡Œç›‘æ§ï¼Œè¿™æ ·å°±å½¢æˆäº†å¤šå“¨å…µæ¨¡å¼ã€‚</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/G2YRE%291X%28_JL9EF%2870CI%240U.png"></p><ul><li>å‡è®¾ä¸»æœåŠ¡å™¨å®•æœºï¼Œå“¨å…µ1å…ˆæ£€æµ‹åˆ°è¿™ä¸ªç»“æœï¼Œç³»ç»Ÿå¹¶ä¸ä¼šé©¬ä¸Šè¿›è¡Œfailoverè¿‡ç¨‹ï¼Œä»…ä»…æ˜¯å“¨å…µ1ä¸»è§‚çš„è®¤ ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè¿™ä¸ªç°è±¡æˆä¸º <strong>ä¸»è§‚ä¸‹çº¿</strong> </li><li>å½“åé¢çš„å“¨å…µä¹Ÿæ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå¹¶ä¸”æ•°é‡è¾¾åˆ°ä¸€ å®šå€¼æ—¶ï¼Œé‚£ä¹ˆå“¨å…µä¹‹é—´å°±ä¼šè¿›è¡Œä¸€æ¬¡æŠ•ç¥¨ï¼ŒæŠ•ç¥¨çš„ç»“æœç”±ä¸€ä¸ªå“¨å…µå‘èµ·ï¼Œè¿›è¡Œfailover[æ•…éšœè½¬ç§»]æ“ä½œã€‚ åˆ‡æ¢æˆåŠŸåï¼Œå°±ä¼šé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè®©å„ä¸ªå“¨å…µæŠŠè‡ªå·±ç›‘æ§çš„ä»æœåŠ¡å™¨å®ç°åˆ‡æ¢ä¸»æœºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>å®¢è§‚ä¸‹çº¿</strong></li></ul><h2 id="ç¼–ç æµ‹è¯•"><a href="#ç¼–ç æµ‹è¯•" class="headerlink" title="ç¼–ç æµ‹è¯•"></a>ç¼–ç æµ‹è¯•</h2><ul><li>ç›®å‰çš„ç¯å¢ƒçŠ¶æ€æ˜¯ ä¸€ä¸»äºŒä»ï¼</li><li>é…ç½®å“¨å…µé…ç½®æ–‡ä»¶ <code>sentinel.conf</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># sentinel monitor è¢«ç›‘æ§çš„åç§°  host  port  1</span><br><span class="line">sentinel montitor myredis  127.0.0.1  6379 1 </span><br><span class="line"># è®¾ç½®å¯†ç </span><br><span class="line">sentinel auth-pass myredis 123456  </span><br></pre></td></tr></table></figure><ul><li>åé¢çš„è¿™ä¸ªæ•°å­—1ï¼Œä»£è¡¨ä¸»æœºæŒ‚äº†ï¼ŒslaveæŠ•ç¥¨çœ‹è®©è°æ¥æ›¿æˆä¸ºä¸»æœºï¼Œç¥¨æ•°æœ€å¤šçš„ï¼Œå°±ä¼šæˆä¸ºä¸»æœºï¼</li><li>å¯åŠ¨å“¨å…µï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@kuangshen bin]<span class="comment"># redis-sentinel kconfig/sentinel.conf</span></span><br><span class="line">26607:X 31 Mar 2020 21:13:10.027 <span class="comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span></span><br><span class="line">26607:X 31 Mar 2020 21:13:10.027 <span class="comment"># Redis version=5.0.8, bits=64,</span></span><br><span class="line">commit=00000000, modified=0, pid=26607, just started</span><br><span class="line">26607:X 31 Mar 2020 21:13:10.027 <span class="comment"># Configuration loaded</span></span><br><span class="line"></span><br><span class="line">                _._</span><br><span class="line">            _.-``__ <span class="string">&#x27;&#x27;</span>-._</span><br><span class="line">        _.-`` `. `_. <span class="string">&#x27;&#x27;</span>-._       Redis 5.0.8 (00000000/0) 64 bit</span><br><span class="line">    .-`` .-```. ```\/ _.,_ <span class="string">&#x27;&#x27;</span>-._</span><br><span class="line">    ( <span class="string">&#x27; , .-` | `, )` _.-&#x27;</span>|         Running <span class="keyword">in</span> sentinel mode</span><br><span class="line">    |`-._`-...-` __...-.``-._|<span class="string">&#x27;        Port: 26379</span></span><br><span class="line"><span class="string">    | `-._ `._ / _.-&#x27;</span> |             PID: 26607</span><br><span class="line">    `-._ `-._ `-./ _.-<span class="string">&#x27; _.-&#x27;</span></span><br><span class="line">    |`-._`-._ `-.__.-<span class="string">&#x27; _.-&#x27;</span>_.-<span class="string">&#x27;|</span></span><br><span class="line"><span class="string">    | `-._`-._ _.-&#x27;</span>_.-<span class="string">&#x27; |            http://redis.io</span></span><br><span class="line"><span class="string">    `-._ `-._`-.__.-&#x27;</span>_.-<span class="string">&#x27; _.-&#x27;</span></span><br><span class="line">    |`-._`-._ `-.__.-<span class="string">&#x27; _.-&#x27;</span>_.-<span class="string">&#x27;|</span></span><br><span class="line"><span class="string">    | `-._`-._ _.-&#x27;</span>_.-<span class="string">&#x27; |</span></span><br><span class="line"><span class="string">    `-._ `-._`-.__.-&#x27;</span>_.-<span class="string">&#x27; _.-&#x27;</span></span><br><span class="line"></span><br><span class="line">26607:X 31 Mar 2020 21:13:10.029 <span class="comment"># WARNING: The TCP backlog setting of 511</span></span><br><span class="line">cannot be enforced because /proc/sys/net/core/somaxconn is <span class="built_in">set</span> to the lower value</span><br><span class="line">of 128.</span><br><span class="line">26607:X 31 Mar 2020 21:13:10.031 <span class="comment"># Sentinel ID is</span></span><br><span class="line">4c780da7e22d2aebe3bc20c333746f202ce72996</span><br><span class="line">26607:X 31 Mar 2020 21:13:10.031 <span class="comment"># +monitor master myredis 127.0.0.1 6379 quorum</span></span><br><span class="line">1</span><br><span class="line">26607:X 31 Mar 2020 21:13:10.031 * +slave slave 127.0.0.1:6380 127.0.0.1 6380 @</span><br><span class="line">myredis 127.0.0.1 6379</span><br><span class="line">26607:X 31 Mar 2020 21:13:10.033 * +slave slave 127.0.0.1:6381 127.0.0.1 6381 @</span><br><span class="line">myredis 127.0.0.1 6379</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœMaster èŠ‚ç‚¹æ–­å¼€äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šä»ä»æœºä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæœåŠ¡å™¨ï¼ ï¼ˆè¿™é‡Œé¢æœ‰ä¸€ä¸ªæŠ•ç¥¨ç®—æ³•ï¼ï¼‰</li><li>å“¨å…µæ—¥å¿—ï¼</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/0ECA8Z%7EX%5B2Y%24SDZMB%7D%28%28PW7.png"></p><ul><li>å¦‚æœä¸»æœºæ­¤æ—¶å›æ¥äº†ï¼Œåªèƒ½å½’å¹¶åˆ°æ–°çš„ä¸»æœºä¸‹ï¼Œå½“åšä»æœºï¼Œè¿™å°±æ˜¯å“¨å…µæ¨¡å¼çš„è§„åˆ™ï¼</li><li>å“¨å…µæ¨¡å¼ä¼˜ç‚¹ï¼š<ul><li>å“¨å…µé›†ç¾¤ï¼ŒåŸºäºä¸»ä»å¤åˆ¶æ¨¡å¼ï¼Œæ‰€æœ‰çš„ä¸»ä»é…ç½®ä¼˜ç‚¹ï¼Œå®ƒå…¨æœ‰</li><li>ä¸»ä»å¯ä»¥åˆ‡æ¢ï¼Œæ•…éšœå¯ä»¥è½¬ç§»ï¼Œç³»ç»Ÿçš„å¯ç”¨æ€§å°±ä¼šæ›´å¥½</li><li>å“¨å…µæ¨¡å¼å°±æ˜¯ä¸»ä»æ¨¡å¼çš„å‡çº§ï¼Œæ‰‹åŠ¨åˆ°è‡ªåŠ¨ï¼Œæ›´åŠ å¥å£®ï¼</li></ul></li><li>å“¨å…µæ¨¡å¼ç¼ºç‚¹ï¼š<ul><li>Redis ä¸å¥½å•Šåœ¨çº¿æ‰©å®¹çš„ï¼Œé›†ç¾¤å®¹é‡ä¸€æ—¦åˆ°è¾¾ä¸Šé™ï¼Œåœ¨çº¿æ‰©å®¹å°±ååˆ†éº»çƒ¦ï¼</li><li>å®ç°å“¨å…µæ¨¡å¼çš„é…ç½®å…¶å®æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œé‡Œé¢æœ‰å¾ˆå¤šé€‰æ‹©ï¼</li></ul></li></ul><h2 id="å“¨å…µæ¨¡å¼å…¨é…ç½®"><a href="#å“¨å…µæ¨¡å¼å…¨é…ç½®" class="headerlink" title="å“¨å…µæ¨¡å¼å…¨é…ç½®"></a>å“¨å…µæ¨¡å¼å…¨é…ç½®</h2><ul><li>å“¨å…µæ¨¡å¼çš„å…¨éƒ¨é…ç½®ï¼</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"># Example sentinel.conf</span><br><span class="line"># å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£ é»˜è®¤26379</span><br><span class="line">port 26379</span><br><span class="line"># å“¨å…µsentinelçš„å·¥ä½œç›®å½•</span><br><span class="line">dir &#x2F;tmp</span><br><span class="line"># å“¨å…µsentinelç›‘æ§çš„redisä¸»èŠ‚ç‚¹çš„ ip port</span><br><span class="line"># master-name å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­— åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9 ã€è¿™ä¸‰ä¸ªå­—ç¬¦&quot;.-_&quot;ç»„æˆã€‚</span><br><span class="line"># quorum é…ç½®å¤šå°‘ä¸ªsentinelå“¨å…µç»Ÿä¸€è®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è” é‚£ä¹ˆè¿™æ—¶å®¢è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹å¤±è”äº†</span><br><span class="line"># sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;</span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 2</span><br><span class="line"># å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass foobared æˆæƒå¯†ç  è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„å®¢æˆ·ç«¯éƒ½è¦æä¾›</span><br><span class="line">å¯†ç </span><br><span class="line"># è®¾ç½®å“¨å…µsentinel è¿æ¥ä¸»ä»çš„å¯†ç  æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç </span><br><span class="line"># sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</span><br><span class="line">sentinel auth-pass mymaster MySUPER--secret-0123passw0rd</span><br><span class="line"># æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel æ­¤æ—¶ å“¨å…µä¸»è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹ä¸‹çº¿ é»˜è®¤30ç§’</span><br><span class="line"># sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</span><br><span class="line">sentinel down-after-milliseconds mymaster 30000</span><br><span class="line"># è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„masterè¿›è¡Œ åŒæ­¥ï¼Œ</span><br><span class="line">è¿™ä¸ªæ•°å­—è¶Šå°ï¼Œå®Œæˆfailoveræ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ï¼Œ</span><br><span class="line">ä½†æ˜¯å¦‚æœè¿™ä¸ªæ•°å­—è¶Šå¤§ï¼Œå°±æ„å‘³ç€è¶Š å¤šçš„slaveå› ä¸ºreplicationè€Œä¸å¯ç”¨ã€‚</span><br><span class="line">å¯ä»¥é€šè¿‡å°†è¿™ä¸ªå€¼è®¾ä¸º 1 æ¥ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªslave å¤„äºä¸èƒ½å¤„ç†å‘½ä»¤è¯·æ±‚çš„çŠ¶æ€ã€‚</span><br><span class="line"># sentinel parallel-syncs &lt;master-name&gt; &lt;numslaves&gt;</span><br><span class="line">sentinel parallel-syncs mymaster 1</span><br><span class="line"># æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ failover-timeout å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š</span><br><span class="line">#1. åŒä¸€ä¸ªsentinelå¯¹åŒä¸€ä¸ªmasterä¸¤æ¬¡failoverä¹‹é—´çš„é—´éš”æ—¶é—´ã€‚</span><br><span class="line">#2. å½“ä¸€ä¸ªslaveä»ä¸€ä¸ªé”™è¯¯çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®å¼€å§‹è®¡ç®—æ—¶é—´ã€‚ç›´åˆ°slaveè¢«çº æ­£ä¸ºå‘æ­£ç¡®çš„masteré‚£</span><br><span class="line">é‡ŒåŒæ­¥æ•°æ®æ—¶ã€‚</span><br><span class="line">#3.å½“æƒ³è¦å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„failoveræ‰€éœ€è¦çš„æ—¶é—´ã€‚</span><br><span class="line">#4.å½“è¿›è¡Œfailoveræ—¶ï¼Œé…ç½®æ‰€æœ‰slavesæŒ‡å‘æ–°çš„masteræ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚ä¸è¿‡ï¼Œå³ä½¿è¿‡äº†è¿™ä¸ªè¶…æ—¶ï¼Œ</span><br><span class="line">slavesä¾ç„¶ä¼šè¢«æ­£ç¡®é…ç½®ä¸ºæŒ‡å‘masterï¼Œä½†æ˜¯å°±ä¸æŒ‰parallel-syncsæ‰€é…ç½®çš„è§„åˆ™æ¥äº†</span><br><span class="line"># é»˜è®¤ä¸‰åˆ†é’Ÿ</span><br><span class="line"># sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds&gt;</span><br><span class="line">sentinel failover-timeout mymaster 180000</span><br><span class="line"># SCRIPTS EXECUTION</span><br><span class="line">#é…ç½®å½“æŸä¸€äº‹ä»¶å‘ç”Ÿæ—¶æ‰€éœ€è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡è„šæœ¬æ¥é€šçŸ¥ç®¡ç†å‘˜ï¼Œä¾‹å¦‚å½“ç³»ç»Ÿè¿è¡Œä¸æ­£å¸¸æ—¶å‘é‚®ä»¶é€šçŸ¥</span><br><span class="line">ç›¸å…³äººå‘˜ã€‚</span><br><span class="line">#å¯¹äºè„šæœ¬çš„è¿è¡Œç»“æœæœ‰ä»¥ä¸‹è§„åˆ™ï¼š</span><br><span class="line">#è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›1ï¼Œé‚£ä¹ˆè¯¥è„šæœ¬ç¨åå°†ä¼šè¢«å†æ¬¡æ‰§è¡Œï¼Œé‡å¤æ¬¡æ•°ç›®å‰é»˜è®¤ä¸º10</span><br><span class="line">#è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›2ï¼Œæˆ–è€…æ¯”2æ›´é«˜çš„ä¸€ä¸ªè¿”å›å€¼ï¼Œè„šæœ¬å°†ä¸ä¼šé‡å¤æ‰§è¡Œã€‚</span><br><span class="line">#å¦‚æœè„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç”±äºæ”¶åˆ°ç³»ç»Ÿä¸­æ–­ä¿¡å·è¢«ç»ˆæ­¢äº†ï¼Œåˆ™åŒè¿”å›å€¼ä¸º1æ—¶çš„è¡Œä¸ºç›¸åŒã€‚</span><br><span class="line">#ä¸€ä¸ªè„šæœ¬çš„æœ€å¤§æ‰§è¡Œæ—¶é—´ä¸º60sï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œè„šæœ¬å°†ä¼šè¢«ä¸€ä¸ªSIGKILLä¿¡å·ç»ˆæ­¢ï¼Œä¹‹åé‡æ–°æ‰§è¡Œã€‚</span><br><span class="line">#é€šçŸ¥å‹è„šæœ¬:å½“sentinelæœ‰ä»»ä½•è­¦å‘Šçº§åˆ«çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚è¯´rediså®ä¾‹çš„ä¸»è§‚å¤±æ•ˆå’Œå®¢è§‚å¤±æ•ˆç­‰ç­‰ï¼‰ï¼Œ</span><br><span class="line">å°†ä¼šå»è°ƒç”¨è¿™ä¸ªè„šæœ¬ï¼Œè¿™æ—¶è¿™ä¸ªè„šæœ¬åº”è¯¥é€šè¿‡é‚®ä»¶ï¼ŒSMSç­‰æ–¹å¼å»é€šçŸ¥ç³»ç»Ÿç®¡ç†å‘˜å…³äºç³»ç»Ÿä¸æ­£å¸¸è¿è¡Œçš„ä¿¡</span><br><span class="line">æ¯ã€‚è°ƒç”¨è¯¥è„šæœ¬æ—¶ï¼Œå°†ä¼ ç»™è„šæœ¬ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„ç±»å‹ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„æè¿°ã€‚å¦‚æœsentinel.confé…</span><br><span class="line">ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¿™ä¸ªè„šæœ¬è·¯å¾„ï¼Œé‚£ä¹ˆå¿…é¡»ä¿è¯è¿™ä¸ªè„šæœ¬å­˜åœ¨äºè¿™ä¸ªè·¯å¾„ï¼Œå¹¶ä¸”æ˜¯å¯æ‰§è¡Œçš„ï¼Œå¦åˆ™sentinelæ— </span><br><span class="line">æ³•æ­£å¸¸å¯åŠ¨æˆåŠŸã€‚</span><br><span class="line">#é€šçŸ¥è„šæœ¬</span><br><span class="line"># shellç¼–ç¨‹</span><br><span class="line"># sentinel notification-script &lt;master-name&gt; &lt;script-path&gt;</span><br><span class="line">sentinel notification-script mymaster &#x2F;var&#x2F;redis&#x2F;notify.sh</span><br><span class="line"># å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬</span><br><span class="line"># å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯å…³äºmasteråœ°å€å·²</span><br><span class="line">ç»å‘ç”Ÿæ”¹å˜çš„ä¿¡æ¯ã€‚</span><br><span class="line"># ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬:</span><br><span class="line"># &lt;master-name&gt; &lt;role&gt; &lt;state&gt; &lt;from-ip&gt; &lt;from-port&gt; &lt;to-ip&gt; &lt;to-port&gt;</span><br><span class="line"># ç›®å‰&lt;state&gt;æ€»æ˜¯â€œfailoverâ€,</span><br><span class="line"># &lt;role&gt;æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚</span><br><span class="line"># å‚æ•° from-ip, from-port, to-ip, to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master(å³æ—§çš„slave)é€š</span><br><span class="line">ä¿¡çš„</span><br><span class="line"># è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚</span><br><span class="line"># sentinel client-reconfig-script &lt;master-name&gt; &lt;script-path&gt;</span><br><span class="line">sentinel client-reconfig-script mymaster &#x2F;var&#x2F;redis&#x2F;reconfig.sh # ä¸€èˆ¬éƒ½æ˜¯ç”±è¿ç»´æ¥é…ç½®ï¼</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Redisä¸»ä»å¤åˆ¶&quot;&gt;&lt;a href=&quot;#Redisä¸»ä»å¤åˆ¶&quot; class=&quot;headerlink&quot; title=&quot;Redisä¸»ä»å¤åˆ¶&quot;&gt;&lt;/a&gt;Redisä¸»ä»å¤åˆ¶&lt;/h1&gt;&lt;h2 id=&quot;ä¸»ä»å¤åˆ¶æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#ä¸»ä»å¤åˆ¶æ¦‚å¿µ&quot; class=&quot;head</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯Rediså‘å¸ƒè®¢é˜…</title>
    <link href="http://xiaoliblog.cn/page/Redis07.html"/>
    <id>http://xiaoliblog.cn/page/Redis07.html</id>
    <published>2021-06-30T08:09:12.321Z</published>
    <updated>2021-06-30T08:36:19.882Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Rediså‘å¸ƒè®¢é˜…"><a href="#Rediså‘å¸ƒè®¢é˜…" class="headerlink" title="Rediså‘å¸ƒè®¢é˜…"></a>Rediså‘å¸ƒè®¢é˜…</h1><ul><li>Redis å‘å¸ƒè®¢é˜…(pub/sub)æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€…(pub)å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…(sub)æ¥æ”¶æ¶ˆæ¯ã€‚æ¯”å¦‚å¾®ä¿¡ã€ å¾®åšã€å…³æ³¨ç³»ç»Ÿï¼</li><li>Redis å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“ã€‚</li></ul><h2 id="å‘å¸ƒè®¢é˜…æ¨¡å‹"><a href="#å‘å¸ƒè®¢é˜…æ¨¡å‹" class="headerlink" title="å‘å¸ƒè®¢é˜…æ¨¡å‹"></a>å‘å¸ƒè®¢é˜…æ¨¡å‹</h2><ul><li>ç¬¬ä¸€ä¸ªï¼šæ¶ˆæ¯å‘é€è€…ï¼Œ ç¬¬äºŒä¸ªï¼šé¢‘é“ ç¬¬ä¸‰ä¸ªï¼šæ¶ˆæ¯è®¢é˜…è€…ï¼</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/YH0C%28K1X%5D3SX9%7BPYQB%7DVJ4R.png"></p><ul><li>ä¸‹å›¾å±•ç¤ºäº†é¢‘é“ channel1 ï¼Œ ä»¥åŠè®¢é˜…è¿™ä¸ªé¢‘é“çš„ä¸‰ä¸ªå®¢æˆ·ç«¯ â€”â€” client2 ã€ client5 å’Œ client1 ä¹‹é—´çš„ å…³ç³»ï¼š</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/%29T67HK88K%29QVT%7BHTWK_NZG6.png"></p><ul><li>å½“æœ‰æ–°æ¶ˆæ¯é€šè¿‡ PUBLISH å‘½ä»¤å‘é€ç»™é¢‘é“ channel1 æ—¶ï¼Œ è¿™ä¸ªæ¶ˆæ¯å°±ä¼šè¢«å‘é€ç»™è®¢é˜…å®ƒçš„ä¸‰ä¸ªå®¢æˆ· ç«¯ï¼š</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/IN%24%25%5D46BNO67SXU4%605C3%60%25B.png"></p><h2 id="ç›¸å…³å‘½ä»¤"><a href="#ç›¸å…³å‘½ä»¤" class="headerlink" title="ç›¸å…³å‘½ä»¤"></a>ç›¸å…³å‘½ä»¤</h2><ul><li>è¿™äº›å‘½ä»¤è¢«å¹¿æ³›ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨ï¼Œæ¯”å¦‚ç½‘ç»œèŠå¤©å®¤(chatroom)å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰ã€‚</li><li>å‚è€ƒï¼š<a href="https://www.runoob.com/redis/redis-pub-sub.html">https://www.runoob.com/redis/redis-pub-sub.html</a></li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/NY8IOPUW%29%60%7BUX%7DTDM%7BDU%40%60H.png"></p><h2 id="ç¼–ç æµ‹è¯•"><a href="#ç¼–ç æµ‹è¯•" class="headerlink" title="ç¼–ç æµ‹è¯•"></a>ç¼–ç æµ‹è¯•</h2><ul><li>è®¢é˜…ç«¯</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SUBSCRIBE xiaoliblog    <span class="comment"># è®¢é˜…ä¸€ä¸ªé¢‘é“</span></span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) <span class="string">&quot;subscribe&quot;</span></span><br><span class="line">2) <span class="string">&quot;xiaoliblog&quot;</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 1</span><br><span class="line"><span class="comment"># ç­‰å¾…è¯»å–æ¨é€çš„ä¿¡æ¯ </span></span><br><span class="line">1) <span class="string">&quot;message&quot;</span>   <span class="comment"># æ¶ˆæ¯</span></span><br><span class="line">2) <span class="string">&quot;xiaoliblog&quot;</span> <span class="comment"># å“ªä¸ªé¢‘é“çš„æ¶ˆæ¯</span></span><br><span class="line">3) <span class="string">&quot;hello,world&quot;</span> <span class="comment"># æ¶ˆæ¯çš„å…·ä½“å†…å®¹</span></span><br><span class="line"></span><br><span class="line">1) <span class="string">&quot;message&quot;</span></span><br><span class="line">2) <span class="string">&quot;xiaoliblog&quot;</span></span><br><span class="line">3) <span class="string">&quot;hello,redis&quot;</span></span><br></pre></td></tr></table></figure><ul><li>å‘é€ç«¯</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; PUBLISH xiaoliblog <span class="string">&quot;hello,world&quot;</span></span><br><span class="line">(error) NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:6379&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; PUBLISH xiaoliblog <span class="string">&quot;hello,world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; PUBLISH xiaoliblog <span class="string">&quot;hello,redis&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure><h2 id="åŸç†æ¢ç©¶"><a href="#åŸç†æ¢ç©¶" class="headerlink" title="åŸç†æ¢ç©¶"></a>åŸç†æ¢ç©¶</h2><ul><li>Redisæ˜¯ä½¿ç”¨Cè¯­è¨€å®ç°çš„ï¼Œé€šè¿‡åˆ†æ Redis æºç é‡Œçš„ <code>pubsub.c</code> æ–‡ä»¶ï¼Œäº†è§£å‘å¸ƒå’Œè®¢é˜…æœºåˆ¶çš„åº•å±‚å®ç°ï¼Œä¾æ­¤åŠ æ·±å¯¹ Redis çš„ç†è§£ã€‚</li><li>Redis é€šè¿‡ <code>PUBLISH</code> ã€<code>SUBSCRIBE</code> å’Œ <code>PSUBSCRIBE</code> ç­‰å‘½ä»¤å®ç°å‘å¸ƒå’Œè®¢é˜…åŠŸèƒ½ã€‚</li><li>é€šè¿‡ <code>SUBSCRIBE</code> å‘½ä»¤è®¢é˜…æŸé¢‘é“åï¼Œ<code>redis-server</code>é‡Œç»´æŠ¤äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„é”®æ˜¯ä¸€ä¸ªä¸ª é¢‘é“ï¼ è€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ª<code>channel</code>å®¢æˆ·ç«¯ã€‚<code>SUBSCRIBE</code> å‘½ä»¤çš„å…³é”®ï¼Œ å°±æ˜¯å°†å®¢æˆ·ç«¯æ·»åŠ åˆ°ç»™å®š<code>channel</code>çš„è®¢é˜…é“¾è¡¨ä¸­</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/blog/YAZQL%7E9D_Q%7E2%60M93X%7EVU%5BP6.png"></p><ul><li>é€šè¿‡ <code>PUBLISH</code> å‘½ä»¤å‘è®¢é˜…è€…å‘é€æ¶ˆæ¯ï¼Œ<code>redis-server</code>ä¼šä½¿ç”¨ç»™å®šçš„é¢‘é“ä½œä¸ºé”®ï¼Œå®ƒæ‰€ç»´æŠ¤çš„ <code>channel</code> å­—å…¸ä¸­æŸ¥æ‰¾è®°å½•äº†è®¢é˜…è¿™ä¸ªé¢‘é“çš„æ‰€æœ‰å®¢æˆ·ç«¯çš„é“¾è¡¨ï¼Œéå†è¿™è¡¨ï¼Œå°†æ¶ˆæ¯å‘å¸ƒç»™æ‰€æœ‰è®¢é˜…è€…ã€‚</li><li><code>Pub/Sub</code> ä»å­—é¢ä¸Šç†è§£å°±æ˜¯å‘å¸ƒï¼ˆPublishï¼‰ä¸è®¢é˜…ï¼ˆSubscribeï¼‰ï¼Œåœ¨Redisä¸­ï¼Œå¯ä»¥è®¾å®šå¯¹æŸä¸€ä¸ª <code>key</code>å€¼è¿›è¡Œæ¶ˆæ¯å‘å¸ƒåŠæ¶ˆæ¯è®¢é˜…ï¼Œå½“ä¸€ä¸ªkeyå€¼ä¸Šè¿›è¡Œäº†æ¶ˆæ¯å‘åï¼Œæ‰€æœ‰è®¢é˜…å®ƒçš„å®¢æˆ·ç«¯éƒ½ä¼šæ”¶åˆ°ç›¸åº”çš„æ¶ˆæ¯ã€‚è¿™ä¸€åŠŸèƒ½æ˜æ˜¾çš„ç”¨æ³•å°±æ˜¯ç”¨ä½œå®æ—¶æ¶ˆç³»ç»Ÿï¼Œæ¯”å¦‚æ™®é€šçš„å³æ—¶èŠå¤©ï¼Œç¾¤èŠç­‰åŠŸèƒ½</li><li>ä½¿ç”¨åœºæ™¯ï¼š<ul><li>å®æ—¶æ¶ˆæ¯ç³»ç»Ÿï¼</li><li>äº‹å®èŠå¤©ï¼ï¼ˆé¢‘é“å½“åšèŠå¤©å®¤ï¼Œå°†ä¿¡æ¯å›æ˜¾ç»™æ‰€æœ‰äººå³å¯ï¼ï¼‰</li><li>è®¢é˜…ï¼Œå…³æ³¨ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥çš„ï¼ ç¨å¾®å¤æ‚çš„åœºæ™¯æˆ‘ä»¬å°±ä¼šä½¿ç”¨ æ¶ˆæ¯ä¸­é—´ä»¶MQ</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Rediså‘å¸ƒè®¢é˜…&quot;&gt;&lt;a href=&quot;#Rediså‘å¸ƒè®¢é˜…&quot; class=&quot;headerlink&quot; title=&quot;Rediså‘å¸ƒè®¢é˜…&quot;&gt;&lt;/a&gt;Rediså‘å¸ƒè®¢é˜…&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Redis å‘å¸ƒè®¢é˜…(pub/sub)æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€…(pub</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯RedisæŒä¹…åŒ–ä¹‹RDBã€AOF</title>
    <link href="http://xiaoliblog.cn/page/Redis06.html"/>
    <id>http://xiaoliblog.cn/page/Redis06.html</id>
    <published>2021-06-30T06:42:33.972Z</published>
    <updated>2021-06-30T08:07:41.752Z</updated>
    
    <content type="html"><![CDATA[<div class="tip faa-horizontal">    <p>Redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœä¸å°†å†…å­˜ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¿å­˜åˆ°ç£ç›˜ï¼Œé‚£ä¹ˆä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼ŒæœåŠ¡å™¨ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¹Ÿä¼šæ¶ˆå¤±ã€‚æ‰€ä»¥ Redis æä¾›äº†æŒä¹…åŒ–åŠŸèƒ½RDBå’ŒAOFï¼</p></div><h1 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h1><h2 id="RDBç®€ä»‹"><a href="#RDBç®€ä»‹" class="headerlink" title="RDBç®€ä»‹"></a>RDBç®€ä»‹</h2><ul><li>RDBï¼ˆRedis DataBaseï¼‰ï¼Œæ˜¯Redisç”¨æ¥è¿›è¡ŒæŒä¹…åŒ–çš„ä¸€ç§æ–¹å¼ï¼Œæ˜¯æŠŠå½“å‰å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯ Snapshot å¿«ç…§ï¼ˆæ•°æ®åº“ä¸­æ‰€æœ‰é”®å€¼å¯¹æ•°æ®ï¼‰ã€‚æ¢å¤æ—¶æ˜¯å°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œã€‚</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/1.jpg"></p><ul><li>Redisä¼šå•ç‹¬åˆ›å»ºï¼ˆforkï¼‰ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹ éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚</li><li>æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•IOæ“ä½œçš„ã€‚ è¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ã€‚å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£ RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚</li><li>RDBçš„ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚æˆ‘ä»¬é»˜è®¤çš„å°±æ˜¯ RDBï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦ä¿®æ”¹è¿™ä¸ªé…ç½®ï¼</li><li>RDBä¿å­˜çš„æ–‡ä»¶æ˜¯<code>dump.rdb</code>éƒ½æ˜¯åœ¨æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ä¸­å¿«ç…§ä¸­è¿›è¡Œé…ç½®çš„ï¼</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/E%4050C%5B5CT7ZW%5DM2%29%60CHTOUV.png"></p><h2 id="è§¦å‘æœºåˆ¶"><a href="#è§¦å‘æœºåˆ¶" class="headerlink" title="è§¦å‘æœºåˆ¶"></a>è§¦å‘æœºåˆ¶</h2><ul><li><code>save</code>çš„è§„åˆ™æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘rdbè§„åˆ™</li><li>æ‰§è¡Œ <code>flushall</code> å‘½ä»¤ï¼Œä¹Ÿä¼šè§¦å‘æˆ‘ä»¬çš„rdbè§„åˆ™ï¼</li><li>é€€å‡ºredisï¼Œä¹Ÿä¼šäº§ç”Ÿ rdb æ–‡ä»¶ï¼</li><li>Vimç¼–è¾‘åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥<code>/</code>+å…¨å±€æœç´¢çš„å†…å®¹å³å¯ï¼Œæ¯”å¦‚æœç´¢<code>/save 60</code>ï¼Œå°±ä¼šè·³è½¬åˆ°å†…å®¹åŒºåŸŸ</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/XF7NUH7AP%60YJ%7DYPHIP%40%25M%406.png"></p><div class="note warning simple"><p>æµ‹è¯•å®Œåéœ€è¦ä¿®æ”¹å›æ¥ï¼Œå…¶é»˜è®¤çš„é…ç½®å°±éå¸¸å¤Ÿç”¨äº†</p></div><ul><li>é…ç½®å¥½åï¼ŒæŠŠåŸæ¥configæ–‡ä»¶ä¸‹çš„<code>dump.rdb</code>æ–‡ä»¶åˆ é™¤ï¼Œè¿›è¡Œæµ‹è¯•</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># ls</span></span><br><span class="line">config  dump.rdb  redis.conf</span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># rm -rf dump.rdb</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># ls</span></span><br><span class="line">config  redis.conf</span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-server redis.conf</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-cli -p 6379</span></span><br><span class="line">127.0.0.1:6379&gt; auth 123456  <span class="comment"># å¯†ç è®¤è¯</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 v1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k4 v4</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k5 v5</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SHUTDOWN</span><br><span class="line">not connected&gt; <span class="built_in">exit</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># ps -ef|grep redis</span></span><br><span class="line">root     27235 16793  0 15:27 pts/0    00:00:00 grep --color=auto redis</span><br></pre></td></tr></table></figure><h2 id="æ¢å¤rdbæ–‡ä»¶"><a href="#æ¢å¤rdbæ–‡ä»¶" class="headerlink" title="æ¢å¤rdbæ–‡ä»¶"></a>æ¢å¤rdbæ–‡ä»¶</h2><ul><li>åªéœ€è¦å°†rdbæ–‡ä»¶æ”¾åœ¨æˆ‘ä»¬rediså¯åŠ¨ç›®å½•å°±å¯ä»¥ï¼Œrediså¯åŠ¨çš„æ—¶å€™ä¼šè‡ªåŠ¨æ£€æŸ¥<code>dump.rdb</code> æ¢å¤å…¶ä¸­ çš„æ•°æ®ï¼</li><li>æŸ¥çœ‹éœ€è¦å­˜åœ¨çš„ä½ç½®</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; config get dir</span><br><span class="line">1) <span class="string">&quot;dir&quot;</span></span><br><span class="line">2) <span class="string">&quot;/usr/local/bin&quot;</span> <span class="comment"># å¦‚æœåœ¨è¿™ä¸ªç›®å½•ä¸‹å­˜åœ¨ dump.rdb æ–‡ä»¶ï¼Œå¯åŠ¨å°±ä¼šè‡ªåŠ¨æ¢å¤å…¶ä¸­çš„æ•°æ®</span></span><br></pre></td></tr></table></figure><ul><li>RDBæŒä¹…åŒ–çš„ä¼˜ç‚¹<ul><li>é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤ï¼</li><li>å¯¹æ•°æ®çš„å®Œæ•´æ€§è¦ä¸é«˜ï¼</li></ul></li><li>RDBæŒä¹…åŒ–çš„ç¼ºç‚¹<ul><li>éœ€è¦ä¸€å®šçš„æ—¶é—´é—´éš”è¿›ç¨‹æ“ä½œï¼å¦‚æœredisæ„å¤–å®•æœºäº†ï¼Œè¿™ä¸ªæœ€åä¸€æ¬¡ä¿®æ”¹æ•°æ®å°±æ²¡æœ‰çš„äº†ï¼</li><li>forkè¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šå ç”¨ä¸€å®šçš„å†…å®¹ç©ºé—´ï¼ï¼</li></ul></li></ul><h1 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h1><h2 id="AOFç®€ä»‹"><a href="#AOFç®€ä»‹" class="headerlink" title="AOFç®€ä»‹"></a>AOFç®€ä»‹</h2><ul><li>AOFï¼ˆAppend Only Fileï¼‰ï¼Œä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶ çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œ</li><li>ç®€å•ç†è§£å°±æ˜¯å°†æˆ‘ä»¬çš„æ‰€æœ‰å‘½ä»¤éƒ½è®°å½•ä¸‹æ¥ï¼Œhistoryï¼Œæ¢å¤çš„æ—¶å€™å°±æŠŠè¿™ä¸ªæ–‡ä»¶å…¨éƒ¨åœ¨æ‰§è¡Œä¸€éï¼</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/RE%7B%7BP6%29NV02PMMJR4NK%292SX.png"></p><ul><li>AOFä¿å­˜çš„æ˜¯ <code>appendonly.aof</code> æ–‡ä»¶</li></ul><h2 id="AOFé…ç½®"><a href="#AOFé…ç½®" class="headerlink" title="AOFé…ç½®"></a>AOFé…ç½®</h2><ul><li>é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è¿›è¡Œé…ç½®ï¼æˆ‘ä»¬åªéœ€è¦å°† <code>appendonly</code> æ”¹ä¸º<code>yes</code>å°±å¼€å¯äº† aofï¼ é‡å¯ï¼Œredis å°±å¯ä»¥ç”Ÿæ•ˆäº†ï¼æ³¨æ„ï¼šæµ‹è¯•å®Œåæœ€å¥½ä¿®æ”¹ä¸º<code>no</code></li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/Z1JLU_CXA%29K97DOS%40IGHOCD.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># ls</span></span><br><span class="line">config  dump.rdb  redis.conf</span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-server redis.conf</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-cli -p 6379</span></span><br><span class="line">127.0.0.1:6379&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; shutdown  <span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">not connected&gt; <span class="built_in">exit</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># ls</span></span><br><span class="line">appendonly.aof  config  dump.rdb  redis.conf <span class="comment"># å¯ä»¥çœ‹åˆ°å¤šäº†ä¸ªappendonly.aof</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœè¿™ä¸ª <code>appendonly.aof</code> æ–‡ä»¶æœ‰é”™ä½æˆ–è€…é­åˆ°æ•…æ„ç ´åï¼Œè¿™æ—¶å€™ Redis æ˜¯å¯åŠ¨ä¸èµ·æ¥çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¿®å¤è¿™ä¸ªaofæ–‡ä»¶</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-server redis.conf</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-cli -p 6379</span></span><br><span class="line">127.0.0.1:6379&gt; auth 123456</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 v1 <span class="comment"># è¿›è¡Œä¸€äº›å‘½ä»¤çš„å†™å…¥</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; shutdown</span><br><span class="line">not connected&gt; <span class="built_in">exit</span></span><br><span class="line"><span class="comment"># å¯¹appendonly.aofè¿›è¡Œæ•…æ„ä¿®æ”¹</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># vim appendonly.aof </span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-server redis.conf</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-cli -p 6379</span></span><br><span class="line"><span class="comment"># å‘ç°Redisæ— æ³•å¯åŠ¨</span></span><br><span class="line">Could not connect to Redis at 127.0.0.1:6379: Connection refused</span><br><span class="line">not connected&gt; <span class="built_in">exit</span></span><br></pre></td></tr></table></figure><ul><li>Redis ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå·¥å…· <code>redis-check-aof --fix</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]# redis-check-aof --fix appendonly.aof</span><br><span class="line">0x               0: Expected prefix &#x27;*&#x27;, got: &#x27;1&#x27;</span><br><span class="line">AOF analyzed: size=113, ok_up_to=0, ok_up_to_line=1, diff=113</span><br><span class="line">This will shrink the AOF from 113 bytes, with 113 bytes, to 0 bytes</span><br><span class="line">Continue? [y/N]: y</span><br><span class="line">Successfully truncated AOF</span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]# redis-server redis.conf</span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]# redis-cli -p 6379</span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure><div class="note success simple"><p>å¦‚æœæ–‡ä»¶æ­£å¸¸ï¼Œé‡å¯å°±å¯ä»¥ç›´æ¥æ¢å¤äº†ï¼</p></div><h2 id="é‡å†™è§„åˆ™è¯´æ˜"><a href="#é‡å†™è§„åˆ™è¯´æ˜" class="headerlink" title="é‡å†™è§„åˆ™è¯´æ˜"></a>é‡å†™è§„åˆ™è¯´æ˜</h2><ul><li>aof é»˜è®¤å°±æ˜¯æ–‡ä»¶çš„æ— é™è¿½åŠ ï¼Œæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/16%24L8R2%25M%28P%7DNTMSC%28X8%7B%604.png"></p><ul><li>å¦‚æœ aof æ–‡ä»¶å¤§äº 64mï¼Œå¤ªå¤§äº†ï¼ forkä¸€ä¸ªæ–°çš„è¿›ç¨‹æ¥å°†æˆ‘ä»¬çš„æ–‡ä»¶è¿›è¡Œé‡å†™ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">appendonly no <span class="comment"># é»˜è®¤æ˜¯ä¸å¼€å¯aofæ¨¡å¼çš„ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨rdbæ–¹å¼æŒä¹…åŒ–çš„ï¼Œåœ¨å¤§éƒ¨åˆ†æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œrdbå®Œå…¨å¤Ÿç”¨ï¼</span></span><br><span class="line">appendfilename <span class="string">&quot;appendonly.aof&quot;</span> <span class="comment"># æŒä¹…åŒ–çš„æ–‡ä»¶çš„åå­—</span></span><br><span class="line"><span class="comment"># appendfsync always # æ¯æ¬¡ä¿®æ”¹éƒ½ä¼š syncã€‚æ¶ˆè€—æ€§èƒ½</span></span><br><span class="line">appendfsync everysec <span class="comment"># æ¯ç§’æ‰§è¡Œä¸€æ¬¡ syncï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™1sçš„æ•°æ®ï¼</span></span><br><span class="line"><span class="comment"># appendfsync no # ä¸æ‰§è¡Œ syncï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«ï¼</span></span><br><span class="line"><span class="comment"># rewrite é‡å†™ï¼Œ</span></span><br></pre></td></tr></table></figure><ul><li>AOFä¼˜ç‚¹<ul><li>æ¯ä¸€æ¬¡ä¿®æ”¹éƒ½åŒæ­¥ï¼Œæ–‡ä»¶çš„å®Œæ•´ä¼šæ›´åŠ å¥½ï¼</li><li>æ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œå¯èƒ½ä¼šä¸¢å¤±ä¸€ç§’çš„æ•°æ®</li><li>å…¶æ•ˆç‡æ˜¯æœ€é«˜çš„ï¼ </li></ul></li><li>AOFç¼ºç‚¹ï¼š<ul><li>ç›¸å¯¹äºæ•°æ®æ–‡ä»¶æ¥è¯´ï¼Œaofè¿œè¿œå¤§äº rdbï¼Œä¿®å¤çš„é€Ÿåº¦ä¹Ÿæ¯” rdbæ…¢ï¼</li><li>Aof è¿è¡Œæ•ˆç‡ä¹Ÿè¦æ¯”rdbæ…¢ï¼Œæ‰€ä»¥æˆ‘ä»¬redisé»˜è®¤çš„é…ç½®å°±æ˜¯rdbæŒä¹…åŒ–</li></ul></li></ul><h1 id="æ€»ç»“åŠæ‰©å±•"><a href="#æ€»ç»“åŠæ‰©å±•" class="headerlink" title="æ€»ç»“åŠæ‰©å±•"></a>æ€»ç»“åŠæ‰©å±•</h1><ul><li>RDB æŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨</li><li>AOF æŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œï¼Œå½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹ çš„æ•°æ®ï¼ŒAOFå‘½ä»¤ä»¥Redis åè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾ï¼ŒRedisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡ å†™ï¼Œä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§ã€‚</li><li>åªåšç¼“å­˜ï¼Œå¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–</li></ul><h2 id="åŒæ—¶å¼€å¯"><a href="#åŒæ—¶å¼€å¯" class="headerlink" title="åŒæ—¶å¼€å¯"></a>åŒæ—¶å¼€å¯</h2><ul><li>åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼<ul><li>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼Œå› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOF æ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´ã€‚</li><li>RDB çš„æ•°æ®ä¸å®æ—¶ï¼ŒåŒæ—¶ä½¿ç”¨ä¸¤è€…æ—¶æœåŠ¡å™¨é‡å¯ä¹Ÿåªä¼šæ‰¾AOFæ–‡ä»¶ï¼Œé‚£è¦ä¸è¦åªä½¿ç”¨AOFå‘¢ï¼Ÿä½œè€… å»ºè®®ä¸è¦ï¼Œå› ä¸ºRDBæ›´é€‚åˆç”¨äºå¤‡ä»½æ•°æ®åº“ï¼ˆAOFåœ¨ä¸æ–­å˜åŒ–ä¸å¥½å¤‡ä»½ï¼‰ï¼Œå¿«é€Ÿé‡å¯ï¼Œè€Œä¸”ä¸ä¼šæœ‰ AOFå¯èƒ½æ½œåœ¨çš„Bugï¼Œç•™ç€ä½œä¸ºä¸€ä¸ªä¸‡ä¸€çš„æ‰‹æ®µã€‚</li></ul></li></ul><h2 id="æ€§èƒ½å»ºè®®"><a href="#æ€§èƒ½å»ºè®®" class="headerlink" title="æ€§èƒ½å»ºè®®"></a>æ€§èƒ½å»ºè®®</h2><ul><li>å› ä¸ºRDBæ–‡ä»¶åªç”¨ä½œåå¤‡ç”¨é€”ï¼Œå»ºè®®åªåœ¨Slaveä¸ŠæŒä¹…åŒ–RDBæ–‡ä»¶ï¼Œè€Œä¸”åªè¦15åˆ†é’Ÿå¤‡ä»½ä¸€æ¬¡å°±å¤Ÿ äº†ï¼Œåªä¿ç•™ save 900 1 è¿™æ¡è§„åˆ™ã€‚</li><li>å¦‚æœEnable AOF ï¼Œå¥½å¤„æ˜¯åœ¨æœ€æ¶åŠ£æƒ…å†µä¸‹ä¹Ÿåªä¼šä¸¢å¤±ä¸è¶…è¿‡ä¸¤ç§’æ•°æ®ï¼Œå¯åŠ¨è„šæœ¬è¾ƒç®€å•åªloadè‡ª å·±çš„AOFæ–‡ä»¶å°±å¯ä»¥äº†ï¼Œä»£ä»·ä¸€æ˜¯å¸¦æ¥äº†æŒç»­çš„IOï¼ŒäºŒæ˜¯AOF rewrite çš„æœ€åå°† rewrite è¿‡ç¨‹ä¸­äº§ ç”Ÿçš„æ–°æ•°æ®å†™åˆ°æ–°æ–‡ä»¶é€ æˆçš„é˜»å¡å‡ ä¹æ˜¯ä¸å¯é¿å…çš„ã€‚åªè¦ç¡¬ç›˜è®¸å¯ï¼Œåº”è¯¥å°½é‡å‡å°‘AOF rewrite çš„é¢‘ç‡ï¼ŒAOFé‡å†™çš„åŸºç¡€å¤§å°é»˜è®¤å€¼64Må¤ªå°äº†ï¼Œå¯ä»¥è®¾åˆ°5Gä»¥ä¸Šï¼Œé»˜è®¤è¶…è¿‡åŸå¤§å°100%å¤§å°é‡ å†™å¯ä»¥æ”¹åˆ°é€‚å½“çš„æ•°å€¼ã€‚</li><li>å¦‚æœä¸Enable AOF ï¼Œä»…é  Master-Slave Repllcation å®ç°é«˜å¯ç”¨æ€§ä¹Ÿå¯ä»¥ï¼Œèƒ½çœæ‰ä¸€å¤§ç¬”IOï¼Œä¹Ÿ å‡å°‘äº†rewriteæ—¶å¸¦æ¥çš„ç³»ç»Ÿæ³¢åŠ¨ã€‚ä»£ä»·æ˜¯å¦‚æœMaster/Slave åŒæ—¶å€’æ‰ï¼Œä¼šä¸¢å¤±åå‡ åˆ†é’Ÿçš„æ•°æ®ï¼Œ å¯åŠ¨è„šæœ¬ä¹Ÿè¦æ¯”è¾ƒä¸¤ä¸ª Master/Slave ä¸­çš„ RDBæ–‡ä»¶ï¼Œè½½å…¥è¾ƒæ–°çš„é‚£ä¸ªï¼Œå¾®åšå°±æ˜¯è¿™ç§æ¶æ„ã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;tip faa-horizontal&quot;&gt;
    &lt;p&gt;Redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœä¸å°†å†…å­˜ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¿å­˜åˆ°ç£ç›˜ï¼Œé‚£ä¹ˆä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼ŒæœåŠ¡å™¨ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¹Ÿä¼šæ¶ˆå¤±ã€‚æ‰€ä»¥ Redis æä¾›äº†æŒä¹…åŒ–åŠŸèƒ½RDBå’ŒAOFï¼&lt;/p&gt;
&lt;/div&gt;

&lt;h1</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯SpringBooté›†æˆRedisåŠé…ç½®æ–‡ä»¶è¯¦è§£</title>
    <link href="http://xiaoliblog.cn/page/Redis05.html"/>
    <id>http://xiaoliblog.cn/page/Redis05.html</id>
    <published>2021-06-29T13:23:47.645Z</published>
    <updated>2021-07-02T12:52:32.569Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SpringBootæ•´åˆ"><a href="#SpringBootæ•´åˆ" class="headerlink" title="SpringBootæ•´åˆ"></a>SpringBootæ•´åˆ</h1><ul><li>SpringBoot æ“ä½œæ•°æ®ï¼šspring-dataã€jpaã€jdbcã€mongodbã€redisï¼</li><li>SpringData ä¹Ÿæ˜¯å’Œ SpringBoot é½åçš„é¡¹ç›®ï¼</li><li>è¯´æ˜ï¼š åœ¨ SpringBoot2.x ä¹‹åï¼ŒåŸæ¥ä½¿ç”¨çš„jedis è¢«æ›¿æ¢ä¸ºäº† lettuce</li><li><code>jedis</code> : é‡‡ç”¨çš„ç›´è¿ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œçš„è¯ï¼Œæ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœæƒ³è¦é¿å…ä¸å®‰å…¨çš„ï¼Œä½¿ç”¨ jedis pool è¿æ¥ æ± ï¼ æ›´åƒ BIO æ¨¡å¼</li><li><code>lettuce</code> : é‡‡ç”¨nettyï¼Œå®ä¾‹å¯ä»¥å†å¤šä¸ªçº¿ç¨‹ä¸­è¿›è¡Œå…±äº«ï¼Œä¸å­˜åœ¨çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µï¼å¯ä»¥å‡å°‘çº¿ç¨‹æ•°æ® äº†ï¼Œæ›´åƒ NIO æ¨¡å¼</li></ul><h2 id="ç›¸å…³ä¾èµ–"><a href="#ç›¸å…³ä¾èµ–" class="headerlink" title="ç›¸å…³ä¾èµ–"></a>ç›¸å…³ä¾èµ–</h2><ul><li>åˆ›å»ºSpringBooté¡¹ç›®ï¼Œå‹¾é€‰éå…³ç³»å‹æ•°æ®åº“ä¸­Redisæ¨¡å—</li><li>æˆ–è€…æ‰‹åŠ¨å¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ“ä½œredis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>æºç åˆ†æ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(name = &quot;redisTemplate&quot;)</span> <span class="comment">// æˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä¹‰ä¸€ä¸ª</span></span><br><span class="line">redisTemplateæ¥æ›¿æ¢è¿™ä¸ªé»˜è®¤çš„ï¼</span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;Object, Object&gt;redisTemplate(RedisConnectionFactory redisConnectionFactory)<span class="keyword">throws</span> UnknownHostException &#123;</span><br><span class="line">        <span class="comment">// é»˜è®¤çš„ RedisTemplate æ²¡æœ‰è¿‡å¤šçš„è®¾ç½®ï¼Œredis å¯¹è±¡éƒ½æ˜¯éœ€è¦åºåˆ—åŒ–ï¼</span></span><br><span class="line">        <span class="comment">// ä¸¤ä¸ªæ³›å‹éƒ½æ˜¯ Object, Object çš„ç±»å‹ï¼Œæˆ‘ä»¬åä½¿ç”¨éœ€è¦å¼ºåˆ¶è½¬æ¢ &lt;String, Object&gt;</span></span><br><span class="line">        RedisTemplate&lt;Object, Object&gt; template = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span> <span class="comment">// ç”±äº String æ˜¯redisä¸­æœ€å¸¸ä½¿ç”¨çš„ç±»å‹ï¼Œæ‰€ä»¥è¯´å•ç‹¬æå‡ºæ¥äº†ä¸€</span></span><br><span class="line">ä¸ªbeanï¼</span><br><span class="line">    <span class="function"><span class="keyword">public</span> StringRedisTemplate <span class="title">stringRedisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span><span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">        StringRedisTemplate template = <span class="keyword">new</span> StringRedisTemplate();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="æ•´åˆæµ‹è¯•"><a href="#æ•´åˆæµ‹è¯•" class="headerlink" title="æ•´åˆæµ‹è¯•"></a>æ•´åˆæµ‹è¯•</h2><ul><li>SpringBootæ‰€æœ‰çš„é…ç½®ç±»ï¼Œéƒ½æœ‰ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»<code>RedisAutoConfiguration</code></li><li>è‡ªåŠ¨é…ç½®ç±»éƒ½ä¼šç»‘å®šä¸€ä¸ªpropertiesé…ç½®æ–‡ä»¶<code>RedisProperties</code></li><li>åœ¨<code>application.properties</code>ä¸­é…ç½®Redis</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®Redis</span></span><br><span class="line"><span class="meta">spring.redis.host</span>=<span class="string">120.26.86.206</span></span><br><span class="line"><span class="meta">spring.redis.port</span>=<span class="string">6379</span></span><br><span class="line"><span class="meta">spring.redis.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="comment"># é€‰æ‹©æ•°æ®åº“</span></span><br><span class="line"><span class="meta">spring.redis.database</span>=<span class="string">1 </span></span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootRedisApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// redisTemplate æ“ä½œä¸åŒçš„æ•°æ®ç±»å‹ï¼Œapiå’Œæˆ‘ä»¬çš„æŒ‡ä»¤æ˜¯ä¸€æ ·çš„</span></span><br><span class="line">        <span class="comment">// opsForValue æ“ä½œå­—ç¬¦ä¸² ç±»ä¼¼String</span></span><br><span class="line">        <span class="comment">// opsForList æ“ä½œList ç±»ä¼¼List</span></span><br><span class="line">        <span class="comment">// opsForSet</span></span><br><span class="line">        <span class="comment">// opsForHash</span></span><br><span class="line">        <span class="comment">// opsForZSet</span></span><br><span class="line">        <span class="comment">// opsForGeo</span></span><br><span class="line">        <span class="comment">// opsForHyperLogLog</span></span><br><span class="line">        <span class="comment">// é™¤äº†è¿›æœ¬çš„æ“ä½œï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•éƒ½å¯ä»¥ç›´æ¥é€šè¿‡redisTemplateæ“ä½œï¼Œæ¯”å¦‚äº‹åŠ¡ï¼Œå’ŒåŸºæœ¬çš„ CRUD</span></span><br><span class="line">        <span class="comment">// è·å–redisçš„è¿æ¥å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// RedisConnection connection =</span></span><br><span class="line">        redisTemplate.getConnectionFactory().getConnection();</span><br><span class="line">        <span class="comment">// connection.flushDb();</span></span><br><span class="line">        <span class="comment">// connection.flushAll();</span></span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;mykey&quot;</span>,<span class="string">&quot;å°æåšå®¢&quot;</span>);</span><br><span class="line">        System.out.println(redisTemplate.opsForValue().get(<span class="string">&quot;mykey&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸å»ºè®®ä½¿ç”¨ä¸­æ–‡ï¼Œå‘½ä»¤è¡Œè¾“å‡ºä¼šå‡ºç°ä¸­æ–‡ä¹±ç é—®é¢˜ï¼éœ€è¦è¿›è¡Œåºåˆ—åŒ–</li></ul><h2 id="å¯¹è±¡åºåˆ—åŒ–"><a href="#å¯¹è±¡åºåˆ—åŒ–" class="headerlink" title="å¯¹è±¡åºåˆ—åŒ–"></a>å¯¹è±¡åºåˆ—åŒ–</h2><ul><li>åˆ›å»ºä¸€ä¸ªç”¨æˆ·å®ä½“ç±»å¹¶åºåˆ—åŒ–ã€‚å¦åˆ™ä¼ é€’å¯¹è±¡ä¼šæŠ¥é”™</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ä¸€ä¸‹ã€‚çœŸå®å¼€å‘éƒ½ä½¿ç”¨JSONä¼ é€’å¯¹è±¡ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line">   <span class="comment">// çœŸå®å¼€å‘éƒ½ä½¿ç”¨JSONä¼ é€’å¯¹è±¡</span></span><br><span class="line">   User user = <span class="keyword">new</span> User(<span class="string">&quot;admin&quot;</span>, <span class="string">&quot;123455&quot;</span>);</span><br><span class="line">   <span class="comment">//String jsonUser = new ObjectMapper().writeValueAsString(user);</span></span><br><span class="line">   <span class="comment">//redisTemplate.opsForValue().set(&quot;user&quot;,jsonUser);</span></span><br><span class="line">   redisTemplate.opsForValue().set(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">   System.out.println(redisTemplate.opsForValue().get(<span class="string">&quot;user&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰RedisTemplete"><a href="#è‡ªå®šä¹‰RedisTemplete" class="headerlink" title="è‡ªå®šä¹‰RedisTemplete"></a>è‡ªå®šä¹‰RedisTemplete</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Configuration</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯æˆ‘ç»™å¤§å®¶å†™å¥½çš„ä¸€ä¸ªå›ºå®šæ¨¡æ¿ï¼Œå¤§å®¶åœ¨ä¼ä¸šä¸­ï¼Œæ‹¿å»å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼</span></span><br><span class="line">    <span class="comment">// è‡ªå·±å®šä¹‰äº†ä¸€ä¸ª RedisTemplateï¼Œæ¬¡é…ç½®ç±»ä¼šè¦†ç›–åŸé…ç½®ç±»</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æˆ‘ä»¬ä¸ºäº†è‡ªå·±å¼€å‘æ–¹ä¾¿ï¼Œä¸€èˆ¬ç›´æ¥ä½¿ç”¨ &lt;String,Object&gt;</span></span><br><span class="line">        RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> RedisTemplate&lt;String,Object&gt;();</span><br><span class="line">        template.setConnectionFactory(factory);</span><br><span class="line">        <span class="comment">// Jsonåºåˆ—åŒ–é…ç½®</span></span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span></span><br><span class="line">                Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">        ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">        <span class="comment">// String çš„åºåˆ—åŒ–</span></span><br><span class="line">        StringRedisSerializer stringRedisSerializer = <span class="keyword">new</span> StringRedisSerializer();</span><br><span class="line">        <span class="comment">// keyé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span></span><br><span class="line">        template.setKeySerializer(stringRedisSerializer);</span><br><span class="line">        <span class="comment">// hashçš„keyä¹Ÿé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span></span><br><span class="line">        template.setHashKeySerializer(stringRedisSerializer);</span><br><span class="line">        <span class="comment">// valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span></span><br><span class="line">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        <span class="comment">// hashçš„valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span></span><br><span class="line">        template.setHashValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        template.afterPropertiesSet();</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ä¸€ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootRedisApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;redisTemplate&quot;)</span> <span class="comment">// å¦‚æœå‘ç”Ÿæ­§ä¹‰ï¼Œå¯ä»¥ä½¿ç”¨@Qualifier(&quot;æ–¹æ³•å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate; <span class="comment">// ç¡®ä¿æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„é…ç½®ç±»</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        redisTemplate.getConnectionFactory().getConnection();</span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;mykey&quot;</span>,<span class="string">&quot;å°æåšå®¢&quot;</span>);</span><br><span class="line">        System.out.println(redisTemplate.opsForValue().get(<span class="string">&quot;mykey&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Rediså·¥å…·ç±»"><a href="#Rediså·¥å…·ç±»" class="headerlink" title="Rediså·¥å…·ç±»"></a>Rediså·¥å…·ç±»</h2><ul><li>å¯¹Redisçš„å¸¸ç”¨æ“ä½œå¯ä»¥å°è£…æˆä¸€ä¸ªå·¥å…·ç±»ï¼Œä¾¿äºå·¥ä½œæ•ˆç‡å¼€å‘</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzy.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.CollectionUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// =============================common============================</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‡å®šç¼“å­˜å¤±æ•ˆæ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">expire</span><span class="params">(String key, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                redisTemplate.expire(key, time, TimeUnit.SECONDS);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®key è·å–è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ—¶é—´(ç§’) è¿”å›0ä»£è¡¨ä¸ºæ°¸ä¹…æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getExpire</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.getExpire(key, TimeUnit.SECONDS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasKey</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.hasKey(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ç¼“å­˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key å¯ä»¥ä¼ ä¸€ä¸ªå€¼ æˆ–å¤šä¸ª</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">del</span><span class="params">(String... key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (key != <span class="keyword">null</span> &amp;&amp; key.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (key.length == <span class="number">1</span>) &#123;</span><br><span class="line">                redisTemplate.delete(key[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                redisTemplate.delete(CollectionUtils.arrayToList(key));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ============================String=============================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ™®é€šç¼“å­˜è·å–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> key == <span class="keyword">null</span> ? <span class="keyword">null</span> : redisTemplate.opsForValue().get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ™®é€šç¼“å­˜æ”¾å…¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> trueæˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">set</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForValue().set(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ™®é€šç¼“å­˜æ”¾å…¥å¹¶è®¾ç½®æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  æ—¶é—´(ç§’) timeè¦å¤§äº0 å¦‚æœtimeå°äºç­‰äº0 å°†è®¾ç½®æ— é™æœŸ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> trueæˆåŠŸ false å¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">set</span><span class="params">(String key, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                redisTemplate.opsForValue().set(key, value, time, TimeUnit.SECONDS);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                set(key, value);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€’å¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta è¦å¢åŠ å‡ (å¤§äº0)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">incr</span><span class="params">(String key, <span class="keyword">long</span> delta)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;é€’å¢å› å­å¿…é¡»å¤§äº0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().increment(key, delta);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€’å‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta è¦å‡å°‘å‡ (å°äº0)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">decr</span><span class="params">(String key, <span class="keyword">long</span> delta)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;é€’å‡å› å­å¿…é¡»å¤§äº0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().increment(key, -delta);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ================================Map=================================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashGet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹ ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">hget</span><span class="params">(String key, String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().get(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–hashKeyå¯¹åº”çš„æ‰€æœ‰é”®å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¯¹åº”çš„å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;Object, Object&gt; <span class="title">hmget</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().entries(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashSet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map å¯¹åº”å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hmset</span><span class="params">(String key, Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashSet å¹¶è®¾ç½®æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map  å¯¹åº”å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> trueæˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hmset</span><span class="params">(String key, Map&lt;String, Object&gt; map, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                expire(key, time);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item  é¡¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true æˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hset</span><span class="params">(String key, String item, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item  é¡¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  æ—¶é—´(ç§’) æ³¨æ„:å¦‚æœå·²å­˜åœ¨çš„hashè¡¨æœ‰æ—¶é—´,è¿™é‡Œå°†ä¼šæ›¿æ¢åŸæœ‰çš„æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true æˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hset</span><span class="params">(String key, String item, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                expire(key, time);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤hashè¡¨ä¸­çš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹ å¯ä»¥ä½¿å¤šä¸ª ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hdel</span><span class="params">(String key, Object... item)</span> </span>&#123;</span><br><span class="line">        redisTemplate.opsForHash().delete(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­hashè¡¨ä¸­æ˜¯å¦æœ‰è¯¥é¡¹çš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹ ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hHasKey</span><span class="params">(String key, String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().hasKey(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hashé€’å¢ å¦‚æœä¸å­˜åœ¨,å°±ä¼šåˆ›å»ºä¸€ä¸ª å¹¶æŠŠæ–°å¢åçš„å€¼è¿”å›</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> by   è¦å¢åŠ å‡ (å¤§äº0)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">hincr</span><span class="params">(String key, String item, <span class="keyword">double</span> by)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().increment(key, item, by);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hashé€’å‡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> by   è¦å‡å°‘è®°(å°äº0)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">hdecr</span><span class="params">(String key, String item, <span class="keyword">double</span> by)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().increment(key, item, -by);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ============================set=============================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®keyè·å–Setä¸­çš„æ‰€æœ‰å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Object&gt; <span class="title">sGet</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().members(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®valueä»ä¸€ä¸ªsetä¸­æŸ¥è¯¢,æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">sHasKey</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().isMember(key, value);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ•°æ®æ”¾å…¥setç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æˆåŠŸä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sSet</span><span class="params">(String key, Object... values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().add(key, values);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†setæ•°æ®æ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time   æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æˆåŠŸä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sSetAndTime</span><span class="params">(String key, <span class="keyword">long</span> time, Object... values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Long count = redisTemplate.opsForSet().add(key, values);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">                expire(key, time);</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–setç¼“å­˜çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sGetSetSize</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().size(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤å€¼ä¸ºvalueçš„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ç§»é™¤çš„ä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">setRemove</span><span class="params">(String key, Object... values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Long count = redisTemplate.opsForSet().remove(key, values);</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ===============================list=================================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–listç¼“å­˜çš„å†…å®¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start å¼€å§‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end   ç»“æŸ 0 åˆ° -1ä»£è¡¨æ‰€æœ‰å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Object&gt; <span class="title">lGet</span><span class="params">(String key, <span class="keyword">long</span> start, <span class="keyword">long</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().range(key, start, end);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–listç¼“å­˜çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">lGetListSize</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().size(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ç´¢å¼• è·å–listä¸­çš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index ç´¢å¼• index&gt;=0æ—¶ï¼Œ 0 è¡¨å¤´ï¼Œ1 ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨ï¼›index&lt;0æ—¶ï¼Œ-1ï¼Œè¡¨å°¾ï¼Œ-2å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">lGetIndex</span><span class="params">(String key, <span class="keyword">long</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().index(key, index);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                expire(key, time);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, List&lt;Object&gt; value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, List&lt;Object&gt; value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">                expire(key, time);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ç´¢å¼•ä¿®æ”¹listä¸­çš„æŸæ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index ç´¢å¼•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lUpdateIndex</span><span class="params">(String key, <span class="keyword">long</span> index, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().set(key, index, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤Nä¸ªå€¼ä¸ºvalue</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> count ç§»é™¤å¤šå°‘ä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ç§»é™¤çš„ä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">lRemove</span><span class="params">(String key, <span class="keyword">long</span> count, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Long remove = redisTemplate.opsForList().remove(key, count, value);</span><br><span class="line">            <span class="keyword">return</span> remove;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ä¸€ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootRedisApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        redisUtil.set(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;xiaoli&quot;</span>);</span><br><span class="line">        System.out.println(redisUtil.get(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Redis-confè¯¦è§£"><a href="#Redis-confè¯¦è§£" class="headerlink" title="Redis.confè¯¦è§£"></a>Redis.confè¯¦è§£</h1><ul><li>å¯åŠ¨çš„æ—¶å€™ï¼Œå°±é€šè¿‡é…ç½®æ–‡ä»¶æ¥å¯åŠ¨ï¼</li><li>é…ç½®æ–‡ä»¶Unitå•ä½å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼</li><li>ç½‘ç»œæ¨¡å—</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bind</span> 127.0.0.1 <span class="comment"># ç»‘å®šçš„ip</span></span><br><span class="line">protected-mode yes <span class="comment"># ä¿æŠ¤æ¨¡å¼</span></span><br><span class="line">port 6379 <span class="comment"># ç«¯å£è®¾ç½®</span></span><br></pre></td></tr></table></figure><h2 id="é€šç”¨é…ç½®"><a href="#é€šç”¨é…ç½®" class="headerlink" title="é€šç”¨é…ç½®"></a>é€šç”¨é…ç½®</h2><ul><li>é€šç”¨é…ç½®</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">daemonize yes <span class="comment"># ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œé»˜è®¤æ˜¯ noï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å¼€å¯ä¸ºyesï¼</span></span><br><span class="line">pidfile /var/run/redis_6379.pid <span class="comment"># å¦‚æœä»¥åå°çš„æ–¹å¼è¿è¡Œï¼Œæˆ‘ä»¬å°±éœ€è¦æŒ‡å®šä¸€ä¸ª pid æ–‡ä»¶ï¼</span></span><br><span class="line"><span class="comment"># æ—¥å¿—</span></span><br><span class="line"><span class="comment"># Specify the server verbosity level.</span></span><br><span class="line"><span class="comment"># This can be one of:</span></span><br><span class="line"><span class="comment"># debug (a lot of information, useful for development/testing)</span></span><br><span class="line"><span class="comment"># verbose (many rarely useful info, but not a mess like the debug level)</span></span><br><span class="line"><span class="comment"># notice (moderately verbose, what you want in production probably) ç”Ÿäº§ç¯å¢ƒ</span></span><br><span class="line"><span class="comment"># warning (only very important / critical messages are logged)</span></span><br><span class="line">loglevel notice</span><br><span class="line">logfile <span class="string">&quot;&quot;</span> <span class="comment"># æ—¥å¿—çš„æ–‡ä»¶ä½ç½®å</span></span><br><span class="line">databases 16 <span class="comment"># æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯ 16 ä¸ªæ•°æ®åº“</span></span><br><span class="line">always-show-logo yes <span class="comment"># æ˜¯å¦æ€»æ˜¯æ˜¾ç¤ºLOGO</span></span><br></pre></td></tr></table></figure><h2 id="å¿«ç…§"><a href="#å¿«ç…§" class="headerlink" title="å¿«ç…§"></a>å¿«ç…§</h2><ul><li>æŒä¹…åŒ–ï¼Œ åœ¨è§„å®šçš„æ—¶é—´å†…ï¼Œæ‰§è¡Œäº†å¤šå°‘æ¬¡æ“ä½œï¼Œåˆ™ä¼šæŒä¹…åŒ–åˆ°æ–‡ä»¶ <code>.rdb</code>ã€<code>.aof</code> ï¼Œredis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰æŒä¹…åŒ–ï¼Œé‚£ä¹ˆæ•°æ®æ–­ç”µåŠå¤±ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœ900så†…ï¼Œå¦‚æœè‡³å°‘æœ‰ä¸€ä¸ª1 keyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠè¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span></span><br><span class="line">save 900 1</span><br><span class="line"><span class="comment"># å¦‚æœ300så†…ï¼Œå¦‚æœè‡³å°‘10 keyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠè¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span></span><br><span class="line">save 300 10</span><br><span class="line"><span class="comment"># å¦‚æœ60så†…ï¼Œå¦‚æœè‡³å°‘10000 keyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠè¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span></span><br><span class="line">save 60 10000</span><br><span class="line"><span class="comment"># æˆ‘ä»¬ä¹‹åå­¦ä¹ æŒä¹…åŒ–ï¼Œä¼šè‡ªå·±å®šä¹‰è¿™ä¸ªæµ‹è¯•ï¼</span></span><br><span class="line">stop-writes-on-bgsave-error yes <span class="comment"># æŒä¹…åŒ–å¦‚æœå‡ºé”™ï¼Œæ˜¯å¦è¿˜éœ€è¦ç»§ç»­å·¥ä½œï¼</span></span><br><span class="line">rdbcompression yes <span class="comment"># æ˜¯å¦å‹ç¼© rdb æ–‡ä»¶ï¼Œéœ€è¦æ¶ˆè€—ä¸€äº›cpuèµ„æºï¼</span></span><br><span class="line">rdbchecksum yes <span class="comment"># ä¿å­˜rdbæ–‡ä»¶çš„æ—¶å€™ï¼Œè¿›è¡Œé”™è¯¯çš„æ£€æŸ¥æ ¡éªŒï¼</span></span><br><span class="line">dir ./ <span class="comment"># rdb æ–‡ä»¶ä¿å­˜çš„ç›®å½•ï¼</span></span><br></pre></td></tr></table></figure><h2 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h2><ul><li>SECURITY å®‰å…¨</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br><span class="line">127.0.0.1:6379&gt; config get requirepass <span class="comment"># è·å–redisçš„å¯†ç </span></span><br><span class="line">1) <span class="string">&quot;requirepass&quot;</span></span><br><span class="line">2) <span class="string">&quot;&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; config <span class="built_in">set</span> requirepass <span class="string">&quot;123456&quot;</span> <span class="comment"># è®¾ç½®redisçš„å¯†ç </span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; config get requirepass <span class="comment"># å‘ç°æ‰€æœ‰çš„å‘½ä»¤éƒ½æ²¡æœ‰æƒé™äº†</span></span><br><span class="line">(error) NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">(error) NOAUTH Authentication required.</span><br><span class="line">127.0.0.1:6379&gt; auth 123456 <span class="comment"># ä½¿ç”¨å¯†ç è¿›è¡Œç™»å½•ï¼</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; config get requirepass</span><br><span class="line">1) <span class="string">&quot;requirepass&quot;</span></span><br><span class="line">2) <span class="string">&quot;123456&quot;</span></span><br></pre></td></tr></table></figure><h2 id="é™åˆ¶"><a href="#é™åˆ¶" class="headerlink" title="é™åˆ¶"></a>é™åˆ¶</h2><ul><li>é™åˆ¶ CLIENTS</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">maxclients 10000 <span class="comment"># è®¾ç½®èƒ½è¿æ¥ä¸Šredisçš„æœ€å¤§å®¢æˆ·ç«¯çš„æ•°é‡</span></span><br><span class="line">maxmemory &lt;bytes&gt; <span class="comment"># redis é…ç½®æœ€å¤§çš„å†…å­˜å®¹é‡</span></span><br><span class="line">maxmemory-policy noeviction <span class="comment"># å†…å­˜åˆ°è¾¾ä¸Šé™ä¹‹åçš„å¤„ç†ç­–ç•¥</span></span><br><span class="line">1ã€volatile-lruï¼šåªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyè¿›è¡ŒLRUï¼ˆé»˜è®¤å€¼ï¼‰</span><br><span class="line">2ã€allkeys-lru ï¼š åˆ é™¤lruç®—æ³•çš„key</span><br><span class="line">3ã€volatile-randomï¼šéšæœºåˆ é™¤å³å°†è¿‡æœŸkey</span><br><span class="line">4ã€allkeys-randomï¼šéšæœºåˆ é™¤</span><br><span class="line">5ã€volatile-ttl ï¼š åˆ é™¤å³å°†è¿‡æœŸçš„</span><br><span class="line">6ã€noeviction ï¼š æ°¸ä¸è¿‡æœŸï¼Œè¿”å›é”™è¯¯</span><br></pre></td></tr></table></figure><h2 id="AOFé…ç½®"><a href="#AOFé…ç½®" class="headerlink" title="AOFé…ç½®"></a>AOFé…ç½®</h2><ul><li>APPEND ONLY æ¨¡å¼ aofé…ç½®</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">appendonly no <span class="comment"># é»˜è®¤æ˜¯ä¸å¼€å¯aofæ¨¡å¼çš„ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨rdbæ–¹å¼æŒä¹…åŒ–çš„ï¼Œåœ¨å¤§éƒ¨åˆ†æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œ</span></span><br><span class="line">rdbå®Œå…¨å¤Ÿç”¨ï¼</span><br><span class="line">appendfilename <span class="string">&quot;appendonly.aof&quot;</span> <span class="comment"># æŒä¹…åŒ–çš„æ–‡ä»¶çš„åå­—</span></span><br><span class="line"><span class="comment"># appendfsync always # æ¯æ¬¡ä¿®æ”¹éƒ½ä¼š syncã€‚æ¶ˆè€—æ€§èƒ½</span></span><br><span class="line">appendfsync everysec <span class="comment"># æ¯ç§’æ‰§è¡Œä¸€æ¬¡ syncï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™1sçš„æ•°æ®ï¼</span></span><br><span class="line"><span class="comment"># appendfsync no # ä¸æ‰§è¡Œ syncï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«ï¼</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SpringBootæ•´åˆ&quot;&gt;&lt;a href=&quot;#SpringBootæ•´åˆ&quot; class=&quot;headerlink&quot; title=&quot;SpringBootæ•´åˆ&quot;&gt;&lt;/a&gt;SpringBootæ•´åˆ&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;SpringBoot æ“ä½œæ•°æ®ï¼šspring-d</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯äº‹åŠ¡åŠJedisæ“ä½œRedis</title>
    <link href="http://xiaoliblog.cn/page/Redis04.html"/>
    <id>http://xiaoliblog.cn/page/Redis04.html</id>
    <published>2021-06-29T07:58:00.805Z</published>
    <updated>2021-06-29T13:13:27.111Z</updated>
    
    <content type="html"><![CDATA[<h1 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h1><ul><li>Redis äº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆï¼ ä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ï¼Œåœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹çš„ä¸­ï¼Œä¼šæŒ‰ ç…§é¡ºåºæ‰§è¡Œï¼</li><li>ä¸€æ¬¡æ€§ã€é¡ºåºæ€§ã€æ’ä»–æ€§ï¼æ‰§è¡Œä¸€äº›åˆ—çš„å‘½ä»¤ï¼</li><li><strong>Redisäº‹åŠ¡æ²¡æœ‰æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</strong>ï¼ æ‰€æœ‰çš„å‘½ä»¤åœ¨äº‹åŠ¡ä¸­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥è¢«æ‰§è¡Œï¼åªæœ‰å‘èµ·æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œï¼<strong>Exec Rediså•æ¡å‘½ä»¤å¼ä¿å­˜åŸå­æ€§çš„ï¼Œä½†æ˜¯äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§</strong>ï¼</li></ul><h2 id="Redisäº‹åŠ¡"><a href="#Redisäº‹åŠ¡" class="headerlink" title="Redisäº‹åŠ¡"></a>Redisäº‹åŠ¡</h2><ul><li>Redisçš„äº‹åŠ¡ï¼š<ul><li>å¼€å¯äº‹åŠ¡ï¼ˆmultiï¼‰</li><li>å‘½ä»¤å…¥é˜Ÿï¼ˆâ€¦â€¦ï¼‰</li><li>æ‰§è¡Œäº‹åŠ¡ï¼ˆexecï¼‰</li></ul></li><li><strong>æ­£å¸¸æ‰§è¡Œäº‹åŠ¡</strong>ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi <span class="comment"># å¼€å¯äº‹åŠ¡</span></span><br><span class="line">OK</span><br><span class="line"><span class="comment"># å‘½ä»¤å…¥é˜Ÿ</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 v1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; get k2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span> <span class="comment"># æ‰§è¡Œäº‹åŠ¡</span></span><br><span class="line">1) OK</span><br><span class="line">2) OK</span><br><span class="line">3) <span class="string">&quot;v2&quot;</span></span><br><span class="line">4) OK</span><br></pre></td></tr></table></figure><ul><li><strong>æ”¾å¼ƒäº‹åŠ¡</strong>ï¼<code>DISCARD</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi <span class="comment"># å¼€å¯äº‹åŠ¡</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 v1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k4 v4</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; DISCARD <span class="comment"># å–æ¶ˆäº‹åŠ¡</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get k4 <span class="comment"># äº‹åŠ¡é˜Ÿåˆ—ä¸­å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼</span></span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure><ul><li><strong>ç¼–è¯‘å‹å¼‚å¸¸</strong>ï¼ˆä»£ç æœ‰é—®é¢˜ï¼ å‘½ä»¤æœ‰é”™ï¼ï¼‰ ï¼Œäº‹åŠ¡ä¸­æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 v1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; getset k3 <span class="comment"># é”™è¯¯çš„å‘½ä»¤</span></span><br><span class="line">(error) ERR wrong number of arguments <span class="keyword">for</span> <span class="string">&#x27;getset&#x27;</span> <span class="built_in">command</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k4 v4</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k5 v5</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span> <span class="comment"># æ‰§è¡Œäº‹åŠ¡æŠ¥é”™ï¼</span></span><br><span class="line">(error) EXECABORT Transaction discarded because of previous errors.</span><br><span class="line">127.0.0.1:6379&gt; get k5 <span class="comment"># æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼</span></span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure><ul><li>è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆ1/0ï¼‰ï¼Œ å¦‚æœäº‹åŠ¡é˜Ÿåˆ—ä¸­å­˜åœ¨è¯­æ³•æ€§ï¼Œé‚£ä¹ˆæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œå…¶ä»–å‘½ä»¤æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œ çš„ï¼Œé”™è¯¯å‘½ä»¤æŠ›å‡ºå¼‚å¸¸ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 <span class="string">&quot;v1&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; incr k1 <span class="comment"># ä¼šæ‰§è¡Œçš„æ—¶å€™å¤±è´¥ï¼</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; get k3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span></span><br><span class="line">1) (error) ERR value is not an <span class="built_in">integer</span> or out of range <span class="comment"># è™½ç„¶ç¬¬ä¸€æ¡å‘½ä»¤æŠ¥é”™äº†ï¼Œä½†æ˜¯</span></span><br><span class="line">ä¾æ—§æ­£å¸¸æ‰§è¡ŒæˆåŠŸäº†ï¼</span><br><span class="line">2) OK</span><br><span class="line">3) OK</span><br><span class="line">4) <span class="string">&quot;v3&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; get k2</span><br><span class="line"><span class="string">&quot;v2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; get k3</span><br><span class="line"><span class="string">&quot;v3&quot;</span></span><br></pre></td></tr></table></figure><h2 id="ä¹è§‚é”"><a href="#ä¹è§‚é”" class="headerlink" title="ä¹è§‚é”"></a>ä¹è§‚é”</h2><ul><li>æ‚²è§‚é”ï¼šå¾ˆæ‚²è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¼šå‡ºé—®é¢˜ï¼Œæ— è®ºåšä»€ä¹ˆéƒ½ä¼šåŠ é”ï¼</li><li>ä¹è§‚é”ï¼šå¾ˆä¹è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¸ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼ -æ›´æ–°æ•°æ®çš„æ—¶å€™å»åˆ¤æ–­ä¸€ä¸‹ï¼Œåœ¨æ­¤æœŸé—´æ˜¯å¦æœ‰äººä¿®æ”¹è¿‡è¿™ä¸ªæ•°æ®ï¼Œè·å–<code>version</code>ï¼Œæ›´æ–°çš„æ—¶å€™æ¯”è¾ƒ <code>version</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> money 100</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> out 0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; watch money <span class="comment"># ç›‘è§† money å¯¹è±¡</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi <span class="comment"># äº‹åŠ¡æ­£å¸¸ç»“æŸï¼Œæ•°æ®æœŸé—´æ²¡æœ‰å‘ç”Ÿå˜åŠ¨ï¼Œè¿™ä¸ªæ—¶å€™å°±æ­£å¸¸æ‰§è¡ŒæˆåŠŸï¼</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; DECRBY money 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCRBY out 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span></span><br><span class="line">1) (<span class="built_in">integer</span>) 80</span><br><span class="line">2) (<span class="built_in">integer</span>) 20</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•å¤šçº¿ç¨‹ä¿®æ”¹å€¼ , ä½¿ç”¨<code>watch</code> å¯ä»¥å½“åšredisçš„ä¹è§‚é”æ“ä½œï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; watch money <span class="comment"># ç›‘è§† money</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; DECRBY money 10</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; INCRBY out 10</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span> <span class="comment"># æ‰§è¡Œä¹‹å‰ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œä¿®æ”¹äº†æˆ‘ä»¬çš„å€¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šå¯¼è‡´äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼</span></span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœä¿®æ”¹å¤±è´¥ï¼Œè·å–æœ€æ–°çš„å€¼å°±å¥½</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; unwatch <span class="comment"># 1.å¦‚æœå‘ç°äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå°±å…ˆè§£å†³</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; watch money <span class="comment"># 2.è·å–æœ€æ–°çš„å€¼ï¼Œå†æ¬¡ç›‘è§†ï¼Œselect version</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; decrby money 1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incrby money 1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span> <span class="comment"># 3.å¯¹æ¯”ç›‘è§†çš„å€¼æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æœæ²¡æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆæ‰§è¡ŒæˆåŠŸï¼Œå¦‚æœå˜äº†å°±æ‰§è¡Œå¤±è´¥</span></span><br><span class="line">1) (<span class="built_in">integer</span>) 999</span><br><span class="line">2) (<span class="built_in">integer</span>) 1000</span><br></pre></td></tr></table></figure><h1 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h1><ul><li><code>Jedis</code> æ˜¯ Redis å®˜æ–¹æ¨èçš„ javaè¿æ¥å¼€å‘å·¥å…·ï¼ ä½¿ç”¨Java æ“ä½œRedis ä¸­é—´ä»¶ï¼å¦‚æœä½ è¦ä½¿ç”¨ javaæ“ä½œredisï¼Œé‚£ä¹ˆä¸€å®šè¦å¯¹Jedis ååˆ†çš„ç†Ÿæ‚‰ï¼</li></ul><h2 id="ç›¸å…³ä¾èµ–"><a href="#ç›¸å…³ä¾èµ–" class="headerlink" title="ç›¸å…³ä¾èµ–"></a>ç›¸å…³ä¾èµ–</h2><ul><li>åˆ›å»ºç©ºMavené¡¹ç›®</li><li>å¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.76<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç¼–ç æµ‹è¯•"><a href="#ç¼–ç æµ‹è¯•" class="headerlink" title="ç¼–ç æµ‹è¯•"></a>ç¼–ç æµ‹è¯•</h2><ul><li>é¦–å…ˆIDEAè¦è¿æ¥Linuxè¿œç¨‹æœåŠ¡å™¨ä¸Šçš„Redisï¼Œéœ€è¦ä¿®æ”¹<code>redis.conf</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">requirepass &lt;è¦è®¾ç½®å¯†ç &gt;</span><br><span class="line"># bind 127.0.0.1  #æ³¨é‡Šæ‰</span><br><span class="line">daemonize yes</span><br><span class="line">protected-mode no</span><br></pre></td></tr></table></figure><ul><li>é…ç½®é˜²ç«å¢™å¯¹å¤–å¼€æ”¾æ¥å£</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼€æ”¾6379ç«¯å£</span></span><br><span class="line">firewall-cmd --zone=public --add-port=6379/tcp --permanent</span><br><span class="line"><span class="comment"># æ°¸ä¹…æ‰“å¼€ç«¯å£</span></span><br><span class="line">firewall-cmd --reload</span><br><span class="line"><span class="comment"># ç„¶åæŸ¥çœ‹ç«¯å£æ˜¯å¦æ‰“å¼€</span></span><br><span class="line">firewall-cmd --query-port=6379/tcp</span><br></pre></td></tr></table></figure><ul><li>ç„¶åè¦åœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨ã€é˜²ç«å¢™ã€‘è®¾ç½®å¯¹<code>6379</code>å¼€æ”¾</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/DTMJFR%29WR5WNVO9J%5DG465W1.png"></p><ul><li>ç„¶åå¼€å¯RedisæœåŠ¡</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server redis.conf</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPing</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1. new Jedis å¯¹è±¡  // æœ¬åœ°ä¸º127.0.0.1</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;120.26.86.206&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="comment">// æµ‹è¯•æ˜¯å¦è¿æ¥æˆåŠŸï¼Œå‰ææ˜¯RedisæœåŠ¡å·²å¼€å¯</span></span><br><span class="line">        jedis.auth(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        System.out.println(jedis.ping());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•å‡ºç°å¦‚ä¸‹ç»“æœ<code>PONG</code>è¡¨ç¤ºè¿æ¥æˆåŠŸ</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/PF%29%40_0ZG7TC3%7BCT%29I1Q%5B%25ET.png"></p><h2 id="å¸¸ç”¨APIæµ‹è¯•"><a href="#å¸¸ç”¨APIæµ‹è¯•" class="headerlink" title="å¸¸ç”¨APIæµ‹è¯•"></a>å¸¸ç”¨APIæµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestKey</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1. new Jedis å¯¹è±¡</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;120.26.86.206&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="comment">// æµ‹è¯•æ˜¯å¦è¿æ¥æˆåŠŸï¼Œå‰ææ˜¯RedisæœåŠ¡å·²å¼€å¯</span></span><br><span class="line">        jedis.auth(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        System.out.println(jedis.ping());</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¸…ç©ºæ•°æ®:&quot;</span>+jedis.flushDB());</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ¤æ–­æŸä¸ªé”®æ˜¯å¦å­˜åœ¨:&quot;</span>+jedis.exists(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–°å¢&lt;&#x27;username&#x27;,&#x27;xiaoli&#x27;&gt;çš„é”®å€¼å¯¹:&quot;</span>+jedis.set(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;xiaoli&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–°å¢&lt;&#x27;password&#x27;,&#x27;12345&#x27;&gt;çš„é”®å€¼å¯¹:&quot;</span>+jedis.set(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;12345&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;ç³»ç»Ÿä¸­æ‰€æœ‰çš„é”®å¦‚ä¸‹:&quot;</span>);</span><br><span class="line">        Set&lt;String&gt; keys = jedis.keys(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        System.out.println(keys);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤é”®password:&quot;</span>+jedis.del(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ¤æ–­passwordæ˜¯å¦å­˜åœ¨:&quot;</span>+jedis.exists(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;æŸ¥çœ‹é”®usernameæ‰€å­˜å‚¨çš„å€¼çš„ç±»å‹:&quot;</span>+jedis.type(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;éšæœºè¿”å›keyç©ºé—´çš„ä¸€ä¸ª:&quot;</span>+jedis.randomKey());</span><br><span class="line">        System.out.println(<span class="string">&quot;é‡å‘½åkey:&quot;</span>+jedis.rename(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;name&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;å–å‡ºæ”¹åçš„name:&quot;</span>+jedis.get(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;æŒ‰ç´¢å¼•æŸ¥è¯¢:&quot;</span>+jedis.select(<span class="number">0</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤å½“å‰é€‰æ‹©æ•°æ®ä¸­çš„æ‰€æœ‰key:&quot;</span>+jedis.flushDB());</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿”å›å½“å‰æ•°æ®åº“ä¸­keyçš„æ•°ç›®:&quot;</span>+jedis.dbSize());</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„key:&quot;</span>+jedis.flushAll());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">PONG</span><br><span class="line">æ¸…ç©ºæ•°æ®:OK</span><br><span class="line">åˆ¤æ–­æŸä¸ªé”®æ˜¯å¦å­˜åœ¨:<span class="keyword">false</span></span><br><span class="line">æ–°å¢&lt;<span class="string">&#x27;username&#x27;</span>,<span class="string">&#x27;xiaoli&#x27;</span>&gt;çš„é”®å€¼å¯¹:OK</span><br><span class="line">æ–°å¢&lt;<span class="string">&#x27;password&#x27;</span>,<span class="string">&#x27;12345&#x27;</span>&gt;çš„é”®å€¼å¯¹:OK</span><br><span class="line">ç³»ç»Ÿä¸­æ‰€æœ‰çš„é”®å¦‚ä¸‹:</span><br><span class="line">[password, username]</span><br><span class="line">åˆ é™¤é”®password:<span class="number">1</span></span><br><span class="line">åˆ¤æ–­passwordæ˜¯å¦å­˜åœ¨:<span class="keyword">false</span></span><br><span class="line">æŸ¥çœ‹é”®usernameæ‰€å­˜å‚¨çš„å€¼çš„ç±»å‹:string</span><br><span class="line">éšæœºè¿”å›keyç©ºé—´çš„ä¸€ä¸ª:username</span><br><span class="line">é‡å‘½åkey:OK</span><br><span class="line">å–å‡ºæ”¹åçš„name:xiaoli</span><br><span class="line">æŒ‰ç´¢å¼•æŸ¥è¯¢:OK</span><br><span class="line">åˆ é™¤å½“å‰é€‰æ‹©æ•°æ®ä¸­çš„æ‰€æœ‰key:OK</span><br><span class="line">è¿”å›å½“å‰æ•°æ®åº“ä¸­keyçš„æ•°ç›®:<span class="number">0</span></span><br><span class="line">åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„key:OK</span><br><span class="line"></span><br><span class="line">è¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç ä¸º <span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="äº‹åŠ¡æ“ä½œ"><a href="#äº‹åŠ¡æ“ä½œ" class="headerlink" title="äº‹åŠ¡æ“ä½œ"></a>äº‹åŠ¡æ“ä½œ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTx</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;120.26.86.206&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        jedis.auth(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        System.out.println(jedis.ping());</span><br><span class="line">        jedis.flushDB();</span><br><span class="line">        JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        jsonObject.put(<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;world&quot;</span>);</span><br><span class="line">        jsonObject.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;xiaoli&quot;</span>);</span><br><span class="line">        <span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">        Transaction multi = jedis.multi();</span><br><span class="line">        String result = jsonObject.toJSONString();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            multi.set(<span class="string">&quot;user1&quot;</span>,result);</span><br><span class="line">            multi.set(<span class="string">&quot;user2&quot;</span>,result);</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>; <span class="comment">// ä»£ç æŠ›å‡ºå¼‚å¸¸äº‹åŠ¡ï¼Œæ‰§è¡Œå¤±è´¥ï¼</span></span><br><span class="line">            multi.exec(); <span class="comment">// æ‰§è¡Œäº‹åŠ¡ï¼</span></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            multi.discard(); <span class="comment">// æ”¾å¼ƒäº‹åŠ¡</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(jedis.get(<span class="string">&quot;user1&quot;</span>));</span><br><span class="line">            System.out.println(jedis.get(<span class="string">&quot;user2&quot;</span>));</span><br><span class="line">            jedis.close(); <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/SZ%40U%7DO%5DIR%292%243BOS9%28G8ES8.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;äº‹åŠ¡&quot;&gt;&lt;a href=&quot;#äº‹åŠ¡&quot; class=&quot;headerlink&quot; title=&quot;äº‹åŠ¡&quot;&gt;&lt;/a&gt;äº‹åŠ¡&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Redis äº‹åŠ¡æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆï¼ ä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ï¼Œåœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹çš„ä¸­ï¼Œä¼šæŒ‰ ç…§é¡ºåºæ‰§è¡Œï¼&lt;/li&gt;
&lt;l</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯ä¸‰ç§ç‰¹æ®Šç±»å‹åŠäº‹åŠ¡æ“ä½œ</title>
    <link href="http://xiaoliblog.cn/page/Redis03.html"/>
    <id>http://xiaoliblog.cn/page/Redis03.html</id>
    <published>2021-06-29T06:45:30.071Z</published>
    <updated>2021-06-29T07:59:41.324Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Geospatial-åœ°ç†ä½ç½®"><a href="#Geospatial-åœ°ç†ä½ç½®" class="headerlink" title="Geospatial åœ°ç†ä½ç½®"></a>Geospatial åœ°ç†ä½ç½®</h1><ul><li>æœ‹å‹çš„å®šä½ï¼Œé™„è¿‘çš„äººï¼Œæ‰“è½¦è·ç¦»è®¡ç®—ï¼Ÿ Redis çš„ Geo åœ¨Redis3.2 ç‰ˆæœ¬å°±æ¨å‡ºäº†ï¼ è¿™ä¸ªåŠŸèƒ½å¯ä»¥æ¨ç®—åœ°ç†ä½ç½®çš„ä¿¡æ¯ï¼Œä¸¤åœ°ä¹‹é—´çš„è·ç¦»ï¼Œæ–¹åœ† å‡ é‡Œçš„äººï¼ </li><li>Rediså®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.redis.net.cn/order/3685.html">https://www.redis.net.cn/order/3685.html</a></li><li>é€šè¿‡ä¸€äº›æ•°æ®ç½‘ç«™è¿›è¡ŒåŸå¸‚ç»çº¬åº¦æŸ¥è¯¢ï¼š<a href="http://www.jsons.cn/lngcode/">http://www.jsons.cn/lngcode/</a></li></ul><h3 id="geoadd"><a href="#geoadd" class="headerlink" title="geoadd"></a>geoadd</h3><ul><li><code>geoadd</code> æ·»åŠ åœ°ç†ä½ç½®<ul><li>è§„åˆ™ï¼šä¸¤çº§æ— æ³•ç›´æ¥æ·»åŠ ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä¸‹è½½åŸå¸‚æ•°æ®ï¼Œç›´æ¥é€šè¿‡javaç¨‹åºä¸€æ¬¡æ€§å¯¼å…¥ï¼</li><li>æœ‰æ•ˆçš„ç»åº¦ä»-180åº¦åˆ°180åº¦</li><li>æœ‰æ•ˆçš„çº¬åº¦ä»-85.05112878åº¦åˆ°85.05112878åº¦</li><li>å½“åæ ‡ä½ç½®è¶…å‡ºä¸Šè¿°æŒ‡å®šèŒƒå›´æ—¶ï¼Œè¯¥å‘½ä»¤å°†ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯</li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»åº¦ï¼Œçº¬åº¦</span></span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 116.40 39.90 beijing</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 121.47 31.23 shanghai</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 106.50 29.53 chongqi 114.05 22.52 shengzhen</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; geoadd china:city 120.16 30.24 hangzhou 108.96 34.26 xian</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></table></figure><h2 id="geopos"><a href="#geopos" class="headerlink" title="geopos"></a>geopos</h2><ul><li>è·å¾—å½“å‰å®šä½ï¼šä¸€å®šæ˜¯ä¸€ä¸ªåæ ‡å€¼ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geopos china:city beijing <span class="comment"># è·å–æŒ‡å®šçš„åŸå¸‚çš„ç»åº¦å’Œçº¬åº¦ï¼</span></span><br><span class="line">1) 1) <span class="string">&quot;116.39999896287918091&quot;</span></span><br><span class="line">2) <span class="string">&quot;39.90000009167092543&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; geopos china:city beijing chongqi</span><br><span class="line">1) 1) <span class="string">&quot;116.39999896287918091&quot;</span></span><br><span class="line">2) <span class="string">&quot;39.90000009167092543&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;106.49999767541885376&quot;</span></span><br><span class="line">2) <span class="string">&quot;29.52999957900659211&quot;</span></span><br></pre></td></tr></table></figure><h2 id="geodist"><a href="#geodist" class="headerlink" title="geodist"></a>geodist</h2><ul><li>ä¸¤ä½ç½®ä¹‹é—´çš„è·ç¦»ï¼å¯ä»¥ç”¨äºè·å–ä¸¤äººä¹‹é—´çš„ä½ç½®ï¼Œ å•ä½ï¼š<ul><li><code>m</code> è¡¨ç¤ºå•ä½ä¸ºç±³</li><li><code>km</code> è¡¨ç¤ºå•ä½ä¸ºåƒç±³</li><li><code>mi</code> è¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œ</li><li><code>ft</code> è¡¨ç¤ºå•ä½ä¸ºè‹±å°º</li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geodist china:city beijing shanghai km <span class="comment"># æŸ¥çœ‹ä¸Šæµ·åˆ°åŒ—äº¬çš„ç›´çº¿è·ç¦»</span></span><br><span class="line"><span class="string">&quot;1067.3788&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; geodist china:city beijing chongqi km <span class="comment"># æŸ¥çœ‹é‡åº†åˆ°åŒ—äº¬çš„ç›´çº¿è·ç¦»</span></span><br><span class="line"><span class="string">&quot;1464.0708&quot;</span></span><br></pre></td></tr></table></figure><h2 id="georadius"><a href="#georadius" class="headerlink" title="georadius"></a>georadius</h2><ul><li>ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ æ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ </li><li>åº”ç”¨äºæˆ‘é™„è¿‘çš„äººï¼Ÿ ï¼ˆè·å¾—æ‰€æœ‰é™„è¿‘çš„äººçš„åœ°å€ï¼Œå®šä½ï¼ï¼‰é€šè¿‡åŠå¾„æ¥æŸ¥è¯¢ï¼ è·å¾—æŒ‡å®šæ•°é‡çš„äººï¼Œ200 æ‰€æœ‰æ•°æ®åº”è¯¥éƒ½å½•å…¥ï¼šchina:city ï¼Œæ‰ä¼šè®©ç»“æœæ›´åŠ è¯·æ±‚ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 1000 km <span class="comment"># ä»¥110ï¼Œ30 è¿™ä¸ªç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œå¯»</span></span><br><span class="line">æ‰¾æ–¹åœ†1000kmå†…çš„åŸå¸‚</span><br><span class="line">1) <span class="string">&quot;chongqi&quot;</span></span><br><span class="line">2) <span class="string">&quot;xian&quot;</span></span><br><span class="line">3) <span class="string">&quot;shengzhen&quot;</span></span><br><span class="line">4) <span class="string">&quot;hangzhou&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 500 km</span><br><span class="line">1) <span class="string">&quot;chongqi&quot;</span></span><br><span class="line">2) <span class="string">&quot;xian&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 500 km withdist <span class="comment"># æ˜¾ç¤ºåˆ°ä¸­é—´è·ç¦»çš„ä½ç½®</span></span><br><span class="line">1) 1) <span class="string">&quot;chongqi&quot;</span></span><br><span class="line">2) <span class="string">&quot;341.9374&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;xian&quot;</span></span><br><span class="line">2) <span class="string">&quot;483.8340&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 500 km withcoord <span class="comment"># æ˜¾ç¤ºä»–äººçš„å®šä½ä¿¡æ¯</span></span><br><span class="line">1) 1) <span class="string">&quot;chongqi&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;106.49999767541885376&quot;</span></span><br><span class="line">2) <span class="string">&quot;29.52999957900659211&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;xian&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;108.96000176668167114&quot;</span></span><br><span class="line">2) <span class="string">&quot;34.25999964418929977&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 500 km withdist withcoord count 1 <span class="comment">#ç­›é€‰å‡ºæŒ‡å®šçš„ç»“æœï¼</span></span><br><span class="line">1) 1) <span class="string">&quot;chongqi&quot;</span></span><br><span class="line">2) <span class="string">&quot;341.9374&quot;</span></span><br><span class="line">3) 1) <span class="string">&quot;106.49999767541885376&quot;</span></span><br><span class="line">2) <span class="string">&quot;29.52999957900659211&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; georadius china:city 110 30 500 km withdist withcoord count 2</span><br><span class="line">1) 1) <span class="string">&quot;chongqi&quot;</span></span><br><span class="line">2) <span class="string">&quot;341.9374&quot;</span></span><br><span class="line">3) 1) <span class="string">&quot;106.49999767541885376&quot;</span></span><br><span class="line">2) <span class="string">&quot;29.52999957900659211&quot;</span></span><br><span class="line">2) 1) <span class="string">&quot;xian&quot;</span></span><br><span class="line">2) <span class="string">&quot;483.8340&quot;</span></span><br><span class="line">3) 1) <span class="string">&quot;108.96000176668167114&quot;</span></span><br><span class="line">2) <span class="string">&quot;34.25999964418929977&quot;</span></span><br></pre></td></tr></table></figure><h2 id="georadiusbymember"><a href="#georadiusbymember" class="headerlink" title="georadiusbymember"></a>georadiusbymember</h2><ul><li>æ‰¾å‡ºä½äºæŒ‡å®šå…ƒç´ å‘¨å›´çš„å…¶ä»–å…ƒç´ ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; georadiusbymember china:city beijing 1000 km</span><br><span class="line">1) <span class="string">&quot;beijing&quot;</span></span><br><span class="line">2) <span class="string">&quot;xian&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; georadiusbymember china:city shanghai 400 km</span><br><span class="line">1) <span class="string">&quot;hangzhou&quot;</span></span><br><span class="line">2) <span class="string">&quot;shanghai&quot;</span></span><br></pre></td></tr></table></figure><h2 id="geohash"><a href="#geohash" class="headerlink" title="geohash"></a>geohash</h2><ul><li>è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®å…ƒç´ çš„ Geohash è¡¨ç¤ºï¼Œè¿”å›11ä¸ªå­—ç¬¦çš„Geohashå­—ç¬¦ä¸²</li><li>å°†äºŒç»´çš„ç»çº¬åº¦è½¬æ¢ä¸ºä¸€ç»´çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²è¶Šæ¥è¿‘ï¼Œé‚£ä¹ˆåˆ™è·ç¦»è¶Šè¿‘ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geohash china:city beijing chongqi</span><br><span class="line">1) <span class="string">&quot;wx4fbxxfke0&quot;</span></span><br><span class="line">2) <span class="string">&quot;wm5xzrybty0&quot;</span></span><br></pre></td></tr></table></figure><ul><li>geo åº•å±‚çš„å®ç°åŸç†å…¶å®å°±æ˜¯ <code>Zset</code>ï¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Zsetå‘½ä»¤æ¥æ“ä½œgeoï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange china:city 0 -1 <span class="comment"># æŸ¥çœ‹åœ°å›¾ä¸­å…¨éƒ¨çš„å…ƒç´ </span></span><br><span class="line">1) <span class="string">&quot;chongqi&quot;</span></span><br><span class="line">2) <span class="string">&quot;xian&quot;</span></span><br><span class="line">3) <span class="string">&quot;shengzhen&quot;</span></span><br><span class="line">4) <span class="string">&quot;hangzhou&quot;</span></span><br><span class="line">5) <span class="string">&quot;shanghai&quot;</span></span><br><span class="line">6) <span class="string">&quot;beijing&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zrem china:city beijing <span class="comment"># ç§»é™¤æŒ‡å®šå…ƒç´ ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange china:city 0 -1</span><br><span class="line">1) <span class="string">&quot;chongqi&quot;</span></span><br><span class="line">2) <span class="string">&quot;xian&quot;</span></span><br><span class="line">3) <span class="string">&quot;shengzhen&quot;</span></span><br><span class="line">4) <span class="string">&quot;hangzhou&quot;</span></span><br><span class="line">5) <span class="string">&quot;shanghai&quot;</span></span><br></pre></td></tr></table></figure><h1 id="HyperloglogåŸºæ•°ç»Ÿè®¡"><a href="#HyperloglogåŸºæ•°ç»Ÿè®¡" class="headerlink" title="HyperloglogåŸºæ•°ç»Ÿè®¡"></a>HyperloglogåŸºæ•°ç»Ÿè®¡</h1><ul><li>åŸºæ•°ï¼šä¸€ä¸ªé›†åˆä¸­ä¸é‡å¤çš„å…ƒç´ ä¸ªæ•°ï¼Œæ¯”å¦‚A {1,3,5,7,8,7}ï¼Œä¸é‡å¤çš„å…ƒç´ ä¸ªæ•°ä¸º5ï¼ŒåŸºæ•°ä¸º5</li><li>Redis 2.8.9 ç‰ˆæœ¬å°±æ›´æ–°äº† Hyperloglog æ•°æ®ç»“æ„ï¼ Redis Hyperloglog åŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼ </li><li>ä¼˜ç‚¹ï¼šå ç”¨çš„å†…å­˜æ˜¯å›ºå®šï¼Œ2^64 ä¸åŒçš„å…ƒç´ çš„æŠ€æœ¯ï¼Œåªéœ€è¦åºŸ 12KBå†…å­˜ï¼å¦‚æœè¦ä»å†…å­˜è§’åº¦æ¥æ¯”è¾ƒçš„ è¯ Hyperloglog é¦–é€‰ï¼</li><li>ç½‘é¡µçš„ UVï¼ˆç½‘ç«™é¡µé¢è®¿é—®é‡ï¼‰ï¼Œ ä¸€ä¸ªäººè®¿é—®ä¸€ä¸ªç½‘ç«™å¤šæ¬¡ï¼Œä½†æ˜¯è¿˜æ˜¯ç®—ä½œä¸€ä¸ªäººï¼<ul><li>ä¼ ç»Ÿçš„æ–¹å¼ï¼Œ set ä¿å­˜ç”¨æˆ·çš„idï¼Œç„¶åå°±å¯ä»¥ç»Ÿè®¡ set ä¸­çš„å…ƒç´ æ•°é‡ä½œä¸ºæ ‡å‡†åˆ¤æ–­ !</li><li>è¿™ä¸ªæ–¹å¼å¦‚æœä¿å­˜å¤§é‡çš„ç”¨æˆ·idï¼Œå°±ä¼šæ¯”è¾ƒéº»çƒ¦ï¼æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è®¡æ•°ï¼Œè€Œä¸æ˜¯ä¿å­˜ç”¨æˆ·idï¼› 0.81% é”™è¯¯ç‡ï¼ ç»Ÿè®¡UVä»»åŠ¡ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡çš„ï¼</li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; PFadd mykey a b c d e f g h i j <span class="comment"># åˆ›å»ºç¬¬ä¸€ç»„å…ƒç´  mykey</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT mykey <span class="comment"># ç»Ÿè®¡ mykey å…ƒç´ çš„åŸºæ•°æ•°é‡</span></span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br><span class="line">127.0.0.1:6379&gt; PFadd mykey2 i j z x c v b n m <span class="comment"># åˆ›å»ºç¬¬äºŒç»„å…ƒç´  mykey2</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT mykey2</span><br><span class="line">(<span class="built_in">integer</span>) 9</span><br><span class="line">127.0.0.1:6379&gt; PFMERGE mykey3 mykey mykey2 <span class="comment"># åˆå¹¶ä¸¤ç»„ mykey mykey2 =&gt; mykey3 å¹¶é›†</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT mykey3 <span class="comment"># çœ‹å¹¶é›†çš„æ•°é‡ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 15</span><br></pre></td></tr></table></figure><div class="note success simple"><p>å¦‚æœå…è®¸å®¹é”™ï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥ä½¿ç”¨ Hyperloglog ï¼ å¦‚æœä¸å…è®¸å®¹é”™ï¼Œå°±ä½¿ç”¨ set æˆ–è€…è‡ªå·±çš„æ•°æ®ç±»å‹å³å¯!</p></div><h1 id="Bitmapä½å›¾"><a href="#Bitmapä½å›¾" class="headerlink" title="Bitmapä½å›¾"></a>Bitmapä½å›¾</h1><ul><li>ç»Ÿè®¡ç”¨æˆ·ä¿¡æ¯ï¼Œæ´»è·ƒï¼Œä¸æ´»è·ƒï¼ ç™»å½• ã€ æœªç™»å½•ï¼ æ‰“å¡ï¼Œ365æ‰“å¡ï¼ ä¸¤ä¸ªçŠ¶æ€çš„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ Bitmapsï¼ </li><li>Bitmap ä½å›¾ï¼Œæ•°æ®ç»“æ„ï¼ éƒ½æ˜¯æ“ä½œäºŒè¿›åˆ¶ä½æ¥è¿›è¡Œè®°å½•ï¼Œå°±åªæœ‰<code>0</code> å’Œ <code>1</code> ä¸¤ä¸ªçŠ¶æ€ï¼</li><li>ä½¿ç”¨bitmap æ¥è®°å½• å‘¨ä¸€åˆ°å‘¨æ—¥çš„æ‰“å¡ï¼1è¡¨ç¤ºæ‰“å¡ï¼Œ0è¡¨ç¤ºæœªæ‰“å¡ï¼Œ0è‡³6è¡¨ç¤ºå‘¨ä¸€åˆ°å‘¨æ—¥</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; setbit sign 0 1 <span class="comment"># å‘¨ä¸€ æœªæ‰“å¼€</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 1 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 2 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 3 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 4 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 5 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit sign 6 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹æŸä¸€å¤©æ˜¯å¦æœ‰æ‰“å¡ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; getbit sign 3</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; getbit sign 6</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure><ul><li>ç»Ÿè®¡æ“ä½œï¼Œç»Ÿè®¡ æ‰“å¡çš„å¤©æ•°ï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; bitcount sign <span class="comment"># ç»Ÿè®¡è¿™å‘¨çš„æ‰“å¡è®°å½•ï¼Œå°±å¯ä»¥çœ‹åˆ°æ˜¯å¦æœ‰å…¨å‹¤ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Geospatial-åœ°ç†ä½ç½®&quot;&gt;&lt;a href=&quot;#Geospatial-åœ°ç†ä½ç½®&quot; class=&quot;headerlink&quot; title=&quot;Geospatial åœ°ç†ä½ç½®&quot;&gt;&lt;/a&gt;Geospatial åœ°ç†ä½ç½®&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;æœ‹å‹çš„å®šä½ï¼Œé™„è¿‘çš„äººï¼Œæ‰“</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯Redisäº”å¤§æ•°æ®ç±»å‹</title>
    <link href="http://xiaoliblog.cn/page/Redis02.html"/>
    <id>http://xiaoliblog.cn/page/Redis02.html</id>
    <published>2021-06-28T14:41:00.411Z</published>
    <updated>2021-06-29T06:41:00.325Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redis-key"><a href="#Redis-key" class="headerlink" title="Redis-key"></a>Redis-key</h1><ul><li>åœ¨Redisä¸­æ— è®ºä»€ä¹ˆæ•°æ®ç±»å‹ï¼Œåœ¨æ•°æ®åº“ä¸­éƒ½æ˜¯ä»¥<code>key-value</code>å½¢å¼ä¿å­˜ï¼Œé€šè¿‡è¿›è¡Œå¯¹Redis-keyçš„æ“ä½œï¼Œæ¥å®Œæˆå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ“</li></ul><table><thead><tr><th align="center">Rediså‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>exists key</code></td><td align="center">åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨</td></tr><tr><td align="center"><code>del key</code></td><td align="center">åˆ é™¤é”®å€¼å¯¹</td></tr><tr><td align="center"><code>move key db</code></td><td align="center">å°†é”®å€¼å¯¹ç§»åŠ¨åˆ°æŒ‡å®šæ•°æ®åº“</td></tr><tr><td align="center"><code>expire key second</code></td><td align="center">è®¾ç½®é”®å€¼å¯¹çš„è¿‡æœŸæ—¶é—´</td></tr><tr><td align="center"><code>ttl key</code></td><td align="center">æŸ¥çœ‹å‰©ä½™æ—¶é—´</td></tr><tr><td align="center"><code>type key</code></td><td align="center">æŸ¥çœ‹valueçš„æ•°æ®ç±»å‹</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys * <span class="comment"># æŸ¥çœ‹å½“å‰æ•°æ®åº“æ‰€æœ‰key</span></span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name xiaoliblog <span class="comment"># set key</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> age 20</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">&quot;age&quot;</span></span><br><span class="line">2) <span class="string">&quot;name&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; move age 1 <span class="comment"># å°†é”®å€¼å¯¹ç§»åŠ¨åˆ°æŒ‡å®šæ•°æ®åº“</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; EXISTS age <span class="comment"># åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">(<span class="built_in">integer</span>) 0 <span class="comment"># ä¸å­˜åœ¨</span></span><br><span class="line">127.0.0.1:6379&gt; EXISTS name</span><br><span class="line">(<span class="built_in">integer</span>) 1 <span class="comment"># å­˜åœ¨</span></span><br><span class="line">127.0.0.1:6379&gt; SELECT 1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[1]&gt; keys *</span><br><span class="line">1) <span class="string">&quot;age&quot;</span></span><br><span class="line">127.0.0.1:6379[1]&gt; del age <span class="comment"># åˆ é™¤é”®å€¼å¯¹</span></span><br><span class="line">(<span class="built_in">integer</span>) 1 <span class="comment"># åˆ é™¤ä¸ªæ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> age 20</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; EXPIRE age 15 <span class="comment"># è®¾ç½®é”®å€¼å¯¹çš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line"></span><br><span class="line">(<span class="built_in">integer</span>) 1 <span class="comment"># è®¾ç½®æˆåŠŸ å¼€å§‹è®¡æ•°</span></span><br><span class="line">127.0.0.1:6379&gt; ttl age <span class="comment"># æŸ¥çœ‹keyçš„è¿‡æœŸå‰©ä½™æ—¶é—´</span></span><br><span class="line">(<span class="built_in">integer</span>) 13</span><br><span class="line">127.0.0.1:6379&gt; ttl age</span><br><span class="line">(<span class="built_in">integer</span>) 11</span><br><span class="line">127.0.0.1:6379&gt; ttl age</span><br><span class="line">(<span class="built_in">integer</span>) 9</span><br><span class="line">127.0.0.1:6379&gt; ttl age</span><br><span class="line">(<span class="built_in">integer</span>) -2 <span class="comment"># -2 è¡¨ç¤ºkeyè¿‡æœŸï¼Œ-1è¡¨ç¤ºkeyæœªè®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; get age <span class="comment"># è¿‡æœŸçš„key ä¼šè¢«è‡ªåŠ¨delete</span></span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">&quot;name&quot;</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">type</span> name <span class="comment"># æŸ¥çœ‹valueçš„æ•°æ®ç±»å‹</span></span><br><span class="line">string</span><br></pre></td></tr></table></figure><div class="note success simple"><p>å…³äºTTLå‘½ä»¤</p></div><ul><li>Redisçš„keyï¼Œé€šè¿‡TTLå‘½ä»¤è¿”å›keyçš„è¿‡æœŸæ—¶é—´ï¼Œä¸€èˆ¬æ¥è¯´æœ‰3ç§ï¼š<ul><li>å½“å‰keyæ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ä¼šè¿”å›<code>-1</code>.</li><li>å½“å‰keyæœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè€Œä¸”keyå·²ç»è¿‡æœŸï¼Œæ‰€ä»¥ä¼šè¿”å›<code>-2</code>.</li><li>å½“å‰keyæœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¸”keyè¿˜æ²¡æœ‰è¿‡æœŸï¼Œæ•…ä¼šè¿”å›keyçš„æ­£å¸¸å‰©ä½™æ—¶é—´.</li></ul></li></ul><div class="note success simple"><p>å…³äºé‡å‘½åRENAMEå’ŒRENAMENX</p></div><ul><li><code>RENAME key newkey</code>ä¿®æ”¹ key çš„åç§°</li><li><code>RENAMENX key newkey</code>ä»…å½“ newkey ä¸å­˜åœ¨æ—¶ï¼Œå°† key æ”¹åä¸º newkey ã€‚</li></ul><div class="note success simple"><p>æ›´å¤šRediså‘½ä»¤å‚è€ƒï¼š<a href="https://www.redis.net.cn/order/">https://www.redis.net.cn/order/</a></p></div><h1 id="äº”å¤§æ•°æ®ç±»å‹"><a href="#äº”å¤§æ•°æ®ç±»å‹" class="headerlink" title="äº”å¤§æ•°æ®ç±»å‹"></a>äº”å¤§æ•°æ®ç±»å‹</h1><h2 id="Stringå­—ç¬¦ä¸²"><a href="#Stringå­—ç¬¦ä¸²" class="headerlink" title="Stringå­—ç¬¦ä¸²"></a>Stringå­—ç¬¦ä¸²</h2><ul><li><code>String</code>ç±»ä¼¼çš„ä½¿ç”¨åœºæ™¯ï¼š<code>value</code>é™¤äº†æ˜¯æˆ‘ä»¬çš„å­—ç¬¦ä¸²è¿˜å¯ä»¥æ˜¯æˆ‘ä»¬çš„æ•°å­—ï¼ <ul><li>è®¡æ•°å™¨ </li><li>ç»Ÿè®¡å¤šå•ä½çš„æ•°é‡ </li><li>ç²‰ä¸æ•° </li><li>å¯¹è±¡ç¼“å­˜å­˜å‚¨ï¼</li></ul></li></ul><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>append key str</code></td><td align="center">è¿½åŠ å­—ç¬¦ä¸²ï¼Œå¦‚æœå½“å‰keyä¸å­˜åœ¨ï¼Œå°±ç›¸å½“äºsetkey</td></tr><tr><td align="center"><code>strlen key</code></td><td align="center">è·å–å­—ç¬¦ä¸²çš„é•¿åº¦</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> key1 v1 <span class="comment"># è®¾ç½®å€¼</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get key1 <span class="comment"># è·å¾—å€¼</span></span><br><span class="line"><span class="string">&quot;v1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; keys * <span class="comment"># è·å¾—æ‰€æœ‰çš„key</span></span><br><span class="line">1) <span class="string">&quot;key1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; EXISTS key1 <span class="comment"># åˆ¤æ–­æŸä¸€ä¸ªkeyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; APPEND key1 <span class="string">&quot;hello&quot;</span> <span class="comment"># è¿½åŠ å­—ç¬¦ä¸²ï¼Œå¦‚æœå½“å‰keyä¸å­˜åœ¨ï¼Œå°±ç›¸å½“äºsetkey</span></span><br><span class="line">(<span class="built_in">integer</span>) 7</span><br><span class="line">127.0.0.1:6379&gt; get key1</span><br><span class="line"><span class="string">&quot;v1hello&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; STRLEN key1 <span class="comment"># è·å–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 7</span><br><span class="line">127.0.0.1:6379&gt; APPEND key1 <span class="string">&quot;,world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 17</span><br><span class="line">127.0.0.1:6379&gt; STRLEN key1</span><br><span class="line">(<span class="built_in">integer</span>) 17</span><br><span class="line">127.0.0.1:6379&gt; get key1</span><br><span class="line"><span class="string">&quot;v1hello,world&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>incr key</code></td><td align="center">é”®å€¼è‡ªå¢1</td></tr><tr><td align="center"><code>decr key</code></td><td align="center">é”®å€¼è‡ªå‡1</td></tr><tr><td align="center"><code>incrby key 10</code></td><td align="center">å¯ä»¥è®¾ç½®æ­¥é•¿ï¼ŒæŒ‡å®šå¢é‡ä¸º10</td></tr><tr><td align="center"><code>decr key 5</code></td><td align="center">å¯ä»¥è®¾ç½®æ­¥é•¿ï¼ŒæŒ‡å®šå‡å¢é‡ä¸º5</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># i++</span></span><br><span class="line"><span class="comment"># æ­¥é•¿ i+=</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> views 0 <span class="comment"># åˆå§‹æµè§ˆé‡ä¸º0</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get views</span><br><span class="line"><span class="string">&quot;0&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; incr views <span class="comment"># è‡ªå¢1 æµè§ˆé‡å˜ä¸º1</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; incr views</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; get views</span><br><span class="line"><span class="string">&quot;2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; decr views <span class="comment"># è‡ªå‡1 æµè§ˆé‡-1</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; decr views</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; decr views</span><br><span class="line">(<span class="built_in">integer</span>) -1</span><br><span class="line">127.0.0.1:6379&gt; get views</span><br><span class="line"><span class="string">&quot;-1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; INCRBY views 10 <span class="comment"># å¯ä»¥è®¾ç½®æ­¥é•¿ï¼ŒæŒ‡å®šå¢é‡ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 9</span><br><span class="line">127.0.0.1:6379&gt; INCRBY views 10</span><br><span class="line">(<span class="built_in">integer</span>) 19</span><br><span class="line">127.0.0.1:6379&gt; DECRBY views 5</span><br><span class="line">(<span class="built_in">integer</span>) 14</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th><th align="center">å®ä¾‹</th></tr></thead><tbody><tr><td align="center"><code>getrange key start end</code></td><td align="center">è·å–æŒ‡å®šèŒƒå›´çš„é”®å€¼</td><td align="center">getrange key1 0 3</td></tr><tr><td align="center"><code>setrange key offset value</code></td><td align="center">ä»offsetå¼€å§‹æ›¿æ¢ä¸ºæŒ‡å®šçš„value</td><td align="center">SETRANGE key2 1 xx</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­—ç¬¦ä¸²èŒƒå›´ range</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> key1 <span class="string">&quot;hello,world&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; getrange key1 0 3 <span class="comment"># æˆªå–å­—ç¬¦ä¸² [0,3]</span></span><br><span class="line"><span class="string">&quot;hell&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; getrange key1 0 -1 <span class="comment"># è·å–å…¨éƒ¨çš„å­—ç¬¦ä¸² å’Œ get keyæ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="string">&quot;hello,world&quot;</span></span><br><span class="line"><span class="comment"># æ›¿æ¢ï¼</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> key2 abcdefg</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get key2</span><br><span class="line"><span class="string">&quot;abcdefg&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SETRANGE key2 1 xx <span class="comment"># æ›¿æ¢æŒ‡å®šä½ç½®å¼€å§‹çš„å­—ç¬¦ä¸²ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 7</span><br><span class="line">127.0.0.1:6379&gt; get key2</span><br><span class="line"><span class="string">&quot;axxdefg&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th><th align="center">å®ä¾‹</th></tr></thead><tbody><tr><td align="center"><code>setex (set with expire)</code></td><td align="center">è®¾ç½®è¿‡æœŸæ—¶é—´</td><td align="center">setex key3 30 â€œhelloâ€</td></tr><tr><td align="center"><code>setnx (set if not exist)</code></td><td align="center">ä¸å­˜åœ¨åœ¨è®¾ç½®,åœ¨åˆ†å¸ƒå¼é”ä¸­ä¼šå¸¸å¸¸ä½¿ç”¨ï¼</td><td align="center">setnx mykey â€œMongoDBâ€</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setex (set with expire) # è®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment"># setnx (set if not exist) # ä¸å­˜åœ¨åœ¨è®¾ç½® ï¼ˆåœ¨åˆ†å¸ƒå¼é”ä¸­ä¼šå¸¸å¸¸ä½¿ç”¨ï¼ï¼‰</span></span><br><span class="line">127.0.0.1:6379&gt; setex key3 30 <span class="string">&quot;hello&quot;</span> <span class="comment"># è®¾ç½®key3 çš„å€¼ä¸º hello,30ç§’åè¿‡æœŸ</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; ttl key3</span><br><span class="line">(<span class="built_in">integer</span>) 26</span><br><span class="line">127.0.0.1:6379&gt; get key3</span><br><span class="line"><span class="string">&quot;hello&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; setnx mykey <span class="string">&quot;redis&quot;</span> <span class="comment"># å¦‚æœmykey ä¸å­˜åœ¨ï¼Œåˆ›å»ºmykey</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">&quot;key2&quot;</span></span><br><span class="line">2) <span class="string">&quot;mykey&quot;</span></span><br><span class="line">3) <span class="string">&quot;key1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; ttl key3</span><br><span class="line">(<span class="built_in">integer</span>) -2</span><br><span class="line">127.0.0.1:6379&gt; setnx mykey <span class="string">&quot;MongoDB&quot;</span> <span class="comment"># å¦‚æœmykeyå­˜åœ¨ï¼Œåˆ›å»ºå¤±è´¥ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; get mykey</span><br><span class="line"><span class="string">&quot;redis&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>mset k1 v1 k2 v2 k3 v3</code></td><td align="center">åŒæ—¶è®¾ç½®å¤šä¸ªå€¼</td></tr><tr><td align="center"><code>mget k1 k2 k3</code></td><td align="center">åŒæ—¶è·å–å¤šä¸ªå€¼</td></tr><tr><td align="center"><code>msetnx k1 v1 k4 v4</code></td><td align="center">msetnx æ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mset åŒæ—¶è®¾ç½®å¤šä¸ªå€¼</span></span><br><span class="line"><span class="comment"># mget åŒæ—¶è·å–å¤šä¸ªå€¼</span></span><br><span class="line">127.0.0.1:6379&gt; mset k1 v1 k2 v2 k3 v3 <span class="comment"># åŒæ—¶è®¾ç½®å¤šä¸ªå€¼</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">&quot;k1&quot;</span></span><br><span class="line">2) <span class="string">&quot;k2&quot;</span></span><br><span class="line">3) <span class="string">&quot;k3&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; mget k1 k2 k3 <span class="comment"># åŒæ—¶è·å–å¤šä¸ªå€¼</span></span><br><span class="line">1) <span class="string">&quot;v1&quot;</span></span><br><span class="line">2) <span class="string">&quot;v2&quot;</span></span><br><span class="line">3) <span class="string">&quot;v3&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; msetnx k1 v1 k4 v4 <span class="comment"># msetnx æ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; get k4</span><br><span class="line">(nil)</span><br><span class="line"><span class="comment"># å¯¹è±¡</span></span><br><span class="line"><span class="built_in">set</span> user:1 &#123;xiaoliblog,age:3&#125; <span class="comment"># è®¾ç½®ä¸€ä¸ªuser:1 å¯¹è±¡ å€¼ä¸º jsonå­—ç¬¦æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡ï¼</span></span><br><span class="line"><span class="comment"># è¿™é‡Œçš„keyæ˜¯ä¸€ä¸ªå·§å¦™çš„è®¾è®¡ï¼š user:&#123;id&#125;:&#123;filed&#125; , å¦‚æ­¤è®¾è®¡åœ¨Redisä¸­æ˜¯å®Œå…¨OKäº†ï¼</span></span><br><span class="line">127.0.0.1:6379&gt; mset user:1:name xiaoliblog user:1:age 2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; mget user:1:name user:1:age</span><br><span class="line">1) <span class="string">&quot;xiaoliblog&quot;</span></span><br><span class="line">2) <span class="string">&quot;2&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>getset</code></td><td align="center">ç»„åˆå‘½ä»¤ï¼Œå¦‚æœä¸å­˜åœ¨å€¼åˆ™è®¾ç½®ï¼Œå­˜åœ¨ä¼šè¦†ç›–åŸå€¼</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆgetç„¶ååœ¨set</span></span><br><span class="line">127.0.0.1:6379&gt; getset db redis <span class="comment"># å¦‚æœä¸å­˜åœ¨å€¼ï¼Œåˆ™è¿”å› nil</span></span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; get db</span><br><span class="line"><span class="string">&quot;redis&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; getset db mongodb <span class="comment"># å¦‚æœå­˜åœ¨å€¼ï¼Œè·å–åŸæ¥çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼</span></span><br><span class="line"><span class="string">&quot;redis&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; get db</span><br><span class="line"><span class="string">&quot;mongodb&quot;</span></span><br></pre></td></tr></table></figure><h2 id="Liståˆ—è¡¨"><a href="#Liståˆ—è¡¨" class="headerlink" title="Liståˆ—è¡¨"></a>Liståˆ—è¡¨</h2><ul><li>åœ¨Redisé‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<code>list</code>ç©æˆ æ ˆã€é˜Ÿåˆ—ã€é˜»å¡é˜Ÿåˆ—ï¼ æ‰€æœ‰çš„<code>list</code>å‘½ä»¤éƒ½æ˜¯ç”¨<code>l</code>å¼€å¤´çš„ï¼ŒRedisä¸åŒºåˆ†å¤§å°å‘½ä»¤<ul><li>listå®é™…ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œbefore Node after ï¼Œ leftï¼Œright éƒ½å¯ä»¥æ’å…¥å€¼</li><li>å¦‚æœkey ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„é“¾è¡¨</li><li>å¦‚æœkeyå­˜åœ¨ï¼Œæ–°å¢å†…å®¹</li><li>å¦‚æœç§»é™¤äº†æ‰€æœ‰å€¼ï¼Œç©ºé“¾è¡¨ï¼Œä¹Ÿä»£è¡¨ä¸å­˜åœ¨ï¼</li><li>åœ¨ä¸¤è¾¹æ’å…¥æˆ–è€…æ”¹åŠ¨å€¼ï¼Œæ•ˆç‡æœ€é«˜ï¼ ä¸­é—´å…ƒç´ ï¼Œç›¸å¯¹æ¥è¯´æ•ˆç‡ä¼šä½ä¸€ç‚¹~</li></ul></li></ul><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>lpush list value</code></td><td align="center">å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ ï¼ˆå·¦ï¼‰</td></tr><tr><td align="center"><code>rpush list value</code></td><td align="center">å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨å°¾éƒ¨ ï¼ˆå³ï¼‰</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; LPUSH list one <span class="comment"># å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ ï¼ˆå·¦ï¼‰</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; LPUSH list two</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; LPUSH list three</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1 <span class="comment"># è·å–listä¸­å€¼ï¼</span></span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 1 <span class="comment"># é€šè¿‡åŒºé—´è·å–å…·ä½“çš„å€¼ï¼</span></span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Rpush list righr <span class="comment"># å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨ä½éƒ¨ ï¼ˆå³ï¼‰</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;righr&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>lpop value</code></td><td align="center">ç§»é™¤listçš„ç¬¬ä¸€ä¸ªå…ƒç´ </td></tr><tr><td align="center"><code>rpop value</code></td><td align="center">ç§»é™¤listçš„æœ€åä¸€ä¸ªå…ƒç´ </td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;righr&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lpop list <span class="comment"># ç§»é™¤listçš„ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="string">&quot;three&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Rpop list <span class="comment"># ç§»é™¤listçš„æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="string">&quot;righr&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>lindex list index</code></td><td align="center">è·å–æŒ‡å®šindexçš„å…ƒç´ </td></tr><tr><td align="center"><code>llen list</code></td><td align="center">è¿”å›åˆ—è¡¨çš„é•¿åº¦</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lindex list 1 <span class="comment"># é€šè¿‡ä¸‹æ ‡è·å¾— list ä¸­çš„æŸä¸€ä¸ªå€¼ï¼</span></span><br><span class="line"><span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lindex list 0</span><br><span class="line"><span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Llen list <span class="comment"># è¿”å›åˆ—è¡¨çš„é•¿åº¦</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>lrem list numer value</code></td><td align="center">ç§»é™¤æŒ‡å®šä¸ªæ•°numberçš„valueå€¼</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span>  <span class="comment"># å­˜åœ¨é‡å¤</span></span><br><span class="line">2) <span class="string">&quot;three&quot;</span></span><br><span class="line">3) <span class="string">&quot;two&quot;</span></span><br><span class="line">4) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lrem list 1 one <span class="comment"># ç§»é™¤listé›†åˆä¸­æŒ‡å®šä¸ªæ•°çš„valueï¼Œç²¾ç¡®åŒ¹é…</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;three&quot;</span></span><br><span class="line">3) <span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lrem list 1 three</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lpush list three</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; lrem list 2 three</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>trim mylist start end </code></td><td align="center">é€šè¿‡ä¸‹æ ‡æˆªå–æŒ‡å®šçš„é•¿åº¦ï¼Œåªä¿ç•™ä¸‹æ ‡1å’Œ2çš„å…ƒç´ </td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;hello1&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;hello2&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;hello3&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; ltrim mylist 1 2 <span class="comment"># é€šè¿‡ä¸‹æ ‡æˆªå–æŒ‡å®šçš„é•¿åº¦ï¼Œè¿™ä¸ªlistå·²ç»è¢«æ”¹å˜äº†ï¼Œæˆªæ–­äº†åªå‰©ä¸‹æˆªå–çš„å…ƒç´ ï¼</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;hello1&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello2&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>rpoplpush oldlist newlist</code></td><td align="center">ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°†ä»–ç§»åŠ¨åˆ°æ–°çš„åˆ—è¡¨ä¸­ï¼</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">rpoplpush <span class="comment"># ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°†ä»–ç§»åŠ¨åˆ°æ–°çš„åˆ—è¡¨ä¸­ï¼</span></span><br><span class="line">127.0.0.1:6379&gt; rpush mylist <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; rpush mylist <span class="string">&quot;hello1&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; rpush mylist <span class="string">&quot;hello2&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; rpoplpush mylist myotherlist <span class="comment"># ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°†ä»–ç§»åŠ¨åˆ°æ–°çš„åˆ—è¡¨ä¸­ï¼</span></span><br><span class="line"><span class="string">&quot;hello2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lrange mylist 0 -1 <span class="comment"># æŸ¥çœ‹åŸæ¥çš„åˆ—è¡¨</span></span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lrange myotherlist 0 -1 <span class="comment"># æŸ¥çœ‹ç›®æ ‡åˆ—è¡¨ä¸­ï¼Œç¡®å®å­˜åœ¨æ”¹å€¼ï¼</span></span><br><span class="line">1) <span class="string">&quot;hello2&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>lset list index newstr</code></td><td align="center">å°†åˆ—è¡¨ä¸­æŒ‡å®šä¸‹æ ‡çš„å€¼æ›¿æ¢ä¸ºå¦å¤–ä¸€ä¸ªå€¼ï¼Œæ›´æ–°æ“ä½œ</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; EXISTS list <span class="comment"># åˆ¤æ–­è¿™ä¸ªåˆ—è¡¨æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; lset list 0 item <span class="comment"># å¦‚æœä¸å­˜åœ¨åˆ—è¡¨æˆ‘ä»¬å»æ›´æ–°å°±ä¼šæŠ¥é”™</span></span><br><span class="line">(error) ERR no such key</span><br><span class="line">127.0.0.1:6379&gt; lpush list value1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 0</span><br><span class="line">1) <span class="string">&quot;value1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lset list 0 item <span class="comment"># å¦‚æœå­˜åœ¨ï¼Œæ›´æ–°å½“å‰ä¸‹æ ‡çš„å€¼</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 0</span><br><span class="line">1) <span class="string">&quot;item&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lset list 1 other <span class="comment"># å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŠ¥é”™ï¼</span></span><br><span class="line">(error) ERR index out of range</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>linsert list before|after value</code></td><td align="center">å°†æŸä¸ªå…·ä½“çš„valueæ’å…¥åˆ°åˆ—æŠŠä½ ä¸­æŸä¸ªå…ƒç´ çš„å‰é¢æˆ–è€…åé¢ï¼</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; Rpush mylist <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; LINSERT mylist before <span class="string">&quot;world&quot;</span> <span class="string">&quot;other&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;other&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LINSERT mylist after world new</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;other&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br><span class="line">4) <span class="string">&quot;new&quot;</span></span><br></pre></td></tr></table></figure><h2 id="seté›†åˆ"><a href="#seté›†åˆ" class="headerlink" title="seté›†åˆ"></a>seté›†åˆ</h2><ul><li>seté›†åˆä¸­çš„å€¼æ— åºä¸”ä¸èƒ½é‡å¤ï¼Œå‘½ä»¤ä»¥<code>s</code>å¼€å¤´</li><li>stringå’Œlistçš„å…ƒç´ éƒ½æ˜¯valueï¼Œsetä¸­æ˜¯<code>member</code></li></ul><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>sadd myset value</code></td><td align="center">seté›†åˆmysetä¸­æ·»åŠ å…ƒç´ </td></tr><tr><td align="center"><code>smembers set</code></td><td align="center">æŸ¥çœ‹é›†åˆæ‰€æœ‰å€¼</td></tr><tr><td align="center"><code>sismember set value</code></td><td align="center">åˆ¤æ–­æŸä¸€ä¸ªå€¼æ˜¯ä¸æ˜¯åœ¨é›†åˆä¸­</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp17eop7f43w7293w2pcZ bin]<span class="comment"># redis-server config/redis.conf</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ bin]<span class="comment"># redis-cli -p 6379</span></span><br><span class="line">127.0.0.1:6379&gt; sadd myset <span class="string">&quot;hello&quot;</span> <span class="comment"># seté›†åˆä¸­æ·»åŠ å…ƒç´ </span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; smembers myset  <span class="comment"># æŸ¥çœ‹é›†åˆæ‰€æœ‰å€¼</span></span><br><span class="line">1) <span class="string">&quot;world&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; sismember myset hello <span class="comment"># åˆ¤æ–­æŸä¸€ä¸ªå€¼æ˜¯ä¸æ˜¯åœ¨é›†åˆä¸­</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sismember myset hello1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>scard myset</code></td><td align="center">å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°</td></tr><tr><td align="center"><code>srem myset value</code></td><td align="center">ç§»é™¤é›†åˆä¸­çš„å…ƒç´ </td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers myset  <span class="comment"># æŸ¥çœ‹é›†åˆæ‰€æœ‰å€¼</span></span><br><span class="line">1) <span class="string">&quot;world&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; scard myset <span class="comment"># è·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; scard myset</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; srem myset <span class="string">&quot;hello&quot;</span> <span class="comment"># ç§»é™¤é›†åˆä¸­çš„å…ƒç´ </span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; smembers myset</span><br><span class="line">1) <span class="string">&quot;world&quot;</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>è¾“å…¥å‘½ä»¤å‰å‡ ä½æŒ‰<kbd>Tab</kbd>ä¼šè‡ªåŠ¨è¡¥é½</p></div><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>srandmember myset</code></td><td align="center">ä»é›†åˆä¸­éšæœºæŠ½å–å…ƒç´ </td></tr><tr><td align="center"><code>srandmember myset number</code></td><td align="center">æŒ‡å®šéšæœºæŠ½å–å…ƒç´ çš„ä¸ªæ•°</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setæ— åºä¸é‡å¤é›†åˆï¼Œåˆ©ç”¨APIå®ç°éšæœºæŠ½å–å…ƒç´ çš„åŠŸèƒ½</span></span><br><span class="line">127.0.0.1:6379&gt; smembers myset <span class="comment"># æŸ¥çœ‹é›†åˆæ‰€æœ‰å…ƒç´ </span></span><br><span class="line">1) <span class="string">&quot;v2&quot;</span></span><br><span class="line">2) <span class="string">&quot;v1&quot;</span></span><br><span class="line">3) <span class="string">&quot;v5&quot;</span></span><br><span class="line">4) <span class="string">&quot;world&quot;</span></span><br><span class="line">5) <span class="string">&quot;v3&quot;</span></span><br><span class="line">6) <span class="string">&quot;v4&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset <span class="comment"># ä»é›†åˆä¸­éšæœºæŠ½å–å…ƒç´  srandmember</span></span><br><span class="line"><span class="string">&quot;v2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset</span><br><span class="line"><span class="string">&quot;v4&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset</span><br><span class="line"><span class="string">&quot;v1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset</span><br><span class="line"><span class="string">&quot;v1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset 2 <span class="comment"># éšæœºæŠ½å–æŒ‡å®šå…ƒç´ </span></span><br><span class="line">1) <span class="string">&quot;world&quot;</span></span><br><span class="line">2) <span class="string">&quot;v2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SRANDMEMBER myset 3</span><br><span class="line">1) <span class="string">&quot;v3&quot;</span></span><br><span class="line">2) <span class="string">&quot;world&quot;</span></span><br><span class="line">3) <span class="string">&quot;v4&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>spop myset</code></td><td align="center">éšæœºç§»é™¤é›†åˆä¸­çš„å…ƒç´ </td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line">1) <span class="string">&quot;v5&quot;</span></span><br><span class="line">2) <span class="string">&quot;world&quot;</span></span><br><span class="line">3) <span class="string">&quot;v3&quot;</span></span><br><span class="line">4) <span class="string">&quot;v4&quot;</span></span><br><span class="line">5) <span class="string">&quot;v2&quot;</span></span><br><span class="line">6) <span class="string">&quot;v1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; spop myset <span class="comment"># éšæœºç§»é™¤é›†åˆä¸­çš„å…ƒç´ </span></span><br><span class="line"><span class="string">&quot;v1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; spop myset</span><br><span class="line"><span class="string">&quot;world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS myset</span><br><span class="line">1) <span class="string">&quot;v5&quot;</span></span><br><span class="line">2) <span class="string">&quot;v3&quot;</span></span><br><span class="line">3) <span class="string">&quot;v4&quot;</span></span><br><span class="line">4) <span class="string">&quot;v2&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>smove myset1 myset2 value</code></td><td align="center">å°†myset1ä¸­çš„valueç§»åˆ°åˆ°myset2ä¸­</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªseté›†åˆ</span></span><br><span class="line">128.127.0.0.1:6379&gt; sadd myset1 <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset1 <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset2 <span class="string">&quot;set2&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; smove myset1 myset2 <span class="string">&quot;world&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; smembers myset1</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; smembers myset2</span><br><span class="line">1) <span class="string">&quot;world&quot;</span></span><br><span class="line">2) <span class="string">&quot;set2&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>sdiff key1 key2</code></td><td align="center">å·®é›†</td></tr><tr><td align="center"><code>sinter key1 key2</code></td><td align="center">äº¤é›†</td></tr><tr><td align="center"><code>sunion key1 key2</code></td><td align="center">å¹¶é›†</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¾®åšå…±åŒå…³æ³¨(å¹¶é›†)</span></span><br><span class="line"><span class="comment"># æ•°å­—é›†åˆç±»:</span></span><br><span class="line"><span class="comment">#   - å·®é›†</span></span><br><span class="line"><span class="comment">#   - äº¤é›†</span></span><br><span class="line"><span class="comment">#   - å¹¶é›†</span></span><br><span class="line">127.0.0.1:6379&gt; sadd key1 a</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key1 b</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key1 c</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key2 c</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd key2 d</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sdiff key1 key2 <span class="comment"># å·®é›†</span></span><br><span class="line">1) <span class="string">&quot;b&quot;</span></span><br><span class="line">2) <span class="string">&quot;a&quot;</span> </span><br><span class="line">127.0.0.1:6379&gt; sinter key1 key2 <span class="comment"># äº¤é›†</span></span><br><span class="line">1) <span class="string">&quot;c&quot;</span> </span><br><span class="line">127.0.0.1:6379&gt; sunion key1 key2 <span class="comment"># å¹¶é›†</span></span><br><span class="line">1) <span class="string">&quot;c&quot;</span></span><br><span class="line">2) <span class="string">&quot;a&quot;</span></span><br><span class="line">3) <span class="string">&quot;b&quot;</span></span><br><span class="line">4) <span class="string">&quot;d&quot;</span></span><br></pre></td></tr></table></figure><h2 id="Hashå“ˆå¸Œ"><a href="#Hashå“ˆå¸Œ" class="headerlink" title="Hashå“ˆå¸Œ"></a>Hashå“ˆå¸Œ</h2><ul><li>Redis hash æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œå…¶å‘½ä»¤ä»¥<code>h</code>å¼€å¤´</li><li>Redis hashæ˜¯ä¸€ä¸ª<code>string</code>ç±»å‹çš„<code>field</code>å’Œ<code>value</code>çš„æ˜ å°„è¡¨ï¼Œhashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡</li></ul><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>hset myhash field value</code></td><td align="center">setä¸€ä¸ªkey-value</td></tr><tr><td align="center"><code>hget myhash field</code></td><td align="center">è·å–æŒ‡å®šfieldçš„å€¼</td></tr><tr><td align="center"><code>hmset myhash field1 value1 field2 value2</code></td><td align="center">setå¤šä¸ªkey-value</td></tr><tr><td align="center"><code>hmget myhash field1 field2</code></td><td align="center">è·å–å¤šä¸ªå€¼</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; flushdb</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; clear</span><br><span class="line">127.0.0.1:6379&gt; hset myhash field1 <span class="string">&quot;xiaoliblog&quot;</span> <span class="comment"># setä¸€ä¸ªå…·ä½“çš„key-value</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hget myhash field1  <span class="comment"># è·å–ä¸€ä¸ªå­—æ®µå€¼</span></span><br><span class="line"><span class="string">&quot;xiaoliblog&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; hmset myhash field1 <span class="string">&quot;hello&quot;</span> field2 <span class="string">&quot;world&quot;</span> <span class="comment"># setå¤šä¸ªå…·ä½“çš„key-value</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; hmget myhash field1 field2 <span class="comment"># è·å–å¤šä¸ªå€¼</span></span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; hgetall myhash <span class="comment"># è·å–æ‰€æœ‰çš„key-value</span></span><br><span class="line">1) <span class="string">&quot;field1&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br><span class="line">3) <span class="string">&quot;field2&quot;</span></span><br><span class="line">4) <span class="string">&quot;world&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>hdel myhash field1</code></td><td align="center">åˆ é™¤æŒ‡å®šçš„å­—æ®µfiled1ï¼Œå…¶å¯¹åº”çš„value1ä¹Ÿåˆ æ‰äº†</td></tr><tr><td align="center"><code>hlen myhash</code></td><td align="center">æŸ¥è¯¢hashçš„å­—æ®µæ•°é‡</td></tr><tr><td align="center"><code>hexists myhash field1</code></td><td align="center">åˆ¤æ–­æŒ‡å®šå­—æ®µæ˜¯å¦å­˜åœ¨</td></tr><tr><td align="center"><code>hkeys myhash</code></td><td align="center">åªè·å–æ‰€æœ‰çš„field</td></tr><tr><td align="center"><code>hvals myhash</code></td><td align="center">åªè·å–æ‰€æœ‰value</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hdel myhash field1 <span class="comment"># åˆ é™¤æŒ‡å®šçš„å­—æ®µfiled1ï¼Œå…¶å¯¹åº”çš„value1ä¹Ÿåˆ æ‰äº†</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hgetall myhash</span><br><span class="line">1) <span class="string">&quot;field2&quot;</span></span><br><span class="line">2) <span class="string">&quot;world&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; hlen myhash <span class="comment"># è·å–hashå­—æ®µæ•°é‡</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hexists myhash field1 <span class="comment"># åˆ¤æ–­æŒ‡å®šå­—æ®µæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hexists myhash field3</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; hkeys myhash  <span class="comment"># åªè·å–æ‰€æœ‰çš„field</span></span><br><span class="line">1) <span class="string">&quot;field2&quot;</span></span><br><span class="line">2) <span class="string">&quot;field1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; hvals myhash <span class="comment"># åªè·å–æ‰€æœ‰value</span></span><br><span class="line">1) <span class="string">&quot;world&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>hincrby myhash field 3</code></td><td align="center">æŒ‡å®šå¯¹æ•°å€¼ç±»å‹çš„å¢é‡</td></tr><tr><td align="center"><code>hsetnx myhash field value</code></td><td align="center">å¦‚æœä¸å­˜åœ¨åˆ™å¯ä»¥è®¾ç½®ï¼Œå­˜åœ¨åˆ™ä¸èƒ½è®¾ç½®</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset myhash field3 5  <span class="comment"># æŒ‡å®šå¢é‡</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hincrby myhash field 3</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; hincrby myhash field3 1</span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">127.0.0.1:6379&gt; hincrby myhash field3 -1</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6379&gt; hsetnx myhash field 4</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; hsetnx myhash field4 hello <span class="comment"># å¦‚æœä¸å­˜åœ¨åˆ™å¯ä»¥è®¾ç½®</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hsetnx myhash field4 world <span class="comment"># å­˜åœ¨åˆ™ä¸èƒ½è®¾ç½®</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure><h2 id="Zsetæœ‰åºé›†åˆ"><a href="#Zsetæœ‰åºé›†åˆ" class="headerlink" title="Zsetæœ‰åºé›†åˆ"></a>Zsetæœ‰åºé›†åˆ</h2><ul><li>Redis zset å’Œ set ä¸€æ ·ä¹Ÿæ˜¯<code>string</code>ç±»å‹å…ƒç´ çš„é›†åˆï¼Œä¸”ä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚å‘½ä»¤ä»¥<code>z</code>å¼€å¤´</li><li>ä¸åŒçš„æ˜¯æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ª<code>double</code>ç±»å‹çš„åˆ†æ•°ã€‚redisæ­£æ˜¯é€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜è¿›è¡Œä»å°åˆ°å¤§çš„æ’åºã€‚<code>zset k1 score v1</code></li><li>zsetçš„æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†åˆ†æ•°<code>score</code>å´å¯ä»¥é‡å¤</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd myset 1 one <span class="comment"># å¢åŠ ä¸€ä¸ªå€¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd myset 2 two 3 three <span class="comment"># å¢åŠ å¤šä¸ªå€¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; zrange myset 0 -1</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;three&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>zrangebyscore salary min max</code></td><td align="center">æŒ‡å®šæ’åºè®¿é—®main~max</td></tr><tr><td align="center"><code>zrangebyscore salary -inf +inf</code></td><td align="center">æ’åºä»è´Ÿæ— ç©·å¤§åˆ°æ­£æ— ç©·å¤§</td></tr><tr><td align="center"><code>zrangebyscore salary -inf +inf withscores</code></td><td align="center">æ’åºä»è´Ÿæ— ç©·å¤§åˆ°æ­£æ— ç©·å¤§å¹¶å¸¦ä¸Šscoreså€¼</td></tr><tr><td align="center"><code>ZREVRANGE salary 0 -1</code></td><td align="center">æ”¹å˜é¡ºåºï¼Œåè½¬</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd salary 2500 xiaoli</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 5000 zhangsan</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd salary 500 lisi</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zrangebyscore salary -inf +inf <span class="comment"># æ’åºä»è´Ÿæ— ç©·å¤§åˆ°æ­£æ— ç©·å¤§</span></span><br><span class="line">1) <span class="string">&quot;lisi&quot;</span></span><br><span class="line">2) <span class="string">&quot;xiaoli&quot;</span></span><br><span class="line">3) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zrangebyscore salary -inf +inf withscores <span class="comment"># æ’åºä»è´Ÿæ— ç©·å¤§åˆ°æ­£æ— ç©·å¤§å¹¶å¸¦ä¸Šscoreså€¼</span></span><br><span class="line">1) <span class="string">&quot;lisi&quot;</span></span><br><span class="line">2) <span class="string">&quot;500&quot;</span></span><br><span class="line">3) <span class="string">&quot;xiaoli&quot;</span></span><br><span class="line">4) <span class="string">&quot;2500&quot;</span></span><br><span class="line">5) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">6) <span class="string">&quot;5000&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zrangebyscore salary -inf 2500 withscores <span class="comment"># æ’åºä»è´Ÿæ— ç©·~2500ï¼Œå‡åºæ’åˆ—</span></span><br><span class="line">1) <span class="string">&quot;lisi&quot;</span></span><br><span class="line">2) <span class="string">&quot;500&quot;</span></span><br><span class="line">3) <span class="string">&quot;xiaoli&quot;</span></span><br><span class="line">4) <span class="string">&quot;2500&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; ZREVRANGE salary 0 -1  <span class="comment"># åè½¬ï¼Œé™åº</span></span><br><span class="line">1) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">2) <span class="string">&quot;xiaoli&quot;</span></span><br><span class="line">3) <span class="string">&quot;lisi&quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>zrem myset value</code></td><td align="center">ç§»é™¤æŒ‡å®šé›†åˆçš„å…ƒç´ </td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange salary 0 -1</span><br><span class="line">1) <span class="string">&quot;lisi&quot;</span></span><br><span class="line">2) <span class="string">&quot;xiaoli&quot;</span></span><br><span class="line">3) <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; zrem salary xiaoli <span class="comment"># ç§»é™¤æŒ‡å®šå…ƒç´ </span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange salary 0 -1</span><br><span class="line">1) <span class="string">&quot;lisi&quot;</span></span><br><span class="line">2) <span class="string">&quot;zhangsan&quot;</span> </span><br><span class="line">127.0.0.1:6379&gt; zcard salary <span class="comment"># è·å–æœ‰åºé›†åˆä¸­çš„ä¸ªæ•°</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">å‘½ä»¤</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>zcount myset 1 3</code></td><td align="center">è·å–æŒ‡å®šåŒºé—´çš„æˆå‘˜æ•°é‡</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd myset 1 <span class="string">&quot;hello&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd myset 2 world 3 reids</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; zcount myset 1 3 <span class="comment"># è·å–æŒ‡å®šåŒºé—´çš„æˆå‘˜æ•°é‡</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; zcount myset 1 2</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Redis-key&quot;&gt;&lt;a href=&quot;#Redis-key&quot; class=&quot;headerlink&quot; title=&quot;Redis-key&quot;&gt;&lt;/a&gt;Redis-key&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;åœ¨Redisä¸­æ— è®ºä»€ä¹ˆæ•°æ®ç±»å‹ï¼Œåœ¨æ•°æ®åº“ä¸­éƒ½æ˜¯ä»¥&lt;code&gt;key-va</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>RedisğŸ¯NoSQLåŠRedisæ¦‚è¿°å’Œå®‰è£…</title>
    <link href="http://xiaoliblog.cn/page/Redis01.html"/>
    <id>http://xiaoliblog.cn/page/Redis01.html</id>
    <published>2021-06-28T06:55:38.832Z</published>
    <updated>2021-07-01T08:47:36.799Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h1><h2 id="å•ä»·MySQLæ—¶ä»£"><a href="#å•ä»·MySQLæ—¶ä»£" class="headerlink" title="å•ä»·MySQLæ—¶ä»£"></a>å•ä»·MySQLæ—¶ä»£</h2><ul><li>åœ¨90å¹´ä»£ï¼Œä¸€ä¸ªç½‘ç«™çš„è®¿é—®é‡ä¸€èˆ¬éƒ½ä¸å¤§ï¼Œç”¨å•ä¸ªæ•°æ®åº“å®Œå…¨å¯ä»¥è½»æ¾åº”ä»˜ã€‚ åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæ›´å¤šçš„éƒ½æ˜¯é™æ€ç½‘é¡µï¼ŒåŠ¨æ€äº¤äº’ç±»å‹çš„ç½‘ç«™ä¸å¤š</li><li>ç½‘ç«™åº”ç”¨å¹¶ä¸æ˜¯ç›´æ¥è®¿é—®æ•°æ®åº“çš„ï¼Œè€Œæ˜¯é€šè¿‡<code>DAL</code> ï¼ˆData Access Layerï¼‰æ•°æ®è®¿é—®å±‚è¿›å…¥MySQLå®ä¾‹ã€‚ä½†æ˜¯æ•°æ®é‡çš„æ€»å¤§å°ä¸€ä¸ªæœºå™¨æ”¾ä¸ä¸‹æ—¶ï¼Œæ•°æ®çš„ç´¢å¼•ï¼ˆB+ Treeï¼‰ä¸€ä¸ªæœºå™¨çš„å†…å­˜æ”¾ä¸ä¸‹æ—¶ã€‚è®¿é—®é‡ï¼ˆè¯»å†™æ··åˆï¼‰ä¸€ä¸ªå®ä¾‹ä¸èƒ½æ‰¿å—æ—¶ã€‚å¦‚æœæ»¡è¶³äº†ä¸Šè¿°1 or 3ä¸ªæ—¶ï¼Œåªèƒ½å¯¹æ•°æ®åº“çš„æ•´ä½“æ¶æ„è¿›è¡Œé‡æ„</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@a92e5c2eb8daea7d752cbf03e177e244c4503d77/2021/06/28/c12a8dad4f2c72e9d5dfc5c6d648e82f.png"></p><ul><li>åæ¥ï¼Œéšç€è®¿é—®é‡çš„ä¸Šå‡ï¼Œå‡ ä¹å¤§éƒ¨åˆ†ä½¿ç”¨MySQLæ¶æ„çš„ç½‘ç«™åœ¨æ•°æ®åº“ä¸Šéƒ½å¼€å§‹å‡ºç°äº†æ€§èƒ½é—®é¢˜ã€‚ç¨‹åºå‘˜ä»¬å¼€å§‹å¤§é‡çš„ä½¿ç”¨ç¼“å­˜æŠ€æœ¯æ¥ç¼“è§£æ•°æ®åº“çš„å‹åŠ›ï¼Œä¼˜åŒ–æ•°æ®åº“çš„ç»“æ„å’Œç´¢å¼•ã€‚å¼€å§‹æ¯”è¾ƒæµè¡Œçš„æ˜¯é€šè¿‡æ–‡ä»¶ç¼“å­˜æ¥ç¼“è§£æ•°æ®åº“å‹åŠ›ï¼Œä½†æ˜¯å½“è®¿é—®é‡ç»§ç»­å¢å¤§çš„æ—¶å€™ï¼Œå¤šå°webæœºå™¨é€šè¿‡æ–‡ä»¶ç¼“å­˜ä¸èƒ½å…±äº«ï¼Œå¤§é‡çš„å°æ–‡ä»¶ç¼“å­˜ä¹Ÿå¸¦äº†äº†æ¯”è¾ƒé«˜çš„IOå‹åŠ›ã€‚åœ¨è¿™ä¸ªæ—¶å€™ï¼Œ<code>Memcached</code>å°±è‡ªç„¶çš„æˆä¸ºä¸€ä¸ªéå¸¸æ—¶å°šçš„æŠ€æœ¯äº§å“ã€‚</li><li>Memcachedä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„åˆ†å¸ƒå¼çš„ç¼“å­˜æœåŠ¡å™¨ï¼Œä¸ºå¤šä¸ªwebæœåŠ¡å™¨æä¾›äº†ä¸€ä¸ªå…±äº«çš„é«˜æ€§èƒ½ç¼“å­˜æœåŠ¡ï¼Œåœ¨MemcachedæœåŠ¡å™¨ä¸Šï¼Œåˆå‘å±•äº†æ ¹æ®hashç®—æ³•æ¥è¿›è¡Œå¤šå°Memcachedç¼“å­˜æœåŠ¡çš„æ‰©å±•ï¼Œç„¶ååˆå‡ºç°äº†ä¸€è‡´æ€§hashæ¥è§£å†³å¢åŠ æˆ–å‡å°‘ç¼“å­˜æœåŠ¡å™¨å¯¼è‡´é‡æ–°hashå¸¦æ¥çš„å¤§é‡ç¼“å­˜å¤±æ•ˆçš„å¼Šç«¯</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@deeac35f865d96460f08608b1744328e39cbb7d4/2021/06/28/7eb34b89f180c82ed3ad826125c8ceb4.png"></p><ul><li>ç”±äºæ•°æ®åº“çš„å†™å…¥å‹åŠ›å¢åŠ ï¼ŒMemcachedåªèƒ½ç¼“è§£æ•°æ®åº“çš„è¯»å–å‹åŠ›ã€‚è¯»å†™é›†ä¸­åœ¨ä¸€ä¸ªæ•°æ®åº“ä¸Šè®©æ•°æ®åº“ä¸å ªé‡è´Ÿï¼Œå¤§éƒ¨åˆ†ç½‘ç«™å¼€å§‹ä½¿ç”¨ä¸»ä»å¤åˆ¶æŠ€æœ¯æ¥è¾¾åˆ°è¯»å†™åˆ†ç¦»ï¼Œä»¥æé«˜è¯»å†™æ€§èƒ½å’Œè¯»åº“çš„å¯æ‰©å±•æ€§ã€‚Mysqlçš„master-slaveæ¨¡å¼æˆä¸ºè¿™ä¸ªæ—¶å€™çš„ç½‘ç«™æ ‡é…äº†</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@7b03ff956d5f81b8479ab7b1b6d9c84637cf779c/2021/06/28/ddcd9b49e1efd71d8ba61e3a0690e74b.png"></p><ul><li>åœ¨Memcachedçš„é«˜é€Ÿç¼“å­˜ï¼ŒMySQLçš„ä¸»ä»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»çš„åŸºç¡€ä¹‹ä¸Šï¼Œè¿™æ—¶MySQLä¸»åº“çš„å†™å‹åŠ›å¼€å§‹å‡ºç°ç“¶é¢ˆï¼Œè€Œæ•°æ®é‡çš„æŒç»­çŒ›å¢ï¼Œç”±äºMyISAMåœ¨å†™æ•°æ®çš„æ—¶å€™ä¼šä½¿ç”¨è¡¨é”ï¼Œåœ¨é«˜å¹¶å‘å†™æ•°æ®çš„æƒ…å†µä¸‹ä¼šå‡ºç°ä¸¥é‡çš„é”é—®é¢˜ï¼Œå¤§é‡çš„é«˜å¹¶å‘MySQLåº”ç”¨å¼€å§‹ä½¿ç”¨InnoDBå¼•æ“ï¼ˆè¡Œé”ï¼‰ä»£æ›¿MyISAM</li><li>åŒæ—¶ï¼Œå¼€å§‹æµè¡Œä½¿ç”¨åˆ†è¡¨åˆ†åº“æ¥ç¼“è§£å†™å‹åŠ›å’Œæ•°æ®å¢é•¿çš„æ‰©å±•é—®é¢˜ã€‚è¿™ä¸ªæ—¶å€™ï¼Œåˆ†è¡¨åˆ†åº“æˆäº†ä¸€ä¸ªçƒ­é—¨æŠ€æœ¯ï¼Œæ˜¯é¢è¯•çš„çƒ­é—¨é—®é¢˜ä¹Ÿæ˜¯ä¸šç•Œè®¨è®ºçš„çƒ­é—¨æŠ€æœ¯é—®é¢˜ã€‚ä¹Ÿå°±åœ¨è¿™ä¸ªæ—¶å€™ï¼ŒMySQLæ¨å‡ºäº†è¿˜ä¸å¤ªç¨³å®šçš„è¡¨åˆ†åŒºï¼Œè¿™ä¹Ÿç»™æŠ€æœ¯å®åŠ›ä¸€èˆ¬çš„å…¬å¸å¸¦æ¥äº†å¸Œæœ›ã€‚è™½ç„¶MySQLæ¨å‡ºäº†MySQL Clusteré›†ç¾¤ï¼Œä½†æ€§èƒ½ä¹Ÿä¸èƒ½å¾ˆå¥½æ»¡è¶³äº’è”ç½‘çš„è¦æ±‚ï¼Œåªæ˜¯åœ¨é«˜å¯é æ€§ä¸Šæä¾›äº†éå¸¸å¤§çš„ä¿è¯</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@b2c683833c2cb036bb7db8b8242bfed2be825b0d/2021/06/28/690e104bf6aadb9669b23cfb621e354c.png"></p><ul><li>MySQLæ•°æ®åº“ä¹Ÿç»å¸¸å­˜å‚¨ä¸€äº›å¤§æ–‡æœ¬å­—æ®µï¼Œå¯¼è‡´æ•°æ®åº“è¡¨éå¸¸çš„å¤§ï¼Œåœ¨åšæ•°æ®åº“æ¢å¤çš„æ—¶å€™å°±å¯¼è‡´éå¸¸çš„æ…¢ï¼Œä¸å®¹æ˜“å¿«é€Ÿæ¢å¤æ•°æ®åº“ã€‚æ¯”å¦‚1000ä¸‡4KBå¤§å°çš„æ–‡æœ¬å°±æ¥è¿‘40GBçš„å¤§å°ï¼Œå¦‚æœèƒ½æŠŠè¿™äº›æ•°æ®ä»MySQLçœå»ï¼ŒMySQLå°†å˜å¾—éå¸¸çš„å°ã€‚å…³ç³»æ•°æ®åº“å¾ˆå¼ºå¤§ï¼Œä½†æ˜¯å®ƒå¹¶ä¸èƒ½å¾ˆå¥½çš„åº”ä»˜æ‰€æœ‰çš„åº”ç”¨åœºæ™¯ã€‚MySQLçš„æ‰©å±•æ€§å·®ï¼ˆéœ€è¦å¤æ‚çš„æŠ€æœ¯æ¥å®ç°ï¼‰ï¼Œå¤§æ•°æ®ä¸‹IOå‹åŠ›å¤§ï¼Œè¡¨ç»“æ„æ›´æ”¹å›°éš¾ï¼Œæ­£æ˜¯å½“å‰ä½¿ç”¨MySQLçš„å¼€å‘äººå‘˜é¢ä¸´çš„é—®é¢˜</li><li>å¦‚ä»Šçš„æ¶æ„å¦‚ä¸‹æ‰€ç¤ºï¼šæœ€å‰é¢çš„æ˜¯ä¼ä¸šçº§é˜²ç«å¢™ï¼Œåé¢é€šè¿‡è´Ÿè½½å‡è¡¡ä¸»æœºï¼ˆè½¯è´Ÿè½½ï¼šNginxï¼Œç¡¬è´Ÿè½½ï¼šF5ï¼‰åœ¨ web æœåŠ¡å™¨é›†ç¾¤ä¹‹é—´è¿›è¡Œè°ƒåº¦ï¼Œå†ç”±å…·ä½“çš„ web æœåŠ¡å™¨ï¼ˆTomcatï¼‰å»è®¿é—®ç¼“å­˜ï¼Œè®¿é—®æ•°æ®åº“</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6d853782eb5a908ff24521cfee3d9e4ed53a3970/2021/06/28/cb3ded8f8ec91a25e278325c09883304.png"></p><h2 id="NoSQLç®€ä»‹"><a href="#NoSQLç®€ä»‹" class="headerlink" title="NoSQLç®€ä»‹"></a>NoSQLç®€ä»‹</h2><ul><li><code>NoSQL</code>(NoSQL = Not Only SQL )ï¼Œæ„å³ä¸ä»…ä»…æ˜¯SQLï¼Œæ³›æŒ‡<strong>éå…³ç³»å‹</strong>çš„æ•°æ®åº“</li><li>éšç€äº’è”ç½‘web2.0ç½‘ç«™çš„å…´èµ·ï¼Œä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“åœ¨åº”ä»˜web2.0ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯è¶…å¤§è§„æ¨¡å’Œé«˜å¹¶å‘çš„SNSç±»å‹çš„web2.0çº¯åŠ¨æ€ç½‘ç«™å·²ç»æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œæš´éœ²äº†å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼Œè€Œéå…³ç³»å‹çš„æ•°æ®åº“åˆ™ç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹å¾—åˆ°äº†éå¸¸è¿…é€Ÿçš„å‘å±•ã€‚NoSQLæ•°æ®åº“çš„äº§ç”Ÿå°±æ˜¯ä¸ºäº†è§£å†³å¤§è§„æ¨¡æ•°æ®é›†åˆå¤šé‡æ•°æ®ç§ç±»å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯å¤§æ•°æ®åº”ç”¨éš¾é¢˜ï¼ŒåŒ…æ‹¬è¶…å¤§è§„æ¨¡æ•°æ®çš„å­˜å‚¨</li><li>å¾ˆå¤šçš„æ•°æ®æ¯”å¦‚ç”¨æˆ·ä¸ªäººä¿¡æ¯ã€ç¤¾äº¤ç½‘ç»œã€åœ°ç†ä½ç½®ã€‚è¿™äº›æ•°æ®ç±»å‹çš„å­˜å‚¨ä¸éœ€è¦ä¸€ä¸ªå›ºå®šçš„æ ¼å¼ï¼Œä¸”ä¸éœ€è¦å¤šä½™çš„æ“ä½œå°±å¯ä»¥æ¨ªå‘æ‰©å±•ï¼åœ¨Javaä¸­ä½¿ç”¨<code>Map&lt;String,Object&gt;</code>é”®å€¼å¯¹æ¥å­˜æ”¾ä¸‡äº‹ä¸‡ç‰©</li><li>NoSQLç‰¹ç‚¹<ul><li>æ˜“æ‰©å±•ã€‚æ•°æ®ä¹‹é—´æ— å…³ç³»ï¼Œè¿™æ ·å°±éå¸¸å®¹æ˜“æ‰©å±•ã€‚</li><li>å¤§æ•°æ®é‡ï¼Œé«˜æ€§èƒ½ã€‚Redisä¸€ç§’å†™8ä¸‡æ¬¡ï¼Œè¯»å–11ä¸‡ï¼ŒNoSQLçš„ç¼“å­˜è®°å½•çº§ï¼Œæ˜¯ä¸€ç§ç»†ç²’åº¦çš„ç¼“å­˜ï¼Œæ€§èƒ½é«˜</li><li>æ•°æ®ç±»å‹å¤šæ ·ï¼Œä¸éœ€è¦äº‹å…ˆè®¾è®¡æ•°æ®åº“</li></ul></li><li>ä¼ ç»Ÿçš„ RDBMS å’Œ NoSQLçš„åŒºåˆ«</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ä¼ ç»Ÿçš„ RDBMS(å…³ç³»å‹æ•°æ®åº“)</span><br><span class="line">- ç»“æ„åŒ–ç»„ç»‡</span><br><span class="line">- SQL</span><br><span class="line">- æ•°æ®å’Œå…³ç³»éƒ½å­˜åœ¨å•ç‹¬çš„è¡¨ä¸­ row col</span><br><span class="line">- æ“ä½œï¼Œæ•°æ®å®šä¹‰è¯­è¨€</span><br><span class="line">- ä¸¥æ ¼çš„ä¸€è‡´æ€§</span><br><span class="line">- åŸºç¡€çš„äº‹åŠ¡</span><br><span class="line">- ...</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Nosql</span><br><span class="line">- ä¸ä»…ä»…æ˜¯æ•°æ®</span><br><span class="line">- æ²¡æœ‰å›ºå®šçš„æŸ¥è¯¢è¯­è¨€</span><br><span class="line">- é”®å€¼å¯¹å­˜å‚¨ï¼Œåˆ—å­˜å‚¨ï¼Œæ–‡æ¡£å­˜å‚¨ï¼Œå›¾å½¢æ•°æ®åº“ï¼ˆç¤¾äº¤å…³ç³»ï¼‰</span><br><span class="line">- æœ€ç»ˆä¸€è‡´æ€§</span><br><span class="line">- CAPå®šç†å’ŒBASE</span><br><span class="line">- é«˜æ€§èƒ½ï¼Œé«˜å¯ç”¨ï¼Œé«˜æ‰©å±•</span><br><span class="line">- ...</span><br></pre></td></tr></table></figure><div class="note success simple"><p>å¤§æ•°æ®æ—¶ä»£3V+3é«˜</p></div><ul><li>å¤§æ•°æ®æ—¶ä»£çš„3V ï¼šä¸»è¦æ˜¯æè¿°é—®é¢˜çš„<ul><li>æµ·é‡Velume</li><li>å¤šæ ·Variety</li><li>å®æ—¶Velocity</li></ul></li><li>å¤§æ•°æ®æ—¶ä»£çš„3é«˜ ï¼š ä¸»è¦æ˜¯å¯¹ç¨‹åºçš„è¦æ±‚<ul><li>é«˜å¹¶å‘</li><li>é«˜å¯æ‰©</li><li>é«˜æ€§èƒ½</li></ul></li></ul><h2 id="é˜¿é‡Œå·´å·´æ¼”è¿›åˆ†æ"><a href="#é˜¿é‡Œå·´å·´æ¼”è¿›åˆ†æ" class="headerlink" title="é˜¿é‡Œå·´å·´æ¼”è¿›åˆ†æ"></a>é˜¿é‡Œå·´å·´æ¼”è¿›åˆ†æ</h2><div class="note success simple"><p>æ¨èé˜…è¯»ï¼šé˜¿é‡Œäº‘çš„è¿™ç¾¤ç–¯å­<a href="https://developer.aliyun.com/article/653511">https://developer.aliyun.com/article/653511</a></p></div><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@e325a026c2601d273f80634becae653e9e80d103/2021/06/28/9f8f0f7adb339bf3735cb02e59082611.png"><br><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@b14245e5944f1957cfd9d090d53bed58d295f681/2021/06/28/39b222aebee31166ae9ba4b034ccb69e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># å•†å“ä¿¡æ¯</span><br><span class="line">- ä¸€èˆ¬å­˜æ”¾åœ¨å…³ç³»å‹æ•°æ®åº“ï¼šMysql,é˜¿é‡Œå·´å·´ä½¿ç”¨çš„Mysqléƒ½æ˜¯ç»è¿‡å†…éƒ¨æ”¹åŠ¨çš„ã€‚</span><br><span class="line"></span><br><span class="line"># å•†å“æè¿°ã€è¯„è®º(æ–‡å­—å±…å¤š)</span><br><span class="line">- æ–‡æ¡£å‹æ•°æ®åº“ï¼šMongoDB</span><br><span class="line"></span><br><span class="line"># å›¾ç‰‡</span><br><span class="line">- åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ FastDFS</span><br><span class="line">- æ·˜å®ï¼šTFS</span><br><span class="line">- Google: GFS</span><br><span class="line">- Hadoop: HDFS</span><br><span class="line">- é˜¿é‡Œäº‘: oss</span><br><span class="line"></span><br><span class="line"># å•†å“å…³é”®å­— ç”¨äºæœç´¢</span><br><span class="line">- æœç´¢å¼•æ“ï¼šsolr,elasticsearch</span><br><span class="line">- é˜¿é‡Œï¼šIsearch å¤šéš†</span><br><span class="line"></span><br><span class="line"># å•†å“çƒ­é—¨çš„æ³¢æ®µä¿¡æ¯</span><br><span class="line">- å†…å­˜æ•°æ®åº“ï¼šRedisï¼ŒMemcache</span><br><span class="line"></span><br><span class="line"># å•†å“äº¤æ˜“ï¼Œå¤–éƒ¨æ”¯ä»˜æ¥å£</span><br><span class="line">- ç¬¬ä¸‰æ–¹åº”ç”¨</span><br></pre></td></tr></table></figure><h2 id="Nosqlå››å¤§åˆ†ç±»"><a href="#Nosqlå››å¤§åˆ†ç±»" class="headerlink" title="Nosqlå››å¤§åˆ†ç±»"></a>Nosqlå››å¤§åˆ†ç±»</h2><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@2b9d1b556006c112d61f4256fcca686596625832/2021/06/28/9c0e418f5d4eccfe37faf6271e54306e.png"></p><div class="note success simple"><p>MongoDBæ˜¯åŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚C++ç¼–å†™ï¼Œç”¨äºå¤„ç†å¤§é‡æ–‡æ¡£ã€‚ MongoDBæ˜¯RDBMSå’ŒNoSQLçš„ä¸­é—´äº§å“ã€‚MongoDBæ˜¯éå…³ç³»å‹æ•°æ®åº“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œçš„ï¼ŒNoSQLä¸­æœ€åƒå…³ç³»å‹æ•°æ®åº“çš„æ•°æ®åº“</p></div><h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><h2 id="Redisæ¦‚è¿°"><a href="#Redisæ¦‚è¿°" class="headerlink" title="Redisæ¦‚è¿°"></a>Redisæ¦‚è¿°</h2><ul><li><code>Redis</code>ï¼ˆRemote Dictionary Server )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ã€‚æ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€<code>Key-Value</code>æ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„API</li><li>ä¸memcachedä¸€æ ·ï¼Œä¸ºäº†ä¿è¯æ•ˆç‡ï¼Œ<strong>æ•°æ®éƒ½æ˜¯ç¼“å­˜åœ¨å†…å­˜ä¸­</strong>ã€‚åŒºåˆ«çš„æ˜¯redisä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº†master-slave(ä¸»ä»)åŒæ­¥ã€‚</li><li>Rediså®˜ç½‘ï¼š<a href="https://redis.io/">https://redis.io/</a></li><li>Redisä¸­æ–‡ç½‘ï¼š<a href="http://www.redis.cn/">http://www.redis.cn/</a></li><li>Redisèƒ½è¯¥å¹²ä»€ä¹ˆï¼Ÿ<ul><li>å†…å­˜å­˜å‚¨ã€æŒä¹…åŒ–ï¼Œå†…å­˜æ˜¯æ–­ç”µå³å¤±çš„ï¼Œæ‰€ä»¥éœ€è¦æŒä¹…åŒ–ï¼ˆRDBã€AOFï¼‰</li><li>é«˜æ•ˆç‡ã€ç”¨äºé«˜é€Ÿç¼“å†²</li><li>å‘å¸ƒè®¢é˜…ç³»ç»Ÿ</li><li>åœ°å›¾ä¿¡æ¯åˆ†æ</li><li>è®¡æ—¶å™¨ã€è®¡æ•°å™¨(egï¼šæµè§ˆé‡)</li></ul></li><li>Redisç‰¹æ€§<ul><li>å¤šæ ·çš„æ•°æ®ç±»å‹</li><li>æŒä¹…åŒ–</li><li>é›†ç¾¤</li><li>äº‹åŠ¡</li></ul></li></ul><h2 id="Widowså®‰è£…"><a href="#Widowså®‰è£…" class="headerlink" title="Widowså®‰è£…"></a>Widowså®‰è£…</h2><div class="btns rounded center grid5">            <a href="https://pan.baidu.com/s/1I1sXTR4xvMILWALcND2WQQ" title="æå–ç fumb"><i class="fas fa-download"></i>æå–ç fumb</a>          </div><ul><li>æ¨èä½¿ç”¨LinuxæœåŠ¡å™¨å­¦ä¹ ã€‚Windowsç‰ˆæœ¬çš„Rediså·²ç»åœæ›´å¾ˆä¹…äº†</li><li>Rediså®˜ç½‘æ²¡æœ‰å®‰è£…åŒ…éœ€è¦å»Githubä¸Šå®‰è£…ï¼š<a href="https://github.com/MicrosoftArchive/redis/releases">https://github.com/MicrosoftArchive/redis/releases</a></li><li>ä¸‹è½½åè§£å‹å®‰è£…åŒ… </li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@b9542fb1adfeb8edf6270fdad3faca59c280f90c/2021/06/28/6f266421d1308c0144ed507280f1c193.png" width="70%"><ul><li>å¼€å¯<code>redis-server.exe</code></li><li>å¯åŠ¨<code>redis-cli.exe</code>æµ‹è¯•</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@13ad33d3b3a0fe830a00e0fbca1cf57c7662666a/2021/06/28/c73f189c763f2bf7315205c0629eed2c.png"></p><h2 id="Linuxå®‰è£…"><a href="#Linuxå®‰è£…" class="headerlink" title="Linuxå®‰è£…"></a>Linuxå®‰è£…</h2><ul><li>è¿›å…¥å®˜æ–¹ç½‘ç«™<a href="https://redis.io/">https://redis.io/</a>ä¸‹è½½å®‰è£…åŒ…ï¼<code>redis-6.2.4.tar.gz</code></li><li>å‹ç¼©åŒ…ä¸Šä¼ åˆ°è¿œç¨‹æœåŠ¡å™¨å¹¶è§£å‹ã€‚ç¨‹åºä¸€èˆ¬æ”¾åœ¨ <code>/opt</code> ç›®å½•ä¸‹ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@657924257ca31e9b387cb724ea7c1fb4c9c9ab40/2021/06/28/8500abdb348e590d3311b41355ec6e44.png"></p><ul><li>è¿›å…¥è§£å‹åçš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬Redisçš„é…ç½®æ–‡ä»¶</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@dda39495a28ba2a5937cadcaa31e4030bd786c7d/2021/06/28/5cae8f0fda94526c2c229c4c39545f87.png"></p><ul><li>åŸºæœ¬ç¯å¢ƒå®‰è£…</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…6.0ä»¥ä¸Šç‰ˆæœ¬éœ€è¦å‡çº§gccåˆ°5.3åŠä»¥ä¸Š</span></span><br><span class="line">yum -y install centos-release-scl</span><br><span class="line">yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span><br><span class="line"><span class="comment"># sclå‘½ä»¤å¯ç”¨åªæ˜¯ä¸´æ—¶çš„ï¼Œé€€å‡ºshellæˆ–é‡å¯å°±ä¼šæ¢å¤åŸç³»ç»Ÿgccç‰ˆæœ¬ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœè¦é•¿æœŸä½¿ç”¨gcc 9.3çš„è¯,æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;source /opt/rh/devtoolset-9/enable&quot;</span> &gt;&gt;/etc/profile</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç‰ˆæœ¬</span></span><br><span class="line">gcc -v</span><br><span class="line"><span class="comment"># é…ç½®ç¼–è¯‘</span></span><br><span class="line">make</span><br><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@a361924b7ac7c2b7b7bd70190269691cc5e7216f/2021/06/28/725f0546ae97f1dec59836b2c30dcbfb.png"></p><ul><li>Redisé»˜è®¤å®‰è£…è·¯å¾„ <code>/usr/local/bin</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@7fb61aa38d5f9103fde91e1770c2d12984a0b974/2021/06/28/fe7ae29ae803f8c02cb7668e15ef17ca.png"></p><ul><li>å°†Redisçš„é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°ç¨‹åºå®‰è£…ç›®å½• <code>/usr/local/bin/config</code>ä¸‹ï¼Œæ–°å»º<code>config</code>æ–‡ä»¶å¤¹ã€‚ä¹‹åå°±ä½¿ç”¨<code>config</code>ä¸‹çš„é…ç½®æ–‡ä»¶</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6cb6061ef298d3467ca885086a2304095c367c7b/2021/06/28/1dcb2c3338be90f861812ee52e011498.png"></p><ul><li>Redisé»˜è®¤ä¸æ˜¯åå°å¯åŠ¨çš„ï¼Œéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@7f4203c331113f0079683f73db90d9811d239f7d/2021/06/28/18322e366721c3bedadb3bbd0a33b2c9.png"></p><ul><li>é€šè¿‡åˆ¶å®šçš„é…ç½®æ–‡ä»¶å¯åŠ¨RedisæœåŠ¡</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@dbb6c237ea541943acd0af40b3ebbf1dd60e78b5/2021/06/28/0905edb1e79fff611c9f2b5e0493be39.png"></p><ul><li>6.2.4ç‰ˆæœ¬å¯åŠ¨åå¹¶æ²¡æœ‰ä»»ä½•çš„è¿”å›å€¼ï¼Œåªéœ€è¦ä½¿ç”¨<code>ps -ef|grep redis</code>æŸ¥çœ‹å¯åŠ¨çš„<code>6379</code>ç«¯å£å³å¯</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@11a7628050c9bbfaddf84cfee8d9e48cc5c23a09/2021/06/28/0184d0fc97df7e88024a440f7430234f.png"></p><ul><li>ä½¿ç”¨<code>redis-cli</code>è¿æ¥æŒ‡å®šçš„ç«¯å£å·æµ‹è¯•ï¼ŒRedisçš„é»˜è®¤ç«¯å£<code>6379</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6548aa0413cb256b3a24c2d9bee2d903e1b8f4c1/2021/06/28/596e0c7f8d95b45ef56efff5c7a20c47.png"></p><ul><li>å…³é—­RedisæœåŠ¡ <code>shutdown</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@f5bbaa4e47e1e38afa2acff44cf7a8f62911ad8d/2021/06/28/1722291b91e0031045db83594b62f92f.png"></p><ul><li>å†æ¬¡æŸ¥çœ‹è¿›ç¨‹æ˜¯å¦å­˜åœ¨</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@95593a1f037faa24f8c6f610f6f46ce072b2e4ee/2021/06/28/d8c0316be401dfa2eeada3fb9f0e2a64.png"></p><h2 id="æ€§èƒ½æµ‹è¯•"><a href="#æ€§èƒ½æµ‹è¯•" class="headerlink" title="æ€§èƒ½æµ‹è¯•"></a>æ€§èƒ½æµ‹è¯•</h2><ul><li><code>redis-benchmark</code>  æ˜¯Rediså®˜æ–¹æä¾›çš„æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œå‚æ•°é€‰é¡¹å¦‚ä¸‹ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@c98c0c55c48ae8ac9ba0e55a64cca992de5e671b/2021/06/28/79928b5a3825bbf903f58f0729e0f489.png"></p><ul><li>ç®€å•æµ‹è¯•</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆè¦å¯åŠ¨æœåŠ¡</span></span><br><span class="line">redis-server config/redis.conf</span><br><span class="line"><span class="comment"># æµ‹è¯•ï¼š100ä¸ªå¹¶å‘è¿æ¥ 100000è¯·æ±‚</span></span><br><span class="line">redis-benchmark -h localhost -p 6379 -c 100 -n 100000</span><br></pre></td></tr></table></figure><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/%28S%60I_I%24M%7D%24FACZ97U%7E8%28007.png"></p><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><ul><li>Redisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“</li></ul><p><img src="https://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/PicGo_img/QQ%E5%9B%BE%E7%89%8720210628222217.png"></p><ul><li>16ä¸ªæ•°æ®åº“ä¸ºï¼šDB 0~DB 15ï¼Œ é»˜è®¤ä½¿ç”¨DB 0 ï¼Œå¯ä»¥ä½¿ç”¨<code>select n</code>åˆ‡æ¢åˆ°DB nï¼Œ<code>dbsize</code>å¯ä»¥æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„å¤§å°ï¼Œä¸keyæ•°é‡ç›¸å…³</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-server redis.conf</span></span><br><span class="line">[root@iZbp17eop7f43w7293w2pcZ config]<span class="comment"># redis-cli -p 6379</span></span><br><span class="line">127.0.0.1:6379&gt; config get databases <span class="comment"># å‘½ä»¤è¡ŒæŸ¥çœ‹æ•°æ®åº“æ•°é‡databases</span></span><br><span class="line">1) <span class="string">&quot;databases&quot;</span></span><br><span class="line">2) <span class="string">&quot;16&quot;</span></span><br><span class="line">128.127.0.0.1:6379&gt; select 3 <span class="comment"># åˆ‡æ¢æ•°æ®åº“ DB 8</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt; DBSIZE <span class="comment"># æŸ¥çœ‹æ•°æ®åº“å¤§å°</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸åŒæ•°æ®åº“ä¹‹é—´ æ•°æ®æ˜¯ä¸èƒ½äº’é€šçš„ï¼Œå¹¶ä¸”dbsize æ˜¯æ ¹æ®åº“ä¸­keyçš„ä¸ªæ•°</span></span><br><span class="line">127.0.0.1:6379[3]&gt; <span class="built_in">set</span> name xiaoliblog</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt; DBSIZE <span class="comment"># sizeå’Œkeyä¸ªæ•°ç›¸å…³</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379[3]&gt; get name <span class="comment"># è·å¾—é”®nameçš„å€¼</span></span><br><span class="line"><span class="string">&quot;xiaoliblog&quot;</span></span><br><span class="line">127.0.0.1:6379[3]&gt; keys *  <span class="comment"># æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰çš„key</span></span><br><span class="line">1) <span class="string">&quot;name&quot;</span></span><br><span class="line">127.0.0.1:6379[3]&gt; flushdb <span class="comment"># ç©ºå½“å‰æ•°æ®åº“ä¸­çš„é”®å€¼å¯¹</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt; keys *</span><br><span class="line">(empty array)</span><br><span class="line">127.0.0.1:6379[3]&gt; select 0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">&quot;mylist&quot;</span></span><br><span class="line">2) <span class="string">&quot;myhash&quot;</span></span><br><span class="line">3) <span class="string">&quot;name&quot;</span></span><br><span class="line">4) <span class="string">&quot;counter:__rand_int__&quot;</span></span><br><span class="line">5) <span class="string">&quot;key:__rand_int__&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; flushall <span class="comment"># æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“çš„é”®å€¼å¯¹</span></span><br></pre></td></tr></table></figure><ul><li><code>keys *</code> ï¼šæŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰çš„key</li><li><code>flushdb</code>ï¼šæ¸…ç©ºå½“å‰æ•°æ®åº“ä¸­çš„é”®å€¼å¯¹</li><li><code>flushall</code>ï¼šæ¸…ç©ºæ‰€æœ‰æ•°æ®åº“çš„é”®å€¼</li></ul><div class="note success simple"><p>Redisæ˜¯å•çº¿ç¨‹çš„ï¼ŒRedisæ˜¯åŸºäºå†…å­˜æ“ä½œçš„</p></div><ul><li>æ‰€ä»¥Redisçš„æ€§èƒ½ç“¶é¢ˆä¸æ˜¯CPUï¼Œè€Œæ˜¯æœºå™¨å†…å­˜å’Œç½‘ç»œå¸¦å®½ï¼Œæ—¢ç„¶å¯ä»¥ä½¿ç”¨å•çº¿ç¨‹å®ç°ï¼Œå°±ä½¿ç”¨å•çº¿ç¨‹äº†</li><li>é‚£ä¹ˆä¸ºä»€ä¹ˆRedisçš„é€Ÿåº¦å¦‚æ­¤å¿«å‘¢ï¼Œæ€§èƒ½è¿™ä¹ˆé«˜å‘¢ï¼ŸRedisæ˜¯Cè¯­è¨€å†™çš„ï¼ŒQPSæ¯ç§’æŸ¥è¯¢ç‡(Query Per Second) è¾¾åˆ°10W+</li></ul><div class="note success simple"><p>Redisä¸ºä»€ä¹ˆå•çº¿ç¨‹è¿˜è¿™ä¹ˆå¿«ï¼Ÿ</p></div><ul><li>è¯¯åŒº1ï¼šé«˜æ€§èƒ½çš„æœåŠ¡å™¨ä¸€å®šæ˜¯å¤šçº¿ç¨‹çš„ï¼Ÿ</li><li>è¯¯åŒº2ï¼šå¤šçº¿ç¨‹ï¼ˆCPUä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ï¼ï¼‰ä¸€å®šæ¯”å•çº¿ç¨‹æ•ˆç‡é«˜ï¼</li><li>æ ¸å¿ƒï¼šRedisæ˜¯å°†æ‰€æœ‰çš„æ•°æ®æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥è¯´ä½¿ç”¨å•çº¿ç¨‹å»æ“ä½œæ•ˆç‡å°±æ˜¯æœ€é«˜çš„ï¼Œå¤šçº¿ç¨‹ï¼ˆCPUä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ï¼šè€—æ—¶çš„æ“ä½œï¼ï¼‰ï¼Œ<strong>å¯¹äºå†…å­˜ç³»ç»Ÿæ¥è¯´ï¼Œå¦‚æœæ²¡æœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢æ•ˆç‡å°±æ˜¯æœ€é«˜çš„ï¼Œå¤šæ¬¡è¯»å†™éƒ½æ˜¯åœ¨ä¸€ä¸ªCPUä¸Šçš„</strong>ï¼Œåœ¨å†…å­˜å­˜å‚¨æ•°æ®æƒ…å†µä¸‹ï¼Œå•çº¿ç¨‹å°±æ˜¯æœ€ä½³çš„æ–¹æ¡ˆã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NoSQL&quot;&gt;&lt;a href=&quot;#NoSQL&quot; class=&quot;headerlink&quot; title=&quot;NoSQL&quot;&gt;&lt;/a&gt;NoSQL&lt;/h1&gt;&lt;h2 id=&quot;å•ä»·MySQLæ—¶ä»£&quot;&gt;&lt;a href=&quot;#å•ä»·MySQLæ—¶ä»£&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="Redis" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/Redis/"/>
    
    
    <category term="Redis" scheme="http://xiaoliblog.cn/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>MybatisPlusğŸ¯MyBatisPlusæ’ä»¶æ‰©å±•</title>
    <link href="http://xiaoliblog.cn/page/MybatisPlus03.html"/>
    <id>http://xiaoliblog.cn/page/MybatisPlus03.html</id>
    <published>2021-06-27T13:51:24.596Z</published>
    <updated>2021-06-27T14:42:19.253Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ€§èƒ½åˆ†ææ’ä»¶"><a href="#æ€§èƒ½åˆ†ææ’ä»¶" class="headerlink" title="æ€§èƒ½åˆ†ææ’ä»¶"></a>æ€§èƒ½åˆ†ææ’ä»¶</h1><ul><li>MyBatisPlusæä¾›äº†æ€§èƒ½åˆ†ææ’ä»¶ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±åœæ­¢è¿è¡Œ!</li><li>é¦–å…ˆè®¾ç½®å¼€å‘ç¯å¢ƒ</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®å¼€å‘ç¯å¢ƒ</span></span><br><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">dev</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">// äº‹åŠ¡ç®¡ç†</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ä»£è¡¨ä¸ºé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ€§èƒ½åˆ†ææ’ä»¶</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Profile(&#123;&quot;dev&quot;,&quot;test&quot;&#125;)</span> <span class="comment">// è®¾ç½®dev test ç¯å¢ƒå¼€å¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PerformanceInterceptor <span class="title">performanceInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PerformanceInterceptor performanceInterceptor = <span class="keyword">new</span> PerformanceInterceptor();</span><br><span class="line">        performanceInterceptor.setMaxTime(<span class="number">1</span>); <span class="comment">//è®¾ç½®sqlæ‰§è¡Œçš„æœ€å¤§æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œè¶…è¿‡åˆ™ä¸æ‰§è¡Œ</span></span><br><span class="line">        performanceInterceptor.setFormat(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> performanceInterceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="comment">// ç»§æ‰¿äº†BaseMapper,æ‰€æœ‰çš„æ–¹æ³•éƒ½æ¥è‡ªBaseMapper,ä¹Ÿå¯ä»¥æ‰©å±•æ–¹æ³•</span></span><br><span class="line">   <span class="comment">// å‚æ•°æ˜¯ä¸€ä¸ªWrapperï¼Œæ¡ä»¶æ„é€ å™¨</span></span><br><span class="line">   List&lt;User&gt; users = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">   users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸€æ¡SQLä¸å¯èƒ½åªæ‰§è¡Œ1æ¯«ç§’ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@82ef4eb518b945a3a60741c03099ec3f016c92c2/2021/06/27/dd674a719c0922326ffbdaf4c3303e9f.png"></p><h1 id="æ¡ä»¶æ„é€ å™¨"><a href="#æ¡ä»¶æ„é€ å™¨" class="headerlink" title="æ¡ä»¶æ„é€ å™¨"></a>æ¡ä»¶æ„é€ å™¨</h1><ul><li>æˆ‘ä»¬å†™ä¸€äº›å¤æ‚çš„SQLå°±å¯ä»¥ä½¿ç”¨æ¡ä»¶æ„é€ å™¨æ›¿ä»£ã€‚å…·ä½“æŸ¥çœ‹<a href="https://mp.baomidou.com/guide/wrapper.html#abstractwrapper">å®˜ç½‘</a></li><li>æŸ¥è¯¢æ¡ä»¶ï¼šæŸ¥è¯¢nameå’Œé‚®ç®±ä¸ä¸ºç©ºï¼Œä¸”å¹´é¾„å¤§äº22çš„ç”¨æˆ·</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WrapperTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoad</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢nameå’Œé‚®ç®±ä¸ä¸ºç©ºï¼Œä¸”å¹´é¾„å¤§äº22çš„ç”¨æˆ·</span></span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        wrapper</span><br><span class="line">                .isNotNull(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">                .isNotNull(<span class="string">&quot;email&quot;</span>)</span><br><span class="line">                .ge(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;22&quot;</span>);</span><br><span class="line">        userMapper.selectList(wrapper).forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢ç»“æœé‡ç‚¹çœ‹SQLè¯­å¥</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@26eea7f8841bf0274e0482fe86ba5db01c98cc1e/2021/06/27/34d3b56aa6a41338099b1fbd087891a3.png"></p><ul><li>æŸ¥è¯¢æ¡ä»¶ï¼šç”¨æˆ·ånameä¸ºå¼ ä¸‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad1</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// æŸ¥è¯¢nameä¸ºå¼ ä¸‰</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   wrapper.eq(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   <span class="comment">// æŸ¥è¯¢ä¸€ä¸ªï¼ŒæŸ¥è¯¢å¤šä¸ªç”¨mapæˆ–list</span></span><br><span class="line">   User user = userMapper.selectOne(wrapper);</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢å¹´é¾„åœ¨20~30ä¹‹é—´çš„ç”¨æˆ·æ•°é‡</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad2</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// æŸ¥è¯¢å¹´é¾„åœ¨20~30ä¹‹é—´çš„ç”¨æˆ·æ•°é‡</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   wrapper.between(<span class="string">&quot;age&quot;</span>,<span class="number">20</span>,<span class="number">30</span>);</span><br><span class="line">   <span class="keyword">int</span> count = userMapper.selectCount(wrapper);</span><br><span class="line">   System.out.println(count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ¨¡ç³ŠæŸ¥è¯¢ï¼Œåå­—ä¸åŒ…å«æï¼Œé‚®ç®±ä»¥tå¼€å¤´ï¼Œå¹´é¾„ä»¥2ç»“å°¾</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad2</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// æ¨¡ç³ŠæŸ¥è¯¢ï¼Œåå­—ä¸åŒ…å«æï¼Œé‚®ç®±ä»¥tå¼€å¤´ï¼Œå¹´é¾„ä»¥2ç»“å°¾</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   <span class="comment">// likeLeft:%æ  likeRight:æ%</span></span><br><span class="line">   wrapper</span><br><span class="line">          .notLike(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;æ&quot;</span>)</span><br><span class="line">          .likeLeft(<span class="string">&quot;email&quot;</span>,<span class="string">&quot;t&quot;</span>)</span><br><span class="line">          .likeRight(<span class="string">&quot;age&quot;</span>,<span class="number">2</span>);</span><br><span class="line">   List&lt;Map&lt;String, Object&gt;&gt; maps = userMapper.selectMaps(wrapper);</span><br><span class="line">   maps.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å®ç°åµŒå¥—æŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad3</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// åµŒå¥—æŸ¥è¯¢</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   <span class="comment">// idåœ¨å­æŸ¥è¯¢ä¸­æŸ¥å‡ºæ¥</span></span><br><span class="line">   wrapper.inSql(<span class="string">&quot;id&quot;</span>,<span class="string">&quot;select id from user where id&lt;3&quot;</span>);</span><br><span class="line">   List&lt;Object&gt; objects = userMapper.selectObjs(wrapper);</span><br><span class="line">   objects.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿‡Idè¿›è¡Œæ’åº</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad4</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// é€šè¿‡Idè¿›è¡Œæ’åº</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   <span class="comment">// idåœ¨å­æŸ¥è¯¢ä¸­æŸ¥å‡ºæ¥</span></span><br><span class="line">   wrapper.orderByDesc(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">   List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">   users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨"><a href="#ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨" class="headerlink" title="ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨"></a>ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨</h1><ul><li>ä½¿ç”¨ä»£ç è‡ªåŠ¨ç”Ÿå­˜æœŸï¼Œåˆ™daoã€pojoã€ serviceã€ controlleréƒ½ä¸éœ€è¦æ‰‹åŠ¨ç¼–å†™ï¼</li><li><code>AutoGenerator</code>æ˜¯MyBatis-Plusçš„ä»£ç ç”Ÿæˆå™¨ï¼Œé€šè¿‡AutoGeneratorå¯ä»¥å¿«é€Ÿç”ŸæˆEntityã€Mapperã€Mapper XMLã€Serviceã€Controllerç­‰å„ä¸ªæ¨¡å—çš„ä»£ç ,æå¤§çš„æå‡äº†å¼€å‘æ•ˆç‡ã€‚</li><li>æ³¨æ„ï¼šMyBatis-Plus çš„é»˜è®¤æ¨¡æ¿å¼•æ“æ˜¯ä½¿ç”¨ <code>Velocity</code>ï¼Œå¦‚æœä½ é€‰æ‹©äº†éé»˜è®¤å¼•æ“ï¼Œéœ€è¦åœ¨ AutoGenerator ä¸­ è®¾ç½®æ¨¡æ¿å¼•æ“</li><li>å¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨æµ‹è¯•åŒ…ä¸‹æ–°å»º<code>CodeGenerator</code>ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CodeGenerator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1ã€åˆ›å»ºä»£ç ç”Ÿæˆå™¨</span></span><br><span class="line">        AutoGenerator mpg = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€å…¨å±€é…ç½®</span></span><br><span class="line">        GlobalConfig gc = <span class="keyword">new</span> GlobalConfig();</span><br><span class="line">        String projectPath = System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line">        <span class="comment">// æ­¤å¤„å»ºè®®å†™é¡¹ç›®/src/main/javaæºä»£ç çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">        gc.setOutputDir(<span class="string">&quot;C:\\idea\\onlinedu-parent\\service\\service-edu&quot;</span> + <span class="string">&quot;/src/main/java&quot;</span>);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆæ³¨é‡Šæ—¶çš„ä½œè€…</span></span><br><span class="line">        gc.setAuthor(<span class="string">&quot;scorpios&quot;</span>);</span><br><span class="line">        <span class="comment">//ç”Ÿæˆåæ˜¯å¦æ‰“å¼€èµ„æºç®¡ç†å™¨</span></span><br><span class="line">        gc.setOpen(<span class="keyword">false</span>);</span><br><span class="line">        gc.setFileOverride(<span class="keyword">false</span>); <span class="comment">//é‡æ–°ç”Ÿæˆæ—¶æ–‡ä»¶æ˜¯å¦è¦†ç›–</span></span><br><span class="line">        gc.setServiceName(<span class="string">&quot;%sService&quot;</span>);<span class="comment">//å»æ‰Serviceæ¥å£çš„é¦–å­—æ¯I</span></span><br><span class="line">        gc.setIdType(IdType.ID_WORKER_STR); <span class="comment">//ä¸»é”®ç­–ç•¥</span></span><br><span class="line">        gc.setDateType(DateType.ONLY_DATE); <span class="comment">//å®šä¹‰ç”Ÿæˆçš„å®ä½“ç±»ä¸­æ—¥æœŸç±»å‹</span></span><br><span class="line">        <span class="comment">// å¦‚æœå¼€å¯Swagger,è¦å¼•å…¥ç›¸åº”çš„åŒ…</span></span><br><span class="line">        gc.setSwagger2(<span class="keyword">true</span>); <span class="comment">//å¼€å¯Swagger2æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€æ•°æ®æºé…ç½®</span></span><br><span class="line">        DataSourceConfig dsc = <span class="keyword">new</span> DataSourceConfig();</span><br><span class="line">        dsc.setUrl(<span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mybatis_plus?serverTimezone=GMT%2B8&quot;</span>);</span><br><span class="line">        dsc.setDriverName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dsc.setDbType(DbType.MYSQL);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4ã€åŒ…é…ç½®</span></span><br><span class="line">        PackageConfig pc = <span class="keyword">new</span> PackageConfig();</span><br><span class="line">        <span class="comment">// æ­¤å¤„è¦æ³¨æ„ï¼šparent + moduleName ä¸ºåŒ…çš„åå­—ï¼Œåœ¨è¿™ä¸ªåŒ…ä¸‹ï¼Œåˆ›å»ºå¯¹åº”çš„controller...</span></span><br><span class="line">        pc.setParent(<span class="string">&quot;com.scorpios&quot;</span>);</span><br><span class="line">        pc.setModuleName(<span class="string">&quot;eduservice&quot;</span>); <span class="comment">//æ¨¡å—å</span></span><br><span class="line">        pc.setController(<span class="string">&quot;controller&quot;</span>);</span><br><span class="line">        pc.setEntity(<span class="string">&quot;entity&quot;</span>);</span><br><span class="line">        pc.setService(<span class="string">&quot;service&quot;</span>);</span><br><span class="line">        pc.setMapper(<span class="string">&quot;mapper&quot;</span>);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5ã€ç­–ç•¥é…ç½®</span></span><br><span class="line">        StrategyConfig strategy = <span class="keyword">new</span> StrategyConfig();</span><br><span class="line">        <span class="comment">// æ•°æ®åº“ä¸­è¡¨çš„åå­—ï¼Œè¡¨ç¤ºè¦å¯¹å“ªäº›è¡¨è¿›è¡Œè‡ªåŠ¨ç”Ÿæˆcontroller serviceã€mapper...</span></span><br><span class="line">        strategy.setInclude(<span class="string">&quot;edu_course&quot;</span>,<span class="string">&quot;edu_course_description&quot;</span>,</span><br><span class="line">        <span class="string">&quot;edu_chapter&quot;</span>,<span class="string">&quot;edu_video&quot;</span>);</span><br><span class="line">        <span class="comment">// æ•°æ®åº“è¡¨æ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥,é©¼å³°å‘½åæ³•</span></span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆå®ä½“æ—¶å»æ‰è¡¨å‰ç¼€ï¼Œæ¯”å¦‚edu_courseï¼Œå¦‚æœä¸åŠ ä¸‹é¢è¿™å¥ï¼Œç”Ÿæˆçš„å®ä½“ç±»åå­—å°±æ˜¯ï¼šEduCourse</span></span><br><span class="line">        strategy.setTablePrefix(<span class="string">&quot;edu_&quot;</span>); </span><br><span class="line">        <span class="comment">//ç”Ÿæˆå®ä½“æ—¶å»æ‰è¡¨å‰ç¼€</span></span><br><span class="line"><span class="comment">// strategy.setTablePrefix(pc.getModuleName() + &quot;_&quot;); </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•°æ®åº“è¡¨å­—æ®µæ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥</span></span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setEntityLombokModel(<span class="keyword">true</span>); <span class="comment">// lombok æ¨¡å‹ @Accessors(chain = true) setteré“¾å¼æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">        strategy.setRestControllerStyle(<span class="keyword">true</span>); <span class="comment">//restful apié£æ ¼æ§åˆ¶å™¨</span></span><br><span class="line">        strategy.setControllerMappingHyphenStyle(<span class="keyword">true</span>); <span class="comment">//urlä¸­é©¼å³°è½¬è¿å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 6ã€æ‰§è¡Œ</span></span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ€§èƒ½åˆ†ææ’ä»¶&quot;&gt;&lt;a href=&quot;#æ€§èƒ½åˆ†ææ’ä»¶&quot; class=&quot;headerlink&quot; title=&quot;æ€§èƒ½åˆ†ææ’ä»¶&quot;&gt;&lt;/a&gt;æ€§èƒ½åˆ†ææ’ä»¶&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;MyBatisPlusæä¾›äº†æ€§èƒ½åˆ†ææ’ä»¶ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±åœæ­¢è¿è¡Œ!&lt;/li&gt;
&lt;li&gt;é¦–å…ˆè®¾</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/MybatisPlus/"/>
    
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/tags/MybatisPlus/"/>
    
  </entry>
  
  <entry>
    <title>MybatisPlusğŸ¯CRUDæ“ä½œæ‰©å±•</title>
    <link href="http://xiaoliblog.cn/page/MybatisPlus02.html"/>
    <id>http://xiaoliblog.cn/page/MybatisPlus02.html</id>
    <published>2021-06-27T12:16:35.858Z</published>
    <updated>2021-06-27T14:19:07.284Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ›´æ–°æ“ä½œ"><a href="#æ›´æ–°æ“ä½œ" class="headerlink" title="æ›´æ–°æ“ä½œ"></a>æ›´æ–°æ“ä½œ</h1><h2 id="æ›´æ–°æµ‹è¯•"><a href="#æ›´æ–°æµ‹è¯•" class="headerlink" title="æ›´æ–°æµ‹è¯•"></a>æ›´æ–°æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">   User user = <span class="keyword">new</span> User();</span><br><span class="line">   <span class="comment">// é€šè¿‡æ¡ä»¶è‡ªåŠ¨æ‹¼æ¥SQL</span></span><br><span class="line">   user.setId(<span class="number">1L</span>);</span><br><span class="line">   user.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   user.setAge(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;2312057536@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// updateByIdå‚æ•°ä¸ºå¯¹è±¡</span></span><br><span class="line">   <span class="keyword">int</span> update = userMapper.updateById(user);</span><br><span class="line">   System.out.println(update);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è‡ªåŠ¨å¡«å……"><a href="#è‡ªåŠ¨å¡«å……" class="headerlink" title="è‡ªåŠ¨å¡«å……"></a>è‡ªåŠ¨å¡«å……</h2><ul><li>åƒåˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´è¿™äº›æ“ä½œä¸€èˆ¬éƒ½æ˜¯è‡ªåŠ¨åŒ–å®Œæˆçš„ï¼Œä¸å¸Œæœ›æ‰‹åŠ¨æ›´æ–°ï¼</li><li>åœ¨é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œä¸­ï¼Œæ˜ç¡®è§„å®šå¿…é¡»æœ‰<code>gmt_create</code>å’Œ<code>gmt_modified</code>è¿™ä¸¤ä¸ªå­—æ®µï¼Œåˆ†åˆ«å¯¹åº”åˆ›å»ºæ—¶é—´å’Œä¿®æ”¹æ—¶é—´</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@8fcdd3107166a9852b0426f927ba2e982f23bae8/2021/06/27/99c4b9e25247f222a5f39ff7e40aac05.png"></p><ul><li>æ–¹å¼ä¸€æ˜¯<strong>æ•°æ®åº“çº§åˆ«</strong>ï¼Œåœ¨è¡¨ä¸­æ–°å¢å­—æ®µ<code>create_time</code>ã€<code>update_time</code>ï¼Œå¹¶å‹¾é€‰æ—¶é—´æˆ³æ›´æ–°å’Œé»˜è®¤ä¸ºå½“å‰æ—¶é—´æˆ³<code>CURRENT_TIMESTAMP</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@cda83e8afd83e0165a86608a1e2ca1871ea85657/2021/06/27/5767c41575f93389a34d28691bf8f215.png"></p><ul><li>å®ä½“ç±»å®Œå–„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Date createTime;</span><br><span class="line"><span class="keyword">private</span> Date updateTime;</span><br></pre></td></tr></table></figure><ul><li>å†æ‰§è¡Œä¸€æ¬¡æ›´æ–°æ“ä½œï¼Œç»“æœå¦‚ä¸‹</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@2cb8202dcba4f5fc2bbda4afa5db5607ca40bb58/2021/06/27/9dcc81d39b06d3b693447cdb259d190a.png"></p><ul><li>æ–¹å¼äºŒæ˜¯<strong>ä»£ç çº§åˆ«</strong>ï¼Œéœ€è¦åˆ é™¤æ•°æ®åº“é»˜è®¤å€¼å’Œæ›´æ–°æ—¶é—´æˆ³æ“ä½œ</li><li>å®ä½“ç±»å­—æ®µä¸Šéœ€è¦å¢åŠ æ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­—æ®µå¢åŠ å¡«å……å†…å®¹</span></span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.DEFAULT)</span></span><br><span class="line"><span class="keyword">private</span> Date createTime;</span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line"><span class="keyword">private</span> Date updateTime;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™å¤„ç†å™¨æ¥å¤„ç†æ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">// ä¸€å®šä¸è¦å¿˜è®°æŠŠå¤„ç†å™¨åŠ åˆ°IOCå®¹å™¨ä¸­ï¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ’å…¥æ—¶çš„å¡«å……ç­–ç•¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;start insert fill...&quot;</span>);</span><br><span class="line">        <span class="comment">// setFieldValByName(String fieldName, Object fieldVal, MetaObject metaObject)</span></span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;createTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ›´æ–°æ—¶çš„å¡«å……ç­–ç•¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;start update fill...&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹è§‚é”"><a href="#ä¹è§‚é”" class="headerlink" title="ä¹è§‚é”"></a>ä¹è§‚é”</h2><ul><li><p>ä¹è§‚é”ã€æ‚²è§‚é”å‚è€ƒï¼š<a href="https://www.jianshu.com/p/d2ac26ca6525">https://www.jianshu.com/p/d2ac26ca6525</a></p></li><li><p>ä¹è§‚é”ï¼šæ•…åæ€ä¹‰ååˆ†ä¹è§‚ï¼Œå®ƒæ€»æ˜¯è®¤ä¸ºä¸ä¼šå‡ºç°é—®é¢˜ï¼Œæ— è®ºå¹²ä»€ä¹ˆéƒ½ä¸å»ä¸Šé”ï¼å¦‚æœå‡ºç°äº†é—®é¢˜ï¼Œå†æ¬¡æ›´æ–°å€¼æµ‹è¯•</p></li><li><p>æ‚²è§‚é”ï¼šæ•…åæ€ä¹‰ååˆ†æ‚²è§‚ï¼Œå®ƒæ€»æ˜¯è®¤ä¸ºä¼šå‡ºç°é—®é¢˜ï¼Œæ— è®ºå¹²ä»€ä¹ˆéƒ½å»ä¸Šé”ï¼å†å»æ“ä½œ</p></li><li><p>ä¹è§‚é”å®ç°æ–¹å¼:</p><ul><li>æŸ¥è¯¢å–å‡ºè®°å½•æ—¶ï¼Œè·å–å½“å‰<code>version</code></li><li>æ›´æ–°æ—¶ï¼Œå¸¦ä¸Šè¿™ä¸ª<code>version</code></li><li>æ‰§è¡Œæ›´æ–°æ—¶ï¼Œ<code>set version = newVersion where version = oldVersion</code></li><li>å¦‚æœ<code>version</code>ä¸å¯¹ï¼Œå°±æ›´æ–°å¤±è´¥</li></ul></li><li><p>é¦–å…ˆç»™æ•°æ®åº“å¢åŠ <code>version</code>å­—æ®µï¼Œå¹¶è®¾ç½®é»˜è®¤å€¼ä¸º<code>1</code><br><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@2f497278d06427147c64bab8bb8c458138f57dc6/2021/06/27/a48cb7efe8b5d9098a94630fc62c543b.png"></p></li><li><p>å®ä½“ç±»åŠ å¯¹åº”å­—æ®µ</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Version</span> <span class="comment">// ä¹è§‚é”versionæ³¨è§£</span></span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure><ul><li>ç„¶åéœ€è¦æ’ä»¶é…ç½®ç±»æ³¨å†Œç»„ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">// äº‹åŠ¡ç®¡ç†</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ä»£è¡¨ä¸ºé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ³¨å†Œä¹è§‚é”æ’ä»¶</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> OptimisticLockerInterceptor <span class="title">optimisticLockerInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> OptimisticLockerInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ä¸€ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•ä¹è§‚é”æˆåŠŸæ¡ˆä¾‹</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// 1. æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">   User user = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">   <span class="comment">// 2. ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">   user.setName(<span class="string">&quot;ç‰›ä¸‰&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;2313123@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// 3. æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">   userMapper.updateById(user);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æµ‹è¯•ä¹è§‚é”å¤±è´¥æ¡ˆä¾‹,å¤šçº¿ç¨‹ä¸‹</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// çº¿ç¨‹1</span></span><br><span class="line">   User user = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">   user.setName(<span class="string">&quot;ç‰›ä¸‰&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;2313123@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// æ¨¡æ‹Ÿå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ’é˜Ÿæ“ä½œ</span></span><br><span class="line">   User user2 = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">   user.setName(<span class="string">&quot;ç‰›ä¸‰2&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;23131232@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">   <span class="comment">// å¯ä»¥ä½¿ç”¨è‡ªæ—‹é”æ¥å¤šæ¬¡å°è¯•æäº¤</span></span><br><span class="line">   userMapper.updateById(user); <span class="comment">// å¦‚æœæ²¡æœ‰ä¹è§‚é”å°±ä¼šè¦†ç›–æ’é˜Ÿçº¿ç¨‹çš„å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æŸ¥è¯¢æ“ä½œ"><a href="#æŸ¥è¯¢æ“ä½œ" class="headerlink" title="æŸ¥è¯¢æ“ä½œ"></a>æŸ¥è¯¢æ“ä½œ</h1><h2 id="æŸ¥è¯¢æµ‹è¯•"><a href="#æŸ¥è¯¢æµ‹è¯•" class="headerlink" title="æŸ¥è¯¢æµ‹è¯•"></a>æŸ¥è¯¢æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•æŸ¥è¯¢</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery</span><span class="params">()</span></span>&#123;</span><br><span class="line">   User user = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryByIDS</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// æ‰¹é‡IDæŸ¥è¯¢</span></span><br><span class="line">   List&lt;User&gt; users = userMapper.selectBatchIds(Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">   users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¡ä»¶æŸ¥è¯¢ Map</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelective</span><span class="params">()</span></span>&#123;</span><br><span class="line">   HashMap&lt;String,Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">   <span class="comment">// è‡ªå®šä¹‰æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">   hashMap.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   hashMap.put(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;3&quot;</span>);</span><br><span class="line">   List&lt;User&gt; users = userMapper.selectByMap(hashMap);</span><br><span class="line">   users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h2><ul><li>MyBatisPluså†…ç½®äº†åˆ†é¡µæ’ä»¶</li><li>é¦–å…ˆåœ¨é…ç½®ç±»ä¸­é…ç½®æ‹¦æˆªå™¨ç»„ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">// äº‹åŠ¡ç®¡ç†</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ä»£è¡¨ä¸ºé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç›´æ¥ç”¨<code>Page</code>å¯¹è±¡å³å¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPage</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// 1. å‚æ•°ä¸º:å½“å‰é¡µ,é¡µé¢å¤§å°</span></span><br><span class="line">   Page&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line">   userMapper.selectPage(page,<span class="keyword">null</span>);</span><br><span class="line">   page.getRecords().forEach(System.out::println);</span><br><span class="line">   System.out.println(<span class="string">&quot;æ€»æ•°:&quot;</span>+page.getTotal());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å…¶æœ¬è´¨è¿˜æ˜¯æ”¹å˜SQLè¯­å¥ä½¿ç”¨<code>limit</code>å®ç°</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@0a37fdd20f691d6ffc18f822fb39e562d67f8911/2021/06/27/63dff3a192c2d5261e9c1096ed6ce4d0.png"></p><h1 id="åˆ é™¤æ“ä½œ"><a href="#åˆ é™¤æ“ä½œ" class="headerlink" title="åˆ é™¤æ“ä½œ"></a>åˆ é™¤æ“ä½œ</h1><h2 id="åˆ é™¤æµ‹è¯•"><a href="#åˆ é™¤æµ‹è¯•" class="headerlink" title="åˆ é™¤æµ‹è¯•"></a>åˆ é™¤æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•åˆ é™¤</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testdelById</span><span class="params">()</span></span>&#123;</span><br><span class="line">   userMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰¹é‡åˆ é™¤</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelbatch</span><span class="params">()</span></span>&#123;</span><br><span class="line">   userMapper.deleteBatchIds(Arrays.asList(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¡ä»¶åˆ é™¤ Map</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelMap</span><span class="params">()</span></span>&#123;</span><br><span class="line">   HashMap&lt;String, Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">   hashMap.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   userMapper.deleteByMap(hashMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é€»è¾‘åˆ é™¤"><a href="#é€»è¾‘åˆ é™¤" class="headerlink" title="é€»è¾‘åˆ é™¤"></a>é€»è¾‘åˆ é™¤</h2><ul><li>ç‰©ç†åˆ é™¤ï¼šä»æ•°æ®åº“ä¸­ç›´æ¥ç§»é™¤</li><li>é€»è¾‘åˆ é™¤ï¼šåœ¨æ•°æ®åº“ä¸­æ²¡æœ‰è¢«åˆ é™¤ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡æ¥è®©ä»–å¤±æ•ˆã€‚é˜²æ­¢æ•°æ®çš„ä¸¢å¤±ï¼Œç±»ä¼¼å›æ”¶ç«™</li><li>åœ¨æ•°æ®è¡¨ä¸­æ·»åŠ ä¸€ä¸ª<code>deleted</code>å­—æ®µï¼Œé»˜è®¤ä¸º<code>0</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@16a5f05e99a0294fbdc3bced1ae3383091356cb0/2021/06/27/6212195cde7fcba1c1195b0dcfdf528c.png"></p><ul><li>å®ä½“ç±»å®Œå–„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableLogic</span>  <span class="comment">//é€»è¾‘åˆ é™¤</span></span><br><span class="line"><span class="keyword">private</span> Integer deleted;</span><br></pre></td></tr></table></figure><ul><li>åœ¨é…ç½®ç±»ä¸­é…ç½®é€»è¾‘åˆ é™¤ç»„ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">// äº‹åŠ¡ç®¡ç†</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ä»£è¡¨ä¸ºé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é€»è¾‘æŸ¥è¯¢ç»„ä»¶</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ISqlInjector <span class="title">sqlInjector</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LogicSqlInjector();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç„¶ååœ¨<code>application.properties</code>ä¸­é…ç½®</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®é€»è¾‘åˆ é™¤ é»˜è®¤æœªåˆ é™¤ä¸º0,åˆ é™¤äº†ä¸º1</span></span><br><span class="line"><span class="meta">mybatis-plus.global-config.db-config.logic-delete-value</span>=<span class="string">1</span></span><br><span class="line"><span class="meta">mybatis-plus.global-config.db-config.logic-not-delete-value</span>=<span class="string">0</span></span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤æµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•åˆ é™¤</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testdelById</span><span class="params">()</span></span>&#123;</span><br><span class="line">   userMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬é»˜è®¤è®¾ç½®<code>deleted</code>å­—æ®µä¸º0ï¼Œå…¶æœ¬è´¨æ‰§è¡Œäº†æ›´æ–°æ“ä½œã€‚æŸ¥è¯¢çš„æ—¶å€™ä¼šè‡ªåŠ¨è¿‡æ»¤è¢«é€»è¾‘åˆ é™¤çš„å­—æ®µ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3c1efc4add3c6a0a3749e7c189e00f0a618d149b/2021/06/27/8f1fbe725e18c51f770f2270ea0ba302.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ›´æ–°æ“ä½œ&quot;&gt;&lt;a href=&quot;#æ›´æ–°æ“ä½œ&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°æ“ä½œ&quot;&gt;&lt;/a&gt;æ›´æ–°æ“ä½œ&lt;/h1&gt;&lt;h2 id=&quot;æ›´æ–°æµ‹è¯•&quot;&gt;&lt;a href=&quot;#æ›´æ–°æµ‹è¯•&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°æµ‹è¯•&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/MybatisPlus/"/>
    
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/tags/MybatisPlus/"/>
    
  </entry>
  
  <entry>
    <title>MybatisPlusğŸ¯æ—¥å¿—é…ç½®åŠä¸»é”®ç­–ç•¥</title>
    <link href="http://xiaoliblog.cn/page/MybatisPlus01.html"/>
    <id>http://xiaoliblog.cn/page/MybatisPlus01.html</id>
    <published>2021-06-27T10:06:42.465Z</published>
    <updated>2021-06-27T12:14:50.557Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MyBatisPlus"><a href="#MyBatisPlus" class="headerlink" title="MyBatisPlus"></a>MyBatisPlus</h1><h2 id="MyBatisPlusç®€ä»‹"><a href="#MyBatisPlusç®€ä»‹" class="headerlink" title="MyBatisPlusç®€ä»‹"></a>MyBatisPlusç®€ä»‹</h2><ul><li><code>MyBatis-Plus</code> (opens new window)ï¼ˆç®€ç§° MPï¼‰æ˜¯ä¸€ä¸ª MyBatis (opens new window)çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ MyBatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3a0d723c46f240cf5ef8123cf4cf0dba25c6ab1e/2021/06/27/94fba68ecf5a43056f9d825ae68d4549.png"></p><ul><li><strong>æ— ä¾µå…¥</strong>ï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¼•å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘</li><li><strong>æŸè€—å°</strong>ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬ CURDï¼Œæ€§èƒ½åŸºæœ¬æ— æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ</li><li><strong>å¼ºå¤§çš„ CRUD æ“ä½œ</strong>ï¼šå†…ç½®é€šç”¨ Mapperã€é€šç”¨ Serviceï¼Œä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ† CRUD æ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚</li><li><strong>æ”¯æŒ Lambda å½¢å¼è°ƒç”¨</strong>ï¼šé€šè¿‡ Lambda è¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™</li><li><strong>æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šæ”¯æŒå¤šè¾¾ 4 ç§ä¸»é”®ç­–ç•¥ï¼ˆå†…å«åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ - Sequenceï¼‰ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜</li><li><strong>æ”¯æŒ ActiveRecord æ¨¡å¼</strong>ï¼šæ”¯æŒ ActiveRecord å½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿ Model ç±»å³å¯è¿›è¡Œå¼ºå¤§çš„ CRUD æ“ä½œ</li><li><strong>æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œ</strong>ï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥ï¼ˆ Write once, use anywhere ï¼‰</li><li><strong>å†…ç½®ä»£ç ç”Ÿæˆå™¨</strong>ï¼šé‡‡ç”¨ä»£ç æˆ–è€… Maven æ’ä»¶å¯å¿«é€Ÿç”Ÿæˆ Mapper ã€ Model ã€ Service ã€ Controller å±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨</li><li><strong>å†…ç½®åˆ†é¡µæ’ä»¶</strong>ï¼šåŸºäº MyBatis ç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€š List æŸ¥è¯¢</li><li><strong>åˆ†é¡µæ’ä»¶æ”¯æŒå¤šç§æ•°æ®åº“</strong>ï¼šæ”¯æŒ MySQLã€MariaDBã€Oracleã€DB2ã€H2ã€HSQLã€SQLiteã€Postgreã€SQLServer ç­‰å¤šç§æ•°æ®åº“</li><li><strong>å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶</strong>ï¼šå¯è¾“å‡º Sql è¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢</li><li><strong>å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶</strong>ï¼šæä¾›å…¨è¡¨ delete ã€ update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ</li></ul><h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><ul><li>æ„å»ºæ•°æ®åº“</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@36e39ab8c43b8f4d5c8140b29b9419c985b89f70/2021/06/27/15e1d0e99870b71dbabb9d29782eb649.png"></p><ul><li>åˆ›å»ºSpringBooté¡¹ç›®ï¼Œå¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning simple"><p>ä½¿ç”¨MyBatis-Pluså¯ä»¥èŠ‚çœæˆ‘ä»¬å¤§é‡çš„ä»£ç ï¼Œå°½é‡ä¸ç”¨åŒæ—¶å¯¼å…¥MyBatiså’ŒMyBatis-Plusï¼Œé¿å…ä¾èµ–å†²çªé—®é¢˜</p></div><ul><li>è¿æ¥æ•°æ®åº“</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure><ul><li>é…ç½®å®ä½“ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™Mapperæ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span> <span class="comment">//ä»£è¡¨æŒä¹…å±‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// CRUDç¼–å†™å®Œæˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ Spring Boot å¯åŠ¨ç±»ä¸­æ·»åŠ <code> @MapperScan</code> æ³¨è§£ï¼Œæ‰«æ Mapper æ–‡ä»¶å¤¹ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisDemo01Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(MybatisDemo01Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿›è¡Œå•å…ƒæµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MybatisDemo01ApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ç»§æ‰¿äº†BaseMapper,æ‰€æœ‰çš„æ–¹æ³•éƒ½æ¥è‡ªBaseMapper,ä¹Ÿå¯ä»¥æ‰©å±•æ–¹æ³•</span></span><br><span class="line">        <span class="comment">// å‚æ•°æ˜¯ä¸€ä¸ªWrapperï¼Œæ¡ä»¶æ„é€ å™¨</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@19135a41bd9ffd5981dc502e43a705d0a91b8dbd/2021/06/27/31d594ade53efa7c9b976e102533d9dc.png"></p><div class="note success simple"><p>é€šè¿‡ä»¥ä¸Šå‡ ä¸ªç®€å•çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°±å®ç°äº† User è¡¨çš„ CRUD åŠŸèƒ½ï¼Œç”šè‡³è¿ XML æ–‡ä»¶éƒ½ä¸ç”¨ç¼–å†™ï¼</p></div><h2 id="é…ç½®æ—¥å¿—"><a href="#é…ç½®æ—¥å¿—" class="headerlink" title="é…ç½®æ—¥å¿—"></a>é…ç½®æ—¥å¿—</h2><ul><li>MyBatis-Plusçš„SQLéƒ½æ˜¯ä¸å¯è§çš„ï¼Œæ‰€ä»¥é…ç½®æ—¥å¿—æ˜¯éå¸¸é‡è¦çš„</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®æ—¥å¿—</span></span><br><span class="line"><span class="meta">mybatis-plus.configuration.log-impl</span>=<span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@4504d0a5c0fe645fc8c9069ac540d9a0575c98d9/2021/06/27/b1079f36cd5c0853f045e7c133648822.png"></p><h1 id="ä¸»é”®ç­–ç•¥"><a href="#ä¸»é”®ç­–ç•¥" class="headerlink" title="ä¸»é”®ç­–ç•¥"></a>ä¸»é”®ç­–ç•¥</h1><h2 id="æµ‹è¯•æ’å…¥"><a href="#æµ‹è¯•æ’å…¥" class="headerlink" title="æµ‹è¯•æ’å…¥"></a>æµ‹è¯•æ’å…¥</h2><ul><li>æµ‹è¯•ä¸€ä¸‹æ’å…¥</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoads1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="comment">// æµ‹è¯•æ’å…¥</span></span><br><span class="line">   User user = <span class="keyword">new</span> User();</span><br><span class="line">   user.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   user.setAge(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;2312057536@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// ä¼šè‡ªåŠ¨ç”ŸæˆID</span></span><br><span class="line">   <span class="keyword">int</span> result = userMapper.insert(user);</span><br><span class="line">   System.out.println(result);</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®åº“è®¾è®¡æ—¶å¹¶æ²¡æœ‰è®¾ç½®ä¸»é”®è‡ªå¢ï¼ŒMyBatisPlusè‡ªåŠ¨ä¸ºæˆ‘ä»¬å¡«å……äº†ID</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6d5004a59c891ea98affea6ba4deb83f434bb0a2/2021/06/27/9f8b41988ba4272a06e346435e5cddf4.png"></p><ul><li>é¦–å…ˆè¦äº†è§£ä¸€ä¸‹ä¸»é”®ç”Ÿæˆç­–ç•¥ï¼ˆUUIDã€è‡ªå¢IDã€é›ªèŠ±ç®—æ³•ã€Redisã€Zookeeperï¼‰</li></ul><h2 id="é›ªèŠ±ç®—æ³•"><a href="#é›ªèŠ±ç®—æ³•" class="headerlink" title="é›ªèŠ±ç®—æ³•"></a>é›ªèŠ±ç®—æ³•</h2><ul><li>åˆ†å¸ƒå¼ç³»ç»Ÿå”¯ä¸€IDç”Ÿæˆæ–¹æ¡ˆå‚è€ƒï¼š<a href="https://www.cnblogs.com/haoxinyue/p/5208136.html">https://www.cnblogs.com/haoxinyue/p/5208136.html</a></li><li><code>snowflake</code>æ˜¯Twitterå¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œç»“æœæ˜¯ä¸€ä¸ªlongå‹çš„IDã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šä½¿ç”¨41bitä½œä¸ºæ¯«ç§’æ•°ï¼Œ10bitä½œä¸ºæœºå™¨çš„IDï¼ˆ5ä¸ªbitæ˜¯æ•°æ®ä¸­å¿ƒï¼Œ5ä¸ªbitçš„æœºå™¨IDï¼‰ï¼Œ12bitä½œä¸ºæ¯«ç§’å†…çš„æµæ°´å·ï¼ˆæ„å‘³ç€æ¯ä¸ªèŠ‚ç‚¹åœ¨æ¯æ¯«ç§’å¯ä»¥äº§ç”Ÿ 4096 ä¸ª IDï¼‰ï¼Œæœ€åè¿˜æœ‰ä¸€ä¸ªç¬¦å·ä½ï¼Œæ°¸è¿œæ˜¯0ã€‚å¯ä»¥ä¿è¯å…¨çƒå”¯ä¸€ï¼</li><li>å…·ä½“å®ç°çš„ä»£ç å¯ä»¥å‚çœ‹<a href="https://github.com/twitter/snowflake">https://github.com/twitter/snowflake</a>ã€‚é›ªèŠ±ç®—æ³•æ”¯æŒçš„TPSå¯ä»¥è¾¾åˆ°419ä¸‡å·¦å³ï¼ˆ2^22*1000ï¼‰</li></ul><h2 id="ä¸»é”®ç­–ç•¥-1"><a href="#ä¸»é”®ç­–ç•¥-1" class="headerlink" title="ä¸»é”®ç­–ç•¥"></a>ä¸»é”®ç­–ç•¥</h2><ul><li>åœ¨å®ä½“ç±»ä¸Šé…ç½®ä¸»é”®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é»˜è®¤ID_WORKER å…¨å±€å”¯ä¸€ID</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.ID_WORKER)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹<code>IdType</code>çš„æºç å¦‚ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">IdType</span> </span>&#123;</span><br><span class="line">    AUTO(<span class="number">0</span>),  <span class="comment">// æ•°æ®åº“ä¸»é”®è‡ªå¢ï¼Œå‰ææ•°æ®åº“è®¾è®¡ä¸ºä¸»é”®è‡ªå¢</span></span><br><span class="line">    NONE(<span class="number">1</span>),  <span class="comment">//æœªè®¾ç½®ä¸»é”®</span></span><br><span class="line">    INPUT(<span class="number">2</span>),  <span class="comment">//æ‰‹åŠ¨è¾“å…¥</span></span><br><span class="line">    ID_WORKER(<span class="number">3</span>), <span class="comment">//é»˜è®¤çš„å…¨å±€å”¯ä¸€</span></span><br><span class="line">    UUID(<span class="number">4</span>),   <span class="comment">//å…¨å±€å”¯ä¸€id</span></span><br><span class="line">    ID_WORKER_STR(<span class="number">5</span>); <span class="comment">//ID_WORKERå­—ç¬¦ä¸²è¡¨ç¤ºæ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MyBatisPlus&quot;&gt;&lt;a href=&quot;#MyBatisPlus&quot; class=&quot;headerlink&quot; title=&quot;MyBatisPlus&quot;&gt;&lt;/a&gt;MyBatisPlus&lt;/h1&gt;&lt;h2 id=&quot;MyBatisPlusç®€ä»‹&quot;&gt;&lt;a href=&quot;#MyBa</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/MybatisPlus/"/>
    
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/tags/MybatisPlus/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒDubboå’ŒZookeeperé›†æˆ</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot20.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot20.html</id>
    <published>2021-06-27T03:40:27.377Z</published>
    <updated>2021-06-27T07:43:49.359Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Dubbo"><a href="#Dubbo" class="headerlink" title="Dubbo"></a>Dubbo</h1><ul><li><code>Apache Dubbo</code> |ËˆdÊŒbÉ™ÊŠ| æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava <code>RPC</code>æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼šé¢å‘æ¥å£çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæ™ºèƒ½å®¹é”™å’Œè´Ÿè½½å‡è¡¡ï¼Œä»¥åŠæœåŠ¡è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°ã€‚</li><li>dubboå®˜ç½‘ï¼š<a href="https://dubbo.apache.org/zh/">https://dubbo.apache.org/zh/</a></li></ul><h2 id="dubboåŸºæœ¬æ¦‚å¿µ"><a href="#dubboåŸºæœ¬æ¦‚å¿µ" class="headerlink" title="dubboåŸºæœ¬æ¦‚å¿µ"></a>dubboåŸºæœ¬æ¦‚å¿µ</h2><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@63f1a633096f3abb8a5d33a958d08496c7882bb6/2021/06/27/0d31799b7c1195ae6b9cefd232adaf2b.png"></p><ul><li><strong>æœåŠ¡æä¾›è€…</strong>ï¼ˆProviderï¼‰ï¼šæš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ï¼ŒæœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li><li><strong>æœåŠ¡æ¶ˆè´¹è€…</strong>ï¼ˆConsumerï¼‰ï¼šè°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ï¼ŒæœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</li><li><strong>æ³¨å†Œä¸­å¿ƒ</strong>ï¼ˆRegistryï¼‰ï¼šæ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…</li><li><strong>ç›‘æ§ä¸­å¿ƒ</strong>ï¼ˆMonitorï¼‰ï¼šæœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒ</li><li>è°ƒç”¨å…³ç³»è¯´æ˜<ul><li>æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</li><li>æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li><li>æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</li><li>æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚</li><li>æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</li><li>æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</li></ul></li></ul><h2 id="å®‰è£…zookeeper"><a href="#å®‰è£…zookeeper" class="headerlink" title="å®‰è£…zookeeper"></a>å®‰è£…zookeeper</h2><ul><li><p>Dubooå®˜æ–¹æ¨èæˆ‘ä»¬ä½¿ç”¨<code>Zookeeper</code>æ³¨å†Œä¸­å¿ƒã€‚ZooKeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œå¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡ï¼Œæ˜¯Googleçš„Chubbyä¸€ä¸ªå¼€æºçš„å®ç°ï¼Œæ˜¯Hadoopå’ŒHbaseçš„é‡è¦ç»„ä»¶ã€‚å®ƒæ˜¯ä¸€ä¸ªä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›ä¸€è‡´æ€§æœåŠ¡çš„è½¯ä»¶ï¼Œæä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼šé…ç½®ç»´æŠ¤ã€åŸŸåæœåŠ¡ã€åˆ†å¸ƒå¼åŒæ­¥ã€ç»„æœåŠ¡ç­‰</p></li><li><p>Zookeeperå®˜ç½‘ï¼š<a href="https://zookeeper.apache.org/">https://zookeeper.apache.org/</a></p></li><li><p>Zookepperä¸‹è½½åœ°å€ï¼š<a href="http://archive.apache.org/dist/zookeeper/">http://archive.apache.org/dist/zookeeper/</a></p></li><li><p>ä¸‹è½½å‹ç¼©åŒ…å¹¶è§£å‹ï¼Œ3.5ä»¥ä¸Šç‰ˆæœ¬è¦ä¸‹è½½å¸¦<code>bin</code>çš„æ–‡ä»¶ï¼Œæœ€å¥½æ˜¯åˆ›å»ºä¸€ä¸ª<code>Environment</code>æ–‡ä»¶å¤¹ä¸“é—¨æ”¾é…ç½®ç¯å¢ƒ<br><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@26a9cdcdb2b47d6c7903bfb60d4776849c64bfe1/2021/06/27/f65ce07cb9f044360d9c2aed81e7b4be.png"></p></li><li><p>è¿›å…¥è§£å‹åçš„æ–‡ä»¶é‡Œæ‰“å¼€<code>/bin/zkServer.cmd</code>ï¼Œåˆæ¬¡è¿è¡Œä¼šæŠ¥é”™ï¼Œæ²¡æœ‰<code>zoo.cfg</code>é…ç½®æ–‡ä»¶ï¼›</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@905019bd5a932781a671eeb845f3df58800c53da/2021/06/27/7197727347f540742ed9f2673e17a913.png"></p><ul><li>å½“å‡ºç°é—ªé€€é—®é¢˜æ‰¾ä¸åˆ°æŠ¥é”™æ—¶ï¼Œç¼–è¾‘<code>zkServer.cmd</code>æ–‡ä»¶æœ«å°¾æ·»åŠ <code>pause </code>ã€‚è¿™æ ·è¿è¡Œå‡ºé”™å°±ä¸ä¼šé€€å‡ºï¼Œä¼šæç¤ºé”™è¯¯ä¿¡æ¯ï¼Œæ–¹ä¾¿æ‰¾åˆ°åŸå› ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@1b3a30fad150f88bf6ee0cf9dfd40a5fba971809/2021/06/27/0e16926ddf34cfbaf57bc337a05a5a3c.png"></p><ul><li>å°†<code>conf</code>æ–‡ä»¶å¤¹ä¸‹é¢çš„<code>zoo_sample.cfg</code>å¤åˆ¶ä¸€ä»½æ”¹åä¸º<code>zoo.cfg</code>å³å¯<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@d22c24ec9aef05e246f15c919669f9f1f67e73ed/2021/06/27/7abae3eb2a4e7d18f818c8158e6ba8ae.png"></li><li>åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º<code>data</code>å’Œ<code>log</code>æ–‡ä»¶å¤¹ï¼Œä¿®æ”¹<code>zoo.cfg</code>ä¸­çš„å‚æ•°</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@8d369d64e0f7639406f0a01c38ff3565a3a181cd/2021/06/27/4cc132a970438d8cdcdbeab2220f90b1.png"></p><ul><li><p>ä¿®æ”¹å®Œæˆåå†æ¬¡å¯åŠ¨zookeeper<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@18c915aed2fd70a8fbbc7eb020e472dc80219777/2021/06/27/8ffb794058f8f76cb5715223f7162d26.png"></p></li><li><p>ä½¿ç”¨<code>bin</code>ç›®å½•ä¸‹çš„<code>zkCli.cmd</code>å®¢æˆ·ç«¯è¿›è¡Œæµ‹è¯•ï¼ŒåŒå‡»æ‰“å¼€å³å¯ã€‚è¿æ¥æˆåŠŸåï¼Œä½¿ç”¨<code>ls /</code>ï¼šåˆ—å‡ºzookeeperæ ¹ä¸‹ä¿å­˜çš„æ‰€æœ‰èŠ‚ç‚¹</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] ls /</span><br><span class="line">[zookeeper]</span><br></pre></td></tr></table></figure><ul><li>ä¹Ÿå¯ä»¥åˆ›å»ºåˆ›å»ºä¸€ä¸ªç»“ç‚¹ï¼Œæ¯”å¦‚åˆ›å»º<code>xiaoliblog</code>èŠ‚ç‚¹ï¼Œå€¼ä¸º<code>123</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 2] create â€“e /xiaoliblog 123</span><br><span class="line">Created /xiaoliblog</span><br></pre></td></tr></table></figure><ul><li>è·å–<code>/xiaoliblog</code>èŠ‚ç‚¹çš„å€¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@003d1b24087c4b6e869faf5f6625188db4ae54c7/2021/06/27/71e7362191fa5b2b7aea80b5457083fd.png"></p><h2 id="å®‰è£…dubbo-admin"><a href="#å®‰è£…dubbo-admin" class="headerlink" title="å®‰è£…dubbo-admin"></a>å®‰è£…dubbo-admin</h2><ul><li>dubboæœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæœåŠ¡è½¯ä»¶ã€‚å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ª<code>jar</code>åŒ…ï¼Œèƒ½å¤Ÿå¸®ä½ çš„javaç¨‹åºè¿æ¥åˆ°zookeeperï¼Œå¹¶åˆ©ç”¨zookeeperæ¶ˆè´¹ã€æä¾›æœåŠ¡ã€‚</li><li>ä½†æ˜¯ä¸ºäº†è®©ç”¨æˆ·æ›´å¥½çš„ç®¡ç†ç›‘æ§ä¼—å¤šçš„dubboæœåŠ¡ï¼Œå®˜æ–¹æä¾›äº†ä¸€ä¸ªå¯è§†åŒ–çš„ç›‘æ§ç¨‹åº<code>dubbo-admin</code>ï¼Œä¸è¿‡è¿™ä¸ªç›‘æ§å³ä½¿ä¸è£…ä¹Ÿä¸å½±å“ä½¿ç”¨</li><li>GitHubåœ°å€ï¼š<a href="https://github.com/apache/dubbo-admin/tree/master">https://github.com/apache/dubbo-admin/tree/master</a></li><li>æˆ–è€…æ‰¾ä¸€ä¸ªGiteeé“¾æ¥ï¼š<a href="https://gitee.com/xiaoliblog/dubbo-admin">https://gitee.com/xiaoliblog/dubbo-admin</a></li><li>ä¸‹è½½è§£å‹è¿›å…¥ç›®å½•ä¿®æ”¹ <code>dubbo-admin\src\main\resources \application.properties</code> æŒ‡å®šzookeeperåœ°å€</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">7001</span></span><br><span class="line"><span class="meta">spring.velocity.cache</span>=<span class="string">false</span></span><br><span class="line"><span class="meta">spring.velocity.charset</span>=<span class="string">UTF-8</span></span><br><span class="line"><span class="meta">spring.velocity.layout-url</span>=<span class="string">/templates/default.vm</span></span><br><span class="line"><span class="meta">spring.messages.fallback-to-system-locale</span>=<span class="string">false</span></span><br><span class="line"><span class="meta">spring.messages.basename</span>=<span class="string">i18n/message</span></span><br><span class="line"><span class="meta">spring.root.password</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.guest.password</span>=<span class="string">guest</span></span><br><span class="line"></span><br><span class="line"><span class="meta">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨è§£å‹åçš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œæ‰“åŒ…æ“ä½œã€‚ç¬¬ä¸€æ¬¡æ‰“åŒ…çš„è¿‡ç¨‹æœ‰ç‚¹æ…¢ï¼Œéœ€è¦è€å¿ƒç­‰å¾…ï¼ç›´åˆ°æˆåŠŸï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -Dmaven.test.skip=<span class="literal">true</span></span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@ae00153d1369952cd9ba83d1a24ec5b55973b67d/2021/06/27/8714e0197c67f862075aa552e30a7320.png" width="70%"><ul><li>æ‰§è¡Œ dubbo-admin\target ä¸‹çš„<code>dubbo-admin-0.0.1-SNAPSHOT.jar</code>ï¼Œã€æ³¨æ„ï¼š<code>zookeeper</code>çš„æœåŠ¡ä¸€å®šè¦æ‰“å¼€ï¼ã€‘</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar dubbo-admin-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œå®Œæ¯•ï¼Œæˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹ <code>http://localhost:7001/</code> ï¼Œ è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦è¾“å…¥ç™»å½•è´¦æˆ·å’Œå¯†ç ï¼Œæˆ‘ä»¬éƒ½æ˜¯é»˜è®¤çš„<code>root</code>-<code>root</code>ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@153e0700f9b306ef1155f2ccd150d1ff47228ea6/2021/06/27/b06a232a595ee2a9141361664b0f2f3f.png"></p><ul><li>ç™»å½•æˆåŠŸåï¼ŒæŸ¥çœ‹ç•Œé¢å¦‚ä¸Šæ‰€ç¤ºï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸ</li></ul><h1 id="é›†æˆDubbo-zookeeper"><a href="#é›†æˆDubbo-zookeeper" class="headerlink" title="é›†æˆDubbo + zookeeper"></a>é›†æˆDubbo + zookeeper</h1><h2 id="æ¡†æ¶æ­å»º"><a href="#æ¡†æ¶æ­å»º" class="headerlink" title="æ¡†æ¶æ­å»º"></a>æ¡†æ¶æ­å»º</h2><ul><li>å¯åŠ¨<code>zookeeper</code> ï¼</li><li>IDEAåˆ›å»ºä¸€ä¸ªç©ºMavené¡¹ç›®ï¼›</li><li>æ·»åŠ ä¸€ä¸ªSpringBootæ¨¡å—ï¼Œå®ç°æœåŠ¡æä¾›è€…ï¼š<code>provider-server</code> ï¼Œ é€‰æ‹©webä¾èµ–å³å¯</li><li>é¡¹ç›®åˆ›å»ºå®Œæ¯•ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªæœåŠ¡ï¼Œæ¯”å¦‚å–ç¥¨çš„æœåŠ¡ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzy.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TicketService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTicket</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzy.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TicketServiceImpl</span> <span class="keyword">implements</span> <span class="title">TicketService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTicket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ä¹°ç¥¨æœåŠ¡...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¾ç½®ç«¯å£</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">provider-server</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8001</span></span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼Œå®ç°æœåŠ¡æ¶ˆè´¹è€…ï¼š<code>consumer-server</code> ï¼Œ é€‰æ‹©webä¾èµ–å³å¯</li><li>é¡¹ç›®åˆ›å»ºå®Œæ¯•ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªæœåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·çš„æœåŠ¡ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzy.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æˆ‘ä»¬éœ€è¦å»æ‹¿å»æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¾ç½®ç«¯å£</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">consumer-server</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8002</span></span><br></pre></td></tr></table></figure><ul><li>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼ŒæœåŠ¡æä¾›è€…å°†æœåŠ¡æ³¨å…¥æ³¨å†Œä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹è€…å»æ³¨å†Œä¸­å¿ƒæ‹¿å–æ–¹æ³•æœåŠ¡æ‰§è¡Œã€‚å®ç°è¿œç¨‹è°ƒç”¨æ–¹æ³•</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@445f750dbca164cd1b94b469e12dca741a0109e3/2021/06/27/e1a3cb6a59b7cc5167f4ff8e2950055a.png"></p><h2 id="æœåŠ¡æä¾›è€…"><a href="#æœåŠ¡æä¾›è€…" class="headerlink" title="æœåŠ¡æä¾›è€…"></a>æœåŠ¡æä¾›è€…</h2><ul><li>å°†æœåŠ¡æä¾›è€…æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘ä»¬éœ€è¦æ•´åˆDubboå’Œzookeeperï¼Œæ‰€ä»¥éœ€è¦å¯¼åŒ…</li><li>æˆ‘ä»¬ä»dubboå®˜ç½‘è¿›å…¥githubï¼Œçœ‹ä¸‹æ–¹çš„å¸®åŠ©æ–‡æ¡£ï¼Œæ‰¾åˆ°<code>dubbo-springboot</code>ï¼Œæ‰¾åˆ°ä¾èµ–åŒ…</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Dubbo Spring Boot Starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br></pre></td></tr></table></figure><ul><li>zookeeperçš„åŒ…æˆ‘ä»¬å»mavenä»“åº“ä¸‹è½½ï¼Œ<code>zkclient</code>ï¼›</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.sgroschupf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ã€æ–°ç‰ˆçš„å‘ã€‘zookeeperåŠå…¶ä¾èµ–åŒ…ï¼Œè§£å†³æ—¥å¿—å†²çªï¼Œè¿˜éœ€è¦å‰”é™¤æ—¥å¿—ä¾èµ–ï¼›</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼•å…¥zookeeper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-framework<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-recipes<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--æ’é™¤è¿™ä¸ªslf4j-log4j12--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨springbooté…ç½®æ–‡ä»¶ä¸­é…ç½®dubboç›¸å…³å±æ€§ï¼</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">provider-server</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8001</span></span><br><span class="line"><span class="comment">#æ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line"><span class="meta">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br><span class="line"><span class="comment">#æ‰«ææŒ‡å®šåŒ…ä¸‹æœåŠ¡</span></span><br><span class="line"><span class="meta">dubbo.scan.base-packages</span>=<span class="string">com.lzy.service</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨serviceçš„å®ç°ç±»ä¸­é…ç½®æœåŠ¡æ³¨è§£ï¼Œå‘å¸ƒæœåŠ¡ï¼æ³¨æ„å¯¼åŒ…é—®é¢˜</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span> <span class="comment">//å¯ä»¥è¢«æ‰«æåˆ°ï¼Œåœ¨é¡¹ç›®ä¸€å¯åŠ¨å°±è‡ªåŠ¨æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">//æ”¾åœ¨å®¹å™¨ä¸­,ä¸€å¯åŠ¨å°±æ³¨å†Œåˆ°æœåŠ¡ä¸­å¿ƒ</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TicketServiceImpl</span> <span class="keyword">implements</span> <span class="title">TicketService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTicket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ä¹°ç¥¨æœåŠ¡...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é€»è¾‘ç†è§£ ï¼šåº”ç”¨å¯åŠ¨èµ·æ¥ï¼Œdubboå°±ä¼šæ‰«ææŒ‡å®šçš„åŒ…ä¸‹å¸¦æœ‰<code>@component</code>æ³¨è§£çš„æœåŠ¡ï¼Œå°†å®ƒå‘å¸ƒåœ¨æŒ‡å®šçš„æ³¨å†Œä¸­å¿ƒä¸­ï¼</li><li>æœåŠ¡æä¾›è€…é…ç½®å¥½åå¯åŠ¨é¡¹ç›®ï¼Œç¡®ä¿zookeeperå·²ç»å¯åŠ¨ï¼Œæ‰§è¡Œæ‰“åŒ…åçš„jar</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar dubbo-admin-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure><ul><li>è®¿é—®ä¸€ä¸‹ <code>http://localhost:7001/</code>ï¼Œè´¦å·å’Œå¯†ç é»˜è®¤<code>root</code>ï¼Œè¿›è¡ŒæŸ¥è¯¢æœåŠ¡æ˜¯å¦å·²ç»æ³¨å†ŒæˆåŠŸ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@fd6786153e636a9086bf286ccf14f72feb3c25ab/2021/06/27/7dcfe54b75ea8e00a41e98bcdd24fbd3.png"></p><h2 id="æœåŠ¡æ¶ˆè´¹è€…"><a href="#æœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="æœåŠ¡æ¶ˆè´¹è€…"></a>æœåŠ¡æ¶ˆè´¹è€…</h2><ul><li>å¯¼å…¥ä¾èµ–ï¼Œå’Œä¹‹å‰çš„ä¾èµ–ä¸€æ ·ï¼›</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--dubbo--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Dubbo Spring Boot Starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--zookeeper--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.sgroschupf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¼•å…¥zookeeper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-framework<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-recipes<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--æ’é™¤è¿™ä¸ªslf4j-log4j12--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é…ç½®å‚æ•°</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">consumer-server</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8002</span></span><br><span class="line"><span class="comment">#æ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line"><span class="meta">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br></pre></td></tr></table></figure><ul><li>æœ¬æ¥æ­£å¸¸æ­¥éª¤æ˜¯éœ€è¦å°†æœåŠ¡æä¾›è€…çš„æ¥å£æ‰“åŒ…ï¼Œç„¶åç”¨<code>pom</code>æ–‡ä»¶å¯¼å…¥ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ç®€å•çš„æ–¹å¼ï¼Œç›´æ¥å°†æœåŠ¡çš„æ¥å£æ‹¿è¿‡æ¥ï¼Œè·¯å¾„å¿…é¡»ä¿è¯æ­£ç¡®ï¼Œå³å’ŒæœåŠ¡æä¾›è€…ç›¸åŒï¼›åŠåœ¨<code>UserService</code>åŒçº§åˆ«ä¸‹åˆ›å»º<code>TicketService</code>ï¼Œéœ€è¦ä¸€ä¸ªæ¥å£å³å¯ï¼Œæ–¹æ³•ä¸ç”¨</li><li><strong>æ³¨æ„<code>TicketService</code>ä¸æ˜¯æœ¬åœ°çš„ï¼Œæ˜¯ä»è¿œç¨‹å¼•ç”¨çš„</strong></li><li>å®Œå–„æ¶ˆè´¹è€…çš„æœåŠ¡ç±»ï¼Œæ³¨æ„å¯¼åŒ…é—®é¢˜</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.dubbo.config.annotation.Reference;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span> <span class="comment">//æ³¨å…¥åˆ°å®¹å™¨ä¸­</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¿œç¨‹å¼•ç”¨æŒ‡å®šçš„æœåŠ¡ï¼Œä»–ä¼šæŒ‰ç…§å…¨ç±»åè¿›è¡ŒåŒ¹é…ï¼Œçœ‹è°ç»™æ³¨å†Œä¸­å¿ƒæ³¨å†Œäº†è¿™ä¸ªå…¨ç±»å</span></span><br><span class="line">    <span class="meta">@Reference</span></span><br><span class="line">    TicketService ticketService;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bugTicket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String ticket = ticketService.getTicket();</span><br><span class="line">        System.out.println(<span class="string">&quot;åœ¨æ³¨å†Œä¸­å¿ƒä¹°çš„:&quot;</span>+ticket);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ç±»ç¼–å†™ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConsumerServerApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        userService.bugTicket();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3d454893e4210fb8ae4d3bdf9349d7461a388c0e/2021/06/27/183adadcb39f89bf81aff3e4f2f25b63.png"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>å¼€å¯zookeeper</li><li>æ‰“å¼€dubbo-adminå®ç°ç›‘æ§ã€å¯ä»¥ä¸ç”¨åšã€‘</li><li>å¼€å¯æœåŠ¡è€…</li><li>æ¶ˆè´¹è€…æ¶ˆè´¹æµ‹è¯•ï¼Œç»“æœï¼š<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3d454893e4210fb8ae4d3bdf9349d7461a388c0e/2021/06/27/183adadcb39f89bf81aff3e4f2f25b63.png"></li><li>ç›‘æ§ä¸­å¿ƒ ï¼š<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@fd6786153e636a9086bf286ccf14f72feb3c25ab/2021/06/27/7dcfe54b75ea8e00a41e98bcdd24fbd3.png"></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Dubbo&quot;&gt;&lt;a href=&quot;#Dubbo&quot; class=&quot;headerlink&quot; title=&quot;Dubbo&quot;&gt;&lt;/a&gt;Dubbo&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Apache Dubbo&lt;/code&gt; |ËˆdÊŒbÉ™ÊŠ| æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="Dubbo" scheme="http://xiaoliblog.cn/tags/Dubbo/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒåˆ†å¸ƒå¼ç³»ç»Ÿç†è®ºåŠRPC</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot19.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot19.html</id>
    <published>2021-06-27T02:38:57.892Z</published>
    <updated>2021-06-27T03:35:15.292Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ†å¸ƒå¼ç†è®º"><a href="#åˆ†å¸ƒå¼ç†è®º" class="headerlink" title="åˆ†å¸ƒå¼ç†è®º"></a>åˆ†å¸ƒå¼ç†è®º</h1><h2 id="åˆ†å¸ƒå¼ç³»ç»Ÿ"><a href="#åˆ†å¸ƒå¼ç³»ç»Ÿ" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»Ÿ"></a>åˆ†å¸ƒå¼ç³»ç»Ÿ</h2><ul><li>åœ¨ã€Šåˆ†å¸ƒå¼ç³»ç»ŸåŸç†ä¸èŒƒå‹ã€‹ä¸€ä¹¦ä¸­æœ‰å¦‚ä¸‹å®šä¹‰ï¼š<strong>åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯è‹¥å¹²ç‹¬ç«‹è®¡ç®—æœºçš„é›†åˆï¼Œè¿™äº›è®¡ç®—æœºå¯¹äºç”¨æˆ·æ¥è¯´å°±åƒå•ä¸ªç›¸å…³ç³»ç»Ÿ</strong>ï¼›</li><li>åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ç”±ä¸€ç»„é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€ä¸ºäº†å®Œæˆå…±åŒçš„ä»»åŠ¡è€Œåè°ƒå·¥ä½œçš„è®¡ç®—æœºèŠ‚ç‚¹ç»„æˆçš„ç³»ç»Ÿã€‚åˆ†å¸ƒå¼ç³»ç»Ÿçš„å‡ºç°æ˜¯ä¸ºäº†ç”¨å»‰ä»·çš„ã€æ™®é€šçš„æœºå™¨å®Œæˆå•ä¸ªè®¡ç®—æœºæ— æ³•å®Œæˆçš„è®¡ç®—ã€å­˜å‚¨ä»»åŠ¡ã€‚å…¶ç›®çš„æ˜¯<strong>åˆ©ç”¨æ›´å¤šçš„æœºå™¨ï¼Œå¤„ç†æ›´å¤šçš„æ•°æ®</strong></li><li><strong>åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆdistributed systemï¼‰æ˜¯å»ºç«‹åœ¨ç½‘ç»œä¹‹ä¸Šçš„è½¯ä»¶ç³»ç»Ÿ</strong></li><li>é¦–å…ˆéœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œåªæœ‰å½“å•ä¸ªèŠ‚ç‚¹çš„å¤„ç†èƒ½åŠ›æ— æ³•æ»¡è¶³æ—¥ç›Šå¢é•¿çš„è®¡ç®—ã€å­˜å‚¨ä»»åŠ¡çš„æ—¶å€™ï¼Œä¸”ç¡¬ä»¶çš„æå‡ï¼ˆåŠ å†…å­˜ã€åŠ ç£ç›˜ã€ä½¿ç”¨æ›´å¥½çš„CPUï¼‰é«˜æ˜‚åˆ°å¾—ä¸å¿å¤±çš„æ—¶å€™ï¼Œåº”ç”¨ç¨‹åºä¹Ÿä¸èƒ½è¿›ä¸€æ­¥ä¼˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰éœ€è¦è€ƒè™‘åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</li><li>å› ä¸ºï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿè¦è§£å†³çš„é—®é¢˜æœ¬èº«å°±æ˜¯å’Œå•æœºç³»ç»Ÿä¸€æ ·çš„ï¼Œè€Œç”±äºåˆ†å¸ƒå¼ç³»ç»Ÿå¤šèŠ‚ç‚¹ã€é€šè¿‡ç½‘ç»œé€šä¿¡çš„æ‹“æ‰‘ç»“æ„ï¼Œä¼šå¼•å…¥å¾ˆå¤šå•æœºç³»ç»Ÿæ²¡æœ‰çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜åˆä¼šå¼•å…¥æ›´å¤šçš„æœºåˆ¶ã€åè®®ï¼Œå¸¦æ¥æ›´å¤šçš„é—®é¢˜ã€‚</li></ul><h2 id="Dubboæ–‡æ¡£"><a href="#Dubboæ–‡æ¡£" class="headerlink" title="Dubboæ–‡æ¡£"></a>Dubboæ–‡æ¡£</h2><ul><li>éšç€äº’è”ç½‘çš„å‘å±•ï¼Œç½‘ç«™åº”ç”¨çš„è§„æ¨¡ä¸æ–­æ‰©å¤§ï¼Œå¸¸è§„çš„å‚ç›´åº”ç”¨æ¶æ„å·²æ— æ³•åº”å¯¹ï¼Œåˆ†å¸ƒå¼æœåŠ¡æ¶æ„ä»¥åŠæµåŠ¨è®¡ç®—æ¶æ„åŠ¿åœ¨å¿…è¡Œï¼Œæ€¥éœ€ä¸€ä¸ªæ²»ç†ç³»ç»Ÿç¡®ä¿æ¶æ„æœ‰æ¡ä¸ç´Šçš„æ¼”è¿›ã€‚</li><li>åœ¨<a href="https://dubbo.apache.org/zh/">Dubbo</a>çš„å®˜ç½‘æ–‡æ¡£æœ‰è¿™æ ·ä¸€å¼ å›¾</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@02aa5603aadb91c30b24b7b56c808c05e2d6134c/2021/06/27/e92b62b69e2839872e6196ebdf1de6be.png"></p><h2 id="å•ä¸€åº”ç”¨æ¶æ„"><a href="#å•ä¸€åº”ç”¨æ¶æ„" class="headerlink" title="å•ä¸€åº”ç”¨æ¶æ„"></a>å•ä¸€åº”ç”¨æ¶æ„</h2><ul><li>å½“ç½‘ç«™æµé‡å¾ˆå°æ—¶ï¼Œåªéœ€ä¸€ä¸ªåº”ç”¨ï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œä»¥å‡å°‘éƒ¨ç½²èŠ‚ç‚¹å’Œæˆæœ¬ã€‚æ­¤æ—¶ï¼Œç”¨äºç®€åŒ–å¢åˆ æ”¹æŸ¥å·¥ä½œé‡çš„<strong>æ•°æ®è®¿é—®æ¡†æ¶</strong>(ORM)æ˜¯å…³é”®</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@c8737fddd49a260a1ee2ddaf7b17f81eb3a49118/2021/06/27/ff874bd9903c25dd7f4b3f32a1e187c5.png" width="70%"><ul><li>é€‚ç”¨äºå°å‹ç½‘ç«™ï¼Œå°å‹ç®¡ç†ç³»ç»Ÿï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åˆ°ä¸€ä¸ªåŠŸèƒ½é‡Œï¼Œç®€å•æ˜“ç”¨</li><li>ç¼ºç‚¹ï¼šæ€§èƒ½æ‰©å±•æ¯”è¾ƒéš¾ï¼ŒååŒå¼€å‘é—®é¢˜ï¼Œä¸åˆ©äºå‡çº§ç»´æŠ¤</li></ul><h2 id="å‚ç›´åº”ç”¨æ¶æ„"><a href="#å‚ç›´åº”ç”¨æ¶æ„" class="headerlink" title="å‚ç›´åº”ç”¨æ¶æ„"></a>å‚ç›´åº”ç”¨æ¶æ„</h2><ul><li>å½“è®¿é—®é‡é€æ¸å¢å¤§ï¼Œå•ä¸€åº”ç”¨å¢åŠ æœºå™¨å¸¦æ¥çš„åŠ é€Ÿåº¦è¶Šæ¥è¶Šå°ï¼Œå°†åº”ç”¨æ‹†æˆäº’ä¸ç›¸å¹²çš„å‡ ä¸ªåº”ç”¨ï¼Œä»¥æå‡æ•ˆç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºåŠ é€Ÿå‰ç«¯é¡µé¢å¼€å‘çš„<strong>Webæ¡†æ¶</strong>(MVC)æ˜¯å…³é”®ã€‚</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@73260bdcc37ad086fa9cafde7f33d7c926a01601/2021/06/27/9efef3c966c8c019e43fadd944eaa447.png" width="70%"><ul><li>é€šè¿‡åˆ‡åˆ†ä¸šåŠ¡æ¥å®ç°å„ä¸ªæ¨¡å—ç‹¬ç«‹éƒ¨ç½²ï¼Œé™ä½äº†ç»´æŠ¤å’Œéƒ¨ç½²çš„éš¾åº¦ï¼Œå›¢é˜Ÿå„å¸å…¶èŒæ›´æ˜“ç®¡ç†ï¼Œæ€§èƒ½æ‰©å±•ä¹Ÿæ›´æ–¹ä¾¿ï¼Œæ›´æœ‰é’ˆå¯¹æ€§ã€‚</li><li>ç¼ºç‚¹ï¼šå…¬ç”¨æ¨¡å—æ— æ³•é‡å¤åˆ©ç”¨ï¼Œå¼€å‘æ€§çš„æµªè´¹</li></ul><h2 id="åˆ†å¸ƒå¼æœåŠ¡æ¶æ„"><a href="#åˆ†å¸ƒå¼æœåŠ¡æ¶æ„" class="headerlink" title="åˆ†å¸ƒå¼æœåŠ¡æ¶æ„"></a>åˆ†å¸ƒå¼æœåŠ¡æ¶æ„</h2><ul><li>å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„<strong>åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶</strong>(RPC)æ˜¯å…³é”®ã€‚</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@138e08689609f8128f2b6b5a15f24b76e46ed01d/2021/06/27/54f2014385b061f640a6aeaa313550c7.png" width="70%"><h2 id="æµåŠ¨è®¡ç®—æ¶æ„"><a href="#æµåŠ¨è®¡ç®—æ¶æ„" class="headerlink" title="æµåŠ¨è®¡ç®—æ¶æ„"></a>æµåŠ¨è®¡ç®—æ¶æ„</h2><ul><li>å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚æ­¤æ—¶ï¼Œç”¨äº<strong>æé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ</strong>(SOA)[ Service Oriented Architecture]æ˜¯å…³é”®</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@5140ae57b0e7e95602e852bdd9f91b3a24abe6a7/2021/06/27/88ece782ddb13dae210dbe0128c0e19e.png" width="70%"><h1 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h1><h2 id="RPCç®€ä»‹"><a href="#RPCç®€ä»‹" class="headerlink" title="RPCç®€ä»‹"></a>RPCç®€ä»‹</h2><ul><li><p><code>RPC</code>ï¼ˆRemote Procedure Callï¼‰è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œä»–æ˜¯ä¸€ç§æŠ€æœ¯çš„æ€æƒ³ï¼Œè€Œä¸æ˜¯è§„èŒƒã€‚ç®€å•çš„ç†è§£æ˜¯ä¸€ä¸ªèŠ‚ç‚¹è¯·æ±‚å¦ä¸€ä¸ªèŠ‚ç‚¹æä¾›çš„æœåŠ¡</p></li><li><p>æœ¬åœ°è¿‡ç¨‹è°ƒç”¨ï¼šå¦‚æœéœ€è¦å°†æœ¬åœ°studentå¯¹è±¡çš„age+1ï¼Œå¯ä»¥å®ç°ä¸€ä¸ªaddAge()æ–¹æ³•ï¼Œå°†studentå¯¹è±¡ä¼ å…¥ï¼Œå¯¹å¹´é¾„è¿›è¡Œæ›´æ–°ä¹‹åè¿”å›å³å¯ï¼Œæœ¬åœ°æ–¹æ³•è°ƒç”¨çš„å‡½æ•°ä½“é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥æŒ‡å®šã€‚</p></li><li><p>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼šä¸Šè¿°æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœaddAge()è¿™ä¸ªæ–¹æ³•åœ¨æœåŠ¡ç«¯ï¼Œæ‰§è¡Œå‡½æ•°çš„å‡½æ•°ä½“åœ¨è¿œç¨‹æœºå™¨ä¸Šï¼Œå¦‚ä½•å‘Šè¯‰æœºå™¨éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿ</p><ul><li>é¦–å…ˆå®¢æˆ·ç«¯éœ€è¦å‘Šè¯‰æœåŠ¡å™¨ï¼Œéœ€è¦è°ƒç”¨çš„å‡½æ•°ï¼Œè¿™é‡Œå‡½æ•°å’Œè¿›ç¨‹IDå­˜åœ¨ä¸€ä¸ªæ˜ å°„ï¼Œå®¢æˆ·ç«¯è¿œç¨‹è°ƒç”¨æ—¶ï¼Œéœ€è¦æŸ¥ä¸€ä¸‹å‡½æ•°ï¼Œæ‰¾åˆ°å¯¹åº”çš„IDï¼Œç„¶åæ‰§è¡Œå‡½æ•°çš„ä»£ç ã€‚</li><li>å®¢æˆ·ç«¯éœ€è¦æŠŠæœ¬åœ°å‚æ•°ä¼ ç»™è¿œç¨‹å‡½æ•°ï¼Œæœ¬åœ°è°ƒç”¨çš„è¿‡ç¨‹ä¸­ï¼Œç›´æ¥å‹æ ˆå³å¯ï¼Œä½†æ˜¯åœ¨è¿œç¨‹è°ƒç”¨è¿‡ç¨‹ä¸­ä¸å†åŒä¸€ä¸ªå†…å­˜é‡Œï¼Œæ— æ³•ç›´æ¥ä¼ é€’å‡½æ•°çš„å‚æ•°ï¼Œå› æ­¤éœ€è¦å®¢æˆ·ç«¯æŠŠå‚æ•°è½¬æ¢æˆå­—èŠ‚æµï¼Œä¼ ç»™æœåŠ¡ç«¯ï¼Œç„¶åæœåŠ¡ç«¯å°†å­—èŠ‚æµè½¬æ¢æˆè‡ªèº«èƒ½è¯»å–çš„æ ¼å¼ï¼Œæ˜¯ä¸€ä¸ªåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚</li><li>æ•°æ®å‡†å¤‡å¥½äº†ä¹‹åï¼Œå¦‚ä½•è¿›è¡Œä¼ è¾“ï¼Ÿç½‘ç»œä¼ è¾“å±‚éœ€è¦æŠŠè°ƒç”¨çš„IDå’Œåºåˆ—åŒ–åçš„å‚æ•°ä¼ ç»™æœåŠ¡ç«¯ï¼Œç„¶åæŠŠè®¡ç®—å¥½çš„ç»“æœåºåˆ—åŒ–ä¼ ç»™å®¢æˆ·ç«¯ï¼Œå› æ­¤TCPå±‚å³å¯å®Œæˆä¸Šè¿°è¿‡ç¨‹ï¼ŒgRPCä¸­é‡‡ç”¨çš„æ˜¯HTTP2åè®®ã€‚</li></ul></li><li><p>æ¨èé˜…è¯»æ–‡ç« ï¼š<a href="https://developer.51cto.com/art/201906/597963.htm">https://developer.51cto.com/art/201906/597963.htm</a></p></li></ul><h2 id="RPCåŸºæœ¬åŸç†"><a href="#RPCåŸºæœ¬åŸç†" class="headerlink" title="RPCåŸºæœ¬åŸç†"></a>RPCåŸºæœ¬åŸç†</h2><div class="tip faa-horizontal animated">   <p>RPCä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼šé€šè®¯ï¼Œåºåˆ—åŒ–</p><p></p></div><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@d35cd0969ec278b198f26f608f305d41696a9036/2021/06/27/4b0fd760980c286fba2c7e6e93d5107d.png"></p><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@620587cd342b5cefc489522877a9b0552d28bb6d/2021/06/27/c0f85ae24f122191fdfc7892325c465b.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åˆ†å¸ƒå¼ç†è®º&quot;&gt;&lt;a href=&quot;#åˆ†å¸ƒå¼ç†è®º&quot; class=&quot;headerlink&quot; title=&quot;åˆ†å¸ƒå¼ç†è®º&quot;&gt;&lt;/a&gt;åˆ†å¸ƒå¼ç†è®º&lt;/h1&gt;&lt;h2 id=&quot;åˆ†å¸ƒå¼ç³»ç»Ÿ&quot;&gt;&lt;a href=&quot;#åˆ†å¸ƒå¼ç³»ç»Ÿ&quot; class=&quot;headerlink&quot; title=&quot;åˆ†å¸ƒå¼</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
</feed>
