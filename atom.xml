<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å°æåšå®¢</title>
  
  
  <link href="http://xiaoliblog.cn/atom.xml" rel="self"/>
  
  <link href="http://xiaoliblog.cn/"/>
  <updated>2021-06-27T14:42:19.253Z</updated>
  <id>http://xiaoliblog.cn/</id>
  
  <author>
    <name>å°æåšå®¢</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MybatisPlusğŸ¯MyBatisPlusæ’ä»¶æ‰©å±•</title>
    <link href="http://xiaoliblog.cn/page/MybatisPlus03.html"/>
    <id>http://xiaoliblog.cn/page/MybatisPlus03.html</id>
    <published>2021-06-27T13:51:24.596Z</published>
    <updated>2021-06-27T14:42:19.253Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ€§èƒ½åˆ†ææ’ä»¶"><a href="#æ€§èƒ½åˆ†ææ’ä»¶" class="headerlink" title="æ€§èƒ½åˆ†ææ’ä»¶"></a>æ€§èƒ½åˆ†ææ’ä»¶</h1><ul><li>MyBatisPlusæä¾›äº†æ€§èƒ½åˆ†ææ’ä»¶ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±åœæ­¢è¿è¡Œ!</li><li>é¦–å…ˆè®¾ç½®å¼€å‘ç¯å¢ƒ</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®å¼€å‘ç¯å¢ƒ</span></span><br><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">dev</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">// äº‹åŠ¡ç®¡ç†</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ä»£è¡¨ä¸ºé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ€§èƒ½åˆ†ææ’ä»¶</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Profile(&#123;&quot;dev&quot;,&quot;test&quot;&#125;)</span> <span class="comment">// è®¾ç½®dev test ç¯å¢ƒå¼€å¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PerformanceInterceptor <span class="title">performanceInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PerformanceInterceptor performanceInterceptor = <span class="keyword">new</span> PerformanceInterceptor();</span><br><span class="line">        performanceInterceptor.setMaxTime(<span class="number">1</span>); <span class="comment">//è®¾ç½®sqlæ‰§è¡Œçš„æœ€å¤§æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œè¶…è¿‡åˆ™ä¸æ‰§è¡Œ</span></span><br><span class="line">        performanceInterceptor.setFormat(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> performanceInterceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="comment">// ç»§æ‰¿äº†BaseMapper,æ‰€æœ‰çš„æ–¹æ³•éƒ½æ¥è‡ªBaseMapper,ä¹Ÿå¯ä»¥æ‰©å±•æ–¹æ³•</span></span><br><span class="line">   <span class="comment">// å‚æ•°æ˜¯ä¸€ä¸ªWrapperï¼Œæ¡ä»¶æ„é€ å™¨</span></span><br><span class="line">   List&lt;User&gt; users = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">   users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸€æ¡SQLä¸å¯èƒ½åªæ‰§è¡Œ1æ¯«ç§’ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@82ef4eb518b945a3a60741c03099ec3f016c92c2/2021/06/27/dd674a719c0922326ffbdaf4c3303e9f.png"></p><h1 id="æ¡ä»¶æ„é€ å™¨"><a href="#æ¡ä»¶æ„é€ å™¨" class="headerlink" title="æ¡ä»¶æ„é€ å™¨"></a>æ¡ä»¶æ„é€ å™¨</h1><ul><li>æˆ‘ä»¬å†™ä¸€äº›å¤æ‚çš„SQLå°±å¯ä»¥ä½¿ç”¨æ¡ä»¶æ„é€ å™¨æ›¿ä»£ã€‚å…·ä½“æŸ¥çœ‹<a href="https://mp.baomidou.com/guide/wrapper.html#abstractwrapper">å®˜ç½‘</a></li><li>æŸ¥è¯¢æ¡ä»¶ï¼šæŸ¥è¯¢nameå’Œé‚®ç®±ä¸ä¸ºç©ºï¼Œä¸”å¹´é¾„å¤§äº22çš„ç”¨æˆ·</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WrapperTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoad</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢nameå’Œé‚®ç®±ä¸ä¸ºç©ºï¼Œä¸”å¹´é¾„å¤§äº22çš„ç”¨æˆ·</span></span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        wrapper</span><br><span class="line">                .isNotNull(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">                .isNotNull(<span class="string">&quot;email&quot;</span>)</span><br><span class="line">                .ge(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;22&quot;</span>);</span><br><span class="line">        userMapper.selectList(wrapper).forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢ç»“æœé‡ç‚¹çœ‹SQLè¯­å¥</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@26eea7f8841bf0274e0482fe86ba5db01c98cc1e/2021/06/27/34d3b56aa6a41338099b1fbd087891a3.png"></p><ul><li>æŸ¥è¯¢æ¡ä»¶ï¼šç”¨æˆ·ånameä¸ºå¼ ä¸‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad1</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// æŸ¥è¯¢nameä¸ºå¼ ä¸‰</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   wrapper.eq(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   <span class="comment">// æŸ¥è¯¢ä¸€ä¸ªï¼ŒæŸ¥è¯¢å¤šä¸ªç”¨mapæˆ–list</span></span><br><span class="line">   User user = userMapper.selectOne(wrapper);</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢å¹´é¾„åœ¨20~30ä¹‹é—´çš„ç”¨æˆ·æ•°é‡</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad2</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// æŸ¥è¯¢å¹´é¾„åœ¨20~30ä¹‹é—´çš„ç”¨æˆ·æ•°é‡</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   wrapper.between(<span class="string">&quot;age&quot;</span>,<span class="number">20</span>,<span class="number">30</span>);</span><br><span class="line">   <span class="keyword">int</span> count = userMapper.selectCount(wrapper);</span><br><span class="line">   System.out.println(count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ¨¡ç³ŠæŸ¥è¯¢ï¼Œåå­—ä¸åŒ…å«æï¼Œé‚®ç®±ä»¥tå¼€å¤´ï¼Œå¹´é¾„ä»¥2ç»“å°¾</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad2</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// æ¨¡ç³ŠæŸ¥è¯¢ï¼Œåå­—ä¸åŒ…å«æï¼Œé‚®ç®±ä»¥tå¼€å¤´ï¼Œå¹´é¾„ä»¥2ç»“å°¾</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   <span class="comment">// likeLeft:%æ  likeRight:æ%</span></span><br><span class="line">   wrapper</span><br><span class="line">          .notLike(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;æ&quot;</span>)</span><br><span class="line">          .likeLeft(<span class="string">&quot;email&quot;</span>,<span class="string">&quot;t&quot;</span>)</span><br><span class="line">          .likeRight(<span class="string">&quot;age&quot;</span>,<span class="number">2</span>);</span><br><span class="line">   List&lt;Map&lt;String, Object&gt;&gt; maps = userMapper.selectMaps(wrapper);</span><br><span class="line">   maps.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å®ç°åµŒå¥—æŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad3</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// åµŒå¥—æŸ¥è¯¢</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   <span class="comment">// idåœ¨å­æŸ¥è¯¢ä¸­æŸ¥å‡ºæ¥</span></span><br><span class="line">   wrapper.inSql(<span class="string">&quot;id&quot;</span>,<span class="string">&quot;select id from user where id&lt;3&quot;</span>);</span><br><span class="line">   List&lt;Object&gt; objects = userMapper.selectObjs(wrapper);</span><br><span class="line">   objects.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿‡Idè¿›è¡Œæ’åº</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoad4</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// é€šè¿‡Idè¿›è¡Œæ’åº</span></span><br><span class="line">   QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">   <span class="comment">// idåœ¨å­æŸ¥è¯¢ä¸­æŸ¥å‡ºæ¥</span></span><br><span class="line">   wrapper.orderByDesc(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">   List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">   users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨"><a href="#ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨" class="headerlink" title="ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨"></a>ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨</h1><ul><li>ä½¿ç”¨ä»£ç è‡ªåŠ¨ç”Ÿå­˜æœŸï¼Œåˆ™daoã€pojoã€ serviceã€ controlleréƒ½ä¸éœ€è¦æ‰‹åŠ¨ç¼–å†™ï¼</li><li><code>AutoGenerator</code>æ˜¯MyBatis-Plusçš„ä»£ç ç”Ÿæˆå™¨ï¼Œé€šè¿‡AutoGeneratorå¯ä»¥å¿«é€Ÿç”ŸæˆEntityã€Mapperã€Mapper XMLã€Serviceã€Controllerç­‰å„ä¸ªæ¨¡å—çš„ä»£ç ,æå¤§çš„æå‡äº†å¼€å‘æ•ˆç‡ã€‚</li><li>æ³¨æ„ï¼šMyBatis-Plus çš„é»˜è®¤æ¨¡æ¿å¼•æ“æ˜¯ä½¿ç”¨ <code>Velocity</code>ï¼Œå¦‚æœä½ é€‰æ‹©äº†éé»˜è®¤å¼•æ“ï¼Œéœ€è¦åœ¨ AutoGenerator ä¸­ è®¾ç½®æ¨¡æ¿å¼•æ“</li><li>å¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨æµ‹è¯•åŒ…ä¸‹æ–°å»º<code>CodeGenerator</code>ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CodeGenerator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1ã€åˆ›å»ºä»£ç ç”Ÿæˆå™¨</span></span><br><span class="line">        AutoGenerator mpg = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€å…¨å±€é…ç½®</span></span><br><span class="line">        GlobalConfig gc = <span class="keyword">new</span> GlobalConfig();</span><br><span class="line">        String projectPath = System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line">        <span class="comment">// æ­¤å¤„å»ºè®®å†™é¡¹ç›®/src/main/javaæºä»£ç çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">        gc.setOutputDir(<span class="string">&quot;C:\\idea\\onlinedu-parent\\service\\service-edu&quot;</span> + <span class="string">&quot;/src/main/java&quot;</span>);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆæ³¨é‡Šæ—¶çš„ä½œè€…</span></span><br><span class="line">        gc.setAuthor(<span class="string">&quot;scorpios&quot;</span>);</span><br><span class="line">        <span class="comment">//ç”Ÿæˆåæ˜¯å¦æ‰“å¼€èµ„æºç®¡ç†å™¨</span></span><br><span class="line">        gc.setOpen(<span class="keyword">false</span>);</span><br><span class="line">        gc.setFileOverride(<span class="keyword">false</span>); <span class="comment">//é‡æ–°ç”Ÿæˆæ—¶æ–‡ä»¶æ˜¯å¦è¦†ç›–</span></span><br><span class="line">        gc.setServiceName(<span class="string">&quot;%sService&quot;</span>);<span class="comment">//å»æ‰Serviceæ¥å£çš„é¦–å­—æ¯I</span></span><br><span class="line">        gc.setIdType(IdType.ID_WORKER_STR); <span class="comment">//ä¸»é”®ç­–ç•¥</span></span><br><span class="line">        gc.setDateType(DateType.ONLY_DATE); <span class="comment">//å®šä¹‰ç”Ÿæˆçš„å®ä½“ç±»ä¸­æ—¥æœŸç±»å‹</span></span><br><span class="line">        <span class="comment">// å¦‚æœå¼€å¯Swagger,è¦å¼•å…¥ç›¸åº”çš„åŒ…</span></span><br><span class="line">        gc.setSwagger2(<span class="keyword">true</span>); <span class="comment">//å¼€å¯Swagger2æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€æ•°æ®æºé…ç½®</span></span><br><span class="line">        DataSourceConfig dsc = <span class="keyword">new</span> DataSourceConfig();</span><br><span class="line">        dsc.setUrl(<span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mybatis_plus?serverTimezone=GMT%2B8&quot;</span>);</span><br><span class="line">        dsc.setDriverName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dsc.setDbType(DbType.MYSQL);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4ã€åŒ…é…ç½®</span></span><br><span class="line">        PackageConfig pc = <span class="keyword">new</span> PackageConfig();</span><br><span class="line">        <span class="comment">// æ­¤å¤„è¦æ³¨æ„ï¼šparent + moduleName ä¸ºåŒ…çš„åå­—ï¼Œåœ¨è¿™ä¸ªåŒ…ä¸‹ï¼Œåˆ›å»ºå¯¹åº”çš„controller...</span></span><br><span class="line">        pc.setParent(<span class="string">&quot;com.scorpios&quot;</span>);</span><br><span class="line">        pc.setModuleName(<span class="string">&quot;eduservice&quot;</span>); <span class="comment">//æ¨¡å—å</span></span><br><span class="line">        pc.setController(<span class="string">&quot;controller&quot;</span>);</span><br><span class="line">        pc.setEntity(<span class="string">&quot;entity&quot;</span>);</span><br><span class="line">        pc.setService(<span class="string">&quot;service&quot;</span>);</span><br><span class="line">        pc.setMapper(<span class="string">&quot;mapper&quot;</span>);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5ã€ç­–ç•¥é…ç½®</span></span><br><span class="line">        StrategyConfig strategy = <span class="keyword">new</span> StrategyConfig();</span><br><span class="line">        <span class="comment">// æ•°æ®åº“ä¸­è¡¨çš„åå­—ï¼Œè¡¨ç¤ºè¦å¯¹å“ªäº›è¡¨è¿›è¡Œè‡ªåŠ¨ç”Ÿæˆcontroller serviceã€mapper...</span></span><br><span class="line">        strategy.setInclude(<span class="string">&quot;edu_course&quot;</span>,<span class="string">&quot;edu_course_description&quot;</span>,</span><br><span class="line">        <span class="string">&quot;edu_chapter&quot;</span>,<span class="string">&quot;edu_video&quot;</span>);</span><br><span class="line">        <span class="comment">// æ•°æ®åº“è¡¨æ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥,é©¼å³°å‘½åæ³•</span></span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆå®ä½“æ—¶å»æ‰è¡¨å‰ç¼€ï¼Œæ¯”å¦‚edu_courseï¼Œå¦‚æœä¸åŠ ä¸‹é¢è¿™å¥ï¼Œç”Ÿæˆçš„å®ä½“ç±»åå­—å°±æ˜¯ï¼šEduCourse</span></span><br><span class="line">        strategy.setTablePrefix(<span class="string">&quot;edu_&quot;</span>); </span><br><span class="line">        <span class="comment">//ç”Ÿæˆå®ä½“æ—¶å»æ‰è¡¨å‰ç¼€</span></span><br><span class="line"><span class="comment">// strategy.setTablePrefix(pc.getModuleName() + &quot;_&quot;); </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•°æ®åº“è¡¨å­—æ®µæ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥</span></span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setEntityLombokModel(<span class="keyword">true</span>); <span class="comment">// lombok æ¨¡å‹ @Accessors(chain = true) setteré“¾å¼æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">        strategy.setRestControllerStyle(<span class="keyword">true</span>); <span class="comment">//restful apié£æ ¼æ§åˆ¶å™¨</span></span><br><span class="line">        strategy.setControllerMappingHyphenStyle(<span class="keyword">true</span>); <span class="comment">//urlä¸­é©¼å³°è½¬è¿å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 6ã€æ‰§è¡Œ</span></span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ€§èƒ½åˆ†ææ’ä»¶&quot;&gt;&lt;a href=&quot;#æ€§èƒ½åˆ†ææ’ä»¶&quot; class=&quot;headerlink&quot; title=&quot;æ€§èƒ½åˆ†ææ’ä»¶&quot;&gt;&lt;/a&gt;æ€§èƒ½åˆ†ææ’ä»¶&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;MyBatisPlusæä¾›äº†æ€§èƒ½åˆ†ææ’ä»¶ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±åœæ­¢è¿è¡Œ!&lt;/li&gt;
&lt;li&gt;é¦–å…ˆè®¾</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/MybatisPlus/"/>
    
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/tags/MybatisPlus/"/>
    
  </entry>
  
  <entry>
    <title>MybatisPlusğŸ¯CRUDæ“ä½œæ‰©å±•</title>
    <link href="http://xiaoliblog.cn/page/MybatisPlus02.html"/>
    <id>http://xiaoliblog.cn/page/MybatisPlus02.html</id>
    <published>2021-06-27T12:16:35.858Z</published>
    <updated>2021-06-27T14:19:07.284Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ›´æ–°æ“ä½œ"><a href="#æ›´æ–°æ“ä½œ" class="headerlink" title="æ›´æ–°æ“ä½œ"></a>æ›´æ–°æ“ä½œ</h1><h2 id="æ›´æ–°æµ‹è¯•"><a href="#æ›´æ–°æµ‹è¯•" class="headerlink" title="æ›´æ–°æµ‹è¯•"></a>æ›´æ–°æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">   User user = <span class="keyword">new</span> User();</span><br><span class="line">   <span class="comment">// é€šè¿‡æ¡ä»¶è‡ªåŠ¨æ‹¼æ¥SQL</span></span><br><span class="line">   user.setId(<span class="number">1L</span>);</span><br><span class="line">   user.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   user.setAge(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;2312057536@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// updateByIdå‚æ•°ä¸ºå¯¹è±¡</span></span><br><span class="line">   <span class="keyword">int</span> update = userMapper.updateById(user);</span><br><span class="line">   System.out.println(update);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è‡ªåŠ¨å¡«å……"><a href="#è‡ªåŠ¨å¡«å……" class="headerlink" title="è‡ªåŠ¨å¡«å……"></a>è‡ªåŠ¨å¡«å……</h2><ul><li>åƒåˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´è¿™äº›æ“ä½œä¸€èˆ¬éƒ½æ˜¯è‡ªåŠ¨åŒ–å®Œæˆçš„ï¼Œä¸å¸Œæœ›æ‰‹åŠ¨æ›´æ–°ï¼</li><li>åœ¨é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œä¸­ï¼Œæ˜ç¡®è§„å®šå¿…é¡»æœ‰<code>gmt_create</code>å’Œ<code>gmt_modified</code>è¿™ä¸¤ä¸ªå­—æ®µï¼Œåˆ†åˆ«å¯¹åº”åˆ›å»ºæ—¶é—´å’Œä¿®æ”¹æ—¶é—´</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@8fcdd3107166a9852b0426f927ba2e982f23bae8/2021/06/27/99c4b9e25247f222a5f39ff7e40aac05.png"></p><ul><li>æ–¹å¼ä¸€æ˜¯<strong>æ•°æ®åº“çº§åˆ«</strong>ï¼Œåœ¨è¡¨ä¸­æ–°å¢å­—æ®µ<code>create_time</code>ã€<code>update_time</code>ï¼Œå¹¶å‹¾é€‰æ—¶é—´æˆ³æ›´æ–°å’Œé»˜è®¤ä¸ºå½“å‰æ—¶é—´æˆ³<code>CURRENT_TIMESTAMP</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@cda83e8afd83e0165a86608a1e2ca1871ea85657/2021/06/27/5767c41575f93389a34d28691bf8f215.png"></p><ul><li>å®ä½“ç±»å®Œå–„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Date createTime;</span><br><span class="line"><span class="keyword">private</span> Date updateTime;</span><br></pre></td></tr></table></figure><ul><li>å†æ‰§è¡Œä¸€æ¬¡æ›´æ–°æ“ä½œï¼Œç»“æœå¦‚ä¸‹</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@2cb8202dcba4f5fc2bbda4afa5db5607ca40bb58/2021/06/27/9dcc81d39b06d3b693447cdb259d190a.png"></p><ul><li>æ–¹å¼äºŒæ˜¯<strong>ä»£ç çº§åˆ«</strong>ï¼Œéœ€è¦åˆ é™¤æ•°æ®åº“é»˜è®¤å€¼å’Œæ›´æ–°æ—¶é—´æˆ³æ“ä½œ</li><li>å®ä½“ç±»å­—æ®µä¸Šéœ€è¦å¢åŠ æ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­—æ®µå¢åŠ å¡«å……å†…å®¹</span></span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.DEFAULT)</span></span><br><span class="line"><span class="keyword">private</span> Date createTime;</span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line"><span class="keyword">private</span> Date updateTime;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™å¤„ç†å™¨æ¥å¤„ç†æ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">// ä¸€å®šä¸è¦å¿˜è®°æŠŠå¤„ç†å™¨åŠ åˆ°IOCå®¹å™¨ä¸­ï¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ’å…¥æ—¶çš„å¡«å……ç­–ç•¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;start insert fill...&quot;</span>);</span><br><span class="line">        <span class="comment">// setFieldValByName(String fieldName, Object fieldVal, MetaObject metaObject)</span></span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;createTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ›´æ–°æ—¶çš„å¡«å……ç­–ç•¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;start update fill...&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹è§‚é”"><a href="#ä¹è§‚é”" class="headerlink" title="ä¹è§‚é”"></a>ä¹è§‚é”</h2><ul><li><p>ä¹è§‚é”ã€æ‚²è§‚é”å‚è€ƒï¼š<a href="https://www.jianshu.com/p/d2ac26ca6525">https://www.jianshu.com/p/d2ac26ca6525</a></p></li><li><p>ä¹è§‚é”ï¼šæ•…åæ€ä¹‰ååˆ†ä¹è§‚ï¼Œå®ƒæ€»æ˜¯è®¤ä¸ºä¸ä¼šå‡ºç°é—®é¢˜ï¼Œæ— è®ºå¹²ä»€ä¹ˆéƒ½ä¸å»ä¸Šé”ï¼å¦‚æœå‡ºç°äº†é—®é¢˜ï¼Œå†æ¬¡æ›´æ–°å€¼æµ‹è¯•</p></li><li><p>æ‚²è§‚é”ï¼šæ•…åæ€ä¹‰ååˆ†æ‚²è§‚ï¼Œå®ƒæ€»æ˜¯è®¤ä¸ºä¼šå‡ºç°é—®é¢˜ï¼Œæ— è®ºå¹²ä»€ä¹ˆéƒ½å»ä¸Šé”ï¼å†å»æ“ä½œ</p></li><li><p>ä¹è§‚é”å®ç°æ–¹å¼:</p><ul><li>æŸ¥è¯¢å–å‡ºè®°å½•æ—¶ï¼Œè·å–å½“å‰<code>version</code></li><li>æ›´æ–°æ—¶ï¼Œå¸¦ä¸Šè¿™ä¸ª<code>version</code></li><li>æ‰§è¡Œæ›´æ–°æ—¶ï¼Œ<code>set version = newVersion where version = oldVersion</code></li><li>å¦‚æœ<code>version</code>ä¸å¯¹ï¼Œå°±æ›´æ–°å¤±è´¥</li></ul></li><li><p>é¦–å…ˆç»™æ•°æ®åº“å¢åŠ <code>version</code>å­—æ®µï¼Œå¹¶è®¾ç½®é»˜è®¤å€¼ä¸º<code>1</code><br><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@2f497278d06427147c64bab8bb8c458138f57dc6/2021/06/27/a48cb7efe8b5d9098a94630fc62c543b.png"></p></li><li><p>å®ä½“ç±»åŠ å¯¹åº”å­—æ®µ</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Version</span> <span class="comment">// ä¹è§‚é”versionæ³¨è§£</span></span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure><ul><li>ç„¶åéœ€è¦æ’ä»¶é…ç½®ç±»æ³¨å†Œç»„ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">// äº‹åŠ¡ç®¡ç†</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ä»£è¡¨ä¸ºé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ³¨å†Œä¹è§‚é”æ’ä»¶</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> OptimisticLockerInterceptor <span class="title">optimisticLockerInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> OptimisticLockerInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ä¸€ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•ä¹è§‚é”æˆåŠŸæ¡ˆä¾‹</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// 1. æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">   User user = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">   <span class="comment">// 2. ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">   user.setName(<span class="string">&quot;ç‰›ä¸‰&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;2313123@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// 3. æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">   userMapper.updateById(user);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æµ‹è¯•ä¹è§‚é”å¤±è´¥æ¡ˆä¾‹,å¤šçº¿ç¨‹ä¸‹</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// çº¿ç¨‹1</span></span><br><span class="line">   User user = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">   user.setName(<span class="string">&quot;ç‰›ä¸‰&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;2313123@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// æ¨¡æ‹Ÿå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ’é˜Ÿæ“ä½œ</span></span><br><span class="line">   User user2 = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">   user.setName(<span class="string">&quot;ç‰›ä¸‰2&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;23131232@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">   <span class="comment">// å¯ä»¥ä½¿ç”¨è‡ªæ—‹é”æ¥å¤šæ¬¡å°è¯•æäº¤</span></span><br><span class="line">   userMapper.updateById(user); <span class="comment">// å¦‚æœæ²¡æœ‰ä¹è§‚é”å°±ä¼šè¦†ç›–æ’é˜Ÿçº¿ç¨‹çš„å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æŸ¥è¯¢æ“ä½œ"><a href="#æŸ¥è¯¢æ“ä½œ" class="headerlink" title="æŸ¥è¯¢æ“ä½œ"></a>æŸ¥è¯¢æ“ä½œ</h1><h2 id="æŸ¥è¯¢æµ‹è¯•"><a href="#æŸ¥è¯¢æµ‹è¯•" class="headerlink" title="æŸ¥è¯¢æµ‹è¯•"></a>æŸ¥è¯¢æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•æŸ¥è¯¢</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery</span><span class="params">()</span></span>&#123;</span><br><span class="line">   User user = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryByIDS</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// æ‰¹é‡IDæŸ¥è¯¢</span></span><br><span class="line">   List&lt;User&gt; users = userMapper.selectBatchIds(Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">   users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¡ä»¶æŸ¥è¯¢ Map</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelective</span><span class="params">()</span></span>&#123;</span><br><span class="line">   HashMap&lt;String,Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">   <span class="comment">// è‡ªå®šä¹‰æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">   hashMap.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   hashMap.put(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;3&quot;</span>);</span><br><span class="line">   List&lt;User&gt; users = userMapper.selectByMap(hashMap);</span><br><span class="line">   users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h2><ul><li>MyBatisPluså†…ç½®äº†åˆ†é¡µæ’ä»¶</li><li>é¦–å…ˆåœ¨é…ç½®ç±»ä¸­é…ç½®æ‹¦æˆªå™¨ç»„ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">// äº‹åŠ¡ç®¡ç†</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ä»£è¡¨ä¸ºé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç›´æ¥ç”¨<code>Page</code>å¯¹è±¡å³å¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPage</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// 1. å‚æ•°ä¸º:å½“å‰é¡µ,é¡µé¢å¤§å°</span></span><br><span class="line">   Page&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line">   userMapper.selectPage(page,<span class="keyword">null</span>);</span><br><span class="line">   page.getRecords().forEach(System.out::println);</span><br><span class="line">   System.out.println(<span class="string">&quot;æ€»æ•°:&quot;</span>+page.getTotal());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å…¶æœ¬è´¨è¿˜æ˜¯æ”¹å˜SQLè¯­å¥ä½¿ç”¨<code>limit</code>å®ç°</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@0a37fdd20f691d6ffc18f822fb39e562d67f8911/2021/06/27/63dff3a192c2d5261e9c1096ed6ce4d0.png"></p><h1 id="åˆ é™¤æ“ä½œ"><a href="#åˆ é™¤æ“ä½œ" class="headerlink" title="åˆ é™¤æ“ä½œ"></a>åˆ é™¤æ“ä½œ</h1><h2 id="åˆ é™¤æµ‹è¯•"><a href="#åˆ é™¤æµ‹è¯•" class="headerlink" title="åˆ é™¤æµ‹è¯•"></a>åˆ é™¤æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•åˆ é™¤</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testdelById</span><span class="params">()</span></span>&#123;</span><br><span class="line">   userMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰¹é‡åˆ é™¤</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelbatch</span><span class="params">()</span></span>&#123;</span><br><span class="line">   userMapper.deleteBatchIds(Arrays.asList(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¡ä»¶åˆ é™¤ Map</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelMap</span><span class="params">()</span></span>&#123;</span><br><span class="line">   HashMap&lt;String, Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">   hashMap.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   userMapper.deleteByMap(hashMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é€»è¾‘åˆ é™¤"><a href="#é€»è¾‘åˆ é™¤" class="headerlink" title="é€»è¾‘åˆ é™¤"></a>é€»è¾‘åˆ é™¤</h2><ul><li>ç‰©ç†åˆ é™¤ï¼šä»æ•°æ®åº“ä¸­ç›´æ¥ç§»é™¤</li><li>é€»è¾‘åˆ é™¤ï¼šåœ¨æ•°æ®åº“ä¸­æ²¡æœ‰è¢«åˆ é™¤ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªå˜é‡æ¥è®©ä»–å¤±æ•ˆã€‚é˜²æ­¢æ•°æ®çš„ä¸¢å¤±ï¼Œç±»ä¼¼å›æ”¶ç«™</li><li>åœ¨æ•°æ®è¡¨ä¸­æ·»åŠ ä¸€ä¸ª<code>deleted</code>å­—æ®µï¼Œé»˜è®¤ä¸º<code>0</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@16a5f05e99a0294fbdc3bced1ae3383091356cb0/2021/06/27/6212195cde7fcba1c1195b0dcfdf528c.png"></p><ul><li>å®ä½“ç±»å®Œå–„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableLogic</span>  <span class="comment">//é€»è¾‘åˆ é™¤</span></span><br><span class="line"><span class="keyword">private</span> Integer deleted;</span><br></pre></td></tr></table></figure><ul><li>åœ¨é…ç½®ç±»ä¸­é…ç½®é€»è¾‘åˆ é™¤ç»„ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">// äº‹åŠ¡ç®¡ç†</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ä»£è¡¨ä¸ºé…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é€»è¾‘æŸ¥è¯¢ç»„ä»¶</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ISqlInjector <span class="title">sqlInjector</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LogicSqlInjector();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç„¶ååœ¨<code>application.properties</code>ä¸­é…ç½®</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®é€»è¾‘åˆ é™¤ é»˜è®¤æœªåˆ é™¤ä¸º0,åˆ é™¤äº†ä¸º1</span></span><br><span class="line"><span class="meta">mybatis-plus.global-config.db-config.logic-delete-value</span>=<span class="string">1</span></span><br><span class="line"><span class="meta">mybatis-plus.global-config.db-config.logic-not-delete-value</span>=<span class="string">0</span></span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤æµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•åˆ é™¤</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testdelById</span><span class="params">()</span></span>&#123;</span><br><span class="line">   userMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬é»˜è®¤è®¾ç½®<code>deleted</code>å­—æ®µä¸º0ï¼Œå…¶æœ¬è´¨æ‰§è¡Œäº†æ›´æ–°æ“ä½œã€‚æŸ¥è¯¢çš„æ—¶å€™ä¼šè‡ªåŠ¨è¿‡æ»¤è¢«é€»è¾‘åˆ é™¤çš„å­—æ®µ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3c1efc4add3c6a0a3749e7c189e00f0a618d149b/2021/06/27/8f1fbe725e18c51f770f2270ea0ba302.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ›´æ–°æ“ä½œ&quot;&gt;&lt;a href=&quot;#æ›´æ–°æ“ä½œ&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°æ“ä½œ&quot;&gt;&lt;/a&gt;æ›´æ–°æ“ä½œ&lt;/h1&gt;&lt;h2 id=&quot;æ›´æ–°æµ‹è¯•&quot;&gt;&lt;a href=&quot;#æ›´æ–°æµ‹è¯•&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°æµ‹è¯•&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/MybatisPlus/"/>
    
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/tags/MybatisPlus/"/>
    
  </entry>
  
  <entry>
    <title>MybatisPlusğŸ¯æ—¥å¿—é…ç½®åŠä¸»é”®ç­–ç•¥</title>
    <link href="http://xiaoliblog.cn/page/MybatisPlus01.html"/>
    <id>http://xiaoliblog.cn/page/MybatisPlus01.html</id>
    <published>2021-06-27T10:06:42.465Z</published>
    <updated>2021-06-27T12:14:50.557Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MyBatisPlus"><a href="#MyBatisPlus" class="headerlink" title="MyBatisPlus"></a>MyBatisPlus</h1><h2 id="MyBatisPlusç®€ä»‹"><a href="#MyBatisPlusç®€ä»‹" class="headerlink" title="MyBatisPlusç®€ä»‹"></a>MyBatisPlusç®€ä»‹</h2><ul><li><code>MyBatis-Plus</code> (opens new window)ï¼ˆç®€ç§° MPï¼‰æ˜¯ä¸€ä¸ª MyBatis (opens new window)çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ MyBatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3a0d723c46f240cf5ef8123cf4cf0dba25c6ab1e/2021/06/27/94fba68ecf5a43056f9d825ae68d4549.png"></p><ul><li><strong>æ— ä¾µå…¥</strong>ï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¼•å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘</li><li><strong>æŸè€—å°</strong>ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬ CURDï¼Œæ€§èƒ½åŸºæœ¬æ— æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ</li><li><strong>å¼ºå¤§çš„ CRUD æ“ä½œ</strong>ï¼šå†…ç½®é€šç”¨ Mapperã€é€šç”¨ Serviceï¼Œä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ† CRUD æ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚</li><li><strong>æ”¯æŒ Lambda å½¢å¼è°ƒç”¨</strong>ï¼šé€šè¿‡ Lambda è¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™</li><li><strong>æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šæ”¯æŒå¤šè¾¾ 4 ç§ä¸»é”®ç­–ç•¥ï¼ˆå†…å«åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ - Sequenceï¼‰ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜</li><li><strong>æ”¯æŒ ActiveRecord æ¨¡å¼</strong>ï¼šæ”¯æŒ ActiveRecord å½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿ Model ç±»å³å¯è¿›è¡Œå¼ºå¤§çš„ CRUD æ“ä½œ</li><li><strong>æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œ</strong>ï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥ï¼ˆ Write once, use anywhere ï¼‰</li><li><strong>å†…ç½®ä»£ç ç”Ÿæˆå™¨</strong>ï¼šé‡‡ç”¨ä»£ç æˆ–è€… Maven æ’ä»¶å¯å¿«é€Ÿç”Ÿæˆ Mapper ã€ Model ã€ Service ã€ Controller å±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨</li><li><strong>å†…ç½®åˆ†é¡µæ’ä»¶</strong>ï¼šåŸºäº MyBatis ç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€š List æŸ¥è¯¢</li><li><strong>åˆ†é¡µæ’ä»¶æ”¯æŒå¤šç§æ•°æ®åº“</strong>ï¼šæ”¯æŒ MySQLã€MariaDBã€Oracleã€DB2ã€H2ã€HSQLã€SQLiteã€Postgreã€SQLServer ç­‰å¤šç§æ•°æ®åº“</li><li><strong>å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶</strong>ï¼šå¯è¾“å‡º Sql è¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢</li><li><strong>å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶</strong>ï¼šæä¾›å…¨è¡¨ delete ã€ update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ</li></ul><h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><ul><li>æ„å»ºæ•°æ®åº“</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@36e39ab8c43b8f4d5c8140b29b9419c985b89f70/2021/06/27/15e1d0e99870b71dbabb9d29782eb649.png"></p><ul><li>åˆ›å»ºSpringBooté¡¹ç›®ï¼Œå¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning simple"><p>ä½¿ç”¨MyBatis-Pluså¯ä»¥èŠ‚çœæˆ‘ä»¬å¤§é‡çš„ä»£ç ï¼Œå°½é‡ä¸ç”¨åŒæ—¶å¯¼å…¥MyBatiså’ŒMyBatis-Plusï¼Œé¿å…ä¾èµ–å†²çªé—®é¢˜</p></div><ul><li>è¿æ¥æ•°æ®åº“</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure><ul><li>é…ç½®å®ä½“ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™Mapperæ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span> <span class="comment">//ä»£è¡¨æŒä¹…å±‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// CRUDç¼–å†™å®Œæˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ Spring Boot å¯åŠ¨ç±»ä¸­æ·»åŠ <code> @MapperScan</code> æ³¨è§£ï¼Œæ‰«æ Mapper æ–‡ä»¶å¤¹ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.mapper&quot;)</span> <span class="comment">// æ‰«æmapperæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisDemo01Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(MybatisDemo01Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿›è¡Œå•å…ƒæµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MybatisDemo01ApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ç»§æ‰¿äº†BaseMapper,æ‰€æœ‰çš„æ–¹æ³•éƒ½æ¥è‡ªBaseMapper,ä¹Ÿå¯ä»¥æ‰©å±•æ–¹æ³•</span></span><br><span class="line">        <span class="comment">// å‚æ•°æ˜¯ä¸€ä¸ªWrapperï¼Œæ¡ä»¶æ„é€ å™¨</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@19135a41bd9ffd5981dc502e43a705d0a91b8dbd/2021/06/27/31d594ade53efa7c9b976e102533d9dc.png"></p><div class="note success simple"><p>é€šè¿‡ä»¥ä¸Šå‡ ä¸ªç®€å•çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°±å®ç°äº† User è¡¨çš„ CRUD åŠŸèƒ½ï¼Œç”šè‡³è¿ XML æ–‡ä»¶éƒ½ä¸ç”¨ç¼–å†™ï¼</p></div><h2 id="é…ç½®æ—¥å¿—"><a href="#é…ç½®æ—¥å¿—" class="headerlink" title="é…ç½®æ—¥å¿—"></a>é…ç½®æ—¥å¿—</h2><ul><li>MyBatis-Plusçš„SQLéƒ½æ˜¯ä¸å¯è§çš„ï¼Œæ‰€ä»¥é…ç½®æ—¥å¿—æ˜¯éå¸¸é‡è¦çš„</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®æ—¥å¿—</span></span><br><span class="line"><span class="meta">mybatis-plus.configuration.log-impl</span>=<span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@4504d0a5c0fe645fc8c9069ac540d9a0575c98d9/2021/06/27/b1079f36cd5c0853f045e7c133648822.png"></p><h1 id="ä¸»é”®ç­–ç•¥"><a href="#ä¸»é”®ç­–ç•¥" class="headerlink" title="ä¸»é”®ç­–ç•¥"></a>ä¸»é”®ç­–ç•¥</h1><h2 id="æµ‹è¯•æ’å…¥"><a href="#æµ‹è¯•æ’å…¥" class="headerlink" title="æµ‹è¯•æ’å…¥"></a>æµ‹è¯•æ’å…¥</h2><ul><li>æµ‹è¯•ä¸€ä¸‹æ’å…¥</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoads1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="comment">// æµ‹è¯•æ’å…¥</span></span><br><span class="line">   User user = <span class="keyword">new</span> User();</span><br><span class="line">   user.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">   user.setAge(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">   user.setEmail(<span class="string">&quot;2312057536@qq.com&quot;</span>);</span><br><span class="line">   <span class="comment">// ä¼šè‡ªåŠ¨ç”ŸæˆID</span></span><br><span class="line">   <span class="keyword">int</span> result = userMapper.insert(user);</span><br><span class="line">   System.out.println(result);</span><br><span class="line">   System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®åº“è®¾è®¡æ—¶å¹¶æ²¡æœ‰è®¾ç½®ä¸»é”®è‡ªå¢ï¼ŒMyBatisPlusè‡ªåŠ¨ä¸ºæˆ‘ä»¬å¡«å……äº†ID</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6d5004a59c891ea98affea6ba4deb83f434bb0a2/2021/06/27/9f8b41988ba4272a06e346435e5cddf4.png"></p><ul><li>é¦–å…ˆè¦äº†è§£ä¸€ä¸‹ä¸»é”®ç”Ÿæˆç­–ç•¥ï¼ˆUUIDã€è‡ªå¢IDã€é›ªèŠ±ç®—æ³•ã€Redisã€Zookeeperï¼‰</li></ul><h2 id="é›ªèŠ±ç®—æ³•"><a href="#é›ªèŠ±ç®—æ³•" class="headerlink" title="é›ªèŠ±ç®—æ³•"></a>é›ªèŠ±ç®—æ³•</h2><ul><li>åˆ†å¸ƒå¼ç³»ç»Ÿå”¯ä¸€IDç”Ÿæˆæ–¹æ¡ˆå‚è€ƒï¼š<a href="https://www.cnblogs.com/haoxinyue/p/5208136.html">https://www.cnblogs.com/haoxinyue/p/5208136.html</a></li><li><code>snowflake</code>æ˜¯Twitterå¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œç»“æœæ˜¯ä¸€ä¸ªlongå‹çš„IDã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šä½¿ç”¨41bitä½œä¸ºæ¯«ç§’æ•°ï¼Œ10bitä½œä¸ºæœºå™¨çš„IDï¼ˆ5ä¸ªbitæ˜¯æ•°æ®ä¸­å¿ƒï¼Œ5ä¸ªbitçš„æœºå™¨IDï¼‰ï¼Œ12bitä½œä¸ºæ¯«ç§’å†…çš„æµæ°´å·ï¼ˆæ„å‘³ç€æ¯ä¸ªèŠ‚ç‚¹åœ¨æ¯æ¯«ç§’å¯ä»¥äº§ç”Ÿ 4096 ä¸ª IDï¼‰ï¼Œæœ€åè¿˜æœ‰ä¸€ä¸ªç¬¦å·ä½ï¼Œæ°¸è¿œæ˜¯0ã€‚å¯ä»¥ä¿è¯å…¨çƒå”¯ä¸€ï¼</li><li>å…·ä½“å®ç°çš„ä»£ç å¯ä»¥å‚çœ‹<a href="https://github.com/twitter/snowflake">https://github.com/twitter/snowflake</a>ã€‚é›ªèŠ±ç®—æ³•æ”¯æŒçš„TPSå¯ä»¥è¾¾åˆ°419ä¸‡å·¦å³ï¼ˆ2^22*1000ï¼‰</li></ul><h2 id="ä¸»é”®ç­–ç•¥-1"><a href="#ä¸»é”®ç­–ç•¥-1" class="headerlink" title="ä¸»é”®ç­–ç•¥"></a>ä¸»é”®ç­–ç•¥</h2><ul><li>åœ¨å®ä½“ç±»ä¸Šé…ç½®ä¸»é”®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é»˜è®¤ID_WORKER å…¨å±€å”¯ä¸€ID</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.ID_WORKER)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹<code>IdType</code>çš„æºç å¦‚ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">IdType</span> </span>&#123;</span><br><span class="line">    AUTO(<span class="number">0</span>),  <span class="comment">// æ•°æ®åº“ä¸»é”®è‡ªå¢ï¼Œå‰ææ•°æ®åº“è®¾è®¡ä¸ºä¸»é”®è‡ªå¢</span></span><br><span class="line">    NONE(<span class="number">1</span>),  <span class="comment">//æœªè®¾ç½®ä¸»é”®</span></span><br><span class="line">    INPUT(<span class="number">2</span>),  <span class="comment">//æ‰‹åŠ¨è¾“å…¥</span></span><br><span class="line">    ID_WORKER(<span class="number">3</span>), <span class="comment">//é»˜è®¤çš„å…¨å±€å”¯ä¸€</span></span><br><span class="line">    UUID(<span class="number">4</span>),   <span class="comment">//å…¨å±€å”¯ä¸€id</span></span><br><span class="line">    ID_WORKER_STR(<span class="number">5</span>); <span class="comment">//ID_WORKERå­—ç¬¦ä¸²è¡¨ç¤ºæ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MyBatisPlus&quot;&gt;&lt;a href=&quot;#MyBatisPlus&quot; class=&quot;headerlink&quot; title=&quot;MyBatisPlus&quot;&gt;&lt;/a&gt;MyBatisPlus&lt;/h1&gt;&lt;h2 id=&quot;MyBatisPlusç®€ä»‹&quot;&gt;&lt;a href=&quot;#MyBa</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/MybatisPlus/"/>
    
    
    <category term="MybatisPlus" scheme="http://xiaoliblog.cn/tags/MybatisPlus/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒDubboå’ŒZookeeperé›†æˆ</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot20.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot20.html</id>
    <published>2021-06-27T03:40:27.377Z</published>
    <updated>2021-06-27T07:43:49.359Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Dubbo"><a href="#Dubbo" class="headerlink" title="Dubbo"></a>Dubbo</h1><ul><li><code>Apache Dubbo</code> |ËˆdÊŒbÉ™ÊŠ| æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava <code>RPC</code>æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼šé¢å‘æ¥å£çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæ™ºèƒ½å®¹é”™å’Œè´Ÿè½½å‡è¡¡ï¼Œä»¥åŠæœåŠ¡è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°ã€‚</li><li>dubboå®˜ç½‘ï¼š<a href="https://dubbo.apache.org/zh/">https://dubbo.apache.org/zh/</a></li></ul><h2 id="dubboåŸºæœ¬æ¦‚å¿µ"><a href="#dubboåŸºæœ¬æ¦‚å¿µ" class="headerlink" title="dubboåŸºæœ¬æ¦‚å¿µ"></a>dubboåŸºæœ¬æ¦‚å¿µ</h2><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@63f1a633096f3abb8a5d33a958d08496c7882bb6/2021/06/27/0d31799b7c1195ae6b9cefd232adaf2b.png"></p><ul><li><strong>æœåŠ¡æä¾›è€…</strong>ï¼ˆProviderï¼‰ï¼šæš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ï¼ŒæœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li><li><strong>æœåŠ¡æ¶ˆè´¹è€…</strong>ï¼ˆConsumerï¼‰ï¼šè°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ï¼ŒæœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</li><li><strong>æ³¨å†Œä¸­å¿ƒ</strong>ï¼ˆRegistryï¼‰ï¼šæ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…</li><li><strong>ç›‘æ§ä¸­å¿ƒ</strong>ï¼ˆMonitorï¼‰ï¼šæœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒ</li><li>è°ƒç”¨å…³ç³»è¯´æ˜<ul><li>æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</li><li>æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li><li>æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</li><li>æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚</li><li>æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</li><li>æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</li></ul></li></ul><h2 id="å®‰è£…zookeeper"><a href="#å®‰è£…zookeeper" class="headerlink" title="å®‰è£…zookeeper"></a>å®‰è£…zookeeper</h2><ul><li><p>Dubooå®˜æ–¹æ¨èæˆ‘ä»¬ä½¿ç”¨<code>Zookeeper</code>æ³¨å†Œä¸­å¿ƒã€‚ZooKeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œå¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡ï¼Œæ˜¯Googleçš„Chubbyä¸€ä¸ªå¼€æºçš„å®ç°ï¼Œæ˜¯Hadoopå’ŒHbaseçš„é‡è¦ç»„ä»¶ã€‚å®ƒæ˜¯ä¸€ä¸ªä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›ä¸€è‡´æ€§æœåŠ¡çš„è½¯ä»¶ï¼Œæä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼šé…ç½®ç»´æŠ¤ã€åŸŸåæœåŠ¡ã€åˆ†å¸ƒå¼åŒæ­¥ã€ç»„æœåŠ¡ç­‰</p></li><li><p>Zookeeperå®˜ç½‘ï¼š<a href="https://zookeeper.apache.org/">https://zookeeper.apache.org/</a></p></li><li><p>Zookepperä¸‹è½½åœ°å€ï¼š<a href="http://archive.apache.org/dist/zookeeper/">http://archive.apache.org/dist/zookeeper/</a></p></li><li><p>ä¸‹è½½å‹ç¼©åŒ…å¹¶è§£å‹ï¼Œ3.5ä»¥ä¸Šç‰ˆæœ¬è¦ä¸‹è½½å¸¦<code>bin</code>çš„æ–‡ä»¶ï¼Œæœ€å¥½æ˜¯åˆ›å»ºä¸€ä¸ª<code>Environment</code>æ–‡ä»¶å¤¹ä¸“é—¨æ”¾é…ç½®ç¯å¢ƒ<br><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@26a9cdcdb2b47d6c7903bfb60d4776849c64bfe1/2021/06/27/f65ce07cb9f044360d9c2aed81e7b4be.png"></p></li><li><p>è¿›å…¥è§£å‹åçš„æ–‡ä»¶é‡Œæ‰“å¼€<code>/bin/zkServer.cmd</code>ï¼Œåˆæ¬¡è¿è¡Œä¼šæŠ¥é”™ï¼Œæ²¡æœ‰<code>zoo.cfg</code>é…ç½®æ–‡ä»¶ï¼›</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@905019bd5a932781a671eeb845f3df58800c53da/2021/06/27/7197727347f540742ed9f2673e17a913.png"></p><ul><li>å½“å‡ºç°é—ªé€€é—®é¢˜æ‰¾ä¸åˆ°æŠ¥é”™æ—¶ï¼Œç¼–è¾‘<code>zkServer.cmd</code>æ–‡ä»¶æœ«å°¾æ·»åŠ <code>pause </code>ã€‚è¿™æ ·è¿è¡Œå‡ºé”™å°±ä¸ä¼šé€€å‡ºï¼Œä¼šæç¤ºé”™è¯¯ä¿¡æ¯ï¼Œæ–¹ä¾¿æ‰¾åˆ°åŸå› ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@1b3a30fad150f88bf6ee0cf9dfd40a5fba971809/2021/06/27/0e16926ddf34cfbaf57bc337a05a5a3c.png"></p><ul><li>å°†<code>conf</code>æ–‡ä»¶å¤¹ä¸‹é¢çš„<code>zoo_sample.cfg</code>å¤åˆ¶ä¸€ä»½æ”¹åä¸º<code>zoo.cfg</code>å³å¯<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@d22c24ec9aef05e246f15c919669f9f1f67e73ed/2021/06/27/7abae3eb2a4e7d18f818c8158e6ba8ae.png"></li><li>åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º<code>data</code>å’Œ<code>log</code>æ–‡ä»¶å¤¹ï¼Œä¿®æ”¹<code>zoo.cfg</code>ä¸­çš„å‚æ•°</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@8d369d64e0f7639406f0a01c38ff3565a3a181cd/2021/06/27/4cc132a970438d8cdcdbeab2220f90b1.png"></p><ul><li><p>ä¿®æ”¹å®Œæˆåå†æ¬¡å¯åŠ¨zookeeper<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@18c915aed2fd70a8fbbc7eb020e472dc80219777/2021/06/27/8ffb794058f8f76cb5715223f7162d26.png"></p></li><li><p>ä½¿ç”¨<code>bin</code>ç›®å½•ä¸‹çš„<code>zkCli.cmd</code>å®¢æˆ·ç«¯è¿›è¡Œæµ‹è¯•ï¼ŒåŒå‡»æ‰“å¼€å³å¯ã€‚è¿æ¥æˆåŠŸåï¼Œä½¿ç”¨<code>ls /</code>ï¼šåˆ—å‡ºzookeeperæ ¹ä¸‹ä¿å­˜çš„æ‰€æœ‰èŠ‚ç‚¹</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] ls /</span><br><span class="line">[zookeeper]</span><br></pre></td></tr></table></figure><ul><li>ä¹Ÿå¯ä»¥åˆ›å»ºåˆ›å»ºä¸€ä¸ªç»“ç‚¹ï¼Œæ¯”å¦‚åˆ›å»º<code>xiaoliblog</code>èŠ‚ç‚¹ï¼Œå€¼ä¸º<code>123</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 2] create â€“e /xiaoliblog 123</span><br><span class="line">Created /xiaoliblog</span><br></pre></td></tr></table></figure><ul><li>è·å–<code>/xiaoliblog</code>èŠ‚ç‚¹çš„å€¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@003d1b24087c4b6e869faf5f6625188db4ae54c7/2021/06/27/71e7362191fa5b2b7aea80b5457083fd.png"></p><h2 id="å®‰è£…dubbo-admin"><a href="#å®‰è£…dubbo-admin" class="headerlink" title="å®‰è£…dubbo-admin"></a>å®‰è£…dubbo-admin</h2><ul><li>dubboæœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæœåŠ¡è½¯ä»¶ã€‚å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ª<code>jar</code>åŒ…ï¼Œèƒ½å¤Ÿå¸®ä½ çš„javaç¨‹åºè¿æ¥åˆ°zookeeperï¼Œå¹¶åˆ©ç”¨zookeeperæ¶ˆè´¹ã€æä¾›æœåŠ¡ã€‚</li><li>ä½†æ˜¯ä¸ºäº†è®©ç”¨æˆ·æ›´å¥½çš„ç®¡ç†ç›‘æ§ä¼—å¤šçš„dubboæœåŠ¡ï¼Œå®˜æ–¹æä¾›äº†ä¸€ä¸ªå¯è§†åŒ–çš„ç›‘æ§ç¨‹åº<code>dubbo-admin</code>ï¼Œä¸è¿‡è¿™ä¸ªç›‘æ§å³ä½¿ä¸è£…ä¹Ÿä¸å½±å“ä½¿ç”¨</li><li>GitHubåœ°å€ï¼š<a href="https://github.com/apache/dubbo-admin/tree/master">https://github.com/apache/dubbo-admin/tree/master</a></li><li>æˆ–è€…æ‰¾ä¸€ä¸ªGiteeé“¾æ¥ï¼š<a href="https://gitee.com/xiaoliblog/dubbo-admin">https://gitee.com/xiaoliblog/dubbo-admin</a></li><li>ä¸‹è½½è§£å‹è¿›å…¥ç›®å½•ä¿®æ”¹ <code>dubbo-admin\src\main\resources \application.properties</code> æŒ‡å®šzookeeperåœ°å€</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">7001</span></span><br><span class="line"><span class="meta">spring.velocity.cache</span>=<span class="string">false</span></span><br><span class="line"><span class="meta">spring.velocity.charset</span>=<span class="string">UTF-8</span></span><br><span class="line"><span class="meta">spring.velocity.layout-url</span>=<span class="string">/templates/default.vm</span></span><br><span class="line"><span class="meta">spring.messages.fallback-to-system-locale</span>=<span class="string">false</span></span><br><span class="line"><span class="meta">spring.messages.basename</span>=<span class="string">i18n/message</span></span><br><span class="line"><span class="meta">spring.root.password</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.guest.password</span>=<span class="string">guest</span></span><br><span class="line"></span><br><span class="line"><span class="meta">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨è§£å‹åçš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œæ‰“åŒ…æ“ä½œã€‚ç¬¬ä¸€æ¬¡æ‰“åŒ…çš„è¿‡ç¨‹æœ‰ç‚¹æ…¢ï¼Œéœ€è¦è€å¿ƒç­‰å¾…ï¼ç›´åˆ°æˆåŠŸï¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -Dmaven.test.skip=<span class="literal">true</span></span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@ae00153d1369952cd9ba83d1a24ec5b55973b67d/2021/06/27/8714e0197c67f862075aa552e30a7320.png" width="70%"><ul><li>æ‰§è¡Œ dubbo-admin\target ä¸‹çš„<code>dubbo-admin-0.0.1-SNAPSHOT.jar</code>ï¼Œã€æ³¨æ„ï¼š<code>zookeeper</code>çš„æœåŠ¡ä¸€å®šè¦æ‰“å¼€ï¼ã€‘</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar dubbo-admin-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œå®Œæ¯•ï¼Œæˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹ <code>http://localhost:7001/</code> ï¼Œ è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦è¾“å…¥ç™»å½•è´¦æˆ·å’Œå¯†ç ï¼Œæˆ‘ä»¬éƒ½æ˜¯é»˜è®¤çš„<code>root</code>-<code>root</code>ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@153e0700f9b306ef1155f2ccd150d1ff47228ea6/2021/06/27/b06a232a595ee2a9141361664b0f2f3f.png"></p><ul><li>ç™»å½•æˆåŠŸåï¼ŒæŸ¥çœ‹ç•Œé¢å¦‚ä¸Šæ‰€ç¤ºï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸ</li></ul><h1 id="é›†æˆDubbo-zookeeper"><a href="#é›†æˆDubbo-zookeeper" class="headerlink" title="é›†æˆDubbo + zookeeper"></a>é›†æˆDubbo + zookeeper</h1><h2 id="æ¡†æ¶æ­å»º"><a href="#æ¡†æ¶æ­å»º" class="headerlink" title="æ¡†æ¶æ­å»º"></a>æ¡†æ¶æ­å»º</h2><ul><li>å¯åŠ¨<code>zookeeper</code> ï¼</li><li>IDEAåˆ›å»ºä¸€ä¸ªç©ºMavené¡¹ç›®ï¼›</li><li>æ·»åŠ ä¸€ä¸ªSpringBootæ¨¡å—ï¼Œå®ç°æœåŠ¡æä¾›è€…ï¼š<code>provider-server</code> ï¼Œ é€‰æ‹©webä¾èµ–å³å¯</li><li>é¡¹ç›®åˆ›å»ºå®Œæ¯•ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªæœåŠ¡ï¼Œæ¯”å¦‚å–ç¥¨çš„æœåŠ¡ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzy.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TicketService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTicket</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzy.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TicketServiceImpl</span> <span class="keyword">implements</span> <span class="title">TicketService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTicket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ä¹°ç¥¨æœåŠ¡...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¾ç½®ç«¯å£</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">provider-server</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8001</span></span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼Œå®ç°æœåŠ¡æ¶ˆè´¹è€…ï¼š<code>consumer-server</code> ï¼Œ é€‰æ‹©webä¾èµ–å³å¯</li><li>é¡¹ç›®åˆ›å»ºå®Œæ¯•ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªæœåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·çš„æœåŠ¡ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzy.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æˆ‘ä»¬éœ€è¦å»æ‹¿å»æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¾ç½®ç«¯å£</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">consumer-server</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8002</span></span><br></pre></td></tr></table></figure><ul><li>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼ŒæœåŠ¡æä¾›è€…å°†æœåŠ¡æ³¨å…¥æ³¨å†Œä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹è€…å»æ³¨å†Œä¸­å¿ƒæ‹¿å–æ–¹æ³•æœåŠ¡æ‰§è¡Œã€‚å®ç°è¿œç¨‹è°ƒç”¨æ–¹æ³•</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@445f750dbca164cd1b94b469e12dca741a0109e3/2021/06/27/e1a3cb6a59b7cc5167f4ff8e2950055a.png"></p><h2 id="æœåŠ¡æä¾›è€…"><a href="#æœåŠ¡æä¾›è€…" class="headerlink" title="æœåŠ¡æä¾›è€…"></a>æœåŠ¡æä¾›è€…</h2><ul><li>å°†æœåŠ¡æä¾›è€…æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘ä»¬éœ€è¦æ•´åˆDubboå’Œzookeeperï¼Œæ‰€ä»¥éœ€è¦å¯¼åŒ…</li><li>æˆ‘ä»¬ä»dubboå®˜ç½‘è¿›å…¥githubï¼Œçœ‹ä¸‹æ–¹çš„å¸®åŠ©æ–‡æ¡£ï¼Œæ‰¾åˆ°<code>dubbo-springboot</code>ï¼Œæ‰¾åˆ°ä¾èµ–åŒ…</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Dubbo Spring Boot Starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br></pre></td></tr></table></figure><ul><li>zookeeperçš„åŒ…æˆ‘ä»¬å»mavenä»“åº“ä¸‹è½½ï¼Œ<code>zkclient</code>ï¼›</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.sgroschupf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ã€æ–°ç‰ˆçš„å‘ã€‘zookeeperåŠå…¶ä¾èµ–åŒ…ï¼Œè§£å†³æ—¥å¿—å†²çªï¼Œè¿˜éœ€è¦å‰”é™¤æ—¥å¿—ä¾èµ–ï¼›</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼•å…¥zookeeper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-framework<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-recipes<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--æ’é™¤è¿™ä¸ªslf4j-log4j12--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨springbooté…ç½®æ–‡ä»¶ä¸­é…ç½®dubboç›¸å…³å±æ€§ï¼</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">provider-server</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8001</span></span><br><span class="line"><span class="comment">#æ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line"><span class="meta">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br><span class="line"><span class="comment">#æ‰«ææŒ‡å®šåŒ…ä¸‹æœåŠ¡</span></span><br><span class="line"><span class="meta">dubbo.scan.base-packages</span>=<span class="string">com.lzy.service</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨serviceçš„å®ç°ç±»ä¸­é…ç½®æœåŠ¡æ³¨è§£ï¼Œå‘å¸ƒæœåŠ¡ï¼æ³¨æ„å¯¼åŒ…é—®é¢˜</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span> <span class="comment">//å¯ä»¥è¢«æ‰«æåˆ°ï¼Œåœ¨é¡¹ç›®ä¸€å¯åŠ¨å°±è‡ªåŠ¨æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">//æ”¾åœ¨å®¹å™¨ä¸­,ä¸€å¯åŠ¨å°±æ³¨å†Œåˆ°æœåŠ¡ä¸­å¿ƒ</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TicketServiceImpl</span> <span class="keyword">implements</span> <span class="title">TicketService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTicket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ä¹°ç¥¨æœåŠ¡...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é€»è¾‘ç†è§£ ï¼šåº”ç”¨å¯åŠ¨èµ·æ¥ï¼Œdubboå°±ä¼šæ‰«ææŒ‡å®šçš„åŒ…ä¸‹å¸¦æœ‰<code>@component</code>æ³¨è§£çš„æœåŠ¡ï¼Œå°†å®ƒå‘å¸ƒåœ¨æŒ‡å®šçš„æ³¨å†Œä¸­å¿ƒä¸­ï¼</li><li>æœåŠ¡æä¾›è€…é…ç½®å¥½åå¯åŠ¨é¡¹ç›®ï¼Œç¡®ä¿zookeeperå·²ç»å¯åŠ¨ï¼Œæ‰§è¡Œæ‰“åŒ…åçš„jar</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar dubbo-admin-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure><ul><li>è®¿é—®ä¸€ä¸‹ <code>http://localhost:7001/</code>ï¼Œè´¦å·å’Œå¯†ç é»˜è®¤<code>root</code>ï¼Œè¿›è¡ŒæŸ¥è¯¢æœåŠ¡æ˜¯å¦å·²ç»æ³¨å†ŒæˆåŠŸ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@fd6786153e636a9086bf286ccf14f72feb3c25ab/2021/06/27/7dcfe54b75ea8e00a41e98bcdd24fbd3.png"></p><h2 id="æœåŠ¡æ¶ˆè´¹è€…"><a href="#æœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="æœåŠ¡æ¶ˆè´¹è€…"></a>æœåŠ¡æ¶ˆè´¹è€…</h2><ul><li>å¯¼å…¥ä¾èµ–ï¼Œå’Œä¹‹å‰çš„ä¾èµ–ä¸€æ ·ï¼›</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--dubbo--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Dubbo Spring Boot Starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--zookeeper--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.sgroschupf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¼•å…¥zookeeper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-framework<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-recipes<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--æ’é™¤è¿™ä¸ªslf4j-log4j12--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é…ç½®å‚æ•°</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">consumer-server</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8002</span></span><br><span class="line"><span class="comment">#æ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line"><span class="meta">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br></pre></td></tr></table></figure><ul><li>æœ¬æ¥æ­£å¸¸æ­¥éª¤æ˜¯éœ€è¦å°†æœåŠ¡æä¾›è€…çš„æ¥å£æ‰“åŒ…ï¼Œç„¶åç”¨<code>pom</code>æ–‡ä»¶å¯¼å…¥ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ç®€å•çš„æ–¹å¼ï¼Œç›´æ¥å°†æœåŠ¡çš„æ¥å£æ‹¿è¿‡æ¥ï¼Œè·¯å¾„å¿…é¡»ä¿è¯æ­£ç¡®ï¼Œå³å’ŒæœåŠ¡æä¾›è€…ç›¸åŒï¼›åŠåœ¨<code>UserService</code>åŒçº§åˆ«ä¸‹åˆ›å»º<code>TicketService</code>ï¼Œéœ€è¦ä¸€ä¸ªæ¥å£å³å¯ï¼Œæ–¹æ³•ä¸ç”¨</li><li><strong>æ³¨æ„<code>TicketService</code>ä¸æ˜¯æœ¬åœ°çš„ï¼Œæ˜¯ä»è¿œç¨‹å¼•ç”¨çš„</strong></li><li>å®Œå–„æ¶ˆè´¹è€…çš„æœåŠ¡ç±»ï¼Œæ³¨æ„å¯¼åŒ…é—®é¢˜</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.dubbo.config.annotation.Reference;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span> <span class="comment">//æ³¨å…¥åˆ°å®¹å™¨ä¸­</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¿œç¨‹å¼•ç”¨æŒ‡å®šçš„æœåŠ¡ï¼Œä»–ä¼šæŒ‰ç…§å…¨ç±»åè¿›è¡ŒåŒ¹é…ï¼Œçœ‹è°ç»™æ³¨å†Œä¸­å¿ƒæ³¨å†Œäº†è¿™ä¸ªå…¨ç±»å</span></span><br><span class="line">    <span class="meta">@Reference</span></span><br><span class="line">    TicketService ticketService;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bugTicket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String ticket = ticketService.getTicket();</span><br><span class="line">        System.out.println(<span class="string">&quot;åœ¨æ³¨å†Œä¸­å¿ƒä¹°çš„:&quot;</span>+ticket);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ç±»ç¼–å†™ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConsumerServerApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        userService.bugTicket();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3d454893e4210fb8ae4d3bdf9349d7461a388c0e/2021/06/27/183adadcb39f89bf81aff3e4f2f25b63.png"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>å¼€å¯zookeeper</li><li>æ‰“å¼€dubbo-adminå®ç°ç›‘æ§ã€å¯ä»¥ä¸ç”¨åšã€‘</li><li>å¼€å¯æœåŠ¡è€…</li><li>æ¶ˆè´¹è€…æ¶ˆè´¹æµ‹è¯•ï¼Œç»“æœï¼š<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3d454893e4210fb8ae4d3bdf9349d7461a388c0e/2021/06/27/183adadcb39f89bf81aff3e4f2f25b63.png"></li><li>ç›‘æ§ä¸­å¿ƒ ï¼š<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@fd6786153e636a9086bf286ccf14f72feb3c25ab/2021/06/27/7dcfe54b75ea8e00a41e98bcdd24fbd3.png"></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Dubbo&quot;&gt;&lt;a href=&quot;#Dubbo&quot; class=&quot;headerlink&quot; title=&quot;Dubbo&quot;&gt;&lt;/a&gt;Dubbo&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Apache Dubbo&lt;/code&gt; |ËˆdÊŒbÉ™ÊŠ| æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="Dubbo" scheme="http://xiaoliblog.cn/tags/Dubbo/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒåˆ†å¸ƒå¼ç³»ç»Ÿç†è®ºåŠRPC</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot19.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot19.html</id>
    <published>2021-06-27T02:38:57.892Z</published>
    <updated>2021-06-27T03:35:15.292Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ†å¸ƒå¼ç†è®º"><a href="#åˆ†å¸ƒå¼ç†è®º" class="headerlink" title="åˆ†å¸ƒå¼ç†è®º"></a>åˆ†å¸ƒå¼ç†è®º</h1><h2 id="åˆ†å¸ƒå¼ç³»ç»Ÿ"><a href="#åˆ†å¸ƒå¼ç³»ç»Ÿ" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»Ÿ"></a>åˆ†å¸ƒå¼ç³»ç»Ÿ</h2><ul><li>åœ¨ã€Šåˆ†å¸ƒå¼ç³»ç»ŸåŸç†ä¸èŒƒå‹ã€‹ä¸€ä¹¦ä¸­æœ‰å¦‚ä¸‹å®šä¹‰ï¼š<strong>åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯è‹¥å¹²ç‹¬ç«‹è®¡ç®—æœºçš„é›†åˆï¼Œè¿™äº›è®¡ç®—æœºå¯¹äºç”¨æˆ·æ¥è¯´å°±åƒå•ä¸ªç›¸å…³ç³»ç»Ÿ</strong>ï¼›</li><li>åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ç”±ä¸€ç»„é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€ä¸ºäº†å®Œæˆå…±åŒçš„ä»»åŠ¡è€Œåè°ƒå·¥ä½œçš„è®¡ç®—æœºèŠ‚ç‚¹ç»„æˆçš„ç³»ç»Ÿã€‚åˆ†å¸ƒå¼ç³»ç»Ÿçš„å‡ºç°æ˜¯ä¸ºäº†ç”¨å»‰ä»·çš„ã€æ™®é€šçš„æœºå™¨å®Œæˆå•ä¸ªè®¡ç®—æœºæ— æ³•å®Œæˆçš„è®¡ç®—ã€å­˜å‚¨ä»»åŠ¡ã€‚å…¶ç›®çš„æ˜¯<strong>åˆ©ç”¨æ›´å¤šçš„æœºå™¨ï¼Œå¤„ç†æ›´å¤šçš„æ•°æ®</strong></li><li><strong>åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆdistributed systemï¼‰æ˜¯å»ºç«‹åœ¨ç½‘ç»œä¹‹ä¸Šçš„è½¯ä»¶ç³»ç»Ÿ</strong></li><li>é¦–å…ˆéœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œåªæœ‰å½“å•ä¸ªèŠ‚ç‚¹çš„å¤„ç†èƒ½åŠ›æ— æ³•æ»¡è¶³æ—¥ç›Šå¢é•¿çš„è®¡ç®—ã€å­˜å‚¨ä»»åŠ¡çš„æ—¶å€™ï¼Œä¸”ç¡¬ä»¶çš„æå‡ï¼ˆåŠ å†…å­˜ã€åŠ ç£ç›˜ã€ä½¿ç”¨æ›´å¥½çš„CPUï¼‰é«˜æ˜‚åˆ°å¾—ä¸å¿å¤±çš„æ—¶å€™ï¼Œåº”ç”¨ç¨‹åºä¹Ÿä¸èƒ½è¿›ä¸€æ­¥ä¼˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰éœ€è¦è€ƒè™‘åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</li><li>å› ä¸ºï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿè¦è§£å†³çš„é—®é¢˜æœ¬èº«å°±æ˜¯å’Œå•æœºç³»ç»Ÿä¸€æ ·çš„ï¼Œè€Œç”±äºåˆ†å¸ƒå¼ç³»ç»Ÿå¤šèŠ‚ç‚¹ã€é€šè¿‡ç½‘ç»œé€šä¿¡çš„æ‹“æ‰‘ç»“æ„ï¼Œä¼šå¼•å…¥å¾ˆå¤šå•æœºç³»ç»Ÿæ²¡æœ‰çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜åˆä¼šå¼•å…¥æ›´å¤šçš„æœºåˆ¶ã€åè®®ï¼Œå¸¦æ¥æ›´å¤šçš„é—®é¢˜ã€‚</li></ul><h2 id="Dubboæ–‡æ¡£"><a href="#Dubboæ–‡æ¡£" class="headerlink" title="Dubboæ–‡æ¡£"></a>Dubboæ–‡æ¡£</h2><ul><li>éšç€äº’è”ç½‘çš„å‘å±•ï¼Œç½‘ç«™åº”ç”¨çš„è§„æ¨¡ä¸æ–­æ‰©å¤§ï¼Œå¸¸è§„çš„å‚ç›´åº”ç”¨æ¶æ„å·²æ— æ³•åº”å¯¹ï¼Œåˆ†å¸ƒå¼æœåŠ¡æ¶æ„ä»¥åŠæµåŠ¨è®¡ç®—æ¶æ„åŠ¿åœ¨å¿…è¡Œï¼Œæ€¥éœ€ä¸€ä¸ªæ²»ç†ç³»ç»Ÿç¡®ä¿æ¶æ„æœ‰æ¡ä¸ç´Šçš„æ¼”è¿›ã€‚</li><li>åœ¨<a href="https://dubbo.apache.org/zh/">Dubbo</a>çš„å®˜ç½‘æ–‡æ¡£æœ‰è¿™æ ·ä¸€å¼ å›¾</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@02aa5603aadb91c30b24b7b56c808c05e2d6134c/2021/06/27/e92b62b69e2839872e6196ebdf1de6be.png"></p><h2 id="å•ä¸€åº”ç”¨æ¶æ„"><a href="#å•ä¸€åº”ç”¨æ¶æ„" class="headerlink" title="å•ä¸€åº”ç”¨æ¶æ„"></a>å•ä¸€åº”ç”¨æ¶æ„</h2><ul><li>å½“ç½‘ç«™æµé‡å¾ˆå°æ—¶ï¼Œåªéœ€ä¸€ä¸ªåº”ç”¨ï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œä»¥å‡å°‘éƒ¨ç½²èŠ‚ç‚¹å’Œæˆæœ¬ã€‚æ­¤æ—¶ï¼Œç”¨äºç®€åŒ–å¢åˆ æ”¹æŸ¥å·¥ä½œé‡çš„<strong>æ•°æ®è®¿é—®æ¡†æ¶</strong>(ORM)æ˜¯å…³é”®</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@c8737fddd49a260a1ee2ddaf7b17f81eb3a49118/2021/06/27/ff874bd9903c25dd7f4b3f32a1e187c5.png" width="70%"><ul><li>é€‚ç”¨äºå°å‹ç½‘ç«™ï¼Œå°å‹ç®¡ç†ç³»ç»Ÿï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åˆ°ä¸€ä¸ªåŠŸèƒ½é‡Œï¼Œç®€å•æ˜“ç”¨</li><li>ç¼ºç‚¹ï¼šæ€§èƒ½æ‰©å±•æ¯”è¾ƒéš¾ï¼ŒååŒå¼€å‘é—®é¢˜ï¼Œä¸åˆ©äºå‡çº§ç»´æŠ¤</li></ul><h2 id="å‚ç›´åº”ç”¨æ¶æ„"><a href="#å‚ç›´åº”ç”¨æ¶æ„" class="headerlink" title="å‚ç›´åº”ç”¨æ¶æ„"></a>å‚ç›´åº”ç”¨æ¶æ„</h2><ul><li>å½“è®¿é—®é‡é€æ¸å¢å¤§ï¼Œå•ä¸€åº”ç”¨å¢åŠ æœºå™¨å¸¦æ¥çš„åŠ é€Ÿåº¦è¶Šæ¥è¶Šå°ï¼Œå°†åº”ç”¨æ‹†æˆäº’ä¸ç›¸å¹²çš„å‡ ä¸ªåº”ç”¨ï¼Œä»¥æå‡æ•ˆç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºåŠ é€Ÿå‰ç«¯é¡µé¢å¼€å‘çš„<strong>Webæ¡†æ¶</strong>(MVC)æ˜¯å…³é”®ã€‚</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@73260bdcc37ad086fa9cafde7f33d7c926a01601/2021/06/27/9efef3c966c8c019e43fadd944eaa447.png" width="70%"><ul><li>é€šè¿‡åˆ‡åˆ†ä¸šåŠ¡æ¥å®ç°å„ä¸ªæ¨¡å—ç‹¬ç«‹éƒ¨ç½²ï¼Œé™ä½äº†ç»´æŠ¤å’Œéƒ¨ç½²çš„éš¾åº¦ï¼Œå›¢é˜Ÿå„å¸å…¶èŒæ›´æ˜“ç®¡ç†ï¼Œæ€§èƒ½æ‰©å±•ä¹Ÿæ›´æ–¹ä¾¿ï¼Œæ›´æœ‰é’ˆå¯¹æ€§ã€‚</li><li>ç¼ºç‚¹ï¼šå…¬ç”¨æ¨¡å—æ— æ³•é‡å¤åˆ©ç”¨ï¼Œå¼€å‘æ€§çš„æµªè´¹</li></ul><h2 id="åˆ†å¸ƒå¼æœåŠ¡æ¶æ„"><a href="#åˆ†å¸ƒå¼æœåŠ¡æ¶æ„" class="headerlink" title="åˆ†å¸ƒå¼æœåŠ¡æ¶æ„"></a>åˆ†å¸ƒå¼æœåŠ¡æ¶æ„</h2><ul><li>å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„<strong>åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶</strong>(RPC)æ˜¯å…³é”®ã€‚</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@138e08689609f8128f2b6b5a15f24b76e46ed01d/2021/06/27/54f2014385b061f640a6aeaa313550c7.png" width="70%"><h2 id="æµåŠ¨è®¡ç®—æ¶æ„"><a href="#æµåŠ¨è®¡ç®—æ¶æ„" class="headerlink" title="æµåŠ¨è®¡ç®—æ¶æ„"></a>æµåŠ¨è®¡ç®—æ¶æ„</h2><ul><li>å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚æ­¤æ—¶ï¼Œç”¨äº<strong>æé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ</strong>(SOA)[ Service Oriented Architecture]æ˜¯å…³é”®</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@5140ae57b0e7e95602e852bdd9f91b3a24abe6a7/2021/06/27/88ece782ddb13dae210dbe0128c0e19e.png" width="70%"><h1 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h1><h2 id="RPCç®€ä»‹"><a href="#RPCç®€ä»‹" class="headerlink" title="RPCç®€ä»‹"></a>RPCç®€ä»‹</h2><ul><li><p><code>RPC</code>ï¼ˆRemote Procedure Callï¼‰è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œä»–æ˜¯ä¸€ç§æŠ€æœ¯çš„æ€æƒ³ï¼Œè€Œä¸æ˜¯è§„èŒƒã€‚ç®€å•çš„ç†è§£æ˜¯ä¸€ä¸ªèŠ‚ç‚¹è¯·æ±‚å¦ä¸€ä¸ªèŠ‚ç‚¹æä¾›çš„æœåŠ¡</p></li><li><p>æœ¬åœ°è¿‡ç¨‹è°ƒç”¨ï¼šå¦‚æœéœ€è¦å°†æœ¬åœ°studentå¯¹è±¡çš„age+1ï¼Œå¯ä»¥å®ç°ä¸€ä¸ªaddAge()æ–¹æ³•ï¼Œå°†studentå¯¹è±¡ä¼ å…¥ï¼Œå¯¹å¹´é¾„è¿›è¡Œæ›´æ–°ä¹‹åè¿”å›å³å¯ï¼Œæœ¬åœ°æ–¹æ³•è°ƒç”¨çš„å‡½æ•°ä½“é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥æŒ‡å®šã€‚</p></li><li><p>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼šä¸Šè¿°æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœaddAge()è¿™ä¸ªæ–¹æ³•åœ¨æœåŠ¡ç«¯ï¼Œæ‰§è¡Œå‡½æ•°çš„å‡½æ•°ä½“åœ¨è¿œç¨‹æœºå™¨ä¸Šï¼Œå¦‚ä½•å‘Šè¯‰æœºå™¨éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿ</p><ul><li>é¦–å…ˆå®¢æˆ·ç«¯éœ€è¦å‘Šè¯‰æœåŠ¡å™¨ï¼Œéœ€è¦è°ƒç”¨çš„å‡½æ•°ï¼Œè¿™é‡Œå‡½æ•°å’Œè¿›ç¨‹IDå­˜åœ¨ä¸€ä¸ªæ˜ å°„ï¼Œå®¢æˆ·ç«¯è¿œç¨‹è°ƒç”¨æ—¶ï¼Œéœ€è¦æŸ¥ä¸€ä¸‹å‡½æ•°ï¼Œæ‰¾åˆ°å¯¹åº”çš„IDï¼Œç„¶åæ‰§è¡Œå‡½æ•°çš„ä»£ç ã€‚</li><li>å®¢æˆ·ç«¯éœ€è¦æŠŠæœ¬åœ°å‚æ•°ä¼ ç»™è¿œç¨‹å‡½æ•°ï¼Œæœ¬åœ°è°ƒç”¨çš„è¿‡ç¨‹ä¸­ï¼Œç›´æ¥å‹æ ˆå³å¯ï¼Œä½†æ˜¯åœ¨è¿œç¨‹è°ƒç”¨è¿‡ç¨‹ä¸­ä¸å†åŒä¸€ä¸ªå†…å­˜é‡Œï¼Œæ— æ³•ç›´æ¥ä¼ é€’å‡½æ•°çš„å‚æ•°ï¼Œå› æ­¤éœ€è¦å®¢æˆ·ç«¯æŠŠå‚æ•°è½¬æ¢æˆå­—èŠ‚æµï¼Œä¼ ç»™æœåŠ¡ç«¯ï¼Œç„¶åæœåŠ¡ç«¯å°†å­—èŠ‚æµè½¬æ¢æˆè‡ªèº«èƒ½è¯»å–çš„æ ¼å¼ï¼Œæ˜¯ä¸€ä¸ªåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚</li><li>æ•°æ®å‡†å¤‡å¥½äº†ä¹‹åï¼Œå¦‚ä½•è¿›è¡Œä¼ è¾“ï¼Ÿç½‘ç»œä¼ è¾“å±‚éœ€è¦æŠŠè°ƒç”¨çš„IDå’Œåºåˆ—åŒ–åçš„å‚æ•°ä¼ ç»™æœåŠ¡ç«¯ï¼Œç„¶åæŠŠè®¡ç®—å¥½çš„ç»“æœåºåˆ—åŒ–ä¼ ç»™å®¢æˆ·ç«¯ï¼Œå› æ­¤TCPå±‚å³å¯å®Œæˆä¸Šè¿°è¿‡ç¨‹ï¼ŒgRPCä¸­é‡‡ç”¨çš„æ˜¯HTTP2åè®®ã€‚</li></ul></li><li><p>æ¨èé˜…è¯»æ–‡ç« ï¼š<a href="https://developer.51cto.com/art/201906/597963.htm">https://developer.51cto.com/art/201906/597963.htm</a></p></li></ul><h2 id="RPCåŸºæœ¬åŸç†"><a href="#RPCåŸºæœ¬åŸç†" class="headerlink" title="RPCåŸºæœ¬åŸç†"></a>RPCåŸºæœ¬åŸç†</h2><div class="tip faa-horizontal animated">   <p>RPCä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼šé€šè®¯ï¼Œåºåˆ—åŒ–</p><p></p></div><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@d35cd0969ec278b198f26f608f305d41696a9036/2021/06/27/4b0fd760980c286fba2c7e6e93d5107d.png"></p><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@620587cd342b5cefc489522877a9b0552d28bb6d/2021/06/27/c0f85ae24f122191fdfc7892325c465b.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åˆ†å¸ƒå¼ç†è®º&quot;&gt;&lt;a href=&quot;#åˆ†å¸ƒå¼ç†è®º&quot; class=&quot;headerlink&quot; title=&quot;åˆ†å¸ƒå¼ç†è®º&quot;&gt;&lt;/a&gt;åˆ†å¸ƒå¼ç†è®º&lt;/h1&gt;&lt;h2 id=&quot;åˆ†å¸ƒå¼ç³»ç»Ÿ&quot;&gt;&lt;a href=&quot;#åˆ†å¸ƒå¼ç³»ç»Ÿ&quot; class=&quot;headerlink&quot; title=&quot;åˆ†å¸ƒå¼</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒå¯Œæ–‡æœ¬ç¼–è¾‘å™¨</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot18.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot18.html</id>
    <published>2021-06-26T07:01:57.096Z</published>
    <updated>2021-06-27T02:23:42.543Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¯Œæ–‡æœ¬ç¼–è¾‘å™¨"><a href="#å¯Œæ–‡æœ¬ç¼–è¾‘å™¨" class="headerlink" title="å¯Œæ–‡æœ¬ç¼–è¾‘å™¨"></a>å¯Œæ–‡æœ¬ç¼–è¾‘å™¨</h1><ul><li>Editor.mdâ€”â€”åŠŸèƒ½éå¸¸ä¸°å¯Œçš„ç¼–è¾‘å™¨ï¼Œå·¦ç«¯ç¼–è¾‘ï¼Œå³ç«¯é¢„è§ˆï¼Œéå¸¸æ–¹ä¾¿ï¼Œå®Œå…¨å…è´¹<ul><li> å®˜ç½‘ï¼š<a href="https://pandao.github.io/editor.md/">https://pandao.github.io/editor.md/</a></li></ul></li><li>wangEditorâ€”â€”åŸºäºjavascriptå’Œcsså¼€å‘çš„ Webå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œ è½»é‡ã€ç®€æ´ã€ç•Œé¢ç¾è§‚ã€æ˜“ç”¨ã€å¼€æºå…è´¹ã€‚<ul><li>å®˜ç½‘ï¼š<a href="http://www.wangeditor.com/">http://www.wangeditor.com/</a></li></ul></li><li>TinyMCEâ€”â€”TinyMCEæ˜¯ä¸€ä¸ªè½»é‡çº§çš„åŸºäºæµè§ˆå™¨çš„æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨ï¼Œç”±JavaScriptå†™æˆã€‚å®ƒå¯¹IE6+å’ŒFirefox1.5+éƒ½æœ‰ç€éå¸¸è‰¯å¥½çš„æ”¯æŒã€‚åŠŸèƒ½é½å…¨ï¼Œç•Œé¢ç¾è§‚ï¼Œå°±æ˜¯æ–‡æ¡£æ˜¯è‹±æ–‡çš„ï¼Œå¯¹å¼€å‘äººå‘˜è‹±æ–‡æ°´å¹³æœ‰ä¸€å®šè¦æ±‚ã€‚<ul><li>å®˜ç½‘ï¼š<a href="https://www.tiny.cloud/docs/demo/full-featured/">https://www.tiny.cloud/docs/demo/full-featured/</a></li><li>åšå®¢å›­</li></ul></li><li>ç™¾åº¦ueditorâ€”â€”UEditoræ˜¯ç”±ç™¾åº¦webå‰ç«¯ç ”å‘éƒ¨å¼€å‘æ‰€è§å³æ‰€å¾—å¯Œæ–‡æœ¬webç¼–è¾‘å™¨ï¼Œå…·æœ‰è½»é‡ï¼ŒåŠŸèƒ½é½å…¨ï¼Œå¯å®šåˆ¶ï¼Œæ³¨é‡ç”¨æˆ·ä½“éªŒç­‰ç‰¹ç‚¹ï¼Œå¼€æºåŸºäºMITåè®®ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ï¼Œç¼ºç‚¹æ˜¯å·²ç»æ²¡æœ‰æ›´æ–°äº†<ul><li>å®˜ç½‘ï¼š<a href="https://ueditor.baidu.com/website/onlinedemo.html">https://ueditor.baidu.com/website/onlinedemo.html</a></li></ul></li><li>kindeditorâ€”â€”ç•Œé¢ç»å…¸ã€‚<ul><li>å®˜ç½‘ï¼š<a href="http://kindeditor.net/demo.php">http://kindeditor.net/demo.php</a></li></ul></li><li>Textboxâ€”â€”Textboxæ˜¯ä¸€æ¬¾æç®€ä½†åŠŸèƒ½å¼ºå¤§çš„åœ¨çº¿æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ”¯æŒæ¡Œé¢è®¾å¤‡å’Œç§»åŠ¨è®¾å¤‡ã€‚ä¸»è¦åŠŸèƒ½åŒ…å«å†…ç½®çš„å›¾åƒå¤„ç†å’Œå­˜å‚¨ã€æ–‡ä»¶æ‹–æ”¾ã€æ‹¼å†™æ£€æŸ¥å’Œè‡ªåŠ¨æ›´æ­£ã€‚æ­¤å¤–ï¼Œè¯¥å·¥å…·è¿˜å®ç°äº†å±å¹•é˜…è¯»å™¨ç­‰è¾…åŠ©æŠ€æœ¯ï¼Œå¹¶ç¬¦åˆWAI-ARIAå¯è®¿é—®æ€§æ ‡å‡†ã€‚<ul><li>å®˜ç½‘ï¼š<a href="https://textbox.io/">https://textbox.io/</a></li></ul></li><li>CKEditorâ€”â€”å›½å¤–çš„ï¼Œç•Œé¢ç¾è§‚ã€‚<ul><li>å®˜ç½‘ï¼š<a href="https://ckeditor.com/ckeditor-5/demo/">https://ckeditor.com/ckeditor-5/demo/</a></li></ul></li><li>quillâ€”â€”åŠŸèƒ½å¼ºå¤§ï¼Œè¿˜å¯ä»¥ç¼–è¾‘å…¬å¼ç­‰<ul><li>å®˜ç½‘ï¼š<a href="https://quilljs.com/">https://quilljs.com/</a></li></ul></li><li>simditorâ€”â€”ç•Œé¢ç¾è§‚ï¼ŒåŠŸèƒ½è¾ƒå…¨ã€‚<ul><li>å®˜ç½‘ï¼š<a href="https://simditor.tower.im/">https://simditor.tower.im/</a></li></ul></li><li>summernoteâ€”â€”UIå¥½çœ‹ï¼Œç²¾ç¾<ul><li>å®˜ç½‘ï¼š<a href="https://summernote.org/">https://summernote.org/</a></li></ul></li><li>joditâ€”â€”åŠŸèƒ½é½å…¨<ul><li>å®˜ç½‘ï¼š<a href="https://xdsoft.net/jodit/">https://xdsoft.net/jodit/</a></li></ul></li><li>froala Editorâ€”â€”ç•Œé¢éå¸¸å¥½çœ‹ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œéå¸¸å¥½ç”¨ï¼ˆéå…è´¹ï¼‰<ul><li>å®˜ç½‘ï¼š<a href="https://www.froala.com/wysiwyg-editor">https://www.froala.com/wysiwyg-editor</a></li></ul></li></ul><h1 id="Editor-md"><a href="#Editor-md" class="headerlink" title="Editor.md"></a>Editor.md</h1><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@8572819a034badf5e2f1565d90e65bbf6b5db20a/2021/06/26/4ecdea36e491e8bdc39c5c399e46c3fb.png"></p><h2 id="ä¸‹è½½å’Œå®‰è£…"><a href="#ä¸‹è½½å’Œå®‰è£…" class="headerlink" title="ä¸‹è½½å’Œå®‰è£…"></a>ä¸‹è½½å’Œå®‰è£…</h2><ul><li>è¿™é‡Œæ¨è<code>Editor.md</code>ï¼Œä¸Markdownè¯­æ³•å®Œç¾æ­é…</li><li>è¿›å…¥å®˜ç½‘ï¼š<a href="https://pandao.github.io/editor.md/">https://pandao.github.io/editor.md/</a>ï¼Œä¸‹è½½å‹ç¼©åŒ…ï¼</li><li>githubè®¿é—®è¾ƒæ…¢å¯ä»¥é€šè¿‡npmä¸‹è½½</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install editor.md</span><br></pre></td></tr></table></figure><ul><li>è§£å‹ä»¥åï¼Œåœ¨<code>examples</code>ç›®å½•ä¸‹é¢ï¼Œå¯ä»¥çœ‹åˆ°ä»–çš„å¾ˆå¤šæ¡ˆä¾‹ä½¿ç”¨ï¼</li><li>æŠ½å–æœ‰ç”¨çš„æ–‡ä»¶å¤åˆ¶è¿›ä¸€ä¸ª<code>editormd</code>æ–‡ä»¶å¤¹ï¼Œç„¶åæ”¾åˆ°SpringBooté¡¹ç›®çš„<code>static</code>æ–‡ä»¶ä¸‹</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@167a094f7b878a066ff4da73569a7f93cba6048a/2021/06/26/7b0ee510fc751c248af72ab08fdf30c4.png"></p><h2 id="æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="æµ‹è¯•ç¯å¢ƒæ­å»º"></a>æµ‹è¯•ç¯å¢ƒæ­å»º</h2><ul><li>æ•°æ®åº“è®¾è®¡ï¼Œ<code>article</code>æ–‡ç« è¡¨</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@06fbcd41a3d84250651aaf254e28c9f72682355a/2021/06/26/d2f0a28a94d92aca9cbbd93e44edab92.png"></p><ul><li>å»ºä¸€ä¸ªSpringBooté¡¹ç›®ï¼Œé…ç½®æ•°æ®åº“è¿æ¥</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">data-username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">data-password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="comment">#?serverTimezone=UTCè§£å†³æ—¶åŒºçš„æŠ¥é”™</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure><ul><li>å®ä½“ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–‡ç« ç±»</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Article</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">int</span> id; <span class="comment">//æ–‡ç« çš„å”¯ä¸€ID</span></span><br><span class="line">   <span class="keyword">private</span> String author; <span class="comment">//ä½œè€…å</span></span><br><span class="line">   <span class="keyword">private</span> String title; <span class="comment">//æ ‡é¢˜</span></span><br><span class="line">   <span class="keyword">private</span> String content; <span class="comment">//æ–‡ç« çš„å†…å®¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Mapperæ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleMapper</span> </span>&#123;</span><br><span class="line">   <span class="comment">//æŸ¥è¯¢æ‰€æœ‰çš„æ–‡ç« </span></span><br><span class="line">   <span class="function">List&lt;Article&gt; <span class="title">queryArticles</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ–°å¢ä¸€ä¸ªæ–‡ç« </span></span><br><span class="line">   <span class="function"><span class="keyword">int</span> <span class="title">addArticle</span><span class="params">(Article article)</span></span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ ¹æ®æ–‡ç« idæŸ¥è¯¢æ–‡ç« </span></span><br><span class="line">   <span class="function">Article <span class="title">getArticleById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ ¹æ®æ–‡ç« idåˆ é™¤æ–‡ç« </span></span><br><span class="line">   <span class="function"><span class="keyword">int</span> <span class="title">deleteArticleById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.lzy.dao.ArticleMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryArticles&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Article&quot;</span>&gt;</span></span><br><span class="line">      select * from article</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getArticleById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Article&quot;</span>&gt;</span></span><br><span class="line">      select * from article where id = #&#123;id&#125;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addArticle&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Article&quot;</span>&gt;</span></span><br><span class="line">      insert into article (author,title,content) values (#&#123;author&#125;,#&#123;title&#125;,#&#123;content&#125;);</span><br><span class="line">   <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteArticleById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">      delete from article where id = #&#123;id&#125;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>MyBatisæ˜ å°„é…ç½®æ–‡ä»¶</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:/mapper/*.xml</span></span><br><span class="line"><span class="meta">mybatis.type-aliases-package</span>=<span class="string">com.lzy.pojo</span></span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™ä¸€ä¸ªControlleræµ‹è¯•ä¸€ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    ArticleMapper articleMapper;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/get&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">getArticle</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;Article&gt; articles = articleMapper.queryArticles();</span><br><span class="line">        <span class="keyword">return</span>  articles;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@4b8a03dd1dc6be572a182a3a15e2253209122014/2021/06/26/8d95569c2177516deecb69cb5a042fa4.png"></p><h1 id="æ–‡ç« ç¼–è¾‘æ•´åˆ"><a href="#æ–‡ç« ç¼–è¾‘æ•´åˆ" class="headerlink" title="æ–‡ç« ç¼–è¾‘æ•´åˆ"></a>æ–‡ç« ç¼–è¾‘æ•´åˆ</h1><h2 id="å‰ç«¯é¡µé¢"><a href="#å‰ç«¯é¡µé¢" class="headerlink" title="å‰ç«¯é¡µé¢"></a>å‰ç«¯é¡µé¢</h2><ul><li>å¯¼å…¥<code>editor.md</code>çš„èµ„æºï¼Œåˆ é™¤å¤šä½™çš„æ–‡ä»¶</li><li>åœ¨<code>templates</code>ä¸‹Â·æ–°å»ºÂ·<code>editor.html</code>ï¼Œéœ€è¦å¼•å…¥<code>jQuery</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">class</span>=<span class="string">&quot;x-admin-sm&quot;</span> <span class="attr">lang</span>=<span class="string">&quot;zh&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å°æ&#x27;Blog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;renderer&quot;</span> <span class="attr">content</span>=<span class="string">&quot;webkit&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge,chrome=1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">content</span>=<span class="string">&quot;width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Editor.md--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--CSS--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/editormd/css/editormd.min.css&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;shortcut icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://pandao.github.io/editor.md/favicon.ico&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/x-icon&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;BigBox&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height:500px&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--åšå®¢è¡¨å• ç¼–è¾‘å™¨æ”¾åœ¨æ–‡æœ¬åŸŸè¡¨å•é‡Œé¢ï¼Œé€šè¿‡submitæäº¤--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">&quot;mdEditorForm&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            æ ‡é¢˜ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            ä½œè€…ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;author&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç¼–è¾‘åŒºåŸŸ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;article-content&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--jQuery--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--JS--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/editormd.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> testEditor = editormd(<span class="string">&quot;article-content&quot;</span>, &#123;</span></span><br><span class="line"><span class="javascript">            width: <span class="string">&quot;100%&quot;</span>,</span></span><br><span class="line">            height: 400,</span><br><span class="line"><span class="javascript">            syncScrolling: <span class="string">&quot;single&quot;</span>,</span></span><br><span class="line"><span class="javascript">            path: <span class="string">&quot;/editormd/lib/&quot;</span>,</span></span><br><span class="line"><span class="javascript">            saveHTMLToTextarea: <span class="literal">true</span>,    <span class="comment">// ä¿å­˜ HTML åˆ° Textarea</span></span></span><br><span class="line"><span class="javascript">            emoji: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">            theme: <span class="string">&quot;default&quot;</span>,<span class="comment">//å·¥å…·æ ä¸»é¢˜[default | dark]</span></span></span><br><span class="line"><span class="javascript">            previewTheme: <span class="string">&quot;default&quot;</span>,<span class="comment">//é¢„è§ˆä¸»é¢˜[default | dark]</span></span></span><br><span class="line"><span class="javascript">            editorTheme: <span class="string">&quot;default&quot;</span>,<span class="comment">//ç¼–è¾‘ä¸»é¢˜[default | dark]</span></span></span><br><span class="line"><span class="javascript">            tex: <span class="literal">true</span>,                   <span class="comment">// å¼€å¯ç§‘å­¦å…¬å¼TeXè¯­è¨€æ”¯æŒï¼Œé»˜è®¤å…³é—­</span></span></span><br><span class="line"><span class="javascript">            flowChart: <span class="literal">true</span>,             <span class="comment">// å¼€å¯æµç¨‹å›¾æ”¯æŒï¼Œé»˜è®¤å…³é—­</span></span></span><br><span class="line"><span class="javascript">            sequenceDiagram: <span class="literal">true</span>,       <span class="comment">// å¼€å¯æ—¶åº/åºåˆ—å›¾æ”¯æŒï¼Œé»˜è®¤å…³é—­,</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//å›¾ç‰‡ä¸Šä¼ </span></span></span><br><span class="line"><span class="javascript">            imageUpload: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">            imageFormats: [<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;gif&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;bmp&quot;</span>, <span class="string">&quot;webp&quot;</span>],</span></span><br><span class="line"><span class="javascript">            imageUploadURL: <span class="string">&quot;/article/file/upload&quot;</span>,  <span class="comment">//è¿™ä¸ªæ˜¯ä¸Šä¼ å›¾ç‰‡æ—¶çš„è®¿é—®åœ°å€</span></span></span><br><span class="line"><span class="javascript">            onload: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">&#x27;onload&#x27;</span>, <span class="built_in">this</span>);</span></span><br><span class="line">            &#125;,</span><br><span class="line"><span class="javascript">            <span class="comment">/*æŒ‡å®šéœ€è¦æ˜¾ç¤ºçš„åŠŸèƒ½æŒ‰é’®*/</span></span></span><br><span class="line"><span class="javascript">            toolbarIcons: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> [<span class="string">&quot;undo&quot;</span>, <span class="string">&quot;redo&quot;</span>, <span class="string">&quot;|&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;bold&quot;</span>, <span class="string">&quot;del&quot;</span>, <span class="string">&quot;italic&quot;</span>, <span class="string">&quot;quote&quot;</span>, <span class="string">&quot;ucwords&quot;</span>, <span class="string">&quot;uppercase&quot;</span>, <span class="string">&quot;lowercase&quot;</span>, <span class="string">&quot;|&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;h1&quot;</span>, <span class="string">&quot;h2&quot;</span>, <span class="string">&quot;h3&quot;</span>, <span class="string">&quot;h4&quot;</span>, <span class="string">&quot;h5&quot;</span>, <span class="string">&quot;h6&quot;</span>, <span class="string">&quot;|&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;list-ul&quot;</span>, <span class="string">&quot;list-ol&quot;</span>, <span class="string">&quot;hr&quot;</span>, <span class="string">&quot;|&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;link&quot;</span>, <span class="string">&quot;reference-link&quot;</span>, <span class="string">&quot;image&quot;</span>, <span class="string">&quot;code&quot;</span>, <span class="string">&quot;preformatted-text&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;code-block&quot;</span>, <span class="string">&quot;table&quot;</span>, <span class="string">&quot;datetime&quot;</span>, <span class="string">&quot;emoji&quot;</span>, <span class="string">&quot;html-entities&quot;</span>, <span class="string">&quot;pagebreak&quot;</span>, <span class="string">&quot;|&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;goto-line&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;preview&quot;</span>, <span class="string">&quot;fullscreen&quot;</span>, <span class="string">&quot;clear&quot;</span>, <span class="string">&quot;search&quot;</span>, <span class="string">&quot;|&quot;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="string">&quot;help&quot;</span>, <span class="string">&quot;info&quot;</span>, <span class="string">&quot;releaseIcon&quot;</span>, <span class="string">&quot;index&quot;</span>]</span></span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line"><span class="javascript">            <span class="comment">/*è‡ªå®šä¹‰åŠŸèƒ½æŒ‰é’®ï¼Œä¸‹é¢æˆ‘è‡ªå®šä¹‰äº†2ä¸ªï¼Œä¸€ä¸ªæ˜¯å‘å¸ƒï¼Œä¸€ä¸ªæ˜¯è¿”å›é¦–é¡µ*/</span></span></span><br><span class="line">            toolbarIconTexts: &#123;</span><br><span class="line"><span class="handlebars"><span class="xml">                releaseIcon: &quot;<span class="tag">&lt;<span class="name">span</span> <span class="attr">bgcolor</span>=<span class="string">\</span>&quot;<span class="attr">gray</span>\&quot;&gt;</span>å‘å¸ƒ<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&quot;,</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">                index: &quot;<span class="tag">&lt;<span class="name">span</span> <span class="attr">bgcolor</span>=<span class="string">\</span>&quot;<span class="attr">red</span>\&quot;&gt;</span>è¿”å›é¦–é¡µ<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&quot;,</span></span></span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line"><span class="javascript">            <span class="comment">/*ç»™è‡ªå®šä¹‰æŒ‰é’®æŒ‡å®šå›è°ƒå‡½æ•°*/</span></span></span><br><span class="line">            toolbarHandlers: &#123;</span><br><span class="line"><span class="javascript">                releaseIcon: <span class="function"><span class="keyword">function</span> (<span class="params">cm, icon, cursor, selection</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">//è¡¨å•æäº¤</span></span></span><br><span class="line"><span class="javascript">                    mdEditorForm.method = <span class="string">&quot;post&quot;</span>;</span></span><br><span class="line"><span class="javascript">                    mdEditorForm.action = <span class="string">&quot;/article/addArticle&quot;</span>;<span class="comment">//æäº¤è‡³æœåŠ¡å™¨çš„è·¯å¾„</span></span></span><br><span class="line">                    mdEditorForm.submit();</span><br><span class="line">                &#125;,</span><br><span class="line"><span class="javascript">                index: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">window</span>.location.href = <span class="string">&#x27;/&#x27;</span>; <span class="comment">//é¦–é¡µè·³è½¬</span></span></span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™Controllerï¼Œè¿›è¡Œè·³è½¬ï¼Œä»¥åŠä¿å­˜æ–‡æ–‡ç« </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/article&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/toEditor&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">toEditor</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;editor&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@PostMapping(&quot;/addArticle&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">addArticle</span><span class="params">(Article article)</span></span>&#123;</span><br><span class="line">       articleMapper.addArticle(article);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;editor&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@dfb6a2378c34f9dd054dbda5eb8158c47a9a94fd/2021/06/27/3df3f072034c7a0368e8524503c7c860.png"></p><h2 id="å›¾ç‰‡ä¸Šä¼ "><a href="#å›¾ç‰‡ä¸Šä¼ " class="headerlink" title="å›¾ç‰‡ä¸Šä¼ "></a>å›¾ç‰‡ä¸Šä¼ </h2><ul><li>åœ¨<code>editor.html</code>çš„JSä»£ç ä¸­æ·»åŠ </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å›¾ç‰‡ä¸Šä¼ </span></span><br><span class="line">imageUpload : <span class="literal">true</span>,</span><br><span class="line">imageFormats : [<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;gif&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;bmp&quot;</span>, <span class="string">&quot;webp&quot;</span>],</span><br><span class="line">imageUploadURL : <span class="string">&quot;/article/file/upload&quot;</span>, <span class="comment">// //è¿™ä¸ªæ˜¯ä¸Šä¼ å›¾ç‰‡æ—¶çš„è®¿é—®åœ°å€</span></span><br></pre></td></tr></table></figure><ul><li>åç«¯è¯·æ±‚ï¼Œæ¥æ”¶ä¿å­˜è¿™ä¸ªå›¾ç‰‡, éœ€è¦å¯¼å…¥ <code>FastJson</code> çš„ä¾èµ–ï¼</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.75<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åšå®¢å›¾ç‰‡ä¸Šä¼ é—®é¢˜</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/file/upload&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JSONObject <span class="title">fileUpload</span><span class="params">(<span class="meta">@RequestParam(value = &quot;editormd-image-file&quot;, required = true)</span> MultipartFile file, HttpServletRequest request)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">   <span class="comment">//ä¸Šä¼ è·¯å¾„ä¿å­˜è®¾ç½®</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">//è·å¾—SpringBootå½“å‰é¡¹ç›®çš„è·¯å¾„ï¼šSystem.getProperty(&quot;user.dir&quot;)</span></span><br><span class="line">   String path = System.getProperty(<span class="string">&quot;user.dir&quot;</span>)+<span class="string">&quot;/upload/&quot;</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æŒ‰ç…§æœˆä»½è¿›è¡Œåˆ†ç±»ï¼š</span></span><br><span class="line">   Calendar instance = Calendar.getInstance();</span><br><span class="line">   String month = (instance.get(Calendar.MONTH) + <span class="number">1</span>)+<span class="string">&quot;æœˆ&quot;</span>;</span><br><span class="line">   path = path+month;</span><br><span class="line"></span><br><span class="line">   File realPath = <span class="keyword">new</span> File(path);</span><br><span class="line">   <span class="keyword">if</span> (!realPath.exists())&#123;</span><br><span class="line">       realPath.mkdir();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ä¸Šä¼ æ–‡ä»¶åœ°å€</span></span><br><span class="line">   System.out.println(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ°å€ï¼š&quot;</span>+realPath);</span><br><span class="line"></span><br><span class="line">   <span class="comment">//è§£å†³æ–‡ä»¶åå­—é—®é¢˜ï¼šæˆ‘ä»¬ä½¿ç”¨uuid;</span></span><br><span class="line">   String filename = <span class="string">&quot;ks-&quot;</span>+UUID.randomUUID().toString().replaceAll(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">   <span class="comment">//é€šè¿‡CommonsMultipartFileçš„æ–¹æ³•ç›´æ¥å†™æ–‡ä»¶ï¼ˆæ³¨æ„è¿™ä¸ªæ—¶å€™ï¼‰</span></span><br><span class="line">   file.transferTo(<span class="keyword">new</span> File(realPath +<span class="string">&quot;/&quot;</span>+ filename));</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ç»™editormdè¿›è¡Œå›è°ƒ</span></span><br><span class="line">   JSONObject res = <span class="keyword">new</span> JSONObject();</span><br><span class="line">   res.put(<span class="string">&quot;url&quot;</span>,<span class="string">&quot;/upload/&quot;</span>+month+<span class="string">&quot;/&quot;</span>+ filename);</span><br><span class="line">   res.put(<span class="string">&quot;success&quot;</span>, <span class="number">1</span>);</span><br><span class="line">   res.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;upload success!&quot;</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è§£å†³æ–‡ä»¶å›æ˜¾æ˜¾ç¤ºçš„é—®é¢˜ï¼Œè®¾ç½®è™šæ‹Ÿç›®å½•æ˜ å°„ï¼åœ¨æˆ‘ä»¬è‡ªå·±æ‹“å±•çš„MvcConfigä¸­è¿›è¡Œé…ç½®å³å¯ï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// æ–‡ä»¶ä¿å­˜åœ¨çœŸå®ç›®å½•/upload/ä¸‹ï¼Œ</span></span><br><span class="line">   <span class="comment">// è®¿é—®çš„æ—¶å€™ä½¿ç”¨è™šè·¯å¾„/uploadï¼Œæ¯”å¦‚æ–‡ä»¶åä¸º1.pngï¼Œå°±ç›´æ¥/upload/1.pngå°±okäº†ã€‚</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> </span>&#123;</span><br><span class="line">       registry.addResourceHandler(<span class="string">&quot;/upload/**&quot;</span>)</span><br><span class="line">          .addResourceLocations(<span class="string">&quot;file:&quot;</span>+System.getProperty(<span class="string">&quot;user.dir&quot;</span>)+<span class="string">&quot;/upload/&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸Šä¼ å›¾ç‰‡æµ‹è¯•</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@58635c816f8ead35cc794a980576757a6cd27ab2/2021/06/27/9bc5369240d8503ea2004d9bdd6db7e7.png"></p><h2 id="è¡¨æƒ…åŒ…é—®é¢˜"><a href="#è¡¨æƒ…åŒ…é—®é¢˜" class="headerlink" title="è¡¨æƒ…åŒ…é—®é¢˜"></a>è¡¨æƒ…åŒ…é—®é¢˜</h2><ul><li>è‡ªå·±æ‰‹åŠ¨ä¸‹è½½ï¼Œemoji è¡¨æƒ…åŒ…ï¼Œæ”¾åˆ°å›¾ç‰‡è·¯å¾„ä¸‹ï¼š</li><li>ä¿®æ”¹<code>editormd.js</code>æ–‡ä»¶</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Emoji graphics files url path</span></span><br><span class="line">editormd.emoji     = &#123;</span><br><span class="line">   path : <span class="string">&quot;../editormd/plugins/emoji-dialog/emoji/&quot;</span>,</span><br><span class="line">   ext   : <span class="string">&quot;.png&quot;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="æ–‡ç« å±•ç¤º"><a href="#æ–‡ç« å±•ç¤º" class="headerlink" title="æ–‡ç« å±•ç¤º"></a>æ–‡ç« å±•ç¤º</h1><ul><li>Controller ä¸­å¢åŠ æ–¹æ³•ï¼Œä½¿ç”¨Restfulé£æ ¼å¸¦ä¸Šæ–‡ç« IDæŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id,Model model)</span></span>&#123;</span><br><span class="line">   Article article = articleMapper.getArticleById(id);</span><br><span class="line">   model.addAttribute(<span class="string">&quot;article&quot;</span>,article);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;article&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™é¡µé¢ <code>article.html</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;article.title&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ–‡ç« å¤´éƒ¨ä¿¡æ¯ï¼šæ ‡é¢˜ï¼Œä½œè€…ï¼Œæœ€åæ›´æ–°æ—¥æœŸï¼Œå¯¼èˆª--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">style</span>=<span class="string">&quot;margin: auto 0&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;article.title&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>ä½œè€…ï¼š<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;float: left&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;article.author&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ–‡ç« ä¸»ä½“å†…å®¹--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;doc-content&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;markdown&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;article.content&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/editormd/css/editormd.preview.css&#125;&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--jQuery--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/lib/marked.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/lib/prettify.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/lib/raphael.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/lib/underscore.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/lib/sequence-diagram.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/lib/flowchart.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/lib/jquery.flowchart.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/editormd/editormd.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> testEditor;</span></span><br><span class="line"><span class="javascript">    $(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        testEditor = editormd.markdownToHTML(<span class="string">&quot;doc-content&quot;</span>, &#123;<span class="comment">//æ³¨æ„ï¼šè¿™é‡Œæ˜¯ä¸Šé¢DIVçš„id</span></span></span><br><span class="line"><span class="javascript">            htmlDecode: <span class="string">&quot;style,script,iframe&quot;</span>,</span></span><br><span class="line"><span class="javascript">            emoji: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">            taskList: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">            tocm: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">            tex: <span class="literal">true</span>, <span class="comment">// é»˜è®¤ä¸è§£æ</span></span></span><br><span class="line"><span class="javascript">            flowChart: <span class="literal">true</span>, <span class="comment">// é»˜è®¤ä¸è§£æ</span></span></span><br><span class="line"><span class="javascript">            sequenceDiagram: <span class="literal">true</span>, <span class="comment">// é»˜è®¤ä¸è§£æ</span></span></span><br><span class="line"><span class="javascript">            codeFold: <span class="literal">true</span></span></span><br><span class="line">        &#125;);&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@ee234e94994c9e7fdf1692e237c84efe33054c2d/2021/06/27/f625108ed95269cbd76b555b32407211.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¯Œæ–‡æœ¬ç¼–è¾‘å™¨&quot;&gt;&lt;a href=&quot;#å¯Œæ–‡æœ¬ç¼–è¾‘å™¨&quot; class=&quot;headerlink&quot; title=&quot;å¯Œæ–‡æœ¬ç¼–è¾‘å™¨&quot;&gt;&lt;/a&gt;å¯Œæ–‡æœ¬ç¼–è¾‘å™¨&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Editor.mdâ€”â€”åŠŸèƒ½éå¸¸ä¸°å¯Œçš„ç¼–è¾‘å™¨ï¼Œå·¦ç«¯ç¼–è¾‘ï¼Œå³ç«¯é¢„è§ˆï¼Œéå¸¸æ–¹ä¾¿ï¼Œå®Œå…¨å…è´¹&lt;ul&gt;
&lt;l</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒå¼‚æ­¥ã€å®šæ—¶ã€é‚®ä»¶ä»»åŠ¡</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot17.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot17.html</id>
    <published>2021-06-26T03:45:11.639Z</published>
    <updated>2021-06-26T06:54:36.746Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¼‚æ­¥ä»»åŠ¡"><a href="#å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="å¼‚æ­¥ä»»åŠ¡"></a>å¼‚æ­¥ä»»åŠ¡</h1><h2 id="å¼‚æ­¥æµ‹è¯•"><a href="#å¼‚æ­¥æµ‹è¯•" class="headerlink" title="å¼‚æ­¥æµ‹è¯•"></a>å¼‚æ­¥æµ‹è¯•</h2><ul><li>å¼‚æ­¥å¤„ç†è¿˜æ˜¯éå¸¸å¸¸ç”¨çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ç½‘ç«™ä¸Šå‘é€é‚®ä»¶ï¼Œåå°ä¼šå»å‘é€é‚®ä»¶ï¼Œæ­¤æ—¶å‰å°ä¼šé€ æˆå“åº”ä¸åŠ¨ï¼Œç›´åˆ°é‚®ä»¶å‘é€å®Œæ¯•ï¼Œå“åº”æ‰ä¼šæˆåŠŸï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ä¼šé‡‡ç”¨å¤šçº¿ç¨‹çš„æ–¹å¼å»å¤„ç†è¿™äº›ä»»åŠ¡</li><li>ç¼–å†™æ–¹æ³•ï¼Œå‡è£…æ­£åœ¨å¤„ç†æ•°æ®ï¼Œä½¿ç”¨çº¿ç¨‹è®¾ç½®ä¸€äº›å»¶æ—¶ï¼Œæ¨¡æ‹ŸåŒæ­¥ç­‰å¾…çš„æƒ…å†µï¼›</li><li>ç¼–å†™ä¸€ä¸ªServiceå±‚æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">       System.out.println(<span class="string">&quot;ä¸šåŠ¡è¿›è¡Œä¸­....&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™Controllerå±‚è¿›è¡Œè¯·æ±‚æµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    AsyncService asyncService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        asyncService.hello();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¿é—®<code>http://localhost:8080/hello</code>è¿›è¡Œæµ‹è¯•ï¼Œ3ç§’åå‡ºç°successï¼Œè¿™æ˜¯åŒæ­¥ç­‰å¾…çš„æƒ…å†µ</li></ul><h2 id="Async"><a href="#Async" class="headerlink" title="@Async"></a>@Async</h2><ul><li>é—®é¢˜ï¼šæˆ‘ä»¬å¦‚æœæƒ³è®©ç”¨æˆ·ç›´æ¥å¾—åˆ°æ¶ˆæ¯ï¼Œå°±åœ¨åå°ä½¿ç”¨å¤šçº¿ç¨‹çš„æ–¹å¼è¿›è¡Œå¤„ç†å³å¯ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦è‡ªå·±æ‰‹åŠ¨å»ç¼–å†™å¤šçº¿ç¨‹çš„å®ç°çš„è¯ï¼Œå¤ªéº»çƒ¦äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨ä¸€ä¸ªç®€å•çš„åŠæ³•ï¼Œåœ¨æˆ‘ä»¬çš„æ–¹æ³•ä¸ŠåŠ ä¸€ä¸ªç®€å•çš„æ³¨è§£å³å¯ï¼Œå¦‚ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸šåŠ¡è¿›è¡Œä¸­....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>SpringBootå°±ä¼šè‡ªå·±å¼€ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè¿›è¡Œè°ƒç”¨ï¼ä½†æ˜¯è¦è®©è¿™ä¸ªæ³¨è§£ç”Ÿæ•ˆï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨ä¸»ç¨‹åºä¸Šæ·»åŠ ä¸€ä¸ªæ³¨è§£<code>@EnableAsync</code> ï¼Œå¼€å¯å¼‚æ­¥æ³¨è§£åŠŸèƒ½ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableAsync</span> <span class="comment">//å¼€å¯å¼‚æ­¥æ³¨è§£åŠŸèƒ½</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootTaskApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       SpringApplication.run(SpringbootTaskApplication.class, args);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é‡å¯æµ‹è¯•ï¼Œç½‘é¡µç¬é—´å“åº”ï¼Œåå°ä»£ç ä¾æ—§æ‰§è¡Œï¼</li></ul><h1 id="å®šæ—¶ä»»åŠ¡"><a href="#å®šæ—¶ä»»åŠ¡" class="headerlink" title="å®šæ—¶ä»»åŠ¡"></a>å®šæ—¶ä»»åŠ¡</h1><ul><li>é¡¹ç›®å¼€å‘ä¸­ç»å¸¸éœ€è¦æ‰§è¡Œä¸€äº›å®šæ—¶ä»»åŠ¡ï¼Œæ¯”å¦‚éœ€è¦åœ¨æ¯å¤©å‡Œæ™¨çš„æ—¶å€™ï¼Œåˆ†æä¸€æ¬¡å‰ä¸€å¤©çš„æ—¥å¿—ä¿¡æ¯ï¼ŒSpringä¸ºæˆ‘ä»¬æä¾›äº†å¼‚æ­¥æ‰§è¡Œä»»åŠ¡è°ƒåº¦çš„æ–¹å¼ï¼Œæä¾›äº†ä¸¤ä¸ªæ¥å£ã€‚<ul><li><code>TaskExecutor</code>æ¥å£</li><li><code>TaskScheduler</code>æ¥å£</li></ul></li><li>ä¸¤ä¸ªæ³¨è§£ï¼š<ul><li><code>@EnableScheduling</code>ï¼šå¼€å¯å®šæ—¶åŠŸèƒ½çš„æ³¨è§£ï¼Œé…ç½®åœ¨å¯åŠ¨ç±»</li><li><code>@Scheduled</code>ï¼šä»€ä¹ˆæ—¶å€™æ‰§è¡Œ</li></ul></li></ul><h2 id="cronè¡¨è¾¾å¼"><a href="#cronè¡¨è¾¾å¼" class="headerlink" title="cronè¡¨è¾¾å¼"></a>cronè¡¨è¾¾å¼</h2><ul><li><code>Cron</code>è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä»¥5æˆ–6ä¸ªç©ºæ ¼éš”å¼€ï¼Œåˆ†ä¸º6æˆ–7ä¸ªåŸŸï¼Œæ¯ä¸€ä¸ªåŸŸä»£è¡¨ä¸€ä¸ªå«ä¹‰ï¼ŒCronæœ‰å¦‚ä¸‹ä¸¤ç§è¯­æ³•æ ¼å¼ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Seconds Minutes Hours DayofMonth Month DayofWeek Year</span><br><span class="line">Seconds Minutes Hours DayofMonth Month DayofWeek</span><br></pre></td></tr></table></figure><ul><li>cornä»å·¦åˆ°å³ï¼ˆç”¨ç©ºæ ¼éš”å¼€ï¼‰ï¼š<strong>ç§’ åˆ† å°æ—¶ æœˆä»½ä¸­çš„æ—¥æœŸ æœˆä»½ æ˜ŸæœŸä¸­çš„æ—¥æœŸ å¹´ä»½</strong></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@7e759308582b0f9bf0c354713cad601c8e0872eb/2021/06/26/8023056fd91f37e3b9da743f44cb736c.png"></p><ul><li>åœ¨å…ˆCronè¡¨è¾¾å¼ç”Ÿæˆå™¨ï¼š<a href="https://cron.qqe2.com/">https://cron.qqe2.com/</a></li><li>å¸¸ç”¨çš„è¡¨è¾¾å¼</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰<span class="number">0</span>/<span class="number">2</span> * * * * ?   è¡¨ç¤ºæ¯<span class="number">2</span>ç§’ æ‰§è¡Œä»»åŠ¡</span><br><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰<span class="number">0</span> <span class="number">0</span>/<span class="number">2</span> * * * ?   è¡¨ç¤ºæ¯<span class="number">2</span>åˆ†é’Ÿ æ‰§è¡Œä»»åŠ¡</span><br><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰<span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> * ?   è¡¨ç¤ºåœ¨æ¯æœˆçš„<span class="number">1</span>æ—¥çš„å‡Œæ™¨<span class="number">2</span>ç‚¹è°ƒæ•´ä»»åŠ¡</span><br><span class="line">ï¼ˆ<span class="number">2</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> ? * MON-FRI   è¡¨ç¤ºå‘¨ä¸€åˆ°å‘¨äº”æ¯å¤©ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>æ‰§è¡Œä½œä¸š</span><br><span class="line">ï¼ˆ<span class="number">3</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> ? <span class="number">6L</span> <span class="number">2002</span>-<span class="number">2006</span>   è¡¨ç¤º<span class="number">2002</span>-<span class="number">2006</span>å¹´çš„æ¯ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>æ‰§è¡Œä½œ</span><br><span class="line">ï¼ˆ<span class="number">4</span>ï¼‰<span class="number">0</span> <span class="number">0</span> <span class="number">10</span>,<span class="number">14</span>,<span class="number">16</span> * * ?   æ¯å¤©ä¸Šåˆ<span class="number">10</span>ç‚¹ï¼Œä¸‹åˆ<span class="number">2</span>ç‚¹ï¼Œ<span class="number">4</span>ç‚¹</span><br><span class="line">ï¼ˆ<span class="number">5</span>ï¼‰<span class="number">0</span> <span class="number">0</span>/<span class="number">30</span> <span class="number">9</span>-<span class="number">17</span> * * ?   æœä¹æ™šäº”å·¥ä½œæ—¶é—´å†…æ¯åŠå°æ—¶</span><br><span class="line">ï¼ˆ<span class="number">6</span>ï¼‰<span class="number">0</span> <span class="number">0</span> <span class="number">12</span> ? * WED   è¡¨ç¤ºæ¯ä¸ªæ˜ŸæœŸä¸‰ä¸­åˆ<span class="number">12</span>ç‚¹</span><br><span class="line">ï¼ˆ<span class="number">7</span>ï¼‰<span class="number">0</span> <span class="number">0</span> <span class="number">12</span> * * ?   æ¯å¤©ä¸­åˆ<span class="number">12</span>ç‚¹è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">8</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> ? * *   æ¯å¤©ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">9</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> * * ?     æ¯å¤©ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">10</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> * * ?   æ¯å¤©ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">11</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> * * ? <span class="number">2005</span>   <span class="number">2005</span>å¹´çš„æ¯å¤©ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">12</span>ï¼‰<span class="number">0</span> * <span class="number">14</span> * * ?     åœ¨æ¯å¤©ä¸‹åˆ<span class="number">2</span>ç‚¹åˆ°ä¸‹åˆ<span class="number">2</span>:<span class="number">59</span>æœŸé—´çš„æ¯<span class="number">1</span>åˆ†é’Ÿè§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">13</span>ï¼‰<span class="number">0</span> <span class="number">0</span>/<span class="number">5</span> <span class="number">14</span> * * ?   åœ¨æ¯å¤©ä¸‹åˆ<span class="number">2</span>ç‚¹åˆ°ä¸‹åˆ<span class="number">2</span>:<span class="number">55</span>æœŸé—´çš„æ¯<span class="number">5</span>åˆ†é’Ÿè§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">14</span>ï¼‰<span class="number">0</span> <span class="number">0</span>/<span class="number">5</span> <span class="number">14</span>,<span class="number">18</span> * * ?     åœ¨æ¯å¤©ä¸‹åˆ<span class="number">2</span>ç‚¹åˆ°<span class="number">2</span>:<span class="number">55</span>æœŸé—´å’Œä¸‹åˆ<span class="number">6</span>ç‚¹åˆ°<span class="number">6</span>:<span class="number">55</span>æœŸé—´çš„æ¯<span class="number">5</span>åˆ†é’Ÿè§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">15</span>ï¼‰<span class="number">0</span> <span class="number">0</span>-<span class="number">5</span> <span class="number">14</span> * * ?   åœ¨æ¯å¤©ä¸‹åˆ<span class="number">2</span>ç‚¹åˆ°ä¸‹åˆ<span class="number">2</span>:<span class="number">05</span>æœŸé—´çš„æ¯<span class="number">1</span>åˆ†é’Ÿè§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">16</span>ï¼‰<span class="number">0</span> <span class="number">10</span>,<span class="number">44</span> <span class="number">14</span> ? <span class="number">3</span> WED   æ¯å¹´ä¸‰æœˆçš„æ˜ŸæœŸä¸‰çš„ä¸‹åˆ<span class="number">2</span>:<span class="number">10</span>å’Œ<span class="number">2</span>:<span class="number">44</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">17</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> ? * MON-FRI   å‘¨ä¸€è‡³å‘¨äº”çš„ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">18</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> <span class="number">15</span> * ?   æ¯æœˆ<span class="number">15</span>æ—¥ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">19</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> L * ?   æ¯æœˆæœ€åä¸€æ—¥çš„ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">20</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> ? * <span class="number">6L</span>   æ¯æœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ<span class="number">21</span>ï¼‰<span class="number">0</span> <span class="number">15</span> <span class="number">10</span> ? * <span class="number">6L</span> <span class="number">2002</span>-<span class="number">2005</span>   <span class="number">2002</span>å¹´è‡³<span class="number">2005</span>å¹´çš„æ¯æœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ<span class="number">10</span>:<span class="number">15</span>è§¦å‘</span><br><span class="line">ï¼ˆ22ï¼‰0 15 10 ? * 6#3   æ¯æœˆçš„ç¬¬ä¸‰ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15è§¦å‘</span><br></pre></td></tr></table></figure><h2 id="å®šæ—¶æµ‹è¯•"><a href="#å®šæ—¶æµ‹è¯•" class="headerlink" title="å®šæ—¶æµ‹è¯•"></a>å®šæ—¶æµ‹è¯•</h2><ul><li>åˆ›å»ºä¸€ä¸ª<code>ScheduledService</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScheduledService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åœ¨ç‰¹å®šæ—¶é—´æ‰§è¡Œ</span></span><br><span class="line">    <span class="comment">//ç§’ åˆ† æ—¶ æ—¥ æœˆ å‘¨å‡ </span></span><br><span class="line">    <span class="comment">// æ˜å¤©14ç‚¹52åˆ† æ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    <span class="meta">@Scheduled(cron = &quot;0 52 14 * * ?&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å†™å®Œå®šæ—¶ä»»åŠ¡ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸»ç¨‹åºä¸Šå¢åŠ <code>@EnableScheduling</code> å¼€å¯å®šæ—¶ä»»åŠ¡åŠŸèƒ½</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableAsync</span> <span class="comment">//å¼€å¯å¼‚æ­¥æ³¨è§£åŠŸèƒ½</span></span><br><span class="line"><span class="meta">@EnableScheduling</span> <span class="comment">//å¼€å¯åŸºäºæ³¨è§£çš„å®šæ—¶ä»»åŠ¡</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootTaskApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       SpringApplication.run(SpringbootTaskApplication.class, args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ç»“æœï¼Œåœ¨14:52åˆ†æ‰§è¡Œæ–¹æ³•è¾“å‡ºç»“æœ</li></ul><h1 id="é‚®ä»¶ä»»åŠ¡"><a href="#é‚®ä»¶ä»»åŠ¡" class="headerlink" title="é‚®ä»¶ä»»åŠ¡"></a>é‚®ä»¶ä»»åŠ¡</h1><h2 id="é‚®ä»¶é…ç½®"><a href="#é‚®ä»¶é…ç½®" class="headerlink" title="é‚®ä»¶é…ç½®"></a>é‚®ä»¶é…ç½®</h2><ul><li>é‚®ä»¶å‘é€ï¼Œåœ¨æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¹Ÿéå¸¸çš„å¤šï¼ŒSpringbootä¹Ÿå¸®æˆ‘ä»¬åšäº†æ”¯æŒ<ul><li>é‚®ä»¶å‘é€éœ€è¦å¼•å…¥<code>spring-boot-start-mail</code></li><li>SpringBoot è‡ªåŠ¨é…ç½®<code>MailSenderAutoConfiguration</code></li><li>å®šä¹‰<code>MailProperties</code>å†…å®¹ï¼Œé…ç½®åœ¨<code>application.yml</code>ä¸­</li><li>è‡ªåŠ¨è£…é…<code>JavaMailSender</code></li><li>æµ‹è¯•é‚®ä»¶å‘é€</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>Alté”®çœ‹å®ƒå¼•å…¥çš„çˆ¶ä¾èµ–ï¼Œå¯ä»¥çœ‹åˆ° <code>jakarta.mail</code></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.mail<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>æœç´¢æŸ¥çœ‹è‡ªåŠ¨é…ç½®ç±»ï¼š<code>MailSenderAutoConfiguration</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@1d45cc25cc6fd7f36e4999152e43157069a31db7/2021/06/26/9a16a252a612d16baa92f2cb6722cffc.png"></p><ul><li>è¿™ä¸ªç±»ä¸­å­˜åœ¨<code>JavaMailSenderImpl</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6aca1a828e91628f904402435169ce250788189a/2021/06/26/b2e6ed49efd4bfbc95222415967c8ab2.png"></p><ul><li>çœ‹ä¸‹é…ç½®æ–‡ä»¶ç±»<code>MailProperties</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(</span></span><br><span class="line"><span class="meta">   prefix = &quot;spring.mail&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailProperties</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset DEFAULT_CHARSET;</span><br><span class="line">   <span class="keyword">private</span> String host;</span><br><span class="line">   <span class="keyword">private</span> Integer port;</span><br><span class="line">   <span class="keyword">private</span> String username;</span><br><span class="line">   <span class="keyword">private</span> String password;</span><br><span class="line">   <span class="keyword">private</span> String protocol = <span class="string">&quot;smtp&quot;</span>;</span><br><span class="line">   <span class="keyword">private</span> Charset defaultEncoding;</span><br><span class="line">   <span class="keyword">private</span> Map&lt;String, String&gt; properties;</span><br><span class="line">   <span class="keyword">private</span> String jndiName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é‚®ä»¶æµ‹è¯•"><a href="#é‚®ä»¶æµ‹è¯•" class="headerlink" title="é‚®ä»¶æµ‹è¯•"></a>é‚®ä»¶æµ‹è¯•</h2><ul><li>åœ¨Â·<code>application.properties</code>ä¸­å¢åŠ é…ç½®</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mail.username</span>=<span class="string">2312057536@qq.com</span></span><br><span class="line"><span class="meta">spring.mail.password</span>=<span class="string">ä½ çš„qqæˆæƒç </span></span><br><span class="line"><span class="meta">spring.mail.host</span>=<span class="string">smtp.qq.com</span></span><br><span class="line"><span class="comment"># qqéœ€è¦é…ç½®ssl</span></span><br><span class="line"><span class="meta">spring.mail.properties.mail.smtp.ssl.enable</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨SpringBootå•å…ƒæµ‹è¯•ä¸­å‘é€ä¸€ä¸ªç®€å•çš„é‚®ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootTaskApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JavaMailSenderImpl mailSender;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. ç®€å•çš„é‚®ä»¶</span></span><br><span class="line">        SimpleMailMessage mailMessage = <span class="keyword">new</span> SimpleMailMessage();</span><br><span class="line">        mailMessage.setSubject(<span class="string">&quot;ä¸»é¢˜&quot;</span>);</span><br><span class="line">        mailMessage.setText(<span class="string">&quot;é‚®ä»¶å†…å®¹&quot;</span>);</span><br><span class="line">        mailMessage.setTo(<span class="string">&quot;xiaoliblog123@163.com&quot;</span>);</span><br><span class="line">        mailMessage.setFrom(<span class="string">&quot;2312057536@qq.com&quot;</span>);</span><br><span class="line">        mailSender.send(mailMessage);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads2</span><span class="params">()</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">        <span class="comment">//2. ä¸€ä¸ªå¤æ‚çš„é‚®ä»¶</span></span><br><span class="line">        MimeMessage mimeMessage = mailSender.createMimeMessage();</span><br><span class="line">        <span class="comment">// ç»„è£…</span></span><br><span class="line">        MimeMessageHelper helper = <span class="keyword">new</span> MimeMessageHelper(mimeMessage, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        helper.setSubject(<span class="string">&quot;éªŒè¯ç é€šçŸ¥&quot;</span>);</span><br><span class="line">        helper.setText(<span class="string">&quot;&lt;b style=&#x27;color:red&#x27;&gt;æ‚¨çš„éªŒè¯ç ä¸º1234&lt;/b&gt;&quot;</span>,<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€é™„ä»¶</span></span><br><span class="line">        helper.addAttachment(<span class="string">&quot;1.jpg&quot;</span>,<span class="keyword">new</span> File(<span class="string">&quot;C:\\1.jpg&quot;</span>));</span><br><span class="line">        helper.addAttachment(<span class="string">&quot;2.jpg&quot;</span>,<span class="keyword">new</span> File(<span class="string">&quot;C:\\2.jpg&quot;</span>));</span><br><span class="line"></span><br><span class="line">        helper.setTo(<span class="string">&quot;2312057536@qq.com&quot;</span>);</span><br><span class="line">        helper.setFrom(<span class="string">&quot;2312057536@qq.com&quot;</span>);</span><br><span class="line"></span><br><span class="line">        mailSender.send(mimeMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¼‚æ­¥ä»»åŠ¡&quot;&gt;&lt;a href=&quot;#å¼‚æ­¥ä»»åŠ¡&quot; class=&quot;headerlink&quot; title=&quot;å¼‚æ­¥ä»»åŠ¡&quot;&gt;&lt;/a&gt;å¼‚æ­¥ä»»åŠ¡&lt;/h1&gt;&lt;h2 id=&quot;å¼‚æ­¥æµ‹è¯•&quot;&gt;&lt;a href=&quot;#å¼‚æ­¥æµ‹è¯•&quot; class=&quot;headerlink&quot; title=&quot;å¼‚æ­¥æµ‹è¯•&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒSwaggerä»‹ç»åŠé›†æˆ</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot16.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot16.html</id>
    <published>2021-06-25T14:47:27.735Z</published>
    <updated>2021-06-26T03:44:34.345Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h1><h2 id="Swaggerç®€ä»‹"><a href="#Swaggerç®€ä»‹" class="headerlink" title="Swaggerç®€ä»‹"></a>Swaggerç®€ä»‹</h2><ul><li>é¦–å…ˆæä¸€ä¸‹å‰åç«¯åˆ†ç¦»æ—¶ä»£<ul><li>å‰ç«¯ -&gt; å‰ç«¯æ§åˆ¶å±‚ã€è§†å›¾å±‚</li><li>åç«¯ -&gt; åç«¯æ§åˆ¶å±‚ã€æœåŠ¡å±‚ã€æ•°æ®è®¿é—®å±‚</li><li>å‰åç«¯é€šè¿‡APIè¿›è¡Œäº¤äº’</li><li>å‰åç«¯ç›¸å¯¹ç‹¬ç«‹ä¸”æ¾è€¦åˆ</li></ul></li><li>å‰åç«¯é›†æˆï¼Œå‰ç«¯æˆ–è€…åç«¯æ— æ³•åšåˆ°åŠæ—¶åå•†ï¼Œå°½æ—©è§£å†³ï¼Œæœ€ç»ˆå¯¼è‡´é—®é¢˜é›†ä¸­çˆ†å‘</li><li>è§£å†³æ–¹æ¡ˆï¼šé¦–å…ˆå®šä¹‰schema [ è®¡åˆ’çš„æçº² ]ï¼Œå¹¶å®æ—¶è·Ÿè¸ªæœ€æ–°çš„APIï¼Œé™ä½é›†æˆé£é™©</li><li><code>Swagger</code>å·ç§°ä¸–ç•Œä¸Šæœ€æµè¡Œçš„APIæ¡†æ¶<ul><li>Restful Api æ–‡æ¡£åœ¨çº¿è‡ªåŠ¨ç”Ÿæˆå™¨ =&gt; API æ–‡æ¡£ ä¸API å®šä¹‰åŒæ­¥æ›´æ–°</li><li>ç›´æ¥è¿è¡Œï¼Œåœ¨çº¿æµ‹è¯•APIæ¥å£</li><li>æ”¯æŒå¤šç§è¯­è¨€ ï¼ˆå¦‚ï¼šJavaï¼ŒPHPç­‰ï¼‰</li><li>å®˜ç½‘ï¼š<a href="https://swagger.io/">https://swagger.io/</a></li></ul></li></ul><h2 id="é›†æˆSwagger"><a href="#é›†æˆSwagger" class="headerlink" title="é›†æˆSwagger"></a>é›†æˆSwagger</h2><ul><li>SpringBooté›†æˆSwagger =&gt; springfoxï¼Œjdk 1.8 +ï¼Œä¸”éœ€è¦ä¸¤ä¸ªjaråŒ…<ul><li><code>Springfox-swagger2</code></li><li><code>swagger-springmvc</code></li></ul></li><li>æ–°å»ºSpringBoot-Webå·¥ç¨‹ï¼Œå¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç¡®ä¿é¡¹ç›®èƒ½è¿è¡Œæ­£å¸¸ï¼Œç¼–å†™<code>config</code>åŒ…ï¼Œåˆ›å»º<code>SwaggerConfig</code>é…ç½®ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¿é—®æµ‹è¯• ï¼š<code>http://localhost:8080/swagger-ui.html</code> ï¼Œå¯ä»¥çœ‹åˆ°swaggerçš„ç•Œé¢ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@07750c92392a4ef9a59fabeea925673920a8da8e/2021/06/26/6f5ee755db4bd54f506f49b7e3689bc4.png"></p><h1 id="é…ç½®Swagger"><a href="#é…ç½®Swagger" class="headerlink" title="é…ç½®Swagger"></a>é…ç½®Swagger</h1><h2 id="é…ç½®Swaggerä¿¡æ¯"><a href="#é…ç½®Swaggerä¿¡æ¯" class="headerlink" title="é…ç½®Swaggerä¿¡æ¯"></a>é…ç½®Swaggerä¿¡æ¯</h2><ul><li>Swaggerå®ä¾‹Beanæ˜¯<code>Docket</code>ï¼Œæ‰€ä»¥é€šè¿‡é…ç½®<code>Docket</code>å®ä¾‹æ¥é…ç½®Swagggerã€‚å¹¶å…³è”ä¸Š <code>apiInfo()</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é…ç½®docketä»¥é…ç½®Swaggerå…·ä½“å‚æ•°</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡<code>apiInfo()</code>å±æ€§é…ç½®æ–‡æ¡£ä¿¡æ¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é…ç½®docketä»¥é…ç½®Swaggerå…·ä½“å‚æ•°</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®Swaggerä¿¡æ¯ apiInfo</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Contact contact = <span class="keyword">new</span> Contact(<span class="string">&quot;è”ç³»äººåå­—&quot;</span>, <span class="string">&quot;http://xxx.xxx.com/è”ç³»äººè®¿é—®é“¾æ¥&quot;</span>, <span class="string">&quot;è”ç³»äººé‚®ç®±&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfo(</span><br><span class="line">                <span class="string">&quot;Swaggerå­¦ä¹ &quot;</span>, <span class="comment">// æ ‡é¢˜</span></span><br><span class="line">                <span class="string">&quot;å­¦ä¹ æ¼”ç¤ºå¦‚ä½•é…ç½®Swagger&quot;</span>, <span class="comment">// æè¿°</span></span><br><span class="line">                <span class="string">&quot;v1.0&quot;</span>, <span class="comment">// ç‰ˆæœ¬</span></span><br><span class="line">                <span class="string">&quot;http://terms.service.url/ç»„ç»‡é“¾æ¥&quot;</span>, <span class="comment">// ç»„ç»‡é“¾æ¥</span></span><br><span class="line">                contact, <span class="comment">// è”ç³»äººä¿¡æ¯</span></span><br><span class="line">                <span class="string">&quot;Apach 2.0 è®¸å¯&quot;</span>, <span class="comment">// è®¸å¯</span></span><br><span class="line">                <span class="string">&quot;è®¸å¯é“¾æ¥&quot;</span>, <span class="comment">// è®¸å¯è¿æ¥</span></span><br><span class="line">                <span class="keyword">new</span> ArrayList&lt;&gt;()<span class="comment">// æ‰©å±•</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é‡å¯é¡¹ç›®ï¼Œè®¿é—®æµ‹è¯• <code>http://localhost:8080/swagger-ui.html</code>  çœ‹ä¸‹æ•ˆæœï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@033fe612ab5a87119d426fb87c002f7c46c09ccf/2021/06/26/8ace22fa0f7bbd9b62a581df604d3975.png"></p><div class="note success simple"><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªAPIï¼Œé»˜è®¤çš„<code>basic-error-controller</code>å’Œè‡ªå®šä¹‰çš„<code>HelloController</code>ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šæ‰«ææ¥å£</p></div><h2 id="é…ç½®æ‰«ææ¥å£"><a href="#é…ç½®æ‰«ææ¥å£" class="headerlink" title="é…ç½®æ‰«ææ¥å£"></a>é…ç½®æ‰«ææ¥å£</h2><ul><li>æ„å»ºDocketæ—¶é€šè¿‡<code>select()</code>æ–¹æ³•é…ç½®æ€ä¹ˆæ‰«ææ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é…ç½®docketä»¥é…ç½®Swaggerå…·ä½“å‚æ•°</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">//é€šè¿‡.select()æ–¹æ³•ï¼Œå»é…ç½®æ‰«ææ¥å£,RequestHandlerSelectorsé…ç½®å¦‚ä½•æ‰«ææ¥å£</span></span><br><span class="line">                <span class="comment">// 1. .basePackage:æŒ‡å®šæ‰«æçš„åŒ…</span></span><br><span class="line">                <span class="comment">// 2. .any():æ‰«æå…¨éƒ¨</span></span><br><span class="line">                <span class="comment">// 3. .none():éƒ½ä¸æ‰«æ</span></span><br><span class="line">                <span class="comment">// 4. .withClassAnnotation:æ‰«æç±»ä¸Šçš„æ³¨è§£ï¼Œå‚æ•°ä¸ºæ³¨è§£çš„åå°„å¯¹è±¡</span></span><br><span class="line">                <span class="comment">// 5. .withMethodAnnotation:æ‰«ææ–¹æ³•ä¸Šçš„æ³¨è§£</span></span><br><span class="line">                <span class="comment">// æŒ‡å®šæ‰«æçš„åŒ…</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.lzy.controller&quot;</span>))</span><br><span class="line">                <span class="comment">//åªä¼šæ‰«ææœ‰@RestControllerçš„ç±»</span></span><br><span class="line">                <span class="comment">//.apis(RequestHandlerSelectors.withMethodAnnotation(RestController.class))</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é‡å¯é¡¹ç›®æµ‹è¯•ï¼Œç”±äºæˆ‘ä»¬é…ç½®æ ¹æ®åŒ…çš„è·¯å¾„æ‰«ææ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½çœ‹åˆ°ä¸€ä¸ªç±»</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@baea96dccc31c063169d0e28c127e66b8cdd91ff/2021/06/26/f6ecc445dc8987d66dba483d34e711b2.png"></p><ul><li>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é…ç½®æ¥å£æ‰«æè¿‡æ»¤</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é…ç½®docketä»¥é…ç½®Swaggerå…·ä½“å‚æ•°</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">// æŒ‡å®šæ‰«æçš„åŒ…</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.lzy.controller&quot;</span>))</span><br><span class="line">                <span class="comment">// paths() è¿‡æ»¤ä»€ä¹ˆè·¯å¾„</span></span><br><span class="line">                <span class="comment">// 1. any() // ä»»ä½•è¯·æ±‚éƒ½æ‰«æ</span></span><br><span class="line">                <span class="comment">// 2. none() // ä»»ä½•è¯·æ±‚éƒ½ä¸æ‰«æ</span></span><br><span class="line">                <span class="comment">// 3. regex(final String pathRegex) // é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ§åˆ¶</span></span><br><span class="line">                <span class="comment">// 4. ant(final String antPattern) // é€šè¿‡ant()æ§åˆ¶</span></span><br><span class="line">                <span class="comment">// é…ç½®å¦‚ä½•é€šè¿‡pathè¿‡æ»¤,å³è¿™é‡Œåªæ‰«æè¯·æ±‚ä»¥/userå¼€å¤´çš„æ¥å£</span></span><br><span class="line">                .paths(PathSelectors.ant(<span class="string">&quot;/user/**&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®Swaggerå¼€å…³"><a href="#é…ç½®Swaggerå¼€å…³" class="headerlink" title="é…ç½®Swaggerå¼€å…³"></a>é…ç½®Swaggerå¼€å…³</h2><ul><li>é€šè¿‡<code>enable()</code>æ–¹æ³•é…ç½®æ˜¯å¦å¯ç”¨swaggerï¼Œå¦‚æœæ˜¯<code>false</code>ï¼Œswaggerå°†ä¸èƒ½åœ¨æµè§ˆå™¨ä¸­è®¿é—®äº†</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é…ç½®docketä»¥é…ç½®Swaggerå…·ä½“å‚æ•°</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                <span class="comment">//é…ç½®æ˜¯å¦å¯ç”¨Swaggerï¼Œå¦‚æœæ˜¯falseï¼Œåœ¨æµè§ˆå™¨å°†æ— æ³•è®¿é—®</span></span><br><span class="line">                .enable(<span class="keyword">false</span>)</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">// æŒ‡å®šæ‰«æçš„åŒ…</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.lzy.controller&quot;</span>))</span><br><span class="line">                <span class="comment">// é…ç½®å¦‚ä½•é€šè¿‡pathè¿‡æ»¤,å³è¿™é‡Œåªæ‰«æè¯·æ±‚ä»¥/userå¼€å¤´çš„æ¥å£</span></span><br><span class="line">                .paths(PathSelectors.ant(<span class="string">&quot;/user/**&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¦‚ä½•åŠ¨æ€é…ç½®å½“é¡¹ç›®å¤„äº<code>test</code>ã€<code>dev</code>ç¯å¢ƒæ—¶æ˜¾ç¤º<code>swagger</code>ï¼Œå¤„äº<code>prod</code>æ—¶ä¸æ˜¾ç¤ºï¼ŸåŠåœ¨ç”Ÿäº§ç¯å¢ƒæ˜¾ç¤ºï¼Œå‘å¸ƒçš„æ—¶å€™ä¸æ˜¾ç¤º<ul><li>åˆ¤æ–­æ˜¯ä¸æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œè®¾ç½®<code>flag=false</code></li><li>æ³¨å…¥<code>enable(false)</code></li></ul></li><li>é¦–å…ˆä½¿ç”¨å¤šç¯å¢ƒåˆ‡æ¢ï¼Œåˆ›å»º<code>application-dev.properties</code>å¼€å‘ç¯å¢ƒå’Œ<code>application-pro.properties</code>æ­£å¼ç¯å¢ƒï¼Œæš‚æ—¶ä¸é…æµ‹è¯•ç¯å¢ƒ</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application.propries ç”¨æ¥æŒ‡å®šç¯å¢ƒ</span></span><br><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">dev</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># application-dev.properties å¼€å‘ç¯å¢ƒ</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8081</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># application-pro.properties æ­£å¼ç¯å¢ƒ</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8082</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨<code>SwaggerConfig</code>è¿›è¡Œé…ç½®è¯»å–</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é…ç½®docketä»¥é…ç½®Swaggerå…·ä½“å‚æ•°</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®è¦æ˜¾ç¤ºçš„Swaggerç¯å¢ƒ</span></span><br><span class="line">        Profiles profiles = Profiles.of(<span class="string">&quot;dev&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        <span class="comment">// é€šè¿‡environment.acceptsProfilesåˆ¤æ–­æ˜¯å¦å¤„äºè‡ªå·±è®¾å®šçš„ç¯å¢ƒå½“ä¸­</span></span><br><span class="line">        Boolean flag = environment.acceptsProfiles(profiles);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                <span class="comment">//é…ç½®æ˜¯å¦å¯ç”¨Swaggerï¼Œå¦‚æœæ˜¯falseï¼Œåœ¨æµè§ˆå™¨å°†æ— æ³•è®¿é—®</span></span><br><span class="line">                .enable(flag)</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">// æŒ‡å®šæ‰«æçš„åŒ…</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.lzy.controller&quot;</span>))</span><br><span class="line">                <span class="comment">// é…ç½®å¦‚ä½•é€šè¿‡pathè¿‡æ»¤,å³è¿™é‡Œåªæ‰«æè¯·æ±‚ä»¥/userå¼€å¤´çš„æ¥å£</span></span><br><span class="line">                .paths(PathSelectors.ant(<span class="string">&quot;/user/**&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç„¶åä¸Šé¢é…ç½®æ–‡ä»¶æŒ‡å®šäº†<code>dev</code>å¼€å‘ç¯å¢ƒï¼Œä¸”ç«¯å£å·ä¸º<code>8081</code>ã€‚æ‰€ä»¥æˆ‘ä»¬è®¿é—®<code>8080</code>æ— æ³•è®¿é—®</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6bad3b517cc12f0ef12b87d864e267e8218c9b50/2021/06/26/8f1247bc7f8f5c22e250c5999fe0665a.png"></p><ul><li>è®¿é—®å¼€å‘ç¯å¢ƒ<code>http://localhost:8081/swagger-ui.html</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@711a8abef66e438ee8dede5e7c69ed4a108c8c5f/2021/06/26/b398adeeb8a10e00e6fb267cd02842e0.png"></p><h2 id="é…ç½®APIåˆ†ç»„"><a href="#é…ç½®APIåˆ†ç»„" class="headerlink" title="é…ç½®APIåˆ†ç»„"></a>é…ç½®APIåˆ†ç»„</h2><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@c1bea8db6f38c1444beda299409e7273d9637dcd/2021/06/26/0dc9e218716a1884763f687e8944468d.png"></p><ul><li>å¦‚æœæ²¡æœ‰é…ç½®åˆ†ç»„ï¼Œé»˜è®¤æ˜¯<code>default</code>ã€‚é€šè¿‡<code>groupName()</code>æ–¹æ³•å³å¯é…ç½®åˆ†ç»„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é…ç½®docketä»¥é…ç½®Swaggerå…·ä½“å‚æ•°</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .groupName(<span class="string">&quot;å°æåšå®¢&quot;</span>) <span class="comment">// é…ç½®åˆ†ç»„</span></span><br><span class="line">                <span class="comment">// çœç•¥é…ç½®</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@d6744964b5d85a71cf8b705c2ace3517d1c89833/2021/06/26/bac845e2d41956f73f5bcc67bb03c89b.png"></p><ul><li>å¦‚ä½•é…ç½®å¤šä¸ªåˆ†ç»„ï¼Ÿé…ç½®å¤šä¸ªåˆ†ç»„åªéœ€è¦é…ç½®å¤šä¸ª<code>docket</code>å³å¯ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//ç›¸å½“äºComponent</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span> <span class="comment">//å¼€å¯Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2).groupName(<span class="string">&quot;group1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2).groupName(<span class="string">&quot;group2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">docket3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2).groupName(<span class="string">&quot;group3&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@38483ab3a87e427b051760492c9f98aa223a0e64/2021/06/26/659e07681c83bafc6341fb1b331099d9.png"></p><h1 id="æ¥å£æ³¨é‡Š"><a href="#æ¥å£æ³¨é‡Š" class="headerlink" title="æ¥å£æ³¨é‡Š"></a>æ¥å£æ³¨é‡Š</h1><h2 id="å®ä½“é…ç½®"><a href="#å®ä½“é…ç½®" class="headerlink" title="å®ä½“é…ç½®"></a>å®ä½“é…ç½®</h2><ul><li>æ–°å»ºä¸€ä¸ªå®ä½“ç±»ï¼Œå¹¶è¿›è¡Œæ³¨é‡Šï¼Œ<code>private</code>éœ€è¦æœ‰<code>get/set</code>æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»™å®ä½“ç±»åŠ æ–‡æ¡£æ³¨é‡Š</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;ç”¨æˆ·å®ä½“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;å¯†ç &quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">// get/set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åªè¦è¿™ä¸ªå®ä½“åœ¨è¯·æ±‚æ¥å£çš„è¿”å›å€¼ä¸Šï¼ˆå³ä½¿æ˜¯æ³›å‹ï¼‰ï¼Œéƒ½èƒ½æ˜ å°„åˆ°å®ä½“é¡¹ä¸­ã€‚åœ¨Controlleræ§åˆ¶å™¨ä¸­è®¾ç½®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åªè¦æˆ‘ä»¬çš„æ¥å£ä¸­ï¼Œè¿”å›å€¼ä¸­å­˜åœ¨å®ä½“ç±»ï¼Œå®ƒå°±ä¼šè¢«æ‰«æåˆ°Swaggerä¸­</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/user&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@f45088c00aa23c873f059aefefcf7beac383a2a8/2021/06/26/1ea35ada2bcbea0ef7558fd1b4db1b27.png"></p><ul><li>æ³¨ï¼šå¹¶ä¸æ˜¯å› ä¸º<code>@ApiModel</code>è¿™ä¸ªæ³¨è§£è®©å®ä½“æ˜¾ç¤ºåœ¨è¿™é‡Œäº†ï¼Œè€Œæ˜¯åªè¦å‡ºç°åœ¨æ¥å£æ–¹æ³•çš„è¿”å›å€¼ä¸Šçš„å®ä½“éƒ½ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œè€Œ<code>@ApiModel</code>å’Œ<code>@ApiModelProperty</code>è¿™ä¸¤ä¸ªæ³¨è§£åªæ˜¯ä¸ºå®ä½“æ·»åŠ æ³¨é‡Šçš„ã€‚</li><li><code>@ApiModel</code>ä¸ºç±»æ·»åŠ æ³¨é‡Š</li><li><code>@ApiModelProperty</code>ä¸ºç±»å±æ€§æ·»åŠ æ³¨é‡Š</li></ul><h2 id="å¸¸ç”¨æ³¨è§£"><a href="#å¸¸ç”¨æ³¨è§£" class="headerlink" title="å¸¸ç”¨æ³¨è§£"></a>å¸¸ç”¨æ³¨è§£</h2><ul><li>Swaggerçš„æ‰€æœ‰æ³¨è§£å®šä¹‰åœ¨<code>io.swagger.annotations</code>åŒ…ä¸‹</li></ul><table><thead><tr><th align="center">Swaggeræ³¨è§£</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">@Api(tags = â€œxxxæ¨¡å—è¯´æ˜â€)</td><td align="center">ä½œç”¨åœ¨æ¨¡å—ç±»ä¸Š</td></tr><tr><td align="center">@ApiOperation(â€œxxxæ¥å£è¯´æ˜â€)</td><td align="center">ä½œç”¨åœ¨æ¥å£æ–¹æ³•ä¸Š</td></tr><tr><td align="center">@ApiModel(â€œxxxPOJOè¯´æ˜â€)</td><td align="center">ä½œç”¨åœ¨æ¨¡å‹ç±»ä¸Šï¼šå¦‚VOã€BO</td></tr><tr><td align="center">@ApiModelProperty(value = â€œxxxå±æ€§è¯´æ˜â€,hidden = true)</td><td align="center">ä½œç”¨åœ¨ç±»æ–¹æ³•å’Œå±æ€§ä¸Šï¼Œhiddenç½®ä¸ºtrueå¯ä»¥éšè—è¯¥å±æ€§</td></tr><tr><td align="center">@ApiParam(â€œxxxå‚æ•°è¯´æ˜â€)</td><td align="center">ä½œç”¨åœ¨å‚æ•°ã€æ–¹æ³•å’Œå­—æ®µä¸Šï¼Œç±»ä¼¼@ApiModelProperty</td></tr></tbody></table><ul><li>ä¹Ÿå¯ä»¥ç»™è¯·æ±‚çš„æ¥å£é…ç½®ä¸€äº›æ³¨é‡Š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/user&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">(<span class="meta">@ApiParam(&quot;è¿™ä¸ªåå­—ä¼šè¢«è¿”å›&quot;)</span> User user)</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é‡å¯é¡¹ç›®ï¼Œæ‰“å¼€æµ‹è¯•<code>POST</code>è¯·æ±‚ï¼Œç‚¹å‡»<code>Try It Out</code>ï¼Œè¾“å…¥ä¿¡æ¯è¿›ç‚¹å‡»<code>Execute</code>è¿›è¡Œæµ‹è¯•</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@7091a65724d777739268625fcfadd5d5549e2570/2021/06/26/6c5d6eede044c0b723aad0fbfee2fb80.png"></p><ul><li>è¿™æ ·çš„è¯ï¼Œå¯ä»¥ç»™ä¸€äº›æ¯”è¾ƒéš¾ç†è§£çš„å±æ€§æˆ–è€…æ¥å£ï¼Œå¢åŠ ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œè®©äººæ›´å®¹æ˜“é˜…è¯»ï¼</li><li>ç›¸è¾ƒäºä¼ ç»Ÿçš„Postmanæˆ–Curlæ–¹å¼æµ‹è¯•æ¥å£ï¼Œä½¿ç”¨swaggerç®€ç›´å°±æ˜¯å‚»ç“œå¼æ“ä½œï¼Œä¸éœ€è¦é¢å¤–è¯´æ˜æ–‡æ¡£ï¼ˆå†™å¾—å¥½æœ¬èº«å°±æ˜¯æ–‡æ¡£ï¼‰è€Œä¸”æ›´ä¸å®¹æ˜“å‡ºé”™ï¼Œåªéœ€è¦å½•å…¥æ•°æ®ç„¶åç‚¹å‡»Executeï¼Œå¦‚æœå†é…åˆè‡ªåŠ¨åŒ–æ¡†æ¶ï¼Œå¯ä»¥è¯´åŸºæœ¬å°±ä¸éœ€è¦äººä¸ºæ“ä½œäº†ã€‚</li><li>Swaggeræ˜¯ä¸ªä¼˜ç§€çš„å·¥å…·ï¼Œç°åœ¨å›½å†…å·²ç»æœ‰å¾ˆå¤šçš„ä¸­å°å‹äº’è”ç½‘å…¬å¸éƒ½åœ¨ä½¿ç”¨å®ƒï¼Œç›¸è¾ƒäºä¼ ç»Ÿçš„è¦å…ˆå‡ºWordæ¥å£æ–‡æ¡£å†æµ‹è¯•çš„æ–¹å¼ï¼Œæ˜¾ç„¶è¿™æ ·ä¹Ÿæ›´ç¬¦åˆç°åœ¨çš„å¿«é€Ÿè¿­ä»£å¼€å‘è¡Œæƒ…ã€‚å½“ç„¶äº†ï¼Œæé†’ä¸‹å¤§å®¶åœ¨æ­£å¼ç¯å¢ƒè¦è®°å¾—å…³é—­Swaggerï¼Œä¸€æ¥å‡ºäºå®‰å…¨è€ƒè™‘äºŒæ¥ä¹Ÿå¯ä»¥èŠ‚çœè¿è¡Œæ—¶å†…å­˜ã€‚</li></ul><h2 id="å…¶ä»–çš®è‚¤"><a href="#å…¶ä»–çš®è‚¤" class="headerlink" title="å…¶ä»–çš®è‚¤"></a>å…¶ä»–çš®è‚¤</h2><ul><li>æˆ‘ä»¬å¯ä»¥å¯¼å…¥ä¸åŒçš„åŒ…å®ç°ä¸åŒçš„çš®è‚¤å®šä¹‰ï¼š</li><li>é»˜è®¤çš„è®¿é—® <code>http://localhost:8080/swagger-ui.html</code></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@baea96dccc31c063169d0e28c127e66b8cdd91ff/2021/06/26/f6ecc445dc8987d66dba483d34e711b2.png"></p><ul><li>bootstrap-ui  è®¿é—® <code>http://localhost:8080/doc.html</code></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼•å…¥swagger-bootstrap-uiåŒ… /doc.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-bootstrap-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@3b7348a84640b91da12e6e3fe39c1e31eb218eb4/2021/06/26/ad62b551438933fa52445eb1018afab9.png"></p><ul><li>Layui-ui   è®¿é—® <code>http://localhost:8080/docs.html</code></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼•å…¥swagger-ui-layeråŒ… /docs.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.caspar-chen<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-ui-layer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@291860adb968e9296edefee0f2d74da220335029/2021/06/26/b401cf8945cf5148d36bffedb1cb335b.png"></p><ul><li>mg-ui   è®¿é—® <code>http://localhost:8080/document.html</code></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼•å…¥swagger-ui-layeråŒ… /document.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zyplayer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-mg-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@47d758581d9ab1e6f7ec983c6763374f944cbd1f/2021/06/26/aa0f45f58e0955e7b359cb5155e47d60.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Swagger&quot;&gt;&lt;a href=&quot;#Swagger&quot; class=&quot;headerlink&quot; title=&quot;Swagger&quot;&gt;&lt;/a&gt;Swagger&lt;/h1&gt;&lt;h2 id=&quot;Swaggerç®€ä»‹&quot;&gt;&lt;a href=&quot;#Swaggerç®€ä»‹&quot; class=&quot;header</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    <category term="Swagger" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/Swagger/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="Swagger" scheme="http://xiaoliblog.cn/tags/Swagger/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒShiroæ•´åˆMyBatiså’ŒThymeleaf</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot15.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot15.html</id>
    <published>2021-06-25T14:46:37.249Z</published>
    <updated>2021-06-25T14:46:38.276Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ•´åˆMyBatis"><a href="#æ•´åˆMyBatis" class="headerlink" title="æ•´åˆMyBatis"></a>æ•´åˆMyBatis</h1><h2 id="å¯¼å…¥ç›¸å…³ä¾èµ–"><a href="#å¯¼å…¥ç›¸å…³ä¾èµ–" class="headerlink" title="å¯¼å…¥ç›¸å…³ä¾èµ–"></a>å¯¼å…¥ç›¸å…³ä¾èµ–</h2><ul><li>å®é™…å¼€å‘ç”¨æˆ·ä¿¡æ¯éƒ½æ˜¯ä»æ•°æ®åº“ä¸­å–å¾—ï¼Œæ‰€æœ‰Shiroéœ€è¦æ•´åˆMyBatis</li><li>è¿™é‡Œä½¿ç”¨Druidæ•°æ®æºè¿›è¡Œæ“ä½œï¼Œå¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mysqlæ•°æ®é©±åŠ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Mybatisé€‚é…SpringBootçš„åŒ…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åˆ›å»º<code>application.yml</code>é…ç½®æ–‡ä»¶æ¥è¿æ¥æ•°æ®åº“</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="comment">#?serverTimezone=UTCè§£å†³æ—¶åŒºçš„æŠ¥é”™</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">###################ä»¥ä¸‹ä¸ºdruidå¢åŠ çš„é…ç½®###########################</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¿æ¥æ± ä¸ªæ•°</span></span><br><span class="line">    <span class="attr">initialSize:</span> <span class="number">5</span></span><br><span class="line">    <span class="comment"># æœ€å°è¿æ¥æ± ä¸ªæ•°â€”â€”ã€‹å·²ç»ä¸å†ä½¿ç”¨ï¼Œé…ç½®äº†ä¹Ÿæ²¡æ•ˆæœ</span></span><br><span class="line">    <span class="attr">minIdle:</span> <span class="number">5</span></span><br><span class="line">    <span class="comment"># æœ€å¤§è¿æ¥æ± ä¸ªæ•°</span></span><br><span class="line">    <span class="attr">maxActive:</span> <span class="number">20</span></span><br><span class="line">    <span class="comment"># é…ç½®è·å–è¿æ¥ç­‰å¾…è¶…æ—¶çš„æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œç¼ºçœå¯ç”¨å…¬å¹³é”ï¼Œå¹¶å‘æ•ˆç‡ä¼šæœ‰æ‰€ä¸‹é™</span></span><br><span class="line">    <span class="attr">maxWait:</span> <span class="number">60000</span></span><br><span class="line">    <span class="comment"># é…ç½®é—´éš”å¤šä¹…æ‰è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œæ£€æµ‹éœ€è¦å…³é—­çš„ç©ºé—²è¿æ¥ï¼Œå•ä½æ˜¯æ¯«ç§’</span></span><br><span class="line">    <span class="attr">timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line">    <span class="comment"># é…ç½®ä¸€ä¸ªè¿æ¥åœ¨æ± ä¸­æœ€å°ç”Ÿå­˜çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’</span></span><br><span class="line">    <span class="attr">minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line">    <span class="comment"># ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚</span></span><br><span class="line">    <span class="comment"># å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowã€testOnReturnã€testWhileIdleéƒ½ä¸ä¼šèµ·ä½œç”¨</span></span><br><span class="line">    <span class="attr">validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line">    <span class="comment"># å»ºè®®é…ç½®ä¸ºtrueï¼Œä¸å½±å“æ€§èƒ½ï¼Œå¹¶ä¸”ä¿è¯å®‰å…¨æ€§ã€‚</span></span><br><span class="line">    <span class="comment"># ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚</span></span><br><span class="line">    <span class="attr">testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</span></span><br><span class="line">    <span class="attr">testOnBorrow:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</span></span><br><span class="line">    <span class="attr">testOnReturn:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># æ‰“å¼€PSCacheï¼Œå¹¶ä¸”æŒ‡å®šæ¯ä¸ªè¿æ¥ä¸ŠPSCacheçš„å¤§å°</span></span><br><span class="line">    <span class="attr">poolPreparedStatements:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œstat:ç›‘æ§ç»Ÿè®¡ã€log4jï¼šæ—¥å¿—è®°å½•ã€wallï¼šé˜²å¾¡sqlæ³¨å…¥</span></span><br><span class="line">    <span class="comment">#å¦‚æœå…è®¸æ—¶æŠ¥é”™  java.lang.ClassNotFoundException: org.apache.log4j.Priority</span></span><br><span class="line">    <span class="comment">#åˆ™å¯¼å…¥ log4j ä¾èµ–å³å¯ï¼ŒMaven åœ°å€ï¼šhttps://mvnrepository.com/artifact/log4j/log4j</span></span><br><span class="line">    <span class="attr">filters:</span> <span class="string">stat,wall,log4j</span></span><br><span class="line">    <span class="attr">maxPoolPreparedStatementPerConnectionSize:</span> <span class="number">20</span></span><br><span class="line">    <span class="attr">connectionProperties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span></span><br><span class="line">    <span class="comment"># åˆå¹¶å¤šä¸ªDruidDataSourceçš„ç›‘æ§æ•°æ®</span></span><br><span class="line">    <span class="attr">useGlobalDataSourceStat:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="MyBatisé…ç½®"><a href="#MyBatisé…ç½®" class="headerlink" title="MyBatisé…ç½®"></a>MyBatisé…ç½®</h2><ul><li>æŒ‰ä¼ ç»Ÿçš„MVCæ¨¡å‹åˆ›å»ºå¥½è½¯ä»¶åŒ…ï¼Œåœ¨<code>resources</code>ä¸‹åˆ›å»º<code>mapper</code>æ–‡ä»¶å¤¹</li><li>åœ¨<code>applicatiobn.properties</code>é…ç½®æ–‡ä»¶é‡Œç¼–å†™MyBatisé…ç½®</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mybatis.type-aliases-package</span>=<span class="string">com.lzy.pojo</span></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:mapper/*.xml</span></span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ"></a>æµ‹è¯•ç¯å¢ƒ</h2><ul><li>å®ä½“ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String Username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Daoå±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryUserByName</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespaceæŒ‡å®šDao/Mapperçš„å®Œæ•´è·¯å¾„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.lzy.dao.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryUserByName&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;String&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from user where username = #&#123;username&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>Serviceå±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryUserByName</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryUserByName</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.queryUserByName(username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨SpringBootçš„æµ‹è¯•æ–¹æ³•è¿›è¡Œæµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootShiroApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserServiceImpl userService;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(userService.queryUserByName(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Shiroç™»å½•"><a href="#Shiroç™»å½•" class="headerlink" title="Shiroç™»å½•"></a>Shiroç™»å½•</h2><ul><li>é…ç½®Shiroè¿›è¡Œç”¨æˆ·è®¤è¯ï¼Œåªéœ€åœ¨<code>UserRealm</code>æ³¨å…¥<code>UserService</code>å³å¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰çš„UserRealm</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="comment">// æˆæƒ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†æˆæƒ&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¤è¯</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†è®¤è¯&quot;</span>);</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°ç”¨æˆ·ç™»å½•ä¿¡æ¯</span></span><br><span class="line">        UsernamePasswordToken usertoken = (UsernamePasswordToken) authenticationToken;</span><br><span class="line">        <span class="comment">// è¿æ¥æ•°æ®åº“</span></span><br><span class="line">        User user = userService.queryUserByName(usertoken.getUsername());</span><br><span class="line">        <span class="keyword">if</span>(user==<span class="keyword">null</span>)&#123;  <span class="comment">//ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">//UnknownAccountException</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¯†ç è®¤è¯ï¼ŒShiroå¸®ä½ å®Œæˆ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(<span class="string">&quot;&quot;</span>,user.getPassword(),<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">// ä½ ä¼šå‘ç°çœ‹ä¸åˆ°ç”¨æˆ·çš„æ˜æ–‡å¯†ç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è¯·æ±‚æˆæƒ"><a href="#è¯·æ±‚æˆæƒ" class="headerlink" title="è¯·æ±‚æˆæƒ"></a>è¯·æ±‚æˆæƒ</h1><h2 id="æ•°æ®åº“è®¾è®¡"><a href="#æ•°æ®åº“è®¾è®¡" class="headerlink" title="æ•°æ®åº“è®¾è®¡"></a>æ•°æ®åº“è®¾è®¡</h2><ul><li>æ¯ä¸ªç”¨æˆ·å…·æœ‰ä¸åŒçš„æƒé™ï¼Œè¿™äº›æƒé™å¯ä»¥å­˜åœ¨æ•°æ®åº“çš„å­—æ®µä¸­ã€‚æ¯”å¦‚æ·»åŠ å­—æ®µ<code>perms</code>ï¼Œå…·æœ‰<code>user:add</code>å’Œ<code>user:update</code>ä¸¤ç§æƒé™</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@0996699dd9da6c6d54e409263e24f2667a8c9b21/2021/06/25/89df08ab825c0be8817e987e5c80614c.png"></p><div class="note success simple"><p>IDEAä¸­å¯ä»¥ä¿®æ”¹æ•°æ®è¡¨å’Œæ•°æ®</p></div><ul><li>å®ä½“ç±»ä¿®æ”¹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String Username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String perms;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æˆæƒæ“ä½œ"><a href="#æˆæƒæ“ä½œ" class="headerlink" title="æˆæƒæ“ä½œ"></a>æˆæƒæ“ä½œ</h2><ul><li>é¦–å…ˆéœ€è¦åœ¨<code>ShiroConfig</code>ä¸­é…ç½®ç”¨æˆ·æƒé™è¿‡æ»¤ï¼ŒæŒ‡å®šç”¨æˆ·æƒé™</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ShiroFilterFactoryBeanï¼Œç¬¬ä¸‰æ­¥</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">getShiroFilterFactoryBean</span><span class="params">(<span class="meta">@Qualifier(&quot;SecurityManager&quot;)</span> DefaultWebSecurityManager defaultWebSecurityManager)</span></span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean factoryBean = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line">        <span class="comment">// è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span></span><br><span class="line">        factoryBean.setSecurityManager(defaultWebSecurityManager);</span><br><span class="line">        Map&lt;String,String&gt; filterMap = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();;</span><br><span class="line">        <span class="comment">// æˆæƒï¼Œæ­£å¸¸æƒ…å†µä¸‹æœªæˆæƒä¼šè·³è½¬åˆ°æœªæˆæƒé¡µé¢</span></span><br><span class="line">        filterMap.put(<span class="string">&quot;/user/add&quot;</span>,<span class="string">&quot;perms[user:add]&quot;</span>); <span class="comment">//å¸¦æœ‰user:addå­—ç¬¦ä¸²</span></span><br><span class="line">        filterMap.put(<span class="string">&quot;/user/update&quot;</span>,<span class="string">&quot;perms[user:update]&quot;</span>);</span><br><span class="line">        factoryBean.setFilterChainDefinitionMap(filterMap);</span><br><span class="line">        <span class="comment">// è®¾ç½®ç™»å½•çš„è¯·æ±‚</span></span><br><span class="line">        factoryBean.setLoginUrl(<span class="string">&quot;/toLogin&quot;</span>);</span><br><span class="line">        <span class="comment">//è·³åˆ°æœªæˆæƒé¡µé¢</span></span><br><span class="line">        factoryBean.setUnauthorizedUrl(<span class="string">&quot;/noauth&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> factoryBean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//DefaultWebSecurityManager ï¼Œç¬¬äºŒæ­¥ ï¼Œä»springä¸­æ‹¿ï¼Œéœ€è¦ä¼ å‚ï¼Œé€šè¿‡@Qualifierç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;SecurityManager&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">getDefaultWebSecurityManager</span><span class="params">(<span class="meta">@Qualifier(&quot;userRealm&quot;)</span> UserRealm userRealm)</span></span>&#123;</span><br><span class="line">        DefaultWebSecurityManager securityManager = <span class="keyword">new</span> DefaultWebSecurityManager();</span><br><span class="line">        <span class="comment">// å…³è”Realm</span></span><br><span class="line">        securityManager.setRealm(userRealm);</span><br><span class="line">        <span class="keyword">return</span> securityManager;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ›å»ºrealmå¯¹è±¡ï¼Œéœ€è¦è‡ªå®šä¹‰ï¼Œç¬¬ä¸€æ­¥</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;userRealm&quot;)</span> <span class="comment">// è®©springæ¥ç®¡,nameå¯ä»¥ä¸å†™ã€‚é»˜è®¤ç»‘å®šå°±æ˜¯æ–¹æ³•åuserRealm</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserRealm <span class="title">userRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserRealm();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨æ§åˆ¶å™¨ä¸­è·³è½¬åˆ°æœªæˆæƒé¡µé¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/noauth&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">unauthorized</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;æœªç»æˆæƒæ— æ³•è®¿é—®æ­¤é¡µé¢&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç„¶ååœ¨<code> UserRealm</code>ä¸­æ“ä½œæ•°æ®åº“å¹¶ç»™ç”¨æˆ·æˆæƒã€‚è¿™æ˜¯ç™»é™†åå°±ä¼šæ‰§è¡Œçš„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰çš„UserRealm</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="comment">// æˆæƒ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†æˆæƒ&quot;</span>);</span><br><span class="line">        SimpleAuthorizationInfo info = <span class="keyword">new</span> SimpleAuthorizationInfo();</span><br><span class="line">        <span class="comment">// æˆäºˆç”¨æˆ·æƒé™ ,å…¶å®è¿™é‡Œçš„æƒé™å¯ä»¥åˆ›å»ºä¸€ä¸ªæ•°æ®è¡¨çš„æƒé™å­—æ®µ</span></span><br><span class="line">        <span class="comment">//info.addStringPermission(&quot;user:add&quot;);</span></span><br><span class="line">        <span class="comment">// æ‹¿åˆ°å½“å‰ç™»å½•çš„å¯¹è±¡</span></span><br><span class="line">        Subject subject = SecurityUtils.getSubject();</span><br><span class="line">        User currentuser = (User) subject.getPrincipal(); <span class="comment">//æ‹¿åˆ°Userå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®å½“å‰ç”¨æˆ·æƒé™</span></span><br><span class="line">        info.addStringPermission(currentuser.getPerms());</span><br><span class="line">        <span class="keyword">return</span> info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¤è¯</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†è®¤è¯&quot;</span>);</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°ç”¨æˆ·ç™»å½•ä¿¡æ¯</span></span><br><span class="line">        UsernamePasswordToken usertoken = (UsernamePasswordToken) authenticationToken;</span><br><span class="line">        <span class="comment">// è¿æ¥æ•°æ®åº“</span></span><br><span class="line">        User user = userService.queryUserByName(usertoken.getUsername());</span><br><span class="line">        <span class="keyword">if</span>(user==<span class="keyword">null</span>)&#123;  <span class="comment">//ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">//UnknownAccountException</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¯ä»¥åŠ å¯†ï¼šMD5:827CCB0EEA8A706C4C34A16891F84E7Bï¼ŒMD5ç›å€¼åŠ å¯†:827CCB0EEA8A706C4C34A16891F84E7Busername</span></span><br><span class="line">        <span class="comment">// å¯†ç è®¤è¯ï¼ŒShiroå¸®ä½ å®Œæˆå¹¶åŠ å¯†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(user,user.getPassword(),<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">// ä½ ä¼šå‘ç°çœ‹ä¸åˆ°ç”¨æˆ·çš„æ˜æ–‡å¯†ç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ•´åˆThymeleaf"><a href="#æ•´åˆThymeleaf" class="headerlink" title="æ•´åˆThymeleaf"></a>æ•´åˆThymeleaf</h1><h2 id="ç›¸å…³ä¾èµ–"><a href="#ç›¸å…³ä¾èµ–" class="headerlink" title="ç›¸å…³ä¾èµ–"></a>ç›¸å…³ä¾èµ–</h2><ul><li>éœ€æ±‚ï¼šæ ¹æ®ä¸åŒçš„æƒé™æ˜¾ç¤ºä¸åŒçš„è·³è½¬é€‰é¡¹ï¼Œæ¯”å¦‚<code>admin</code>ç”¨æˆ·åªæœ‰<code>user:add</code>æƒé™ï¼Œåˆ™ä¸æ˜¾ç¤º<code>update</code>é€‰é¡¹</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@50c3ebf42773dd4b3b27a53823abffd204ffb5e8/2021/06/25/a15d3b31be5c687e5811ba2b8aa6fc88.png"></p><ul><li>éœ€è¦å¯¼å…¥Shiroæ•´åˆThymeleafçš„åŒ…</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Shrioæ•´åˆThymeleaf--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.theborakompanioni<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-shiro<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Shiroé…ç½®"><a href="#Shiroé…ç½®" class="headerlink" title="Shiroé…ç½®"></a>Shiroé…ç½®</h2><ul><li>åœ¨<code>ShiroConfig</code>é…ç½®ç±»ä¸­è¿›è¡Œæ•´åˆThymeleafçš„é…ç½®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ShiroFilterFactoryBeanï¼Œç¬¬ä¸‰æ­¥</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">getShiroFilterFactoryBean</span><span class="params">(<span class="meta">@Qualifier(&quot;SecurityManager&quot;)</span> DefaultWebSecurityManager defaultWebSecurityManager)</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//DefaultWebSecurityManager ï¼Œç¬¬äºŒæ­¥ ï¼Œä»springä¸­æ‹¿ï¼Œéœ€è¦ä¼ å‚ï¼Œé€šè¿‡@Qualifierç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;SecurityManager&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">getDefaultWebSecurityManager</span><span class="params">(<span class="meta">@Qualifier(&quot;userRealm&quot;)</span> UserRealm userRealm)</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ›å»ºrealmå¯¹è±¡ï¼Œéœ€è¦è‡ªå®šä¹‰ï¼Œç¬¬ä¸€æ­¥</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;userRealm&quot;)</span> <span class="comment">// è®©springæ¥ç®¡,nameå¯ä»¥ä¸å†™ã€‚é»˜è®¤ç»‘å®šå°±æ˜¯æ–¹æ³•åuserRealm</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserRealm <span class="title">userRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserRealm();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•´åˆShiroDialect:ç”¨æ¥æ•´åˆShiro Thymeleaf</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroDialect <span class="title">getShiroDialect</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ShiroDialect();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨<code>UserRealm</code>æ·»åŠ ç”¨æˆ·Sessionï¼Œåé¢ä¼šç”¨åˆ°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰çš„UserRealm</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="comment">// æˆæƒ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†æˆæƒ&quot;</span>);</span><br><span class="line">        SimpleAuthorizationInfo info = <span class="keyword">new</span> SimpleAuthorizationInfo();</span><br><span class="line">        <span class="comment">// æˆäºˆç”¨æˆ·æƒé™ ,å…¶å®è¿™é‡Œçš„æƒé™å¯ä»¥åˆ›å»ºä¸€ä¸ªæ•°æ®è¡¨çš„æƒé™å­—æ®µ</span></span><br><span class="line">        <span class="comment">// æ‹¿åˆ°å½“å‰ç™»å½•çš„å¯¹è±¡</span></span><br><span class="line">        Subject subject = SecurityUtils.getSubject();</span><br><span class="line">        User currentuser = (User) subject.getPrincipal(); <span class="comment">//æ‹¿åˆ°Userå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®å½“å‰ç”¨æˆ·æƒé™ï¼ˆå€¼ä»æ•°æ®åº“å–ï¼‰</span></span><br><span class="line">        info.addStringPermission(currentuser.getPerms());</span><br><span class="line">        <span class="keyword">return</span> info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¤è¯</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†è®¤è¯&quot;</span>);</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°ç”¨æˆ·ç™»å½•ä¿¡æ¯</span></span><br><span class="line">        UsernamePasswordToken usertoken = (UsernamePasswordToken) authenticationToken;</span><br><span class="line">        <span class="comment">// è¿æ¥æ•°æ®åº“</span></span><br><span class="line">        User user = userService.queryUserByName(usertoken.getUsername());</span><br><span class="line">        <span class="keyword">if</span>(user==<span class="keyword">null</span>)&#123;  <span class="comment">//ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">//UnknownAccountException</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ·»åŠ ç”¨æˆ·Session</span></span><br><span class="line">        Subject currentSubjecty = SecurityUtils.getSubject();</span><br><span class="line">        Session session = currentSubjecty.getSession();</span><br><span class="line">        session.setAttribute(<span class="string">&quot;loginUser&quot;</span>,user);</span><br><span class="line">        <span class="comment">// å¯ä»¥åŠ å¯†ï¼šMD5:827CCB0EEA8A706C4C34A16891F84E7Bï¼ŒMD5ç›å€¼åŠ å¯†:827CCB0EEA8A706C4C34A16891F84E7Busername</span></span><br><span class="line">        <span class="comment">// å¯†ç è®¤è¯ï¼ŒShiroå¸®ä½ å®Œæˆå¹¶åŠ å¯†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(user,user.getPassword(),<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">// ä½ ä¼šå‘ç°çœ‹ä¸åˆ°ç”¨æˆ·çš„æ˜æ–‡å¯†ç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‰ç«¯æ“ä½œ"><a href="#å‰ç«¯æ“ä½œ" class="headerlink" title="å‰ç«¯æ“ä½œ"></a>å‰ç«¯æ“ä½œ</h2><ul><li>éœ€è¦å¯¼å…¥å‘½åç©ºé—´</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:shiro</span>=<span class="string">http://www.pollix.at/thymeleaf/shiro</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å‰ç«¯é¡µé¢</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ä»sessionä¸­åˆ¤æ–­å€¼ï¼Œç™»é™†åå°±ä¸è¦æ˜¾ç¤ºç™»é™†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.loginUser==null&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/toLogin&#125;&quot;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">shiro:hasPermission</span>=<span class="string">&quot;user:add&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/add&#125;&quot;</span>&gt;</span>add<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">shiro:hasPermission</span>=<span class="string">&quot;user:update&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/update&#125;&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ•´åˆMyBatis&quot;&gt;&lt;a href=&quot;#æ•´åˆMyBatis&quot; class=&quot;headerlink&quot; title=&quot;æ•´åˆMyBatis&quot;&gt;&lt;/a&gt;æ•´åˆMyBatis&lt;/h1&gt;&lt;h2 id=&quot;å¯¼å…¥ç›¸å…³ä¾èµ–&quot;&gt;&lt;a href=&quot;#å¯¼å…¥ç›¸å…³ä¾èµ–&quot; class=&quot;head</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    <category term="Shrio" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/Shrio/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="Shrio" scheme="http://xiaoliblog.cn/tags/Shrio/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒæ•´åˆShiroå®‰å…¨æ¡†æ¶</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot14.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot14.html</id>
    <published>2021-06-24T12:07:17.437Z</published>
    <updated>2021-06-25T12:05:51.916Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Shiro"><a href="#Shiro" class="headerlink" title="Shiro"></a>Shiro</h1><h2 id="Shiroç®€ä»‹"><a href="#Shiroç®€ä»‹" class="headerlink" title="Shiroç®€ä»‹"></a>Shiroç®€ä»‹</h2><ul><li>Apache Shiroæ˜¯ä¸€ä¸ªJavaçš„å®‰å…¨ï¼ˆæƒé™ï¼‰æ¡†æ¶ã€‚ç›®å‰ï¼Œä½¿ç”¨ Apache Shiro çš„äººè¶Šæ¥è¶Šå¤šï¼Œå› ä¸ºå®ƒç›¸å½“ç®€å•ï¼Œå¯¹æ¯” Spring Securityï¼Œå¯èƒ½æ²¡æœ‰ Spring Security åšçš„åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯åœ¨å®é™…å·¥ä½œæ—¶å¯èƒ½å¹¶ä¸éœ€è¦é‚£ä¹ˆå¤æ‚çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä½¿ç”¨å°è€Œç®€å•çš„ Shiro å°±è¶³å¤Ÿäº†</li><li>ä¸‹è½½åœ°å€ï¼š<a href="http://shiro.apache.org/">http://shiro.apache.org/</a></li><li>GitHubåœ°å€ï¼š<a href="https://github.com/apache/shiro">https://github.com/apache/shiro</a></li><li>W3Cæ–‡æ¡£ï¼š<a href="https://www.w3cschool.cn/shiro/">https://www.w3cschool.cn/shiro/</a></li><li>Shiro å¯ä»¥éå¸¸å®¹æ˜“çš„å¼€å‘å‡ºè¶³å¤Ÿå¥½çš„åº”ç”¨ï¼Œå…¶ä¸ä»…å¯ä»¥ç”¨åœ¨ JavaSE ç¯å¢ƒï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨ JavaEE ç¯å¢ƒã€‚Shiro å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆï¼šè®¤è¯ã€æˆæƒã€åŠ å¯†ã€ä¼šè¯ç®¡ç†ã€ä¸ Web é›†æˆã€ç¼“å­˜ç­‰ã€‚è¿™ä¸å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„å˜›ï¼Œè€Œä¸” Shiro çš„ API ä¹Ÿæ˜¯éå¸¸ç®€å•ï¼›å…¶åŸºæœ¬åŠŸèƒ½ç‚¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@4feae32f77ac7c08e8a350076062d6c27656ad88/2021/06/24/918a993434741da89240e4d2f23a68a0.png"></p><ul><li><code>Authentication</code>ï¼šèº«ä»½è®¤è¯ / ç™»å½•ï¼ŒéªŒè¯ç”¨æˆ·æ˜¯ä¸æ˜¯æ‹¥æœ‰ç›¸åº”çš„èº«ä»½ï¼›</li><li><code>Authorization</code>ï¼šæˆæƒï¼Œå³æƒé™éªŒè¯ï¼ŒéªŒè¯æŸä¸ªå·²è®¤è¯çš„ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªæƒé™ï¼›å³åˆ¤æ–­ç”¨æˆ·æ˜¯å¦èƒ½åšäº‹æƒ…ï¼Œå¸¸è§çš„å¦‚ï¼šéªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªè§’è‰²ã€‚æˆ–è€…ç»†ç²’åº¦çš„éªŒè¯æŸä¸ªç”¨æˆ·å¯¹æŸä¸ªèµ„æºæ˜¯å¦å…·æœ‰æŸä¸ªæƒé™ï¼›</li><li><code>Session Management</code>ï¼šä¼šè¯ç®¡ç†ï¼Œå³ç”¨æˆ·ç™»å½•åå°±æ˜¯ä¸€æ¬¡ä¼šè¯ï¼Œåœ¨æ²¡æœ‰é€€å‡ºä¹‹å‰ï¼Œå®ƒçš„æ‰€æœ‰ä¿¡æ¯éƒ½åœ¨ä¼šè¯ä¸­ï¼›ä¼šè¯å¯ä»¥æ˜¯æ™®é€š JavaSE ç¯å¢ƒçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¦‚ Web ç¯å¢ƒçš„ï¼›</li><li><code>Cryptography</code>ï¼šåŠ å¯†ï¼Œä¿æŠ¤æ•°æ®çš„å®‰å…¨æ€§ï¼Œå¦‚å¯†ç åŠ å¯†å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œè€Œä¸æ˜¯æ˜æ–‡å­˜å‚¨ï¼›</li><li><code>Web Support</code>ï¼šWeb æ”¯æŒï¼Œå¯ä»¥éå¸¸å®¹æ˜“çš„é›†æˆåˆ° Web ç¯å¢ƒï¼›</li><li><code>Caching</code>ï¼šç¼“å­˜ï¼Œæ¯”å¦‚ç”¨æˆ·ç™»å½•åï¼Œå…¶ç”¨æˆ·ä¿¡æ¯ã€æ‹¥æœ‰çš„è§’è‰² / æƒé™ä¸å¿…æ¯æ¬¡å»æŸ¥ï¼Œè¿™æ ·å¯ä»¥æé«˜æ•ˆç‡ï¼›</li><li><code>Concurrency</code>ï¼šshiro æ”¯æŒå¤šçº¿ç¨‹åº”ç”¨çš„å¹¶å‘éªŒè¯ï¼Œå³å¦‚åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å¼€å¯å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œèƒ½æŠŠæƒé™è‡ªåŠ¨ä¼ æ’­è¿‡å»ï¼›</li><li><code>Testing</code>ï¼šæä¾›æµ‹è¯•æ”¯æŒï¼›</li><li><code>Run As</code>ï¼šå…è®¸ä¸€ä¸ªç”¨æˆ·å‡è£…ä¸ºå¦ä¸€ä¸ªç”¨æˆ·ï¼ˆå¦‚æœä»–ä»¬å…è®¸ï¼‰çš„èº«ä»½è¿›è¡Œè®¿é—®ï¼›</li><li><code>Remember Me</code>ï¼šè®°ä½æˆ‘ï¼Œè¿™ä¸ªæ˜¯éå¸¸å¸¸è§çš„åŠŸèƒ½ï¼Œå³ä¸€æ¬¡ç™»å½•åï¼Œä¸‹æ¬¡å†æ¥çš„è¯ä¸ç”¨ç™»å½•äº†ã€‚</li></ul><div class="note success simple"><p><strong>è®°ä½ä¸€ç‚¹ï¼ŒShiro ä¸ä¼šå»ç»´æŠ¤ç”¨æˆ·ã€ç»´æŠ¤æƒé™ï¼›è¿™äº›éœ€è¦æˆ‘ä»¬è‡ªå·±å»è®¾è®¡ / æä¾›ï¼›ç„¶åé€šè¿‡ç›¸åº”çš„æ¥å£æ³¨å…¥ç»™ Shiro å³å¯</strong></p></div><h2 id="Shiroæ¶æ„-å¤–éƒ¨"><a href="#Shiroæ¶æ„-å¤–éƒ¨" class="headerlink" title="Shiroæ¶æ„(å¤–éƒ¨)"></a>Shiroæ¶æ„(å¤–éƒ¨)</h2><ul><li>é¦–å…ˆï¼Œæˆ‘ä»¬ä»å¤–éƒ¨æ¥çœ‹ Shiro å§ï¼Œå³ä»åº”ç”¨ç¨‹åºè§’åº¦çš„æ¥è§‚å¯Ÿå¦‚ä½•ä½¿ç”¨ Shiro å®Œæˆå·¥ä½œã€‚å¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@04adf5feed685897481041c734870f6ae760db15/2021/06/24/dd2fad8e65cc172d4cb1db41eb4ae72b.png"></p><ul><li>å¯ä»¥çœ‹åˆ°ï¼šåº”ç”¨ä»£ç ç›´æ¥äº¤äº’çš„å¯¹è±¡æ˜¯<code>Subject</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ Shiro çš„å¯¹å¤– API æ ¸å¿ƒå°±æ˜¯ <code>Subject</code>ï¼›å…¶æ¯ä¸ª API çš„å«ä¹‰ï¼š</li><li><code>Subject</code>ï¼šä¸»ä½“ï¼Œä»£è¡¨äº†å½“å‰ â€œç”¨æˆ·â€ï¼Œè¿™ä¸ªç”¨æˆ·ä¸ä¸€å®šæ˜¯ä¸€ä¸ªå…·ä½“çš„äººï¼Œä¸å½“å‰åº”ç”¨äº¤äº’çš„ä»»ä½•ä¸œè¥¿éƒ½æ˜¯ Subjectï¼Œå¦‚ç½‘ç»œçˆ¬è™«ï¼Œæœºå™¨äººç­‰ï¼›å³ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼›æ‰€æœ‰ Subject éƒ½ç»‘å®šåˆ° - SecurityManagerï¼Œä¸ Subject çš„æ‰€æœ‰äº¤äº’éƒ½ä¼šå§”æ‰˜ç»™ SecurityManagerï¼›å¯ä»¥æŠŠ Subject è®¤ä¸ºæ˜¯ä¸€ä¸ªé—¨é¢ï¼›SecurityManager æ‰æ˜¯å®é™…çš„æ‰§è¡Œè€…ï¼›</li><li><code>SecurityManager</code>ï¼šå®‰å…¨ç®¡ç†å™¨ï¼›å³æ‰€æœ‰ä¸å®‰å…¨æœ‰å…³çš„æ“ä½œéƒ½ä¼šä¸ SecurityManager äº¤äº’ï¼›ä¸”å®ƒç®¡ç†ç€æ‰€æœ‰ Subjectï¼›å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ Shiro çš„æ ¸å¿ƒï¼Œå®ƒè´Ÿè´£ä¸åè¾¹ä»‹ç»çš„å…¶ä»–ç»„ä»¶è¿›è¡Œäº¤äº’ï¼Œå¦‚æœå­¦ä¹ è¿‡ SpringMVCï¼Œä½ å¯ä»¥æŠŠå®ƒçœ‹æˆ DispatcherServlet å‰ç«¯æ§åˆ¶å™¨ï¼›</li><li><code>Realm</code>ï¼šåŸŸï¼ŒShiro ä» Realm è·å–å®‰å…¨æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰ï¼Œå°±æ˜¯è¯´ SecurityManager è¦éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œé‚£ä¹ˆå®ƒéœ€è¦ä» Realm è·å–ç›¸åº”çš„ç”¨æˆ·è¿›è¡Œæ¯”è¾ƒä»¥ç¡®å®šç”¨æˆ·èº«ä»½æ˜¯å¦åˆæ³•ï¼›ä¹Ÿéœ€è¦ä» Realm å¾—åˆ°ç”¨æˆ·ç›¸åº”çš„è§’è‰² / æƒé™è¿›è¡ŒéªŒè¯ç”¨æˆ·æ˜¯å¦èƒ½è¿›è¡Œæ“ä½œï¼›å¯ä»¥æŠŠ Realm çœ‹æˆ DataSourceï¼Œå³å®‰å…¨æ•°æ®æºã€‚</li><li>ä¹Ÿå°±æ˜¯è¯´å¯¹äºæˆ‘ä»¬è€Œè¨€ï¼Œæœ€ç®€å•çš„ä¸€ä¸ª Shiro åº”ç”¨ï¼š<ul><li>åº”ç”¨ä»£ç é€šè¿‡ <code>Subject</code> æ¥è¿›è¡Œè®¤è¯å’Œæˆæƒï¼Œè€Œ <code>Subject</code> åˆå§”æ‰˜ç»™ <code>SecurityManager</code>ï¼›</li><li>æˆ‘ä»¬éœ€è¦ç»™ Shiro çš„ <code>SecurityManager</code> æ³¨å…¥ <code>Realm</code>ï¼Œä»è€Œè®© <code>SecurityManager </code>èƒ½å¾—åˆ°åˆæ³•çš„ç”¨æˆ·åŠå…¶æƒé™è¿›è¡Œåˆ¤æ–­ã€‚</li></ul></li><li>ä»ä»¥ä¸Šä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒShiro ä¸æä¾›ç»´æŠ¤ç”¨æˆ· / æƒé™ï¼Œè€Œæ˜¯é€šè¿‡ Realm è®©å¼€å‘äººå‘˜è‡ªå·±æ³¨å…¥ã€‚</li></ul><h2 id="Shiroæ¶æ„-å†…éƒ¨"><a href="#Shiroæ¶æ„-å†…éƒ¨" class="headerlink" title="Shiroæ¶æ„(å†…éƒ¨)"></a>Shiroæ¶æ„(å†…éƒ¨)</h2><ul><li>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä» Shiro å†…éƒ¨æ¥çœ‹ä¸‹ Shiro çš„æ¶æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@14bf109f813cd6e286b5e24f6aca4c5a1d6f1d1b/2021/06/24/296c95d591942a42c29619c1918140b1.png"></p><ul><li><code>Subject</code>ï¼šä¸»ä½“ï¼Œå¯ä»¥çœ‹åˆ°ä¸»ä½“å¯ä»¥æ˜¯ä»»ä½•å¯ä»¥ä¸åº”ç”¨äº¤äº’çš„ â€œç”¨æˆ·â€ï¼›</li><li><code>SecurityManager</code>ï¼šç›¸å½“äº SpringMVC ä¸­çš„ DispatcherServlet æˆ–è€… Struts2 ä¸­çš„ FilterDispatcherï¼›æ˜¯ Shiro çš„å¿ƒè„ï¼›æ‰€æœ‰å…·ä½“çš„äº¤äº’éƒ½é€šè¿‡ SecurityManager è¿›è¡Œæ§åˆ¶ï¼›å®ƒç®¡ç†ç€æ‰€æœ‰ Subjectã€ä¸”è´Ÿè´£è¿›è¡Œè®¤è¯å’Œæˆæƒã€åŠä¼šè¯ã€ç¼“å­˜çš„ç®¡ç†ã€‚</li><li><code>Authenticator</code>ï¼šè®¤è¯å™¨ï¼Œè´Ÿè´£ä¸»ä½“è®¤è¯çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªæ‰©å±•ç‚¹ï¼Œå¦‚æœç”¨æˆ·è§‰å¾— Shiro é»˜è®¤çš„ä¸å¥½ï¼Œå¯ä»¥è‡ªå®šä¹‰å®ç°ï¼›å…¶éœ€è¦è®¤è¯ç­–ç•¥ï¼ˆAuthentication Strategyï¼‰ï¼Œå³ä»€ä¹ˆæƒ…å†µä¸‹ç®—ç”¨æˆ·è®¤è¯é€šè¿‡äº†ï¼›</li><li><code>Authrizer</code>ï¼šæˆæƒå™¨ï¼Œæˆ–è€…è®¿é—®æ§åˆ¶å™¨ï¼Œç”¨æ¥å†³å®šä¸»ä½“æ˜¯å¦æœ‰æƒé™è¿›è¡Œç›¸åº”çš„æ“ä½œï¼›å³æ§åˆ¶ç€ç”¨æˆ·èƒ½è®¿é—®åº”ç”¨ä¸­çš„å“ªäº›åŠŸèƒ½ï¼›</li><li><code>Realm</code>ï¼šå¯ä»¥æœ‰ 1 ä¸ªæˆ–å¤šä¸ª Realmï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å®‰å…¨å®ä½“æ•°æ®æºï¼Œå³ç”¨äºè·å–å®‰å…¨å®ä½“çš„ï¼›å¯ä»¥æ˜¯ JDBC å®ç°ï¼Œä¹Ÿå¯ä»¥æ˜¯ LDAP å®ç°ï¼Œæˆ–è€…å†…å­˜å®ç°ç­‰ç­‰ï¼›ç”±ç”¨æˆ·æä¾›ï¼›æ³¨æ„ï¼šShiro ä¸çŸ¥é“ä½ çš„ç”¨æˆ· / æƒé™å­˜å‚¨åœ¨å“ªåŠä»¥ä½•ç§æ ¼å¼å­˜å‚¨ï¼›æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬åœ¨åº”ç”¨ä¸­éƒ½éœ€è¦å®ç°è‡ªå·±çš„ Realmï¼›</li><li><code>SessionManager</code>ï¼šå¦‚æœå†™è¿‡ Servlet å°±åº”è¯¥çŸ¥é“ Session çš„æ¦‚å¿µï¼ŒSession å‘¢éœ€è¦æœ‰äººå»ç®¡ç†å®ƒçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™ä¸ªç»„ä»¶å°±æ˜¯ SessionManagerï¼›è€Œ Shiro å¹¶ä¸ä»…ä»…å¯ä»¥ç”¨åœ¨ Web ç¯å¢ƒï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨å¦‚æ™®é€šçš„ JavaSE ç¯å¢ƒã€EJB ç­‰ç¯å¢ƒï¼›æ‰€ä»¥å‘¢ï¼ŒShiro å°±æŠ½è±¡äº†ä¸€ä¸ªè‡ªå·±çš„ Session æ¥ç®¡ç†ä¸»ä½“ä¸åº”ç”¨ä¹‹é—´äº¤äº’çš„æ•°æ®ï¼›è¿™æ ·çš„è¯ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ Web ç¯å¢ƒç”¨ï¼Œåˆšå¼€å§‹æ˜¯ä¸€å° Web æœåŠ¡å™¨ï¼›æ¥ç€åˆä¸Šäº†å° EJB æœåŠ¡å™¨ï¼›è¿™æ—¶æƒ³æŠŠä¸¤å°æœåŠ¡å™¨çš„ä¼šè¯æ•°æ®æ”¾åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥å®ç°è‡ªå·±çš„åˆ†å¸ƒå¼ä¼šè¯ï¼ˆå¦‚æŠŠæ•°æ®æ”¾åˆ° Memcached æœåŠ¡å™¨ï¼‰ï¼›</li><li><code>SessionDAO</code>ï¼šDAO å¤§å®¶éƒ½ç”¨è¿‡ï¼Œæ•°æ®è®¿é—®å¯¹è±¡ï¼Œç”¨äºä¼šè¯çš„ CRUDï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³æŠŠ Session ä¿å­˜åˆ°æ•°æ®åº“ï¼Œé‚£ä¹ˆå¯ä»¥å®ç°è‡ªå·±çš„ SessionDAOï¼Œé€šè¿‡å¦‚ JDBC å†™åˆ°æ•°æ®åº“ï¼›æ¯”å¦‚æƒ³æŠŠ Session æ”¾åˆ° Memcached ä¸­ï¼Œå¯ä»¥å®ç°è‡ªå·±çš„ Memcached SessionDAOï¼›å¦å¤– SessionDAO ä¸­å¯ä»¥ä½¿ç”¨ Cache è¿›è¡Œç¼“å­˜ï¼Œä»¥æé«˜æ€§èƒ½ï¼›</li><li><code>CacheManager</code>ï¼šç¼“å­˜æ§åˆ¶å™¨ï¼Œæ¥ç®¡ç†å¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ç­‰çš„ç¼“å­˜çš„ï¼›å› ä¸ºè¿™äº›æ•°æ®åŸºæœ¬ä¸Šå¾ˆå°‘å»æ”¹å˜ï¼Œæ”¾åˆ°ç¼“å­˜ä¸­åå¯ä»¥æé«˜è®¿é—®çš„æ€§èƒ½</li><li><code>Cryptography</code>ï¼šå¯†ç æ¨¡å—ï¼ŒShiro æä¾›äº†ä¸€äº›å¸¸è§çš„åŠ å¯†ç»„ä»¶ç”¨äºå¦‚å¯†ç åŠ å¯† / è§£å¯†çš„ã€‚</li></ul><h1 id="æ•´åˆShiro"><a href="#æ•´åˆShiro" class="headerlink" title="æ•´åˆShiro"></a>æ•´åˆShiro</h1><h2 id="ç›¸å…³ä¾èµ–"><a href="#ç›¸å…³ä¾èµ–" class="headerlink" title="ç›¸å…³ä¾èµ–"></a>ç›¸å…³ä¾èµ–</h2><ul><li>åˆ›å»ºä¸€ä¸ªSpringBooté¡¹ç›®ï¼Œé€‰æ‹©Webæ¨¡å—</li><li>å¯¼å…¥ç›¸å…³ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--shiroæ•´åˆspringçš„åŒ…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™é…ç½®ç±»"><a href="#ç¼–å†™é…ç½®ç±»" class="headerlink" title="ç¼–å†™é…ç½®ç±»"></a>ç¼–å†™é…ç½®ç±»</h2><ul><li>åœ¨é…ç½®Shiroé…ç½®ç±»å‰ï¼Œå…ˆå†™ä¸€ä¸ªç®€å•çš„Realmï¼Œæ–°å»º<code>config</code>åŒ…ï¼Œè‡ªå®šä¹‰<code>UserRealm</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰çš„UserRealm</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æˆæƒ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†æˆæƒ&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¤è¯</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†è®¤è¯&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ–°å»º<code>config</code>åŒ…ï¼Œåˆ›å»º<code>ShiroConfig</code>é…ç½®ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ShiroFilterFactoryBeanï¼Œç¬¬ä¸‰æ­¥</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">getShiroFilterFactoryBean</span><span class="params">(<span class="meta">@Qualifier(&quot;SecurityManager&quot;)</span> DefaultWebSecurityManager defaultWebSecurityManager)</span></span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean factoryBean = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line">        <span class="comment">// è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span></span><br><span class="line">        factoryBean.setSecurityManager(defaultWebSecurityManager);</span><br><span class="line">        <span class="keyword">return</span> factoryBean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//DefaultWebSecurityManager ï¼Œç¬¬äºŒæ­¥ ï¼Œä»springä¸­æ‹¿ï¼Œéœ€è¦ä¼ å‚ï¼Œé€šè¿‡@Qualifierç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;SecurityManager&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">getDefaultWebSecurityManager</span><span class="params">(<span class="meta">@Qualifier(&quot;userRealm&quot;)</span> UserRealm userRealm)</span></span>&#123;</span><br><span class="line">        DefaultWebSecurityManager securityManager = <span class="keyword">new</span> DefaultWebSecurityManager();</span><br><span class="line">        <span class="comment">// å…³è”Realm</span></span><br><span class="line">        securityManager.setRealm(userRealm);</span><br><span class="line">        <span class="keyword">return</span> securityManager;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ›å»ºrealmå¯¹è±¡ï¼Œéœ€è¦è‡ªå®šä¹‰ï¼Œç¬¬ä¸€æ­¥</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;userRealm&quot;)</span> <span class="comment">// è®©springæ¥ç®¡,nameå¯ä»¥ä¸å†™ã€‚é»˜è®¤ç»‘å®šå°±æ˜¯æ–¹æ³•åuserRealm</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserRealm <span class="title">userRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserRealm();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™ä¸‰ä¸ªå‰ç«¯é¡µé¢åšæµ‹è¯•ç¯å¢ƒ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|templates</span><br><span class="line">   |--user</span><br><span class="line">     |--add.html</span><br><span class="line">     |--update.html</span><br><span class="line">   |--login.html</span><br><span class="line">   |--index.html</span><br></pre></td></tr></table></figure><ul><li>æ§åˆ¶å™¨å¤„ç†é¡µé¢è·³è½¬</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&#123;&quot;/&quot;,&quot;/index&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toIndex</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/add&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user/add&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/update&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user/update&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/toLogin&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toLogin</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç™»å½•æ‹¦æˆª"><a href="#ç™»å½•æ‹¦æˆª" class="headerlink" title="ç™»å½•æ‹¦æˆª"></a>ç™»å½•æ‹¦æˆª</h1><ul><li>å®ç°<code>add</code>é¡µé¢ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ï¼Œä½†<code>update</code>é¡µé¢éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ï¼Œéœ€è¦ä¿®æ”¹<code>ShiroConfig</code>é…ç½®è¿‡æ»¤å™¨</li></ul><table><thead><tr><th align="center">è¿‡æ»¤å™¨</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>anon</code></td><td align="center">æ— éœ€è®¤è¯å°±å¯ä»¥è®¿é—®</td></tr><tr><td align="center"><code>authc</code></td><td align="center">å¿…é¡»è®¤è¯æ‰èƒ½è®¿é—®</td></tr><tr><td align="center"><code>user</code></td><td align="center">å¿…é¡»æ‹¥æœ‰ è®°ä½æˆ‘åŠŸèƒ½æ‰èƒ½ä½¿ç”¨</td></tr><tr><td align="center"><code>perms</code></td><td align="center">æ‹¥æœ‰å¯¹æŸä¸ªèµ„æºçš„æƒé™æ‰èƒ½è®¿é—®</td></tr><tr><td align="center"><code>role</code></td><td align="center">æ‹¥æœ‰æŸä¸ªè§’è‰²æƒé™æ‰èƒ½è®¿é—®</td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ShiroFilterFactoryBeanï¼Œç¬¬ä¸‰æ­¥</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">getShiroFilterFactoryBean</span><span class="params">(<span class="meta">@Qualifier(&quot;SecurityManager&quot;)</span> DefaultWebSecurityManager defaultWebSecurityManager)</span></span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean factoryBean = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line">        <span class="comment">// è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span></span><br><span class="line">        factoryBean.setSecurityManager(defaultWebSecurityManager);</span><br><span class="line">        <span class="comment">// æ·»åŠ Shiroå†…ç½®è¿‡æ»¤å™¨ï¼Œæœ‰ä»¥ä¸‹è¿‡æ»¤å™¨</span></span><br><span class="line">        Map&lt;String,String&gt; filterMap = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();;</span><br><span class="line">        filterMap.put(<span class="string">&quot;/user/add&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        filterMap.put(<span class="string">&quot;/user/update&quot;</span>,<span class="string">&quot;authc&quot;</span>); </span><br><span class="line">        <span class="comment">//filterMap.put(&quot;/user/*&quot;,&quot;authc&quot;); //æ”¯æŒé€šé…ç¬¦</span></span><br><span class="line">        factoryBean.setFilterChainDefinitionMap(filterMap);</span><br><span class="line">        <span class="comment">// è®¾ç½®ç™»å½•çš„è¯·æ±‚</span></span><br><span class="line">        factoryBean.setLoginUrl(<span class="string">&quot;/toLogin&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> factoryBean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//DefaultWebSecurityManager ï¼Œç¬¬äºŒæ­¥ ï¼Œä»springä¸­æ‹¿ï¼Œéœ€è¦ä¼ å‚ï¼Œé€šè¿‡@Qualifierç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;SecurityManager&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">getDefaultWebSecurityManager</span><span class="params">(<span class="meta">@Qualifier(&quot;userRealm&quot;)</span> UserRealm userRealm)</span></span>&#123;</span><br><span class="line">        DefaultWebSecurityManager securityManager = <span class="keyword">new</span> DefaultWebSecurityManager();</span><br><span class="line">        <span class="comment">// å…³è”Realm</span></span><br><span class="line">        securityManager.setRealm(userRealm);</span><br><span class="line">        <span class="keyword">return</span> securityManager;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ›å»ºrealmå¯¹è±¡ï¼Œéœ€è¦è‡ªå®šä¹‰ï¼Œç¬¬ä¸€æ­¥</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;userRealm&quot;)</span> <span class="comment">// è®©springæ¥ç®¡,nameå¯ä»¥ä¸å†™ã€‚é»˜è®¤ç»‘å®šå°±æ˜¯æ–¹æ³•åuserRealm</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserRealm <span class="title">userRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserRealm();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç”¨æˆ·è®¤è¯"><a href="#ç”¨æˆ·è®¤è¯" class="headerlink" title="ç”¨æˆ·è®¤è¯"></a>ç”¨æˆ·è®¤è¯</h1><ul><li>è®¾ç½®äº†ç™»å½•æ‹¦æˆªè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œå°±éœ€è¦å¯¹ç”¨æˆ·è®¤è¯è¿›è¡Œæ“ä½œ</li><li>å½“ç”¨æˆ·æäº¤è¡¨å•ï¼Œéœ€è¦åœ¨æ§åˆ¶å±‚å¯¹å»è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå°è£…ç”¨æˆ·ä¿¡æ¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;login&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(String username,String password,Model model)</span></span>&#123;</span><br><span class="line">   <span class="comment">// è·å–å½“å‰ç”¨æˆ·</span></span><br><span class="line">   Subject subject = SecurityUtils.getSubject();</span><br><span class="line">   <span class="comment">// å°è£…å½“å‰ç”¨æˆ·çš„ç™»å½•æ•°æ® æ‹¿åˆ°ä»¤ç‰Œtoken</span></span><br><span class="line">   UsernamePasswordToken token = <span class="keyword">new</span> UsernamePasswordToken(username,password);</span><br><span class="line">   <span class="comment">// æ‰§è¡Œç™»å½•æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰å¼‚å¸¸å°±è¡¨ç¤ºæˆåŠŸ</span></span><br><span class="line">   <span class="keyword">try</span>&#123;</span><br><span class="line">      subject.login(token);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">   &#125;<span class="keyword">catch</span> (UnknownAccountException e)&#123; <span class="comment">// ç”¨æˆ·åä¸å­˜åœ¨å¼‚å¸¸</span></span><br><span class="line">      model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;ç”¨æˆ·åé”™è¯¯&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">   &#125;<span class="keyword">catch</span> (IncorrectCredentialsException e)&#123; <span class="comment">// å¯†ç ä¸å­˜åœ¨</span></span><br><span class="line">      model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¡¨å•å¦‚ä¸‹</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å¯† ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç„¶ååœ¨<code>UserRealm</code>ä¸­é…ç½®ç”¨æˆ·è®¤è¯ä¿¡æ¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰çš„UserRealm</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æˆæƒ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†æˆæƒ&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¤è¯</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œäº†è®¤è¯&quot;</span>);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·åå¯†ç åº”è¯¥ä»æ•°æ®åº“ä¸­å–</span></span><br><span class="line">        String username = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°ç”¨æˆ·ç™»å½•ä¿¡æ¯</span></span><br><span class="line">        UsernamePasswordToken usertoken = (UsernamePasswordToken) authenticationToken;</span><br><span class="line">        <span class="keyword">if</span>(!usertoken.getUsername().equals(username))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">//return nullæŠ›å‡ºå¼‚å¸¸ UnknownAccountException</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¯†ç è®¤è¯ï¼ŒShiroå¸®ä½ å®Œæˆ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(<span class="string">&quot;&quot;</span>,password,<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•è¡¨å•ä¸ä»…å¯ä»¥æ™ºèƒ½çš„å®šä½å“ªä¸€é¡¹å‡ºé”™ï¼Œç™»å½•è®¤è¯æˆåŠŸå,<code>update</code>é¡µé¢ä¹Ÿå¯ä»¥è®¿é—®äº†</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Shiro&quot;&gt;&lt;a href=&quot;#Shiro&quot; class=&quot;headerlink&quot; title=&quot;Shiro&quot;&gt;&lt;/a&gt;Shiro&lt;/h1&gt;&lt;h2 id=&quot;Shiroç®€ä»‹&quot;&gt;&lt;a href=&quot;#Shiroç®€ä»‹&quot; class=&quot;headerlink&quot; title=</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    <category term="Shrio" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/Shrio/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="Shrio" scheme="http://xiaoliblog.cn/tags/Shrio/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒé›†æˆSpringSecurity</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot13.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot13.html</id>
    <published>2021-06-23T12:51:43.751Z</published>
    <updated>2021-06-25T12:04:51.795Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SpringSecurity"><a href="#SpringSecurity" class="headerlink" title="SpringSecurity"></a>SpringSecurity</h1><h2 id="å®‰å…¨ç®€ä»‹"><a href="#å®‰å…¨ç®€ä»‹" class="headerlink" title="å®‰å…¨ç®€ä»‹"></a>å®‰å…¨ç®€ä»‹</h2><ul><li>åœ¨ Web å¼€å‘ä¸­ï¼Œå®‰å…¨ä¸€ç›´æ˜¯éå¸¸é‡è¦çš„ä¸€ä¸ªæ–¹é¢ã€‚å®‰å…¨è™½ç„¶å±äºåº”ç”¨çš„éåŠŸèƒ½æ€§éœ€æ±‚ï¼Œä½†æ˜¯åº”è¯¥åœ¨åº”ç”¨å¼€å‘çš„åˆæœŸå°±è€ƒè™‘è¿›æ¥ã€‚å¦‚æœåœ¨åº”ç”¨å¼€å‘çš„åæœŸæ‰è€ƒè™‘å®‰å…¨çš„é—®é¢˜ï¼Œå°±å¯èƒ½é™·å…¥ä¸€ä¸ªä¸¤éš¾çš„å¢ƒåœ°ï¼š<ul><li>ä¸€æ–¹é¢ï¼Œåº”ç”¨å­˜åœ¨ä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œæ— æ³•æ»¡è¶³ç”¨æˆ·çš„è¦æ±‚ï¼Œå¹¶å¯èƒ½é€ æˆç”¨æˆ·çš„éšç§æ•°æ®è¢«æ”»å‡»è€…çªƒå–ï¼›</li><li>å¦ä¸€æ–¹é¢ï¼Œåº”ç”¨çš„åŸºæœ¬æ¶æ„å·²ç»ç¡®å®šï¼Œè¦ä¿®å¤å®‰å…¨æ¼æ´ï¼Œå¯èƒ½éœ€è¦å¯¹ç³»ç»Ÿçš„æ¶æ„åšå‡ºæ¯”è¾ƒé‡å¤§çš„è°ƒæ•´ï¼Œå› è€Œéœ€è¦æ›´å¤šçš„å¼€å‘æ—¶é—´ï¼Œå½±å“åº”ç”¨çš„å‘å¸ƒè¿›ç¨‹ã€‚å› æ­¤ï¼Œä»åº”ç”¨å¼€å‘çš„ç¬¬ä¸€å¤©å°±åº”è¯¥æŠŠå®‰å…¨ç›¸å…³çš„å› ç´ è€ƒè™‘è¿›æ¥ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨çš„å¼€å‘è¿‡ç¨‹ä¸­ã€‚</li></ul></li><li>å¸‚é¢ä¸Šå­˜åœ¨æ¯”è¾ƒæœ‰åçš„ï¼š<code>Shiro</code>ï¼Œ<code>Spring Security</code> ï¼</li><li>Spring Securityæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”é«˜åº¦å¯å®šåˆ¶çš„èº«ä»½éªŒè¯å’Œè®¿é—®æ§åˆ¶æ¡†æ¶ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¿æŠ¤åŸºäºspringçš„åº”ç”¨ç¨‹åºçš„æ ‡å‡†ï¼Œæä¾›äº†ä¸€å¥— Web åº”ç”¨å®‰å…¨æ€§çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚</li><li>Spring Securityæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œä¾§é‡äºä¸ºJavaåº”ç”¨ç¨‹åºæä¾›èº«ä»½éªŒè¯å’Œæˆæƒã€‚ä¸æ‰€æœ‰Springé¡¹ç›®ä¸€æ ·ï¼ŒSpringå®‰å…¨æ€§çš„çœŸæ­£å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒå¯ä»¥è½»æ¾åœ°æ‰©å±•ä»¥æ»¡è¶³å®šåˆ¶éœ€æ±‚</li><li>ä¸€èˆ¬æ¥è¯´ï¼ŒWeb åº”ç”¨çš„å®‰å…¨æ€§åŒ…æ‹¬<strong>ç”¨æˆ·è®¤è¯</strong>ï¼ˆAuthenticationï¼‰å’Œ<strong>ç”¨æˆ·æˆæƒ</strong>ï¼ˆAuthorizationï¼‰ä¸¤ä¸ªéƒ¨åˆ†<ul><li>ç”¨æˆ·è®¤è¯æŒ‡çš„æ˜¯éªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦ä¸ºç³»ç»Ÿä¸­çš„åˆæ³•ä¸»ä½“ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·èƒ½å¦è®¿é—®è¯¥ç³»ç»Ÿã€‚ç”¨æˆ·è®¤è¯ä¸€èˆ¬è¦æ±‚ç”¨æˆ·æä¾›ç”¨æˆ·åå’Œå¯†ç ã€‚ç³»ç»Ÿé€šè¿‡æ ¡éªŒç”¨æˆ·åå’Œå¯†ç æ¥å®Œæˆè®¤è¯è¿‡ç¨‹ã€‚</li><li>ç”¨æˆ·æˆæƒæŒ‡çš„æ˜¯éªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦æœ‰æƒé™æ‰§è¡ŒæŸä¸ªæ“ä½œã€‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œä¸åŒç”¨æˆ·æ‰€å…·æœ‰çš„æƒé™æ˜¯ä¸åŒçš„ã€‚æ¯”å¦‚å¯¹ä¸€ä¸ªæ–‡ä»¶æ¥è¯´ï¼Œæœ‰çš„ç”¨æˆ·åªèƒ½è¿›è¡Œè¯»å–ï¼Œè€Œæœ‰çš„ç”¨æˆ·å¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿä¼šä¸ºä¸åŒçš„ç”¨æˆ·åˆ†é…ä¸åŒçš„è§’è‰²ï¼Œè€Œæ¯ä¸ªè§’è‰²åˆ™å¯¹åº”ä¸€ç³»åˆ—çš„æƒé™ã€‚</li></ul></li><li>å¯¹äºä¸Šé¢æåˆ°çš„ä¸¤ç§åº”ç”¨æƒ…æ™¯ï¼ŒSpring Security æ¡†æ¶éƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚åœ¨ç”¨æˆ·è®¤è¯æ–¹é¢ï¼ŒSpring Security æ¡†æ¶æ”¯æŒä¸»æµçš„è®¤è¯æ–¹å¼ï¼ŒåŒ…æ‹¬ HTTP åŸºæœ¬è®¤è¯ã€HTTP è¡¨å•éªŒè¯ã€HTTP æ‘˜è¦è®¤è¯ã€OpenID å’Œ LDAP ç­‰ã€‚åœ¨ç”¨æˆ·æˆæƒæ–¹é¢ï¼ŒSpring Security æä¾›äº†åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶å’Œè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆAccess Control Listï¼ŒACLï¼‰ï¼Œå¯ä»¥å¯¹åº”ç”¨ä¸­çš„é¢†åŸŸå¯¹è±¡è¿›è¡Œç»†ç²’åº¦çš„æ§åˆ¶ã€‚</li><li>Spring Securityå®˜ç½‘ï¼š<a href="https://spring.io/projects/spring-security">https://spring.io/projects/spring-security</a></li></ul><h2 id="SpringSecurityç®€ä»‹"><a href="#SpringSecurityç®€ä»‹" class="headerlink" title="SpringSecurityç®€ä»‹"></a>SpringSecurityç®€ä»‹</h2><ul><li>Spring Security æ˜¯é’ˆå¯¹Springé¡¹ç›®çš„å®‰å…¨æ¡†æ¶ï¼Œä¹Ÿæ˜¯Spring Bootåº•å±‚å®‰å…¨æ¨¡å—é»˜è®¤çš„æŠ€æœ¯é€‰å‹ï¼Œä»–å¯ä»¥å®ç°å¼ºå¤§çš„Webå®‰å…¨æ§åˆ¶ï¼Œå¯¹äºå®‰å…¨æ§åˆ¶ï¼Œæˆ‘ä»¬ä»…éœ€è¦å¼•å…¥ <code>spring-boot-starter-security</code> æ¨¡å—ï¼Œè¿›è¡Œå°‘é‡çš„é…ç½®ï¼Œå³å¯å®ç°å¼ºå¤§çš„å®‰å…¨ç®¡ç†ï¼</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.security<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-security-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">ç±»å</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>WebSecurityConfigurerAdapter</code></td><td align="center">è‡ªå®šä¹‰Securityç­–ç•¥</td></tr><tr><td align="center"><code>AuthenticationManagerBuilder</code></td><td align="center">è‡ªå®šä¹‰è®¤è¯ç­–ç•¥</td></tr><tr><td align="center"><code>@EnableWebSecurity</code></td><td align="center">å¼€å¯WebSecurityæ¨¡å¼ï¼Œ@Enablexxxå¼€å¯æŸä¸ªæ¨¡å¼</td></tr></tbody></table><ul><li>Spring Securityçš„ä¸¤ä¸ªä¸»è¦ç›®æ ‡æ˜¯ ã€è®¤è¯ã€‘ å’Œ ã€æˆæƒã€‘ï¼ˆè®¿é—®æ§åˆ¶ï¼‰</li><li><strong>è®¤è¯</strong>ï¼ˆAuthenticationï¼‰<ul><li>èº«ä»½éªŒè¯æ˜¯å…³äºéªŒè¯æ‚¨çš„å‡­æ®ï¼Œå¦‚ç”¨æˆ·å/ç”¨æˆ·IDå’Œå¯†ç ï¼Œä»¥éªŒè¯æ‚¨çš„èº«ä»½ã€‚</li><li>èº«ä»½éªŒè¯é€šå¸¸é€šè¿‡ç”¨æˆ·åå’Œå¯†ç å®Œæˆï¼Œæœ‰æ—¶ä¸èº«ä»½éªŒè¯å› ç´ ç»“åˆä½¿ç”¨ã€‚</li></ul></li><li><strong>æˆæƒ</strong> ï¼ˆAuthorizationï¼‰<ul><li>æˆæƒå‘ç”Ÿåœ¨ç³»ç»ŸæˆåŠŸéªŒè¯æ‚¨çš„èº«ä»½åï¼Œæœ€ç»ˆä¼šæˆäºˆæ‚¨è®¿é—®èµ„æºï¼ˆå¦‚ä¿¡æ¯ï¼Œæ–‡ä»¶ï¼Œæ•°æ®åº“ï¼Œèµ„é‡‘ï¼Œä½ç½®ï¼Œå‡ ä¹ä»»ä½•å†…å®¹ï¼‰çš„å®Œå…¨æƒé™ã€‚</li><li>è¿™ä¸ªæ¦‚å¿µæ˜¯é€šç”¨çš„ï¼Œè€Œä¸æ˜¯åªåœ¨Spring Security ä¸­å­˜åœ¨ã€‚</li></ul></li></ul><h2 id="æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="æµ‹è¯•ç¯å¢ƒæ­å»º"></a>æµ‹è¯•ç¯å¢ƒæ­å»º</h2><ul><li>æ–°å»ºä¸€ä¸ªåˆå§‹çš„springbooté¡¹ç›®webæ¨¡å—ï¼Œthymeleafæ¨¡å—ï¼ŒLobmkï¼Œå‹¾é€‰SpringSecurityï¼Œçƒ­éƒ¨ç½²</li><li>å¯¼å…¥é™æ€èµ„æº</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">|-resources</span><br><span class="line">  |--static</span><br><span class="line">    |--css</span><br><span class="line">    |--js</span><br><span class="line">  |-templates</span><br><span class="line">    |-views      # æ¯ä¸ªlevelæ–‡ä»¶å¤¹ä¸‹éƒ½æœ‰1ï¼Œ2ï¼Œ3ä¸ªHTMLé¡µé¢</span><br><span class="line">      |--level1  # VIP1æ‰èƒ½è¿›çš„é¡µé¢</span><br><span class="line">        |--1.html</span><br><span class="line">        |--2.html</span><br><span class="line">        |--3.html</span><br><span class="line">      |--level2  # VIP2æ‰èƒ½è¿›çš„é¡µé¢</span><br><span class="line">      |--level3  # VIP3æ‰èƒ½è¿›çš„é¡µé¢</span><br><span class="line">      |--login.html</span><br><span class="line">    |-index.html</span><br></pre></td></tr></table></figure><ul><li>å…³é—­æ¨¡æ¿å¼•æ“ç¼“å­˜ï¼Œé˜²æ­¢æ¯æ¬¡éƒ½è¦é‡å¯</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™ä¸€ä¸ªControllerè¿›è¡Œé¡µé¢è·³è½¬è¯·æ±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RouterController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&#123;&quot;/&quot;,&quot;/index&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/toLogin&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toLogin</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;views/login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/level1/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">level1</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;views/level1/&quot;</span>+id;  <span class="comment">//æ–¹ä¾¿ä¸‰ä¸ªé¡µé¢æ˜ å°„åˆ°åŒä¸€ä¸ªè¯·æ±‚</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/level2/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">level2</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;views/level2/&quot;</span>+id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/level3/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">level3</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;views/level3/&quot;</span>+id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨BUG"><a href="#å¯åŠ¨BUG" class="headerlink" title="å¯åŠ¨BUG"></a>å¯åŠ¨BUG</h2><ul><li>å½“æˆ‘ä»¬å¯åŠ¨åè®¿é—®è¯·æ±‚éƒ½è·³è½¬åˆ°ä¸€ä¸ªç™»å½•é¡µé¢</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@4aac89df05dfcbc993065ea664627715662a9424/2021/06/24/0faf8ecc7769dca7dd317fd2aab4be06.png"></p><ul><li>è¿™æ˜¯å› ä¸ºåœ¨SpringBootä¸­ï¼Œé»˜è®¤çš„Spring Securityå°±æ˜¯ç”Ÿæ•ˆäº†çš„ï¼Œæ­¤æ—¶çš„æ¥å£éƒ½æ˜¯è¢«ä¿æŠ¤çš„ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡éªŒè¯æ‰èƒ½æ­£å¸¸çš„è®¿é—®ã€‚Spring Securityæä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯<code>user</code>ï¼Œè€Œå¯†ç åˆ™æ˜¯å¯åŠ¨é¡¹ç›®çš„æ—¶å€™è‡ªåŠ¨ç”Ÿæˆçš„</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@2bd72d7a063f6d90311b9ba226211e7df2ac8884/2021/06/24/2448f8ceb8e0e413d512eabf6b6c4542.png"></p><ul><li>å¦‚æœéœ€è¦ä½¿ç”¨ SpringSecurity ,å°±æ˜¯ç”¨ <code>user</code> + ç”Ÿæˆçš„å¯†ç è¿›è¡Œç™»é™†,ç™»é™†æˆåŠŸåå°±è·³è½¬æ­£å¸¸çš„è°ƒç”¨é¡µé¢</li><li>æ¨èåœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ªé…ç½®ç±»ã€æ¨èã€‘ï¼Œæ¯”å¦‚åˆ›å»º<code>config</code>åŒ…å¹¶ç¼–å†™ Spring Security åŸºç¡€é…ç½®ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableWebSecurity</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æŸ¥çœ‹æ–¹æ³• Alt+Inert é‡å†™æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// é¦–é¡µæ‰€æœ‰äººå¯ä»¥è®¿é—®ï¼ŒåŠŸèƒ½é¡µåªæœ‰å¯¹åº”æœ‰æƒé™çš„äººæ‰èƒ½è®¿é—®</span></span><br><span class="line">        http.csrf().disable();</span><br><span class="line">        <span class="comment">//é…ç½®ä¸éœ€è¦ç™»å½•éªŒè¯</span></span><br><span class="line">        http.authorizeRequests()</span><br><span class="line">                .anyRequest().permitAll()</span><br><span class="line">                .and().logout().permitAll();</span><br><span class="line">        <span class="comment">//super.configure(http);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨åé¦–é¡µå¦‚ä¸‹</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@dee1368d74ef46ab40d61d8251a484005463cca1/2021/06/24/c821a14bd11e18eea3c4f2e95c618741.png"></p><h1 id="è®¤è¯å’Œæˆæƒ"><a href="#è®¤è¯å’Œæˆæƒ" class="headerlink" title="è®¤è¯å’Œæˆæƒ"></a>è®¤è¯å’Œæˆæƒ</h1><h2 id="å®šä¹‰æˆæƒè§„åˆ™"><a href="#å®šä¹‰æˆæƒè§„åˆ™" class="headerlink" title="å®šä¹‰æˆæƒè§„åˆ™"></a>å®šä¹‰æˆæƒè§„åˆ™</h2><ul><li>å¼•å…¥ Spring Security æ¨¡å—</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åˆ›å»º<code>config</code>åŒ…å¹¶ç¼–å†™ Spring Security åŸºç¡€é…ç½®ç±»ï¼Œå‚è€ƒå®˜ç½‘ï¼š<a href="https://spring.io/projects/spring-security">https://spring.io/projects/spring-security</a></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableWebSecurity</span> <span class="comment">// å¼€å¯WebSecurityæ¨¡å¼</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æŸ¥çœ‹æ–¹æ³• Alt+Inert é‡å†™æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// å®šåˆ¶è¯·æ±‚çš„æˆæƒè§„åˆ™</span></span><br><span class="line">        <span class="comment">// é¦–é¡µæ‰€æœ‰äººå¯ä»¥è®¿é—®ï¼ŒåŠŸèƒ½é¡µåªæœ‰å¯¹åº”æœ‰æƒé™çš„äººæ‰èƒ½è®¿é—®</span></span><br><span class="line">        http.authorizeRequests()</span><br><span class="line">                .antMatchers(<span class="string">&quot;/&quot;</span>).permitAll()</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level1/**&quot;</span>).hasRole(<span class="string">&quot;vip1&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level2/**&quot;</span>).hasRole(<span class="string">&quot;vip2&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level3/**&quot;</span>).hasRole(<span class="string">&quot;vip3&quot;</span>);</span><br><span class="line">        <span class="comment">// æ²¡æœ‰æƒé™ä¼šè·³è½¬åˆ°é»˜è®¤ç™»å½•é¡µ</span></span><br><span class="line">        http.formLogin();  <span class="comment">//å¼€å¯è‡ªåŠ¨é…ç½®çš„ç™»å½•åŠŸèƒ½</span></span><br><span class="line">        <span class="comment">//super.configure(http);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ä¸€ä¸‹ï¼šå‘ç°ï¼Œæ²¡æœ‰æƒé™çš„æ—¶å€™ï¼Œä¼šè·³è½¬åˆ°ç™»å½•çš„é¡µé¢ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@4aac89df05dfcbc993065ea664627715662a9424/2021/06/24/0faf8ecc7769dca7dd317fd2aab4be06.png">\</p><h2 id="å®šä¹‰è®¤è¯è§„åˆ™"><a href="#å®šä¹‰è®¤è¯è§„åˆ™" class="headerlink" title="å®šä¹‰è®¤è¯è§„åˆ™"></a>å®šä¹‰è®¤è¯è§„åˆ™</h2><ul><li>å¯ä»¥å®šä¹‰è®¤è¯è§„åˆ™ï¼Œé‡å†™<code>configure(AuthenticationManagerBuilder auth)</code>æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableWebSecurity</span> <span class="comment">// å¼€å¯WebSecurityæ¨¡å¼</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æŸ¥çœ‹æ–¹æ³• Alt+Inert é‡å†™æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// åœ¨å†…å­˜ä¸­å®šä¹‰ï¼Œæ­£å¸¸åº”è¯¥åœ¨JDBCæ•°æ®åº“ä¸­æ‹¿</span></span><br><span class="line">        auth.inMemoryAuthentication()</span><br><span class="line">                .withUser(<span class="string">&quot;admin&quot;</span>).password(<span class="string">&quot;123456&quot;</span>).roles().roles(<span class="string">&quot;vip2&quot;</span>,<span class="string">&quot;vip3&quot;</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">&quot;root&quot;</span>).password(<span class="string">&quot;123456&quot;</span>).roles(<span class="string">&quot;vip1&quot;</span>,<span class="string">&quot;vip2&quot;</span>,<span class="string">&quot;vip3&quot;</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">&quot;guest&quot;</span>).password(<span class="string">&quot;123456&quot;</span>).roles(<span class="string">&quot;vip1&quot;</span>,<span class="string">&quot;vip2&quot;</span>);</span><br><span class="line">        <span class="comment">//super.configure(auth);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿›è¡Œç™»å½•æµ‹è¯•å‘ç°æŠ¥é”™ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@9e05b417cce0dacc94b9796780ccc83edbbbcae5/2021/06/24/6c2bad4f16eadc27ba5ebf07a9cffe08.png"></p><ul><li>è¿™æ˜¯å› ä¸ºSpring security 5.0ä¸­æ–°å¢äº†å¤šç§åŠ å¯†æ–¹å¼ï¼Œä¹Ÿæ”¹å˜äº†å¯†ç çš„æ ¼å¼ã€‚æˆ‘ä»¬è¦å°†å‰ç«¯ä¼ è¿‡æ¥çš„å¯†ç è¿›è¡ŒæŸç§æ–¹å¼åŠ å¯†ï¼Œå¦åˆ™å°±æ— æ³•ç™»å½•ï¼Œä¿®æ”¹ä»£ç </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableWebSecurity</span> <span class="comment">// å¼€å¯WebSecurityæ¨¡å¼</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æŸ¥çœ‹æ–¹æ³• Alt+Inert é‡å†™æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// åœ¨å†…å­˜ä¸­å®šä¹‰ï¼Œæ­£å¸¸åº”è¯¥åœ¨JDBCæ•°æ®åº“ä¸­æ‹¿</span></span><br><span class="line">         auth.inMemoryAuthentication().passwordEncoder(<span class="keyword">new</span> BCryptPasswordEncoder())</span><br><span class="line">                .withUser(<span class="string">&quot;admin&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip2&quot;</span>,<span class="string">&quot;vip3&quot;</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">&quot;root&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip1&quot;</span>,<span class="string">&quot;vip2&quot;</span>,<span class="string">&quot;vip3&quot;</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">&quot;guest&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip1&quot;</span>,<span class="string">&quot;vip2&quot;</span>);</span><br><span class="line">        <span class="comment">//super.configure(auth);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ï¼Œå‘ç°ï¼Œç™»å½•æˆåŠŸï¼Œå¹¶ä¸”æ¯ä¸ªè§’è‰²åªèƒ½è®¿é—®è‡ªå·±è®¤è¯ä¸‹çš„è§„åˆ™ï¼</li></ul><h1 id="æ³¨é”€å’Œæƒé™æ§åˆ¶"><a href="#æ³¨é”€å’Œæƒé™æ§åˆ¶" class="headerlink" title="æ³¨é”€å’Œæƒé™æ§åˆ¶"></a>æ³¨é”€å’Œæƒé™æ§åˆ¶</h1><h2 id="æ³¨é”€"><a href="#æ³¨é”€" class="headerlink" title="æ³¨é”€"></a>æ³¨é”€</h2><ul><li>åœ¨é…ç½®ç±»ä¸­å¼€å¯è‡ªåŠ¨é…ç½®çš„æ³¨é”€åŠŸèƒ½</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableWebSecurity</span> <span class="comment">// å¼€å¯WebSecurityæ¨¡å¼</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        <span class="comment">//å¼€å¯æ³¨é”€</span></span><br><span class="line">        http.logout();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨å‰ç«¯ï¼Œå¢åŠ ä¸€ä¸ªæ³¨é”€çš„æŒ‰é’®ã€‚æ³¨æ„ï¼Œè¯·æ±‚é»˜è®¤ä¸º<code>/logout</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/logout&#125;&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;sign-out card icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> æ³¨é”€</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ä¸€ä¸‹ï¼Œç™»å½•æˆåŠŸåç‚¹å‡»æ³¨é”€ï¼Œå‘ç°æ³¨é”€å®Œæ¯•ä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼ä½†æ˜¯ï¼Œæˆ‘ä»¬æƒ³è®©ä»–æ³¨é”€æˆåŠŸåï¼Œä¾æ—§å¯ä»¥è·³è½¬åˆ°é¦–é¡µï¼Œå¯ä»¥åœ¨é…ç½®ç±»ä¸­è¿›è¡Œè®¾ç½®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .logoutSuccessUrl(&quot;/&quot;); æ³¨é”€æˆåŠŸæ¥åˆ°é¦–é¡µ</span></span><br><span class="line">http.logout().logoutSuccessUrl(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="comment">// è¿˜å¯ä»¥ç§»é™¤Cookieå’ŒSession</span></span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ï¼Œæ³¨é”€å®Œæ¯•åï¼Œå‘ç°è·³è½¬åˆ°é¦–é¡µOK</li></ul><h2 id="æƒé™æ§åˆ¶"><a href="#æƒé™æ§åˆ¶" class="headerlink" title="æƒé™æ§åˆ¶"></a>æƒé™æ§åˆ¶</h2><ul><li>å®ç°éœ€æ±‚<ul><li>ç”¨æˆ·æ²¡æœ‰ç™»å½•çš„æ—¶å€™ï¼Œå¯¼èˆªæ ä¸Šåªæ˜¾ç¤ºç™»å½•æŒ‰é’®ï¼Œç”¨æˆ·ç™»å½•ä¹‹åï¼Œå¯¼èˆªæ å¯ä»¥æ˜¾ç¤ºç™»å½•çš„ç”¨æˆ·ä¿¡æ¯åŠæ³¨é”€æŒ‰é’®ï¼</li><li>æ¯”å¦‚<code>admin</code>è¿™ä¸ªç”¨æˆ·ç™»å½•ï¼Œå®ƒæœ‰<code>vip2</code>ï¼Œ<code>vip3</code>åŠŸèƒ½ï¼Œé‚£ä¹ˆç™»å½•åˆ™åªæ˜¾ç¤ºè¿™ä¸¤ä¸ªåŠŸèƒ½ï¼Œè€Œ<code>vip1</code>çš„åŠŸèƒ½èœå•ä¸æ˜¾ç¤ºï¼</li></ul></li><li>éœ€è¦ç»“åˆthymeleafä¸­çš„ä¸€äº›åŠŸèƒ½</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sec:authorize=&quot;isAuthenticated()&quot;:æ˜¯å¦è®¤è¯ç™»å½•ï¼æ¥æ˜¾ç¤ºä¸åŒçš„é¡µé¢</span><br></pre></td></tr></table></figure><ul><li>éœ€è¦å¯¼å…¥thymeleafå’Œspringsecurityçš„æ•´åˆä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.thymeleaf.extras/thymeleaf-extras-springsecurity4 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-springsecurity5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹æˆ‘ä»¬çš„å‰ç«¯é¡µé¢ï¼Œéœ€è¦å¯¼å…¥å‘½åç©ºé—´</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span> <span class="attr">xmlns:sec</span>=<span class="string">&quot;http://www.thymeleaf.org/thymeleaf-extras-springsecurity5&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹å¯¼èˆªæ ï¼Œå¢åŠ è®¤è¯åˆ¤æ–­</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç™»å½•æ³¨é”€--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right menu&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--æœªç™»å½•--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">sec:authorize</span>=<span class="string">&quot;!isAuthenticated()&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/toLogin&#125;&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;address card icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> ç™»å½•</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--å·²ç™»å½•:æ˜¾ç¤ºç”¨æˆ·åå’Œæ³¨é”€--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">sec:authorize</span>=<span class="string">&quot;isAuthenticated()&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;address card icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">span</span> <span class="attr">sec:authentication</span>=<span class="string">&quot;principal.username&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            è§’è‰²ï¼š<span class="tag">&lt;<span class="name">span</span> <span class="attr">sec:authentication</span>=<span class="string">&quot;principal.authorities&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">sec:authorize</span>=<span class="string">&quot;isAuthenticated()&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/logout&#125;&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;address card icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> æ³¨é”€</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é‡å¯æµ‹è¯•ç™»å½•ï¼Œç™»å½•æˆåŠŸåç¡®å®ï¼Œæ˜¾ç¤ºäº†æˆ‘ä»¬æƒ³è¦çš„é¡µé¢</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@245e8988b5c779cab389789c204867641d5b5741/2021/06/24/1b714948041a7f727742ff6c337adaf6.png"></p><ul><li>å¦‚æœæ³¨é”€404äº†ï¼Œå°±æ˜¯å› ä¸ºå®ƒé»˜è®¤é˜²æ­¢<code>csrf</code>è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œå› ä¸ºä¼šäº§ç”Ÿå®‰å…¨é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯·æ±‚æ”¹ä¸º<code>post</code>è¡¨å•æäº¤ï¼Œæˆ–è€…åœ¨spring securityä¸­å…³é—­<code>csrf</code>åŠŸèƒ½ï¼›åœ¨é…ç½®ä¸­å¢åŠ  </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http.csrf().disable();<span class="comment">//å…³é—­csrfåŠŸèƒ½:è·¨ç«™è¯·æ±‚ä¼ªé€ ,é»˜è®¤åªèƒ½é€šè¿‡postæ–¹å¼æäº¤logoutè¯·æ±‚</span></span><br><span class="line">http.logout().logoutSuccessUrl(<span class="string">&quot;/&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>ç»§ç»­å°†ä¸‹é¢çš„è§’è‰²åŠŸèƒ½å—è®¤è¯å®Œæˆï¼</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- sec:authorize=&quot;hasRole(&#x27;vip1&#x27;)&quot; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;column&quot;</span> <span class="attr">sec:authorize</span>=<span class="string">&quot;hasRole(&#x27;vip1&#x27;)&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui raised segment&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>Level 1<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level1/1&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-1-1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level1/2&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-1-2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level1/3&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-1-3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;column&quot;</span> <span class="attr">sec:authorize</span>=<span class="string">&quot;hasRole(&#x27;vip2&#x27;)&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui raised segment&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>Level 2<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level2/1&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-2-1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level2/2&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-2-2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level2/3&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-2-3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;column&quot;</span> <span class="attr">sec:authorize</span>=<span class="string">&quot;hasRole(&#x27;vip3&#x27;)&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui raised segment&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>Level 3<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level3/1&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-3-1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level3/2&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-3-2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/level3/3&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Level-3-3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç™»å½•<code>admin</code>ç”¨æˆ·è¿›è¡Œæµ‹è¯•ã€‚å¯ä»¥å‘ç°åªæ˜¾ç¤º<code>level2</code>å’Œ<code>level3</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@905094514fd0424cd065d9ea9c74084c26e9589b/2021/06/24/e3cacb531c0b15c73f668c33bf4700ba.png"></p><h1 id="è®°ä½æˆ‘åŠç™»å½•å®šåˆ¶"><a href="#è®°ä½æˆ‘åŠç™»å½•å®šåˆ¶" class="headerlink" title="è®°ä½æˆ‘åŠç™»å½•å®šåˆ¶"></a>è®°ä½æˆ‘åŠç™»å½•å®šåˆ¶</h1><h2 id="è®°ä½æˆ‘"><a href="#è®°ä½æˆ‘" class="headerlink" title="è®°ä½æˆ‘"></a>è®°ä½æˆ‘</h2><ul><li>ç°åœ¨çš„æƒ…å†µï¼Œæˆ‘ä»¬åªè¦ç™»å½•ä¹‹åï¼Œå…³é—­æµè§ˆå™¨ï¼Œå†ç™»å½•ï¼Œå°±ä¼šè®©æˆ‘ä»¬é‡æ–°ç™»å½•ï¼Œä½†æ˜¯å¾ˆå¤šç½‘ç«™çš„æƒ…å†µï¼Œå°±æ˜¯æœ‰ä¸€ä¸ªè®°ä½å¯†ç çš„åŠŸèƒ½ï¼Œè¿™ä¸ªè¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿå¾ˆç®€å•</li><li>å¼€å¯è®°ä½æˆ‘åŠŸèƒ½</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šåˆ¶è¯·æ±‚çš„æˆæƒè§„åˆ™</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">   <span class="comment">//...</span></span><br><span class="line">   <span class="comment">//è®°ä½æˆ‘</span></span><br><span class="line">   http.rememberMe();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å†æ¬¡å¯åŠ¨é¡¹ç›®æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°ç™»å½•é¡µå¤šäº†ä¸€ä¸ªè®°ä½æˆ‘åŠŸèƒ½ï¼Œæˆ‘ä»¬ç™»å½•ä¹‹åå…³é—­ æµè§ˆå™¨ï¼Œç„¶åé‡æ–°æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼Œå‘ç°ç”¨æˆ·ä¾æ—§å­˜åœ¨ï¼<strong>é»˜è®¤ä¿å­˜14å¤©</strong></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@002d847326f2d0989da307ea0a6e511fa13ab2d0/2021/06/24/deb2f40e7aa62f196ccb0a0487e62d1d.png"></p><ul><li>å…¶åŸç†å°±æ˜¯ç™»å½•æˆåŠŸåï¼Œå°†<code>cookie</code>å‘é€ç»™æµè§ˆå™¨ä¿å­˜ï¼Œä»¥åç™»å½•å¸¦ä¸Šè¿™ä¸ª<code>cookie</code>ï¼Œåªè¦é€šè¿‡æ£€æŸ¥å°±å¯ä»¥å…ç™»å½•äº†ã€‚å¦‚æœç‚¹å‡»æ³¨é”€ï¼Œåˆ™ä¼šåˆ é™¤è¿™ä¸ª<code>cookie</code>ã€‚è¿™ä¸€åˆ‡ä½†æ˜¯Spring Security å¸®æˆ‘ä»¬è‡ªåŠ¨å®Œæˆçš„</li></ul><h2 id="å®šåˆ¶ç™»å½•é¡µ"><a href="#å®šåˆ¶ç™»å½•é¡µ" class="headerlink" title="å®šåˆ¶ç™»å½•é¡µ"></a>å®šåˆ¶ç™»å½•é¡µ</h2><ul><li>æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰Spring Securityé»˜è®¤çš„ç™»å½•é¡µã€‚åœ¨åˆšæ‰çš„é…ç½®ç±»ä¸­ç™»å½•é¡µé…ç½®åé¢æŒ‡å®š <code>loginpage</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// toLoginä¸ºæ§åˆ¶å±‚çš„è¯·æ±‚</span></span><br><span class="line">http.formLogin().loginPage(<span class="string">&quot;/toLogin&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>å‰ç«¯ä¹Ÿéœ€è¦æŒ‡å‘æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ loginè¯·æ±‚</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/toLogin&#125;&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;address card icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> ç™»å½•</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬ç™»å½•ï¼Œéœ€è¦å°†è¿™äº›ä¿¡æ¯å‘é€åˆ°å“ªé‡Œï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦é…ç½®ï¼Œ<code>login.html</code> é…ç½®è¡¨å•æäº¤è¯·æ±‚åŠæ–¹å¼ï¼Œæ–¹å¼å¿…é¡»ä¸º<code>post</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;field&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">label</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui left icon input&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Username&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;user icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;field&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">label</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui left icon input&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;lock icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ui blue submit button&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ä½†æ˜¯è¡¨å•æäº¤çš„è¯·æ±‚æ˜¯<code>/login</code>ï¼Œæˆ‘ä»¬è¿˜éœ€è¦éªŒè¯å¤„ç†ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥<code>Alt</code>æŸ¥çœ‹<code>formLogin()</code>æ–¹æ³•çš„æºç ï¼æˆ‘ä»¬é…ç½®æ¥æ”¶ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç çš„å‚æ•°ï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http.formLogin()</span><br><span class="line">  .usernameParameter(<span class="string">&quot;username&quot;</span>) <span class="comment">// å‚æ•°å€¼å¯¹åº”è¡¨å•nameå€¼</span></span><br><span class="line">  .passwordParameter(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">  .loginPage(<span class="string">&quot;/toLogin&quot;</span>)         <span class="comment">//è·³è½¬åˆ°ç™»å½•é¡µé¢çš„è¯·æ±‚</span></span><br><span class="line">  .loginProcessingUrl(<span class="string">&quot;/login&quot;</span>); <span class="comment">// ç™»é™†è¡¨å•æäº¤è¯·æ±‚</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨ç™»å½•é¡µå¢åŠ è®°ä½æˆ‘çš„å¤šé€‰æ¡†</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;remember&quot;</span>&gt;</span> è®°ä½æˆ‘</span><br></pre></td></tr></table></figure><ul><li>åç«¯éªŒè¯å¤„ç†ï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šåˆ¶è®°ä½æˆ‘çš„å‚æ•°ï¼</span></span><br><span class="line">http.rememberMe().rememberMeParameter(<span class="string">&quot;remember&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="å®Œæ•´é…ç½®"><a href="#å®Œæ•´é…ç½®" class="headerlink" title="å®Œæ•´é…ç½®"></a>å®Œæ•´é…ç½®</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzy.config;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableWebSecurity</span> <span class="comment">// å¼€å¯WebSecurityæ¨¡å¼</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æŸ¥çœ‹æ–¹æ³• Alt+Inert é‡å†™æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"><span class="comment">//        http.csrf().disable();</span></span><br><span class="line"><span class="comment">//        //é…ç½®ä¸éœ€è¦ç™»å½•éªŒè¯</span></span><br><span class="line"><span class="comment">//        http.authorizeRequests()</span></span><br><span class="line"><span class="comment">//                .anyRequest().permitAll()</span></span><br><span class="line"><span class="comment">//                .and().logout().permitAll();</span></span><br><span class="line">        <span class="comment">// å®šåˆ¶è¯·æ±‚çš„æˆæƒè§„åˆ™</span></span><br><span class="line">        <span class="comment">// é¦–é¡µæ‰€æœ‰äººå¯ä»¥è®¿é—®ï¼ŒåŠŸèƒ½é¡µåªæœ‰å¯¹åº”æœ‰æƒé™çš„äººæ‰èƒ½è®¿é—®</span></span><br><span class="line"></span><br><span class="line">        http.authorizeRequests()</span><br><span class="line">                .antMatchers(<span class="string">&quot;/&quot;</span>).permitAll()</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level1/**&quot;</span>).hasRole(<span class="string">&quot;vip1&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level2/**&quot;</span>).hasRole(<span class="string">&quot;vip2&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level3/**&quot;</span>).hasRole(<span class="string">&quot;vip3&quot;</span>);</span><br><span class="line">        <span class="comment">// å¼€å¯è‡ªåŠ¨é…ç½®çš„ç™»å½•åŠŸèƒ½</span></span><br><span class="line">        <span class="comment">// /login è¯·æ±‚æ¥åˆ°ç™»å½•é¡µ</span></span><br><span class="line">        <span class="comment">// /login?error é‡å®šå‘åˆ°è¿™é‡Œè¡¨ç¤ºç™»å½•å¤±è´¥</span></span><br><span class="line">        <span class="comment">//loginProcessingUrlè¡¨ç¤ºç™»å½•æˆåŠŸåçš„è¯·æ±‚</span></span><br><span class="line">        http.formLogin()</span><br><span class="line">                .usernameParameter(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">                .passwordParameter(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">                .loginPage(<span class="string">&quot;/toLogin&quot;</span>)</span><br><span class="line">                .loginProcessingUrl(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">        <span class="comment">//å¼€å¯æ³¨é”€</span></span><br><span class="line">        http.logout().logoutSuccessUrl(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">// è®°ä½æˆ‘</span></span><br><span class="line">        http.rememberMe().rememberMeParameter(<span class="string">&quot;remember&quot;</span>);</span><br><span class="line">        <span class="comment">//super.configure(http);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// åœ¨å†…å­˜ä¸­å®šä¹‰ï¼Œæ­£å¸¸åº”è¯¥åœ¨JDBCæ•°æ®åº“ä¸­æ‹¿</span></span><br><span class="line">        auth.inMemoryAuthentication().passwordEncoder(<span class="keyword">new</span> BCryptPasswordEncoder())</span><br><span class="line">                .withUser(<span class="string">&quot;admin&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip2&quot;</span>,<span class="string">&quot;vip3&quot;</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">&quot;root&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip1&quot;</span>,<span class="string">&quot;vip2&quot;</span>,<span class="string">&quot;vip3&quot;</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">&quot;guest&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123456&quot;</span>)).roles(<span class="string">&quot;vip1&quot;</span>,<span class="string">&quot;vip2&quot;</span>);</span><br><span class="line">        <span class="comment">//super.configure(auth);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SpringSecurity&quot;&gt;&lt;a href=&quot;#SpringSecurity&quot; class=&quot;headerlink&quot; title=&quot;SpringSecurity&quot;&gt;&lt;/a&gt;SpringSecurity&lt;/h1&gt;&lt;h2 id=&quot;å®‰å…¨ç®€ä»‹&quot;&gt;&lt;a href=&quot;#å®‰</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    <category term="SpringSecurity" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/SpringSecurity/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="SpringSecurity" scheme="http://xiaoliblog.cn/tags/SpringSecurity/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒSpringDataæ•°æ®åº“æ“ä½œ</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot12.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot12.html</id>
    <published>2021-06-23T08:55:59.135Z</published>
    <updated>2021-06-25T12:22:36.696Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SpringData"><a href="#SpringData" class="headerlink" title="SpringData"></a>SpringData</h1><ul><li>å¯¹äºæ•°æ®è®¿é—®å±‚ï¼Œæ— è®ºæ˜¯ SQL(å…³ç³»å‹æ•°æ®åº“) è¿˜æ˜¯ NOSQL(éå…³ç³»å‹æ•°æ®åº“)ï¼ŒSpring Boot åº•å±‚éƒ½æ˜¯é‡‡ç”¨ Spring Data çš„æ–¹å¼è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚</li><li>Spring Boot åº•å±‚éƒ½æ˜¯é‡‡ç”¨ Spring Data çš„æ–¹å¼è¿›è¡Œç»Ÿä¸€å¤„ç†å„ç§æ•°æ®åº“ï¼ŒSpring Data ä¹Ÿæ˜¯ Spring ä¸­ä¸ Spring Bootã€Spring Cloud ç­‰é½åçš„çŸ¥åé¡¹ç›®ã€‚</li><li>Sping Data å®˜ç½‘ï¼š<a href="https://spring.io/projects/spring-data">https://spring.io/projects/spring-data</a></li><li>æ•°æ®åº“ç›¸å…³çš„å¯åŠ¨å™¨ ï¼šå¯ä»¥å‚è€ƒ<a href="https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#using-boot-starter">å®˜æ–¹æ–‡æ¡£</a></li></ul><h1 id="æ•´åˆJDBC"><a href="#æ•´åˆJDBC" class="headerlink" title="æ•´åˆJDBC"></a>æ•´åˆJDBC</h1><h2 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h2><ul><li>æ–°å»ºä¸€ä¸ªé¡¹ç›®æµ‹è¯•ï¼Œéœ€è¦å¼•å…¥ç›¸åº”çš„æ¨¡å—</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@98a700108583574ce090a7d57031f0ce38775620/2021/06/23/a0c39e4ae1e773b9d9b4da80f82f1501.png"></p><ul><li>é¡¹ç›®å»ºå¥½ä¹‹åï¼Œå‘ç°è‡ªåŠ¨å¸®æˆ‘ä»¬å¯¼å…¥äº†å¦‚ä¸‹çš„å¯åŠ¨å™¨ï¼š</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•æ•°æ®æº"><a href="#æµ‹è¯•æ•°æ®æº" class="headerlink" title="æµ‹è¯•æ•°æ®æº"></a>æµ‹è¯•æ•°æ®æº</h2><ul><li>æ–°å»º<code>application.yml</code>é…ç½®æ–‡ä»¶è¿æ¥æ•°æ®åº“ï¼›</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">data-username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">data-password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="comment">#?serverTimezone=UTCè§£å†³æ—¶åŒºçš„æŠ¥é”™</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure><ul><li>é…ç½®å®Œè¿™ä¸€äº›ä¸œè¥¿åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å»ä½¿ç”¨äº†ï¼Œå› ä¸ºSpringBootå·²ç»é»˜è®¤å¸®æˆ‘ä»¬è¿›è¡Œäº†è‡ªåŠ¨é…ç½®ï¼›å»æµ‹è¯•ç±»æµ‹è¯•ä¸€ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootDataJdbcApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//DIæ³¨å…¥æ•°æ®æº</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">//çœ‹ä¸€ä¸‹é»˜è®¤æ•°æ®æº</span></span><br><span class="line">        System.out.println(dataSource.getClass());</span><br><span class="line">        <span class="comment">//è·å¾—è¿æ¥</span></span><br><span class="line">        Connection connection =   dataSource.getConnection();</span><br><span class="line">        System.out.println(connection);</span><br><span class="line">        <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–é»˜è®¤ç»™æˆ‘ä»¬é…ç½®çš„æ•°æ®æºä¸º ï¼š<code>class com.zaxxer.hikari.HikariDataSource</code>ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æ‰‹åŠ¨é…ç½®</li><li>æˆ‘ä»¬æ¥å…¨å±€æœç´¢ä¸€ä¸‹ï¼Œæ‰¾åˆ°æ•°æ®æºçš„æ‰€æœ‰è‡ªåŠ¨é…ç½®éƒ½åœ¨ ï¼šDataSourceAutoConfigurationæ–‡ä»¶ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(</span></span><br><span class="line"><span class="meta">    &#123;Hikari.class, Tomcat.class, Dbcp2.class, Generic.class, DataSourceJmxConfiguration.class&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PooledDataSourceConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">PooledDataSourceConfiguration</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿™é‡Œå¯¼å…¥çš„ç±»éƒ½åœ¨ DataSourceConfiguration é…ç½®ç±»ä¸‹ï¼Œå¯ä»¥çœ‹å‡º Spring Boot 2.2.5 é»˜è®¤ä½¿ç”¨HikariDataSource æ•°æ®æºï¼Œè€Œä»¥å‰ç‰ˆæœ¬ï¼Œå¦‚ Spring Boot 1.5 é»˜è®¤ä½¿ç”¨ org.apache.tomcat.jdbc.pool.DataSource ä½œä¸ºæ•°æ®æº</li><li><strong><code>HikariDataSource</code> å·ç§° Java WEB å½“å‰é€Ÿåº¦æœ€å¿«çš„æ•°æ®æºï¼Œç›¸æ¯”äºä¼ ç»Ÿçš„ C3P0 ã€DBCPã€Tomcat jdbc ç­‰è¿æ¥æ± æ›´åŠ ä¼˜ç§€ï¼›</strong></li><li><strong>å¯ä»¥ä½¿ç”¨ <code>spring.datasource.type</code> æŒ‡å®šè‡ªå®šä¹‰çš„æ•°æ®æºç±»å‹ï¼Œå€¼ä¸ºè¦ä½¿ç”¨çš„è¿æ¥æ± å®ç°çš„å®Œå…¨é™å®šå</strong></li></ul><h2 id="JdbcTemplate"><a href="#JdbcTemplate" class="headerlink" title="JdbcTemplate"></a>JdbcTemplate</h2><ul><li>æœ‰äº†æ•°æ®æº<code>com.zaxxer.hikari.HikariDataSource</code>ï¼Œç„¶åå¯ä»¥æ‹¿åˆ°æ•°æ®åº“è¿æ¥<code>java.sql.Connection</code>ï¼Œæœ‰äº†è¿æ¥ï¼Œå°±å¯ä»¥ä½¿ç”¨åŸç”Ÿçš„ JDBC è¯­å¥æ¥æ“ä½œæ•°æ®åº“ï¼›</li><li>å³ä½¿ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹ç¬¬æ•°æ®åº“æ“ä½œæ¡†æ¶ï¼Œå¦‚ MyBatisç­‰ï¼ŒSpring æœ¬èº«ä¹Ÿå¯¹åŸç”Ÿçš„JDBC åšäº†è½»é‡çº§çš„å°è£…ï¼Œå³<code>JdbcTemplate</code></li><li>æ•°æ®åº“æ“ä½œçš„æ‰€æœ‰ CRUD æ–¹æ³•éƒ½åœ¨ JdbcTemplate ä¸­</li><li>Spring Boot ä¸ä»…æä¾›äº†é»˜è®¤çš„æ•°æ®æºï¼ŒåŒæ—¶é»˜è®¤å·²ç»é…ç½®å¥½äº† JdbcTemplate æ”¾åœ¨äº†å®¹å™¨ä¸­ï¼Œç¨‹åºå‘˜åªéœ€è‡ªå·±æ³¨å…¥å³å¯ä½¿ç”¨</li><li>JdbcTemplate çš„è‡ªåŠ¨é…ç½®æ˜¯ä¾èµ– org.springframework.boot.autoconfigure.jdbc åŒ…ä¸‹çš„ JdbcTemplateConfiguration ç±»</li><li>JdbcTemplateä¸»è¦æä¾›ä»¥ä¸‹å‡ ç±»æ–¹æ³•ï¼š<ul><li><code>execute</code>æ–¹æ³•ï¼šå¯ä»¥ç”¨äºæ‰§è¡Œä»»ä½•SQLè¯­å¥ï¼Œä¸€èˆ¬ç”¨äºæ‰§è¡ŒDDLè¯­å¥ï¼›</li><li><code>update</code>æ–¹æ³•åŠ<code>batchUpdate</code>æ–¹æ³•ï¼šupdateæ–¹æ³•ç”¨äºæ‰§è¡Œæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ç­‰è¯­å¥ï¼›batchUpdateæ–¹æ³•ç”¨äºæ‰§è¡Œæ‰¹å¤„ç†ç›¸å…³è¯­å¥ï¼›</li><li><code>query</code>æ–¹æ³•åŠ<code>queryForXXX</code>æ–¹æ³•ï¼šç”¨äºæ‰§è¡ŒæŸ¥è¯¢ç›¸å…³è¯­å¥ï¼›</li><li><code>call</code>æ–¹æ³•ï¼šç”¨äºæ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ã€å‡½æ•°ç›¸å…³è¯­å¥</li></ul></li></ul><h2 id="æµ‹è¯•æ¡ˆä¾‹"><a href="#æµ‹è¯•æ¡ˆä¾‹" class="headerlink" title="æµ‹è¯•æ¡ˆä¾‹"></a>æµ‹è¯•æ¡ˆä¾‹</h2><ul><li>ç¼–å†™ä¸€ä¸ªControllerï¼Œæ³¨å…¥ jdbcTemplateï¼Œç¼–å†™æµ‹è¯•æ–¹æ³•è¿›è¡Œè®¿é—®æµ‹è¯•ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCController</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Spring Boot é»˜è®¤æä¾›äº†æ•°æ®æºï¼Œé»˜è®¤æä¾›äº† org.springframework.jdbc.core.JdbcTemplate</span></span><br><span class="line"><span class="comment">     * JdbcTemplate ä¸­ä¼šè‡ªå·±æ³¨å…¥æ•°æ®æºï¼Œç”¨äºç®€åŒ– JDBCæ“ä½œ</span></span><br><span class="line"><span class="comment">     * è¿˜èƒ½é¿å…ä¸€äº›å¸¸è§çš„é”™è¯¯,ä½¿ç”¨èµ·æ¥ä¹Ÿä¸ç”¨å†è‡ªå·±æ¥å…³é—­æ•°æ®åº“è¿æ¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŸ¥è¯¢userè¡¨ä¸­æ‰€æœ‰æ•°æ®</span></span><br><span class="line">    <span class="comment">//List ä¸­çš„1ä¸ª Map å¯¹åº”æ•°æ®åº“çš„ 1è¡Œæ•°æ®</span></span><br><span class="line">    <span class="comment">//Map ä¸­çš„ key å¯¹åº”æ•°æ®åº“çš„å­—æ®µåï¼Œvalue å¯¹åº”æ•°æ®åº“çš„å­—æ®µå€¼</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/userlist&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Map&lt;String,Object&gt;&gt; userList()&#123;</span><br><span class="line">        String sql = <span class="string">&quot;select * from user&quot;</span>;</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; maps = jdbcTemplate.queryForList(sql);</span><br><span class="line">        <span class="keyword">return</span> maps;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ–°å¢ä¸€ä¸ªç”¨æˆ·</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;insert into user(username, password)&quot;</span> +</span><br><span class="line">                <span class="string">&quot; values (&#x27;æå››&#x27;,&#x27;123456&#x27;)&quot;</span>;</span><br><span class="line">        jdbcTemplate.update(sql);</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;addOk&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/update/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updateUser</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="comment">//æ’å…¥è¯­å¥</span></span><br><span class="line">        String sql = <span class="string">&quot;update user set username=?,password=? where id=&quot;</span>+id;</span><br><span class="line">        <span class="comment">//æ•°æ®</span></span><br><span class="line">        Object[] objects = <span class="keyword">new</span> Object[<span class="number">2</span>];</span><br><span class="line">        objects[<span class="number">0</span>] = <span class="string">&quot;æç™½&quot;</span>;</span><br><span class="line">        objects[<span class="number">1</span>] = <span class="string">&quot;24736743123&quot;</span>;</span><br><span class="line">        jdbcTemplate.update(sql,objects);</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;updateOk&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤ç”¨æˆ·</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/delete/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delUser</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="comment">//æ’å…¥è¯­å¥</span></span><br><span class="line">        String sql = <span class="string">&quot;delete from user where id=?&quot;</span>;</span><br><span class="line">        jdbcTemplate.update(sql,id);</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;deleteOk&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ•´åˆDruid"><a href="#æ•´åˆDruid" class="headerlink" title="æ•´åˆDruid"></a>æ•´åˆDruid</h1><h2 id="Druidç®€ä»‹"><a href="#Druidç®€ä»‹" class="headerlink" title="Druidç®€ä»‹"></a>Druidç®€ä»‹</h2><ul><li>Javaç¨‹åºå¾ˆå¤§ä¸€éƒ¨åˆ†è¦æ“ä½œæ•°æ®åº“ï¼Œä¸ºäº†æé«˜æ€§èƒ½æ“ä½œæ•°æ®åº“çš„æ—¶å€™ï¼Œåˆä¸å¾—ä¸ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± </li><li><code>Druid</code> æ˜¯é˜¿é‡Œå·´å·´å¼€æºå¹³å°ä¸Šä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œç»“åˆäº† C3P0ã€DBCP ç­‰ DB æ± çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶åŠ å…¥äº†æ—¥å¿—ç›‘æ§ã€‚</li><li>Druid å¯ä»¥å¾ˆå¥½çš„ç›‘æ§ DB æ± è¿æ¥å’Œ SQL çš„æ‰§è¡Œæƒ…å†µï¼Œå¤©ç”Ÿå°±æ˜¯é’ˆå¯¹ç›‘æ§è€Œç”Ÿçš„ DB è¿æ¥æ± ã€‚</li><li>Druidå·²ç»åœ¨é˜¿é‡Œå·´å·´éƒ¨ç½²äº†è¶…è¿‡600ä¸ªåº”ç”¨ï¼Œç»è¿‡ä¸€å¹´å¤šç”Ÿäº§ç¯å¢ƒå¤§è§„æ¨¡éƒ¨ç½²çš„ä¸¥è‹›è€ƒéªŒã€‚</li><li>Spring Boot 2.0 ä»¥ä¸Šé»˜è®¤ä½¿ç”¨ Hikari æ•°æ®æºï¼Œå¯ä»¥è¯´ Hikari ä¸ Driud éƒ½æ˜¯å½“å‰ Java Web ä¸Šæœ€ä¼˜ç§€çš„æ•°æ®æºï¼Œæˆ‘ä»¬æ¥é‡ç‚¹ä»‹ç» Spring Boot å¦‚ä½•é›†æˆ Druid æ•°æ®æºï¼Œå¦‚ä½•å®ç°æ•°æ®åº“ç›‘æ§ã€‚</li><li>Githubåœ°å€ï¼š<a href="https://github.com/alibaba/druid/">https://github.com/alibaba/druid/</a></li><li>com.alibaba.druid.pool.DruidDataSource åŸºæœ¬é…ç½®å‚æ•°å¦‚ä¸‹ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@f20c7f0ed06a42be34e782d8beb588fdde1c82d9/2021/06/23/2903cdb121901eb466eb0a63c59e13ee.png"><br><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@0602c6a19196cd304930b2021b3f60e07d80dbad/2021/06/23/3a06da6a83a1f3da4029c9901a8fc7d8.png"><br><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@2f062359a6c899d23fa74c53b8b6ef4ac7e2a21a/2021/06/23/73e4d85c5258acc82f28e701b504d0a9.png"></p><h2 id="é…ç½®æ•°æ®æº"><a href="#é…ç½®æ•°æ®æº" class="headerlink" title="é…ç½®æ•°æ®æº"></a>é…ç½®æ•°æ®æº</h2><ul><li>æ·»åŠ ä¸Š Druid æ•°æ®æºä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åˆ‡æ¢æ•°æ®æºï¼›ä¹‹å‰å·²ç»è¯´è¿‡ Spring Boot 2.0 ä»¥ä¸Šé»˜è®¤ä½¿ç”¨ com.zaxxer.hikari.HikariDataSource æ•°æ®æºï¼Œä½†å¯ä»¥ é€šè¿‡ <code>spring.datasource.type</code> æŒ‡å®šæ•°æ®æº</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">data-username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">data-password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="comment">#?serverTimezone=UTCè§£å†³æ—¶åŒºçš„æŠ¥é”™</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span> <span class="comment"># è‡ªå®šä¹‰æ•°æ®æº</span></span><br></pre></td></tr></table></figure><ul><li>æ•°æ®æºåˆ‡æ¢ä¹‹åï¼Œåœ¨æµ‹è¯•ç±»ä¸­æ³¨å…¥ <code>DataSource</code>ï¼Œç„¶åè·å–åˆ°å®ƒï¼Œè¾“å‡ºä¸€çœ‹ä¾¿çŸ¥æ˜¯å¦æˆåŠŸåˆ‡æ¢ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@bf4be9164cd45f86b3010b1c4b106629c2c14c2d/2021/06/23/d6c1014c938693808dec79a970892009.png"></p><ul><li>åˆ‡æ¢æˆåŠŸï¼æ—¢ç„¶åˆ‡æ¢æˆåŠŸï¼Œå°±å¯ä»¥è®¾ç½®æ•°æ®æºè¿æ¥åˆå§‹åŒ–å¤§å°ã€æœ€å¤§è¿æ¥æ•°ã€ç­‰å¾…æ—¶é—´ã€æœ€å°è¿æ¥æ•° ç­‰è®¾ç½®é¡¹ï¼›å¯ä»¥æŸ¥çœ‹æºç </li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="comment">#?serverTimezone=UTCè§£å†³æ—¶åŒºçš„æŠ¥é”™</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">###################ä»¥ä¸‹ä¸ºdruidå¢åŠ çš„é…ç½®###########################</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¿æ¥æ± ä¸ªæ•°</span></span><br><span class="line">    <span class="attr">initialSize:</span> <span class="number">5</span></span><br><span class="line">    <span class="comment"># æœ€å°è¿æ¥æ± ä¸ªæ•°â€”â€”ã€‹å·²ç»ä¸å†ä½¿ç”¨ï¼Œé…ç½®äº†ä¹Ÿæ²¡æ•ˆæœ</span></span><br><span class="line">    <span class="attr">minIdle:</span> <span class="number">5</span>  </span><br><span class="line">    <span class="comment"># æœ€å¤§è¿æ¥æ± ä¸ªæ•°</span></span><br><span class="line">    <span class="attr">maxActive:</span> <span class="number">20</span> </span><br><span class="line">    <span class="comment"># é…ç½®è·å–è¿æ¥ç­‰å¾…è¶…æ—¶çš„æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œç¼ºçœå¯ç”¨å…¬å¹³é”ï¼Œå¹¶å‘æ•ˆç‡ä¼šæœ‰æ‰€ä¸‹é™</span></span><br><span class="line">    <span class="attr">maxWait:</span> <span class="number">60000</span> </span><br><span class="line">    <span class="comment"># é…ç½®é—´éš”å¤šä¹…æ‰è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œæ£€æµ‹éœ€è¦å…³é—­çš„ç©ºé—²è¿æ¥ï¼Œå•ä½æ˜¯æ¯«ç§’</span></span><br><span class="line">    <span class="attr">timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line">    <span class="comment"># é…ç½®ä¸€ä¸ªè¿æ¥åœ¨æ± ä¸­æœ€å°ç”Ÿå­˜çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’</span></span><br><span class="line">    <span class="attr">minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line">    <span class="comment"># ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚</span></span><br><span class="line">    <span class="comment"># å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowã€testOnReturnã€testWhileIdleéƒ½ä¸ä¼šèµ·ä½œç”¨</span></span><br><span class="line">    <span class="attr">validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line">    <span class="comment"># å»ºè®®é…ç½®ä¸ºtrueï¼Œä¸å½±å“æ€§èƒ½ï¼Œå¹¶ä¸”ä¿è¯å®‰å…¨æ€§ã€‚</span></span><br><span class="line">    <span class="comment"># ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚</span></span><br><span class="line">    <span class="attr">testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</span></span><br><span class="line">    <span class="attr">testOnBorrow:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</span></span><br><span class="line">    <span class="attr">testOnReturn:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># æ‰“å¼€PSCacheï¼Œå¹¶ä¸”æŒ‡å®šæ¯ä¸ªè¿æ¥ä¸ŠPSCacheçš„å¤§å°</span></span><br><span class="line">    <span class="attr">poolPreparedStatements:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œstat:ç›‘æ§ç»Ÿè®¡ã€log4jï¼šæ—¥å¿—è®°å½•ã€wallï¼šé˜²å¾¡sqlæ³¨å…¥</span></span><br><span class="line">    <span class="comment">#å¦‚æœå…è®¸æ—¶æŠ¥é”™  java.lang.ClassNotFoundException: org.apache.log4j.Priority</span></span><br><span class="line">    <span class="comment">#åˆ™å¯¼å…¥ log4j ä¾èµ–å³å¯ï¼ŒMaven åœ°å€ï¼šhttps://mvnrepository.com/artifact/log4j/log4j</span></span><br><span class="line">    <span class="attr">filters:</span> <span class="string">stat,wall,log4j</span></span><br><span class="line">    <span class="attr">maxPoolPreparedStatementPerConnectionSize:</span> <span class="number">20</span></span><br><span class="line">    <span class="attr">useGlobalDataSourceStat:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">connectionProperties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span></span><br></pre></td></tr></table></figure><ul><li>å¯¼å…¥Log4j çš„ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç°åœ¨éœ€è¦ç¨‹åºå‘˜è‡ªå·±ä¸º <code>DruidDataSource</code> ç»‘å®šå…¨å±€é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°ï¼Œå†æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼Œè€Œä¸å†ä½¿ç”¨ Spring Boot çš„è‡ªåŠ¨ç”Ÿæˆäº†ï¼›æˆ‘ä»¬éœ€è¦ è‡ªå·±æ·»åŠ  <code>DruidDataSource</code> ç»„ä»¶åˆ°å®¹å™¨ä¸­ï¼Œå¹¶ç»‘å®šå±æ€§ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">       å°†è‡ªå®šä¹‰çš„ Druidæ•°æ®æºæ·»åŠ åˆ°å®¹å™¨ä¸­ï¼Œä¸å†è®© Spring Boot è‡ªåŠ¨åˆ›å»º</span></span><br><span class="line"><span class="comment">       ç»‘å®šå…¨å±€é…ç½®æ–‡ä»¶ä¸­çš„ druid æ•°æ®æºå±æ€§åˆ° com.alibaba.druid.pool.DruidDataSourceä»è€Œè®©å®ƒä»¬ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment">       @ConfigurationProperties(prefix = &quot;spring.datasource&quot;)ï¼šä½œç”¨å°±æ˜¯å°† å…¨å±€é…ç½®æ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="comment">       å‰ç¼€ä¸º spring.datasourceçš„å±æ€§å€¼æ³¨å…¥åˆ° com.alibaba.druid.pool.DruidDataSource çš„åŒåå‚æ•°ä¸­</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties(prefix = &quot;spring.datasource&quot;)</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">druidDataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å»æµ‹è¯•ç±»ä¸­æµ‹è¯•ä¸€ä¸‹ï¼›çœ‹æ˜¯å¦æˆåŠŸï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootDataJdbcApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//DIæ³¨å…¥æ•°æ®æº</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">//çœ‹ä¸€ä¸‹é»˜è®¤æ•°æ®æº</span></span><br><span class="line">        System.out.println(dataSource.getClass());</span><br><span class="line">        <span class="comment">//è·å¾—è¿æ¥</span></span><br><span class="line">        Connection connection =   dataSource.getConnection();</span><br><span class="line">        System.out.println(connection);</span><br><span class="line"></span><br><span class="line">        DruidDataSource druidDataSource = (DruidDataSource) dataSource;</span><br><span class="line">        System.out.println(<span class="string">&quot;druidDataSource æ•°æ®æºæœ€å¤§è¿æ¥æ•°ï¼š&quot;</span> + druidDataSource.getMaxActive());</span><br><span class="line">        System.out.println(<span class="string">&quot;druidDataSource æ•°æ®æºåˆå§‹åŒ–è¿æ¥æ•°ï¼š&quot;</span> + druidDataSource.getInitialSize());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@b95e74d7df7bf803a6d4e95281e67e160248149f/2021/06/23/092ad2c104c166f4f13fd3ded8105cc0.png"></p><h2 id="é…ç½®Druidæ•°æ®æºç›‘æ§"><a href="#é…ç½®Druidæ•°æ®æºç›‘æ§" class="headerlink" title="é…ç½®Druidæ•°æ®æºç›‘æ§"></a>é…ç½®Druidæ•°æ®æºç›‘æ§</h2><ul><li>Druid æ•°æ®æºå…·æœ‰ç›‘æ§çš„åŠŸèƒ½ï¼Œå¹¶æä¾›äº†ä¸€ä¸ª web ç•Œé¢æ–¹ä¾¿ç”¨æˆ·æŸ¥çœ‹ï¼Œç±»ä¼¼å®‰è£… è·¯ç”±å™¨ æ—¶ï¼Œäººå®¶ä¹Ÿæä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ web é¡µé¢ã€‚</li><li>æ‰€ä»¥ç¬¬ä¸€æ­¥éœ€è¦è®¾ç½® Druid çš„åå°ç®¡ç†é¡µé¢ï¼Œæ¯”å¦‚ ç™»å½•è´¦å·ã€å¯†ç  ç­‰ï¼›é…ç½®åå°ç®¡ç†ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é…ç½® Druid ç›‘æ§ç®¡ç†åå°çš„Servletï¼›</span></span><br><span class="line">    <span class="comment">//å†…ç½® Servlet å®¹å™¨æ—¶æ²¡æœ‰web.xmlæ–‡ä»¶ï¼Œæ‰€ä»¥ä½¿ç”¨ Spring Boot çš„æ³¨å†Œ Servlet æ–¹å¼</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">statViewServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ServletRegistrationBean bean = <span class="keyword">new</span> ServletRegistrationBean(<span class="keyword">new</span> StatViewServlet(), <span class="string">&quot;/druid/*&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿™äº›å‚æ•°å¯ä»¥åœ¨ com.alibaba.druid.support.http.StatViewServlet</span></span><br><span class="line">        <span class="comment">// çš„çˆ¶ç±» com.alibaba.druid.support.http.ResourceServlet ä¸­æ‰¾åˆ°</span></span><br><span class="line">        Map&lt;String, String&gt; initParams = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        initParams.put(<span class="string">&quot;loginUsername&quot;</span>, <span class="string">&quot;admin&quot;</span>); <span class="comment">//åå°ç®¡ç†ç•Œé¢çš„ç™»å½•è´¦å·</span></span><br><span class="line">        initParams.put(<span class="string">&quot;loginPassword&quot;</span>, <span class="string">&quot;123456&quot;</span>); <span class="comment">//åå°ç®¡ç†ç•Œé¢çš„ç™»å½•å¯†ç </span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//åå°å…è®¸è°å¯ä»¥è®¿é—®</span></span><br><span class="line">        <span class="comment">//initParams.put(&quot;allow&quot;, &quot;localhost&quot;)ï¼šè¡¨ç¤ºåªæœ‰æœ¬æœºå¯ä»¥è®¿é—®</span></span><br><span class="line">        <span class="comment">//initParams.put(&quot;allow&quot;, &quot;&quot;)ï¼šä¸ºç©ºæˆ–è€…ä¸ºnullæ—¶ï¼Œè¡¨ç¤ºå…è®¸æ‰€æœ‰è®¿é—®</span></span><br><span class="line">        initParams.put(<span class="string">&quot;allow&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">//denyï¼šDruid åå°æ‹’ç»è°è®¿é—®</span></span><br><span class="line">        <span class="comment">//initParams.put(&quot;kuangshen&quot;, &quot;192.168.1.20&quot;);è¡¨ç¤ºç¦æ­¢æ­¤ipè®¿é—®</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">        bean.setInitParameters(initParams);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é…ç½®å®Œæ¯•åï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è®¿é—® ï¼š<code>http://localhost:8080/druid/login.html</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@ba7e2d9eeaf1deb129ef7715556eeda9e34825c6/2021/06/23/6e0adb78f5261fe91e096c3dbd53cefb.png"></p><ul><li>è¿›å…¥ä¹‹å</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@daaecd55704d1a24162aa602297e54b9d76df9a5/2021/06/23/5bae0d4b62ced593da31c9137565dfc0.png"></p><ul><li>é…ç½®å®Œæ•´çš„æ•°æ®æºåï¼Œæ‰§è¡Œä¸€æ¡SQLè¯­å¥ä¼šå‘ç°å…¶ç›‘æ§äº†SQLæ“ä½œ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@72cc90ed216527e18ec27c96bbf6528081ce2fef/2021/06/23/cce30f91274a84d319e2f4f6e48118e7.png"></p><h2 id="filter-è¿‡æ»¤å™¨"><a href="#filter-è¿‡æ»¤å™¨" class="headerlink" title="filter è¿‡æ»¤å™¨"></a>filter è¿‡æ»¤å™¨</h2><ul><li>é…ç½® Druid web ç›‘æ§ filter è¿‡æ»¤å™¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é…ç½® Druid ç›‘æ§ ä¹‹  web ç›‘æ§çš„ filter</span></span><br><span class="line"><span class="comment">//WebStatFilterï¼šç”¨äºé…ç½®Webå’ŒDruidæ•°æ®æºä¹‹é—´çš„ç®¡ç†å…³è”ç›‘æ§ç»Ÿè®¡</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">webStatFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   FilterRegistrationBean bean = <span class="keyword">new</span> FilterRegistrationBean();</span><br><span class="line">   bean.setFilter(<span class="keyword">new</span> WebStatFilter());</span><br><span class="line">   </span><br><span class="line">   <span class="comment">//exclusionsï¼šè®¾ç½®å“ªäº›è¯·æ±‚è¿›è¡Œè¿‡æ»¤æ’é™¤æ‰ï¼Œä»è€Œä¸è¿›è¡Œç»Ÿè®¡</span></span><br><span class="line">   Map&lt;String, String&gt; initParams = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">   initParams.put(<span class="string">&quot;exclusions&quot;</span>, <span class="string">&quot;*.js,*.css,/druid/*,/jdbc/*&quot;</span>);</span><br><span class="line">   bean.setInitParameters(initParams);</span><br><span class="line"></span><br><span class="line">   <span class="comment">//&quot;/*&quot; è¡¨ç¤ºè¿‡æ»¤æ‰€æœ‰è¯·æ±‚</span></span><br><span class="line">   bean.setUrlPatterns(Arrays.asList(<span class="string">&quot;/*&quot;</span>));</span><br><span class="line">   <span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ•´åˆMyBatis"><a href="#æ•´åˆMyBatis" class="headerlink" title="æ•´åˆMyBatis"></a>æ•´åˆMyBatis</h1><ul><li>å®˜æ–¹æ–‡æ¡£ï¼š<a href="http://mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/">http://mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/</a></li><li>Mavenä»“åº“åœ°å€ï¼š<a href="https://mvnrepository.com/artifact/org.mybatis.spring.boot/mybatis-spring-boot-starter/2.1.1">https://mvnrepository.com/artifact/org.mybatis.spring.boot/mybatis-spring-boot-starter/2.1.1</a></li></ul><h2 id="ç›¸å…³ä¾èµ–"><a href="#ç›¸å…³ä¾èµ–" class="headerlink" title="ç›¸å…³ä¾èµ–"></a>ç›¸å…³ä¾èµ–</h2><ul><li>å¯¼å…¥ MyBatis æ‰€éœ€è¦çš„ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ•°æ®åº“è¿æ¥"><a href="#æ•°æ®åº“è¿æ¥" class="headerlink" title="æ•°æ®åº“è¿æ¥"></a>æ•°æ®åº“è¿æ¥</h2><ul><li>é…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼ˆä¸å˜ï¼‰</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">data-username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">data-password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="comment">#?serverTimezone=UTCè§£å†³æ—¶åŒºçš„æŠ¥é”™</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span> <span class="comment"># è‡ªå®šä¹‰æ•°æ®æº</span></span><br><span class="line">    <span class="comment">#Spring Boot é»˜è®¤æ˜¯ä¸æ³¨å…¥è¿™äº›å±æ€§å€¼çš„ï¼Œéœ€è¦è‡ªå·±ç»‘å®š</span></span><br><span class="line">    <span class="comment">#druid æ•°æ®æºä¸“æœ‰é…ç½®</span></span><br><span class="line">    <span class="attr">initialSize:</span> <span class="number">5</span></span><br><span class="line">    <span class="attr">minIdle:</span> <span class="number">5</span></span><br><span class="line">    <span class="attr">maxActive:</span> <span class="number">20</span></span><br><span class="line">    <span class="attr">maxWait:</span> <span class="number">60000</span></span><br><span class="line">    <span class="attr">timeBetweenEvictionRunsMillis:</span> <span class="number">60000</span></span><br><span class="line">    <span class="attr">minEvictableIdleTimeMillis:</span> <span class="number">300000</span></span><br><span class="line">    <span class="attr">validationQuery:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span></span><br><span class="line">    <span class="attr">testWhileIdle:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">testOnBorrow:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">testOnReturn:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">poolPreparedStatements:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œstat:ç›‘æ§ç»Ÿè®¡ã€log4jï¼šæ—¥å¿—è®°å½•ã€wallï¼šé˜²å¾¡sqlæ³¨å…¥</span></span><br><span class="line">    <span class="comment">#å¦‚æœå…è®¸æ—¶æŠ¥é”™  java.lang.ClassNotFoundException: org.apache.log4j.Priority</span></span><br><span class="line">    <span class="comment">#åˆ™å¯¼å…¥ log4j ä¾èµ–å³å¯ï¼ŒMaven åœ°å€ï¼šhttps://mvnrepository.com/artifact/log4j/log4j</span></span><br><span class="line">    <span class="attr">filters:</span> <span class="string">stat,wall,log4j</span></span><br><span class="line">    <span class="attr">maxPoolPreparedStatementPerConnectionSize:</span> <span class="number">20</span></span><br><span class="line">    <span class="attr">useGlobalDataSourceStat:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">connectionProperties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span></span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•æ•°æ®åº“æ˜¯å¦è¿æ¥æˆåŠŸï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootDataJdbcApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//DIæ³¨å…¥æ•°æ®æº</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">//çœ‹ä¸€ä¸‹æ•°æ®æº</span></span><br><span class="line">        System.out.println(dataSource.getClass());</span><br><span class="line">        <span class="comment">//è·å¾—è¿æ¥</span></span><br><span class="line">        Connection connection =   dataSource.getConnection();</span><br><span class="line">        System.out.println(connection);</span><br><span class="line">        <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ•´åˆæµ‹è¯•"><a href="#æ•´åˆæµ‹è¯•" class="headerlink" title="æ•´åˆæµ‹è¯•"></a>æ•´åˆæµ‹è¯•</h2><ul><li>åˆ›å»ºå®ä½“ç±»ï¼Œå¯¼å…¥ Lombokï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºmapperç›®å½•ï¼ˆå³daoï¼‰ä»¥åŠå¯¹åº”çš„ Mapper æ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™ä¸ªæ³¨è§£è¡¨ç¤ºäº†è¿™æ˜¯ä¸€ä¸ªmybatisçš„mapperç±»</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">queryAllUser</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">User <span class="title">queryUserById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é™¤äº†@mapperæ³¨è§£ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨å¯åŠ¨ç±»æ·»åŠ æ‰«æåŒ…å®ç°</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.lzy.dao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootDataApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SpringbootDataApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é¦–å…ˆåœ¨<code>application.properties</code>ä¸­æ•´åˆmyBatis</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•´åˆMyBatis</span></span><br><span class="line"><span class="meta">mybatis.type-aliases-package</span>=<span class="string">com.lzy.pojo</span></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:mybatis/mapper/*.xml</span></span><br></pre></td></tr></table></figure><ul><li>å¯¹åº”çš„Mapperæ˜ å°„æ–‡ä»¶<code>UserMapper.xml</code>ï¼Œåœ¨<code>resources</code>ä¸‹åˆ›å»º<code>mybatis/mapper</code>æ–‡ä»¶å¤¹å­˜æ”¾é…ç½®æ–‡ä»¶</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespaceæŒ‡å®šDao/Mapperçš„å®Œæ•´è·¯å¾„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.lzy.dao.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryAllUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from user where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        insert into user (username, password) values (#&#123;username&#125;,#&#123;password&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        update user set username = #&#123;username&#125;,password = #&#123;password&#125; where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        delete from user where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™UserControllerç±»è¿›è¡Œæµ‹è¯•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/queryAll&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">queryAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;User&gt; userList = userMapper.queryAllUser();</span><br><span class="line">        <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> userList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@e4871b33db57528d225c91bafb2036cf99393adf/2021/06/23/4349520df40de33155461f059d410928.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SpringData&quot;&gt;&lt;a href=&quot;#SpringData&quot; class=&quot;headerlink&quot; title=&quot;SpringData&quot;&gt;&lt;/a&gt;SpringData&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;å¯¹äºæ•°æ®è®¿é—®å±‚ï¼Œæ— è®ºæ˜¯ SQL(å…³ç³»å‹æ•°æ®åº“) è¿˜æ˜¯ NOSQL</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    <category term="SpringData" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/SpringData/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="SpringData" scheme="http://xiaoliblog.cn/tags/SpringData/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒå‘˜å·¥ç®¡ç†ç³»ç»Ÿä¹‹CRUD</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot11.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot11.html</id>
    <published>2021-06-22T12:37:41.527Z</published>
    <updated>2021-06-23T08:43:02.021Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å±•ç¤ºå‘˜å·¥åˆ—è¡¨"><a href="#å±•ç¤ºå‘˜å·¥åˆ—è¡¨" class="headerlink" title="å±•ç¤ºå‘˜å·¥åˆ—è¡¨"></a>å±•ç¤ºå‘˜å·¥åˆ—è¡¨</h1><h2 id="æ§åˆ¶å±‚"><a href="#æ§åˆ¶å±‚" class="headerlink" title="æ§åˆ¶å±‚"></a>æ§åˆ¶å±‚</h2><ul><li>åˆ›å»º<code>EmployeeController</code>æ§åˆ¶å™¨Â·</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeDao employeeDao;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/emps&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">        Collection&lt;Employee&gt; employees = employeeDao.getAll();</span><br><span class="line">        model.addAttribute(<span class="string">&quot;emps&quot;</span>,employees);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;emp/list&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹å‰ç«¯é¡µé¢è¿›è¡Œè·³è½¬</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/emps&#125;&quot;</span>&gt;</span></span><br><span class="line">   å‘˜å·¥ç®¡ç†</span><br><span class="line">   <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å…¬å…±éƒ¨åˆ†"><a href="#å…¬å…±éƒ¨åˆ†" class="headerlink" title="å…¬å…±éƒ¨åˆ†"></a>å…¬å…±éƒ¨åˆ†</h2><ul><li>æ¯”å¦‚ä¾§è¾¹æ å’Œå¤´éƒ¨å¯¼èˆªæ æ˜¯å…¬å…±çš„ï¼Œå¯ä»¥æŠŠå…¬å…±éƒ¨åˆ†æŠ½å–å‡ºæ¥ã€‚æ¯”å¦‚<code>dashboard.html</code>çš„å¯¼èˆªæ è¿›è¡ŒæŠ½å–ï¼Œæˆä¸ºä¸€ä¸ªç»„ä»¶ï¼Œå°±å¯ä»¥åœ¨å…¶ä»–é¡µé¢ä½¿ç”¨</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¤´éƒ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">th:fragment</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ä¾§è¾¹æ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">th:fragment</span>=<span class="string">&quot;sidebar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨<code>list.html</code>ä¸­ä½¿ç”¨æŠ½å–å‡ºæ¥çš„ç»„ä»¶<code>&#123;é¡µé¢è·¯å¾„::è®¾ç½®çš„å‚æ•°å€¼&#125;</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;~&#123;dashboard::header&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">&quot;~&#123;dashboard::sidebar&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ä¹Ÿå¯ä»¥æŠŠä¾§è¾¹æ å’Œå¤´éƒ¨å¯¼èˆªæ æŠ½å–åˆ°ä¸€ä¸ª<code>commons.html</code>é‡Œï¼Œæ¯”å¦‚åœ¨<code>templates</code>ä¸‹åˆ›å»ºÂ·<code>commons</code>æ–‡ä»¶å¤¹å­˜æ”¾<code>commons.html</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¤´éƒ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">th:fragment</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ä¾§è¾¹æ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">th:fragment</span>=<span class="string">&quot;sidebar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å¯ä»¥è¯•ä¸€ä¸‹<code>th:replace</code>ä½¿ç”¨</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;~&#123;commons/commons::header&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;~&#123;commons/commons::sidebar&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="URLä¼ å‚"><a href="#URLä¼ å‚" class="headerlink" title="URLä¼ å‚"></a>URLä¼ å‚</h2><ul><li>å½“é€‰æ‹©å‘˜å·¥ç®¡ç†æ—¶éœ€æŠŠå‘˜å·¥ç®¡ç†é‚£ä¸€é¡¹é«˜äº®æ˜¾ç¤ºï¼Œè¿™é‡Œä½¿ç”¨åˆ°äº†URLä¼ å‚</li><li>æ¯”å¦‚åœ¨<code>list.html</code>çš„å…¬å…±éƒ¨åˆ†ï¼Œä¼ é€’ä¸€ä¸ªå‚æ•°é”®å€¼å¯¹<code>active=&#39;list.html&#39;</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">&quot;~&#123;commons/commons::sidebar(active=&#x27;list.html&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨å…¬å…±éƒ¨åˆ†<code>commons.html</code>ä¸­è¿›è¡Œæ¥æ”¶å¹¶åˆ¤æ–­</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:class</span>=<span class="string">&quot;$&#123;active==&#x27;list.html&#x27;?&#x27;nav-link active&#x27;:&#x27;nav-link&#x27;&#125;&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/emps&#125;&quot;</span>&gt;</span></span><br><span class="line">   å‘˜å·¥ç®¡ç†</span><br><span class="line">   <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="éå†æ•°æ®"><a href="#éå†æ•°æ®" class="headerlink" title="éå†æ•°æ®"></a>éå†æ•°æ®</h2><ul><li>ä½¿ç”¨<code>th:each=&quot;åˆ«å:$&#123;æ•°æ®å¯¹è±¡&#125;&quot;</code>è¿›è¡Œæ•°æ®éå†</li><li>å–å€¼å¯ä»¥é€šè¿‡è¡Œå†…<code>[[$&#123;value&#125;]]</code>ï¼Œç¼ºç‚¹æ˜¯æ²¡æœ‰æç¤ºã€‚å¯ä»¥é€šè¿‡<code>th:text=&quot;$&#123;value&#125;&quot;</code>ï¼Œä¼šæœ‰æç¤º</li><li>ä½¿ç”¨thymeleafçš„å·¥å…·ç±»è¿›è¡Œæ—¥æœŸæ ¼å¼è½¬æ¢<code>$&#123;#dates.format(date,&#39;yyyy-MM-dd HH:mm:ss&#39;)&#125;</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;table table-striped table-sm&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">th</span>&gt;</span>lastName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">th</span>&gt;</span>department<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">th</span>&gt;</span>birth<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--åŠ¨æ€ç”Ÿæˆ--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;emp:$&#123;emps&#125;&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.getId()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">td</span>&gt;</span>[[$&#123;emp.getLastName&#125;]]<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.getEmail()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.getGender()==0?&#x27;å¥³&#x27;:&#x27;ç”·&#x27;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.department.getDepartmentName()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;#dates.format(emp.getBirth(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-info&quot;</span>&gt;</span>ç¼–è¾‘<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-danger&quot;</span>&gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="å¢åŠ å‘˜å·¥å®ç°"><a href="#å¢åŠ å‘˜å·¥å®ç°" class="headerlink" title="å¢åŠ å‘˜å·¥å®ç°"></a>å¢åŠ å‘˜å·¥å®ç°</h1><h2 id="è·å–éƒ¨é—¨ä¿¡æ¯"><a href="#è·å–éƒ¨é—¨ä¿¡æ¯" class="headerlink" title="è·å–éƒ¨é—¨ä¿¡æ¯"></a>è·å–éƒ¨é—¨ä¿¡æ¯</h2><ul><li>å¢åŠ æ·»åŠ æŒ‰é’®è·³è½¬åˆ°æ·»åŠ é¡µé¢</li><li>è¾“å…¥å‘˜å·¥ä¿¡æ¯æäº¤è¡¨å•ï¼Œè·³è½¬åˆ°å‘˜å·¥ç®¡ç†é¡µé¢</li><li>ä½¿ç”¨Restfulé£æ ¼<code>GET</code>è¯·æ±‚è·³è½¬åˆ°æ·»åŠ é¡µé¢ï¼Œ<code>POST</code>è¯·æ±‚æäº¤è¡¨å•ã€‚åŒä¸€ä¸ªè¯·æ±‚ä¸åŒçš„è¯·æ±‚æ–¹æ³•å®ç°ä¸åŒçš„ä¸šåŠ¡</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/emp&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success&quot;</span>&gt;</span>æ·»åŠ å‘˜å·¥<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é¦–å…ˆè¦è·å–éƒ¨é—¨ä¿¡æ¯å¹¶å±•ç¤º</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@921051c119a3daf142f19a1389233d00db30de55/2021/06/23/e9baf8e39f5ba5a2c899f25544a5244c.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">DepartmentDao departmentDao;</span><br><span class="line"><span class="meta">@GetMapping(&quot;/emp&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toAddpage</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">   <span class="comment">// æŸ¥å‡ºæ‰€æœ‰éƒ¨é—¨çš„ä¿¡æ¯</span></span><br><span class="line">   Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">   model.addAttribute(<span class="string">&quot;departments&quot;</span>,departments);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;emp/add&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å‰ç«¯é¡µé¢æ¥æ”¶</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--valueä¼ çš„æ˜¯idï¼Œnameä¹Ÿè¦ä¸€ä¸€å¯¹åº”ï¼Œä¼ çš„æ˜¯ç‰¹æ®Šç±»å‹ï¼Œä¸èƒ½ä¼ å¯¹è±¡åªèƒ½è½¬ç»„ä»¶--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;department.id&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--textåªæ˜¯æ˜¾ç¤ºï¼Œæäº¤çš„æ˜¯value--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:each</span>=<span class="string">&quot;dept:$&#123;departments&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;dept.getDepartmentName()&#125;&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;dept.getId()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ å®ç°"><a href="#æ·»åŠ å®ç°" class="headerlink" title="æ·»åŠ å®ç°"></a>æ·»åŠ å®ç°</h2><ul><li>ç¼–å†™æ§åˆ¶å™¨å¤„ç†POSTè¡¨å•æäº¤è¯·æ±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">DepartmentDao departmentDao;</span><br><span class="line"><span class="comment">//è·³è½¬åˆ°å‘˜å·¥ç®¡ç†é¡µé¢</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/emps&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">   Collection&lt;Employee&gt; employees = employeeDao.getAll();</span><br><span class="line">   model.addAttribute(<span class="string">&quot;emps&quot;</span>,employees);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;emp/list&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@PostMapping(&quot;/emp&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addEmp</span><span class="params">(Employee employee,Model model)</span></span>&#123;</span><br><span class="line">   <span class="comment">// æ·»åŠ å‘˜å·¥</span></span><br><span class="line">   System.out.println(<span class="string">&quot;save=&gt;&quot;</span>+employee);</span><br><span class="line">   employeeDao.save(employee);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>; <span class="comment">//è·³è½¬åˆ°å‘˜å·¥åˆ—è¡¨å¹¶åˆ·æ–°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å‰ç«¯é¡µé¢ï¼Œæ³¨æ„<code>name</code>å€¼è¦å’Œå®ä½“ç±»ä¸€ä¸€å¯¹åº”</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/emp&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>LastName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;LastName&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>Gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span><span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span><span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>å¥³<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>department<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;department.id&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--textåªæ˜¯æ˜¾ç¤ºï¼Œæäº¤çš„æ˜¯value--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:each</span>=<span class="string">&quot;dept:$&#123;departments&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;dept.getDepartmentName()&#125;&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;dept.getId()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>Birth<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Birth&quot;</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>æäº¤è¡¨å•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ—¶é—´æ ¼å¼"><a href="#æ—¶é—´æ ¼å¼" class="headerlink" title="æ—¶é—´æ ¼å¼"></a>æ—¶é—´æ ¼å¼</h2><ul><li>å½“æˆ‘ä»¬è¾“å…¥<code>1999/11/12</code>æ—¶ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†æ˜¯è¾“å…¥<code>1999-11-12</code>å´å‡ºç°äº†é”™è¯¯</li><li>è¿™æ˜¯å› ä¸ºSpringBootæœ‰ä¸€ä¸ªé»˜è®¤çš„æ ¼å¼<code>dd/MM/yyyy</code>ï¼Œæ‰€ä»¥éœ€è¦è‡ªå®šä¹‰æ ¼å¼ã€‚è‡ªå®šä¹‰å<code>/</code>æ ¼å¼å°±æ— æ³•ä½¿ç”¨</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.format.date</span>=<span class="string">yyyy-MM-dd</span></span><br></pre></td></tr></table></figure><h1 id="ä¿®æ”¹å‘˜å·¥ä¿¡æ¯"><a href="#ä¿®æ”¹å‘˜å·¥ä¿¡æ¯" class="headerlink" title="ä¿®æ”¹å‘˜å·¥ä¿¡æ¯"></a>ä¿®æ”¹å‘˜å·¥ä¿¡æ¯</h1><h2 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><ul><li>é€šè¿‡æŒ‰é’®ç»‘å®šæ¯ä¸€ä¸ªå‘˜å·¥IDï¼Œè®¿é—®ç¼–è¾‘é¡µé¢çš„æ—¶å€™å¸¦å‘˜å·¥IDå‚æ•°</li><li>é€šè¿‡Restfulåˆ†éš”å®ç°</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;emp:$&#123;emps&#125;&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.getId()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span>[[$&#123;emp.getLastName&#125;]]<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.getEmail()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.getGender()==0?&#x27;å¥³&#x27;:&#x27;ç”·&#x27;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;emp.department.getDepartmentName()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;#dates.format(emp.getBirth(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-info&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/emp/&#125;+$&#123;emp.getId()&#125;&quot;</span>&gt;</span>ç¼–è¾‘<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-danger&quot;</span>&gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™æ§åˆ¶å™¨å¤„ç†è¯·æ±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¼–è¾‘é¡µé¢</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/emp/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toUpdateEmp</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id,Model model)</span></span>&#123;</span><br><span class="line">   <span class="comment">//æŸ¥å‡ºåŸæ¥æ•°æ®</span></span><br><span class="line">   Employee employee = employeeDao.getEmployeeByID(id);</span><br><span class="line">   model.addAttribute(<span class="string">&quot;emp&quot;</span>,employee);</span><br><span class="line">   <span class="comment">// æŸ¥å‡ºéƒ¨é—¨ä¿¡æ¯</span></span><br><span class="line">   Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">   model.addAttribute(<span class="string">&quot;departments&quot;</span>,departments);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;emp/update&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¼–è¾‘å®ç°"><a href="#ç¼–è¾‘å®ç°" class="headerlink" title="ç¼–è¾‘å®ç°"></a>ç¼–è¾‘å®ç°</h2><ul><li>åœ¨<code>emp</code>æ–‡ä»¶ä¸‹æ–°å»º<code>update.html</code>é¡µé¢ï¼Œä¼ å…¥åç«¯çš„æ•°æ®</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/emp&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--éšè—åŸŸ ç”¨äºéšè—ä¿å­˜ä¸»é”®ID--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp.getId()&#125;&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>LastName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp.getLastName()&#125;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;LastName&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;emp.getEmail()&#125;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>Gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">th:checked</span>=<span class="string">&quot;$&#123;emp.getGender()==1&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span><span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check form-check-inline&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">th:checked</span>=<span class="string">&quot;$&#123;emp.getGender()==0&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span><span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span>&gt;</span>å¥³<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>department<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;department.id&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--textåªæ˜¯æ˜¾ç¤ºï¼Œæäº¤çš„æ˜¯value--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:selected</span>=<span class="string">&quot;$&#123;dept.getId()==emp.getDepartment().getId()&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;dept:$&#123;departments&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;dept.getDepartmentName()&#125;&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;dept.getId()&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>Birth<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;#dates.format(emp.getBirth(),&#x27;yyyy-MM-dd HH:mm&#x27;)&#125;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Birth&quot;</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>æäº¤è¡¨å•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span>            </span><br></pre></td></tr></table></figure><ul><li>å¡«å†™è¡¨å•åéœ€è¦æ§åˆ¶å™¨å¤„ç†è¯·æ±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‘˜å·¥ä¿¡æ¯ä¿®æ”¹</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/updateEmp&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">updateEmp</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">   employeeDao.save((employee));</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åˆ é™¤åŠ404æ“ä½œ"><a href="#åˆ é™¤åŠ404æ“ä½œ" class="headerlink" title="åˆ é™¤åŠ404æ“ä½œ"></a>åˆ é™¤åŠ404æ“ä½œ</h1><h2 id="åˆ é™¤å‘˜å·¥ä¿¡æ¯"><a href="#åˆ é™¤å‘˜å·¥ä¿¡æ¯" class="headerlink" title="åˆ é™¤å‘˜å·¥ä¿¡æ¯"></a>åˆ é™¤å‘˜å·¥ä¿¡æ¯</h2><ul><li>é¦–å…ˆåˆ é™¤æŒ‰é’®ç»‘å®šå‘˜å·¥IDï¼Œä¼ é€’å‚æ•°ç»™åç«¯</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/delemp/&#125;+$&#123;emp.getId()&#125;&quot;</span>&gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åç«¯æ¥æ”¶å‘˜å·¥IDè¿›è¡Œåˆ é™¤ï¼Œåˆ é™¤åè·³åˆ°å‘˜å·¥åˆ—è¡¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ é™¤å‘˜å·¥</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/emp/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">delEmp</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id,Model model)</span></span>&#123;</span><br><span class="line">   employeeDao.delete(id);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ³¨é”€æ“ä½œ"><a href="#æ³¨é”€æ“ä½œ" class="headerlink" title="æ³¨é”€æ“ä½œ"></a>æ³¨é”€æ“ä½œ</h2><ul><li>å‰ç«¯é¡µé¢æäº¤æ³¨é”€è¯·æ±‚</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/user/loginout&#125;&quot;</span>&gt;</span>æ³¨é”€<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åç«¯ç§»é™¤ç”¨æˆ·Sessionï¼Œå¹¶è·³è½¬åˆ°ç™»å½•é¡µé¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”¨æˆ·æ³¨é”€</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/loginout&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">loginout</span><span class="params">(HttpSession session)</span></span>&#123;</span><br><span class="line">   session.invalidate();</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;redirect:/index.html&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="404é¡µé¢"><a href="#404é¡µé¢" class="headerlink" title="404é¡µé¢"></a>404é¡µé¢</h2><ul><li>åœ¨<code>templates</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª<code>error</code>æ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ª<code>404.html</code></li><li>å½“å‘ç°é”™è¯¯æ—¶ä¼šè‡ªåŠ¨è·³è½¬åˆ°404é¡µé¢</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å±•ç¤ºå‘˜å·¥åˆ—è¡¨&quot;&gt;&lt;a href=&quot;#å±•ç¤ºå‘˜å·¥åˆ—è¡¨&quot; class=&quot;headerlink&quot; title=&quot;å±•ç¤ºå‘˜å·¥åˆ—è¡¨&quot;&gt;&lt;/a&gt;å±•ç¤ºå‘˜å·¥åˆ—è¡¨&lt;/h1&gt;&lt;h2 id=&quot;æ§åˆ¶å±‚&quot;&gt;&lt;a href=&quot;#æ§åˆ¶å±‚&quot; class=&quot;headerlink&quot; title=&quot;æ§åˆ¶å±‚</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒå‘˜å·¥ç®¡ç†ç³»ç»Ÿä¹‹ç™»å½•æ‹¦æˆª</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot10.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot10.html</id>
    <published>2021-06-22T11:44:50.051Z</published>
    <updated>2021-06-22T12:57:25.472Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çƒ­éƒ¨ç½²"><a href="#çƒ­éƒ¨ç½²" class="headerlink" title="çƒ­éƒ¨ç½²"></a>çƒ­éƒ¨ç½²</h1><ul><li>çƒ­éƒ¨ç½²ï¼Œå°±æ˜¯åœ¨åº”ç”¨æ­£åœ¨è¿è¡Œçš„æ—¶å€™å‡çº§è½¯ä»¶ï¼Œå´ä¸éœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨</li><li>SpringBootçƒ­éƒ¨ç½²å°±æ˜¯åœ¨é¡¹ç›®æ­£åœ¨è¿è¡Œçš„æ—¶å€™ä¿®æ”¹ä»£ç , å´ä¸éœ€è¦é‡æ–°å¯åŠ¨é¡¹ç›®</li></ul><h2 id="é…ç½®çƒ­éƒ¨ç½²"><a href="#é…ç½®çƒ­éƒ¨ç½²" class="headerlink" title="é…ç½®çƒ­éƒ¨ç½²"></a>é…ç½®çƒ­éƒ¨ç½²</h2><ul><li>pomæ–‡ä»¶ä¸­å¯¼å…¥ <code>spring-boot-devtools</code> ä¾èµ–ï¼š</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç»§ç»­åœ¨pom.xmlä¸­æ·»åŠ æ’ä»¶</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">fork</span>&gt;</span>true<span class="tag">&lt;/<span class="name">fork</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">addResources</span>&gt;</span>true<span class="tag">&lt;/<span class="name">addResources</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>è®¾ç½®<code>application.properties</code></li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®é¡¹ç›®çƒ­éƒ¨ç½²</span></span><br><span class="line"><span class="meta">spring.devtools.restart.enabled</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨ideaä¸­è®¾ç½®è‡ªåŠ¨ç¼–è¯‘ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@faf08691318f4e003832ce54cf9f22de94d8c3b1/2021/06/22/1920dbecb59f02595044901846eced46.png"></p><ul><li><p>æŒ‰ä½<kbd>ctrl</kbd>+<kbd>shift</kbd>+<kbd>alt</kbd>+<kbd> / </kbd>ï¼Œå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºç•Œé¢ï¼Œç‚¹å‡»Registryï¼ˆæ³¨å†Œï¼‰â€¦ï¼Œå¦‚ä¸‹å›¾ï¼š<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@04df3016a11980061b66917dd18d2f3be038611d/2021/06/22/d21320e0e3a4b52337f3d234ca4b21dd.png"></p></li><li><p> ç‚¹å‡»è¿›å…¥åï¼Œå‹¾é€‰<code>compiler.automake.allow.when.app.running</code>åå…³é—­å³å¯</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@fb274a58ab33dac06815f77b4dc7ae682f60de07/2021/06/22/347f522d897e4fb7efc8dbd2f0c71098.png"></p><h1 id="ç™»å½•åŠŸèƒ½"><a href="#ç™»å½•åŠŸèƒ½" class="headerlink" title="ç™»å½•åŠŸèƒ½"></a>ç™»å½•åŠŸèƒ½</h1><h2 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><ul><li>é¦–å…ˆå†™ä¸€ä¸ªæ§åˆ¶å™¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(String username, String password, Model model)</span></span>&#123;</span><br><span class="line">        <span class="comment">// å…·ä½“ä¸šåŠ¡</span></span><br><span class="line">        <span class="keyword">if</span>(username.equals(<span class="string">&quot;admin&quot;</span>) &amp;&amp;  password.equals(<span class="string">&quot;12345&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;dashboard&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹å‰ç«¯ä»£ç </li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">&quot;form-signin&quot;</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/user/login&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--çœç•¥--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--å¦‚æœmsgä¸ºç©ºåˆ™ä¸æ˜¾ç¤º--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;not #strings.isEmpty(msg)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--çœç•¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>è®¿é—®åå‘ç°æˆåŠŸè·³è½¬ï¼Œä½†åœ°å€æ å´æ²¡æœ‰å˜åŒ–</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@4db08156fa4d3b9e4605ffb105b0e1d60851e5c3/2021/06/22/3f3a26df0fc5aa158b2ab336a0e0c5ce.png"></p><h2 id="åœ°å€æ˜ å°„"><a href="#åœ°å€æ˜ å°„" class="headerlink" title="åœ°å€æ˜ å°„"></a>åœ°å€æ˜ å°„</h2><ul><li>æˆ‘ä»¬å¯ä»¥å–ä¸€ä¸ªå‡çš„åœ°å€åˆ«åï¼Œå…¶ä¸æ˜¯çœŸæ­£çš„é¡µé¢è€Œåªæ˜¯ä¸€ä¸ªè¯·æ±‚è€Œå·²</li><li>åœ¨æˆ‘ä»¬<code>config</code>ä¸‹åˆ›å»ºçš„SpringMVCæ‰©å±•ç±»é‡Œæ·»åŠ åœ°å€æ˜ å°„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰©å±•springmvc</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocaleResolver <span class="title">localeResolver</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyLocaleResolver();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span></span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/index.html&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        <span class="comment">//ç›¸å½“äºç»™dashboardèµ·åˆ«å</span></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/main.html&quot;</span>).setViewName(<span class="string">&quot;dashboard&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ§åˆ¶å™¨ä¸­ä¿®æ”¹ä¸ºé‡å®šå‘</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(String username, String password, Model model)</span></span>&#123;</span><br><span class="line">        <span class="comment">// å…·ä½“ä¸šåŠ¡</span></span><br><span class="line">        <span class="keyword">if</span>(username.equals(<span class="string">&quot;admin&quot;</span>) &amp;&amp;  password.equals(<span class="string">&quot;12345&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/main.html&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å†æ¬¡è®¿é—®å°±ä¼šæ˜ å°„åˆ°<code>main.html</code>äº†</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@e42e34813212331a3e7fb29319e795d528cf3766/2021/06/22/88e9b814fdb05572659a9f894b89ec91.png"></p><h1 id="ç™»å½•æ‹¦æˆª"><a href="#ç™»å½•æ‹¦æˆª" class="headerlink" title="ç™»å½•æ‹¦æˆª"></a>ç™»å½•æ‹¦æˆª</h1><ul><li>ä½†æ˜¯æœªç™»å½•çŠ¶æ€ä¸‹è®¿é—®<code>http://localhost:8080/main.html</code>ç…§æ ·èƒ½è¿›å…¥ï¼Œè¿™æ˜¯ä¸åˆç†çš„ï¼Œéœ€è¦é…ç½®æ‹¦æˆªå™¨</li><li>åœ¨<code>config</code>åŒ…ä¸‹æ–°å»ºä¸€ä¸ªæ‹¦æˆªå™¨ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginHandlerInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// ç™»å½•æˆåŠŸä¹‹åï¼Œåº”è¯¥æœ‰ç”¨æˆ·çš„Session</span></span><br><span class="line">        Object loginUser = request.getSession().getAttribute(<span class="string">&quot;loginUser&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(loginUser == <span class="keyword">null</span>)&#123; <span class="comment">//æœªç™»å½•</span></span><br><span class="line">            request.setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;æ²¡æœ‰æƒé™ï¼Œè¯·å…ˆç™»å½•&quot;</span>);</span><br><span class="line">            request.getRequestDispatcher(<span class="string">&quot;/index.html&quot;</span>).forward(request,response);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span>  <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨<code>config</code>ä¸‹çš„SpringMVCæ‰©å±•ä¸­è¿›è¡Œè®¾ç½®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰©å±•springmvc</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocaleResolver <span class="title">localeResolver</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyLocaleResolver();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span></span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/index.html&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        <span class="comment">//ç›¸å½“äºç»™dashboardèµ·åˆ«å</span></span><br><span class="line">        registry.addViewController(<span class="string">&quot;/main.html&quot;</span>).setViewName(<span class="string">&quot;dashboard&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span></span>&#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> LoginHandlerInterceptor())</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .excludePathPatterns(<span class="string">&quot;/index.html&quot;</span>,<span class="string">&quot;/&quot;</span>,<span class="string">&quot;/user/login&quot;</span>,<span class="string">&quot;static/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>éœ€è¦åœ¨æ§åˆ¶å™¨å¤„ç†æ—¶ï¼Œæ·»åŠ ç”¨æˆ·Session</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(String username, String password, Model model, HttpSession session)</span></span>&#123;</span><br><span class="line">        <span class="comment">// å…·ä½“ä¸šåŠ¡</span></span><br><span class="line">        <span class="keyword">if</span>(username.equals(<span class="string">&quot;admin&quot;</span>) &amp;&amp;  password.equals(<span class="string">&quot;12345&quot;</span>))&#123;</span><br><span class="line">            session.setAttribute(<span class="string">&quot;loginUser&quot;</span>,username);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/main.html&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç™»é™†åç”¨æˆ·åæ˜¾ç¤º</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span>[[$&#123;session.loginUser&#125;]]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;çƒ­éƒ¨ç½²&quot;&gt;&lt;a href=&quot;#çƒ­éƒ¨ç½²&quot; class=&quot;headerlink&quot; title=&quot;çƒ­éƒ¨ç½²&quot;&gt;&lt;/a&gt;çƒ­éƒ¨ç½²&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;çƒ­éƒ¨ç½²ï¼Œå°±æ˜¯åœ¨åº”ç”¨æ­£åœ¨è¿è¡Œçš„æ—¶å€™å‡çº§è½¯ä»¶ï¼Œå´ä¸éœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨&lt;/li&gt;
&lt;li&gt;SpringBootçƒ­éƒ¨ç½²å°±æ˜¯åœ¨é¡¹ç›®æ­£</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒå‘˜å·¥ç®¡ç†ç³»ç»Ÿå‡†å¤‡åŠå›½é™…åŒ–</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot09.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot09.html</id>
    <published>2021-06-22T08:33:52.422Z</published>
    <updated>2021-06-23T08:19:51.524Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h1><h2 id="é™æ€èµ„æº"><a href="#é™æ€èµ„æº" class="headerlink" title="é™æ€èµ„æº"></a>é™æ€èµ„æº</h2><ul><li>HTMLé¡µé¢æ”¾å…¥<code>templates</code>æ–‡ä»¶å¤¹ä¸‹</li><li>CSSã€JSã€å›¾ç‰‡ç­‰æ”¾åœ¨<code>static</code>æ–‡ä»¶å¤¹ä¸‹</li></ul><h2 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h2><ul><li>è¿™é‡Œæœªä½¿ç”¨æ•°æ®åº“ï¼Œéœ€è¦ä¼ªé€ æ•°æ®ã€‚é¦–å…ˆåˆ›å»ºå®ä½“ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éƒ¨é—¨è¡¨</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Department</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String departmentName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘˜å·¥è¡¨</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Integer gender; <span class="comment">//0ï¼šå¥³ 1ï¼šç”·</span></span><br><span class="line">    <span class="keyword">private</span> Department department;</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(Integer id, String lastName, String email, Integer gender, Department department, Date birth)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender;</span><br><span class="line">        <span class="keyword">this</span>.department = department;</span><br><span class="line">        <span class="comment">// é»˜è®¤åˆ›å»ºæ—¥æœŸ</span></span><br><span class="line">        <span class="keyword">this</span>.birth = <span class="keyword">new</span> Date();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨Daoå±‚æ¨¡æ‹Ÿæ•°æ®åº“æ•°æ®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éƒ¨é—¨Dao</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DepartmentDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿæ•°æ®åº“ä¸­çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Integer, Department&gt; departmentmap = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        departmentmap = <span class="keyword">new</span> HashMap&lt;&gt;(); <span class="comment">//åˆ›å»ºä¸€ä¸ªéƒ¨é—¨è¡¨</span></span><br><span class="line">        departmentmap.put(<span class="number">101</span>,<span class="keyword">new</span> Department(<span class="number">101</span>,<span class="string">&quot;æ•™å­¦éƒ¨&quot;</span>));</span><br><span class="line">        departmentmap.put(<span class="number">102</span>,<span class="keyword">new</span> Department(<span class="number">102</span>,<span class="string">&quot;å¸‚åœºéƒ¨&quot;</span>));</span><br><span class="line">        departmentmap.put(<span class="number">103</span>,<span class="keyword">new</span> Department(<span class="number">103</span>,<span class="string">&quot;æ•™ç ”éƒ¨&quot;</span>));</span><br><span class="line">        departmentmap.put(<span class="number">104</span>,<span class="keyword">new</span> Department(<span class="number">104</span>,<span class="string">&quot;è¿è¥éƒ¨&quot;</span>));</span><br><span class="line">        departmentmap.put(<span class="number">105</span>,<span class="keyword">new</span> Department(<span class="number">105</span>,<span class="string">&quot;åå‹¤éƒ¨&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰éƒ¨é—¨å­¦æ ¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection&lt;Department&gt; <span class="title">getDepartments</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> departmentmap.values();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é€šè¿‡idå¾—åˆ°éƒ¨é—¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Department <span class="title">getDepartmentByID</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> departmentmap.get(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘˜å·¥Deao</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿæ•°æ®åº“ä¸­çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Integer, Employee&gt; employeeMap = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// å‘˜å·¥æœ‰æ‰€å±çš„éƒ¨é—¨</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DepartmentDao departmentDao;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        employeeMap = <span class="keyword">new</span> HashMap&lt;&gt;(); <span class="comment">//åˆ›å»ºä¸€ä¸ªå‘˜å·¥è¡¨</span></span><br><span class="line">        employeeMap.put(<span class="number">101</span>,<span class="keyword">new</span> Employee(<span class="number">101</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>,<span class="string">&quot;A247312312@qq.com&quot;</span>,<span class="number">1</span>,<span class="keyword">new</span> Department(<span class="number">101</span>,<span class="string">&quot;æ•™å­¦éƒ¨&quot;</span>),<span class="keyword">new</span> Date()));</span><br><span class="line">        employeeMap.put(<span class="number">102</span>,<span class="keyword">new</span> Employee(<span class="number">102</span>,<span class="string">&quot;æå››&quot;</span>,<span class="string">&quot;B247312312@qq.com&quot;</span>,<span class="number">0</span>,<span class="keyword">new</span> Department(<span class="number">102</span>,<span class="string">&quot;å¸‚åœºéƒ¨&quot;</span>),<span class="keyword">new</span> Date()));</span><br><span class="line">        employeeMap.put(<span class="number">103</span>,<span class="keyword">new</span> Employee(<span class="number">103</span>,<span class="string">&quot;ç‹äº”&quot;</span>,<span class="string">&quot;C247312312@qq.com&quot;</span>,<span class="number">1</span>,<span class="keyword">new</span> Department(<span class="number">103</span>,<span class="string">&quot;æ•™ç ”éƒ¨&quot;</span>),<span class="keyword">new</span> Date()));</span><br><span class="line">        employeeMap.put(<span class="number">104</span>,<span class="keyword">new</span> Employee(<span class="number">104</span>,<span class="string">&quot;èµµå…­&quot;</span>,<span class="string">&quot;D247312312@qq.com&quot;</span>,<span class="number">0</span>,<span class="keyword">new</span> Department(<span class="number">104</span>,<span class="string">&quot;è¿è¥éƒ¨&quot;</span>),<span class="keyword">new</span> Date()));</span><br><span class="line">        employeeMap.put(<span class="number">105</span>,<span class="keyword">new</span> Employee(<span class="number">105</span>,<span class="string">&quot;è€ç™½&quot;</span>,<span class="string">&quot;E247312312@qq.com&quot;</span>,<span class="number">1</span>,<span class="keyword">new</span> Department(<span class="number">105</span>,<span class="string">&quot;åå‹¤éƒ¨&quot;</span>),<span class="keyword">new</span> Date()));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¢åŠ ä¸€ä¸ªå‘˜å·¥ï¼Œä¸»é”®è‡ªå¢</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer initID = <span class="number">1006</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(employee.getId() == <span class="keyword">null</span>)&#123;</span><br><span class="line">            employee.setId(initID++);</span><br><span class="line">        &#125;</span><br><span class="line">        employee.setDepartment(departmentDao.getDepartmentByID(employee.getDepartment().getId()));</span><br><span class="line">        employeeMap.put(employee.getId(),employee);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è·å¾—æŸ¥è¯¢å…¨éƒ¨å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection&lt;Employee&gt; <span class="title">getAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> employeeMap.values();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//é€šè¿‡IDæŸ¥è¯¢å‘˜å·¥</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmployeeByID</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> employeeMap.get(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ é™¤å‘˜å·¥é€šè¿‡id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        employeeMap.remove(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="é¦–é¡µå®ç°"><a href="#é¦–é¡µå®ç°" class="headerlink" title="é¦–é¡µå®ç°"></a>é¦–é¡µå®ç°</h1><h2 id="è§†å›¾è·³è½¬"><a href="#è§†å›¾è·³è½¬" class="headerlink" title="è§†å›¾è·³è½¬"></a>è§†å›¾è·³è½¬</h2><ul><li>è§†å›¾è·³è½¬æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œç¬¬ä¸€ç§æ˜¯å†™ä¸€ä¸ª<code>Controller</code>è¿›è¡Œè·³è½¬</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line">   <span class="comment">//  /å’Œ/index.htmléƒ½æ˜ å°„åˆ°é¦–é¡µï¼Œä½†ä¸å»ºè®®ç”¨è¿™ç§æ–¹æ³•å®ç°</span></span><br><span class="line">    <span class="meta">@RequestMapping(&#123;&quot;/&quot;,&quot;/index.html&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¬¬äºŒç§æ–¹æ³•æ˜¯å†™ä¸€ä¸ª<code>/config</code>åŒ…ä¸‹çš„æ‰©å±•SpringMVC</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰©å±•springmvc</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span></span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/index.html&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é™æ€èµ„æº-1"><a href="#é™æ€èµ„æº-1" class="headerlink" title="é™æ€èµ„æº"></a>é™æ€èµ„æº</h2><ul><li>æ‰“å¼€é¡µé¢å‘ç°é™æ€èµ„æºåŠ è½½ä¸å‡ºæ¥ï¼Œè¿™æ˜¯å› ä¸º<code>Thymeleaf</code>æ²¡é…å¥½</li><li>é¦–å…ˆè¦é…ç½®çº¦æŸå¤´</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>URLé™æ€èµ„æºçš„å¼•å…¥ï¼Œé¦–å…ˆ<code>@&#123;/&#125;</code>å°±ä»£è¡¨èµ„æºæ ¹ç›®å½•ï¼Œå…¶ç”¨äºå®šä¹‰URLï¼Œæ¯”å¦‚<code>/static/</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--/static/css/..--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/css/bootstrap.min.css&#125;&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœé¡µé¢è¿˜æ˜¯æ²¡æœ‰æ•ˆæœï¼Œå¯èƒ½æ˜¯æ¨¡æ¿å¼•æ“ç¼“å­˜çš„å½±å“ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­å»æ‰ç¼“å­˜</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure><ul><li>å›¾ç‰‡çš„å¼•å…¥ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå±æ€§å‰åŠ <code>th:</code>å³å¯</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/img/bootstrap-solid.svg&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p><strong>åœ¨çº¿é“¾æ¥ä¸éœ€è¦åŠ <code>th:</code></strong></p></div><ul><li><code>@&#123;/&#125;</code>æ˜¯ä¸‡èƒ½åŒ¹é…çš„ï¼Œæ¯”å¦‚æ›´æ”¹é¡¹ç›®è™šæ‹Ÿè·¯å¾„</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.servlet.context-path</span>=<span class="string">/lzy</span></span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6146ca57b0ecfab9c10cd09321913443093add33/2021/06/22/ccb552fb0770d4ab90bc124ab81e72c7.png" width="80%"><h1 id="å›½é™…åŒ–"><a href="#å›½é™…åŒ–" class="headerlink" title="å›½é™…åŒ–"></a>å›½é™…åŒ–</h1><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><ul><li>å…ˆåœ¨IDEAä¸­ç»Ÿä¸€è®¾ç½®<code>properties</code>çš„ç¼–ç é—®é¢˜ï¼ç¡®ä¿ä¸º<code>UTF-8</code></li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@e1d8743bbfe129388d432d36968252e4e5b07250/2021/06/22/b38d12edb6fb89c4859413d429a852db.png" width="100%"><ul><li>ç¼–å†™å›½é™…åŒ–é…ç½®æ–‡ä»¶ï¼ŒæŠ½å–é¡µé¢éœ€è¦æ˜¾ç¤ºçš„å›½é™…åŒ–é¡µé¢æ¶ˆæ¯ã€‚æˆ‘ä»¬å¯ä»¥å»ç™»å½•é¡µé¢æŸ¥çœ‹ä¸€ä¸‹ï¼Œå“ªäº›å†…å®¹æˆ‘ä»¬éœ€è¦ç¼–å†™å›½é™…åŒ–çš„é…ç½®ï¼</li></ul><h2 id="é…ç½®æ–‡ä»¶ç¼–å†™"><a href="#é…ç½®æ–‡ä»¶ç¼–å†™" class="headerlink" title="é…ç½®æ–‡ä»¶ç¼–å†™"></a>é…ç½®æ–‡ä»¶ç¼–å†™</h2><ul><li>åœ¨<code>resources</code>èµ„æºæ–‡ä»¶ä¸‹æ–°å»ºä¸€ä¸ª<code>i18n</code>ç›®å½•ï¼Œå­˜æ”¾å›½é™…åŒ–é…ç½®æ–‡ä»¶</li><li>å»ºç«‹ä¸€ä¸ª<code>login.properties</code>æ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>login_zh_CN.properties</code>ï¼›å‘ç°IDEAè‡ªåŠ¨è¯†åˆ«äº†æˆ‘ä»¬è¦åšå›½é™…åŒ–æ“ä½œï¼›æ–‡ä»¶å¤¹å˜äº†ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@05b305796fc369bc04a039b8fe6f8eff67e90f53/2021/06/22/12390d515e5fa815fbff2f3e8375468d.png"></p><ul><li>å¯ä»¥åœ¨è¿™èµ„æºåŒ…ä¸Šé¢å»æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@14ccd343a0828a5937c5466b99062511c6575755/2021/06/22/df2764f950c56545d5d8a550c0bccf2c.png"></p><ul><li>å¼¹å‡ºå¦‚ä¸‹é¡µé¢ï¼šå†æ·»åŠ ä¸€ä¸ªè‹±æ–‡çš„ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@8dd692fd56097d22caf47f754bd17e57da7e07ad/2021/06/22/f36b3a40a9366eda72f6e4639d450992.png"></p><ul><li>è¿™æ ·å°±å¿«å¤šäº†</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@5cdbcc3bbcb08af75ecf938ef7b01d8da66c6580/2021/06/22/644efbafc744b51d3da7047a1a07cf77.png"></p><ul><li>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥ç¼–å†™é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ideaç¼–è¾‘åŒºå·¦ä¸‹é¢æœ‰å¦å¤–ä¸€ä¸ªè§†å›¾ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@42f99570d9487758a145fd2bbd9e0c4eabcfdff5/2021/06/22/9ddf7bb5186379fb099c725db0430aff.png"></p><ul><li>è¿™ä¸ªè§†å›¾æˆ‘ä»¬ç‚¹å‡» <code>+</code> å·å°±å¯ä»¥ç›´æ¥æ·»åŠ å±æ€§äº†ï¼›æˆ‘ä»¬æ–°å»ºä¸€ä¸ª<code>login.tip</code>ï¼Œå¯ä»¥çœ‹åˆ°è¾¹ä¸Šæœ‰ä¸‰ä¸ªæ–‡ä»¶æ¡†å¯ä»¥è¾“å…¥</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@c86891070ed953d7f5ed77b53ad5665def3adbad/2021/06/22/3ebea77661a0c92ab259ae57a72d7727.png"></p><ul><li>ç„¶åä¾æ¬¡æ·»åŠ å…¶ä»–é¡µé¢å†…å®¹å³å¯ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@e37c5aad1c7eeb5310056ba60c5074d17e9a68dc/2021/06/22/c3d011f10c2f911a9d16287fdf886c5c.png"></p><ul><li>ç„¶åå»æŸ¥çœ‹æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ï¼›</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># login.properties(é»˜è®¤)</span></span><br><span class="line"><span class="meta">login.btn</span>=<span class="string">è¯·ç™»å½•</span></span><br><span class="line"><span class="meta">login.passwod</span>=<span class="string">å¯†ç </span></span><br><span class="line"><span class="meta">login.remember</span>=<span class="string">è®°ä½æˆ‘</span></span><br><span class="line"><span class="meta">login.tip</span>=<span class="string">è¯·ç™»å½•</span></span><br><span class="line"><span class="meta">login.username</span>=<span class="string">ç”¨æˆ·å</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># login_en_US.properties(è‹±æ–‡)</span></span><br><span class="line"><span class="meta">login.btn</span>=<span class="string">Sign in</span></span><br><span class="line"><span class="meta">login.passwod</span>=<span class="string">Password</span></span><br><span class="line"><span class="meta">login.remember</span>=<span class="string">Remember me</span></span><br><span class="line"><span class="meta">login.tip</span>=<span class="string">Please sign in</span></span><br><span class="line"><span class="meta">login.username</span>=<span class="string">Username</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># login_zh_CN.properties(ä¸­æ–‡)</span></span><br><span class="line"><span class="meta">login.btn</span>=<span class="string">è¯·ç™»å½•</span></span><br><span class="line"><span class="meta">login.passwod</span>=<span class="string">å¯†ç </span></span><br><span class="line"><span class="meta">login.remember</span>=<span class="string">è®°ä½æˆ‘</span></span><br><span class="line"><span class="meta">login.tip</span>=<span class="string">è¯·ç™»å½•</span></span><br><span class="line"><span class="meta">login.username</span>=<span class="string">ç”¨æˆ·å</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®æ–‡ä»¶ç”Ÿæ•ˆæ¢ç©¶"><a href="#é…ç½®æ–‡ä»¶ç”Ÿæ•ˆæ¢ç©¶" class="headerlink" title="é…ç½®æ–‡ä»¶ç”Ÿæ•ˆæ¢ç©¶"></a>é…ç½®æ–‡ä»¶ç”Ÿæ•ˆæ¢ç©¶</h2><ul><li>æˆ‘ä»¬å»çœ‹ä¸€ä¸‹SpringBootå¯¹å›½é™…åŒ–çš„è‡ªåŠ¨é…ç½®ï¼è¿™é‡Œåˆæ¶‰åŠåˆ°ä¸€ä¸ªç±»ï¼š<code>MessageSourceAutoConfiguration</code></li><li>é‡Œé¢æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™é‡Œå‘ç°SpringBootå·²ç»è‡ªåŠ¨é…ç½®å¥½äº†ç®¡ç†æˆ‘ä»¬å›½é™…åŒ–èµ„æºæ–‡ä»¶çš„ç»„ä»¶ <code>ResourceBundleMessageSource</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å– properties ä¼ é€’è¿‡æ¥çš„å€¼è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> MessageSource <span class="title">messageSource</span><span class="params">(MessageSourceProperties properties)</span> </span>&#123;</span><br><span class="line">    ResourceBundleMessageSource messageSource = <span class="keyword">new</span> ResourceBundleMessageSource();</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.hasText(properties.getBasename())) &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®å›½é™…åŒ–æ–‡ä»¶çš„åŸºç¡€åï¼ˆå»æ‰è¯­è¨€å›½å®¶ä»£ç çš„ï¼‰</span></span><br><span class="line">        messageSource.setBasenames(</span><br><span class="line">            StringUtils.commaDelimitedListToStringArray(</span><br><span class="line">                                       StringUtils.trimAllWhitespace(properties.getBasename())));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (properties.getEncoding() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        messageSource.setDefaultEncoding(properties.getEncoding().name());</span><br><span class="line">    &#125;</span><br><span class="line">    messageSource.setFallbackToSystemLocale(properties.isFallbackToSystemLocale());</span><br><span class="line">    Duration cacheDuration = properties.getCacheDuration();</span><br><span class="line">    <span class="keyword">if</span> (cacheDuration != <span class="keyword">null</span>) &#123;</span><br><span class="line">        messageSource.setCacheMillis(cacheDuration.toMillis());</span><br><span class="line">    &#125;</span><br><span class="line">    messageSource.setAlwaysUseMessageFormat(properties.isAlwaysUseMessageFormat());</span><br><span class="line">    messageSource.setUseCodeAsDefaultMessage(properties.isUseCodeAsDefaultMessage());</span><br><span class="line">    <span class="keyword">return</span> messageSource;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬çœŸå® çš„æƒ…å†µæ˜¯æ”¾åœ¨äº†<code>i18n</code>ç›®å½•ä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å»é…ç½®è¿™ä¸ª<code>messages</code>çš„è·¯å¾„ï¼›</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.messages.basename</span>=<span class="string">i18n.login</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®é¡µé¢å›½é™…åŒ–å€¼"><a href="#é…ç½®é¡µé¢å›½é™…åŒ–å€¼" class="headerlink" title="é…ç½®é¡µé¢å›½é™…åŒ–å€¼"></a>é…ç½®é¡µé¢å›½é™…åŒ–å€¼</h2><ul><li>å»é¡µé¢è·å–å›½é™…åŒ–çš„å€¼ï¼ŒæŸ¥çœ‹Thymeleafçš„æ–‡æ¡£ï¼Œæ‰¾åˆ°messageå–å€¼æ“ä½œä¸ºï¼š<code>#&#123;...&#125;</code>ã€‚æˆ‘ä»¬å»é¡µé¢æµ‹è¯•ä¸‹ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@0030722222d13602ce99ec8d8df87e06e6bfd5f5/2021/06/22/c3984fa2a1f47984839a0e3469b49fbd.png"></p><ul><li>å»å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®ä¸€ä¸‹ï¼Œå‘ç°å·²ç»è‡ªåŠ¨è¯†åˆ«ä¸ºä¸­æ–‡çš„äº†ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@946c964ba21e30475e12c83bd7ab6dd000f6d085/2021/06/22/ca6e98629adbc8262638f2b48e94641c.png"></p><ul><li>ä½†æ˜¯æˆ‘ä»¬éœ€è¦å¯ä»¥æ ¹æ®æŒ‰é’®è‡ªåŠ¨åˆ‡æ¢ä¸­æ–‡è‹±æ–‡ï¼</li></ul><h2 id="é…ç½®å›½é™…åŒ–è§£æ"><a href="#é…ç½®å›½é™…åŒ–è§£æ" class="headerlink" title="é…ç½®å›½é™…åŒ–è§£æ"></a>é…ç½®å›½é™…åŒ–è§£æ</h2><ul><li>åœ¨Springä¸­æœ‰ä¸€ä¸ªå›½é™…åŒ–çš„<code>Locale</code> ï¼ˆåŒºåŸŸä¿¡æ¯å¯¹è±¡ï¼‰ï¼›é‡Œé¢æœ‰ä¸€ä¸ªå«åš<code>LocaleResolver</code> ï¼ˆè·å–åŒºåŸŸä¿¡æ¯å¯¹è±¡ï¼‰çš„è§£æå™¨ï¼</li><li>æˆ‘ä»¬å»æˆ‘ä»¬webmvcè‡ªåŠ¨é…ç½®æ–‡ä»¶ï¼Œå¯»æ‰¾ä¸€ä¸‹ï¼çœ‹åˆ°SpringBooté»˜è®¤é…ç½®ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;locale&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> LocaleResolver <span class="title">localeResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®¹å™¨ä¸­æ²¡æœ‰å°±è‡ªå·±é…ï¼Œæœ‰çš„è¯å°±ç”¨ç”¨æˆ·é…ç½®çš„</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.mvcProperties.getLocaleResolver() == WebMvcProperties.LocaleResolver.FIXED) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> FixedLocaleResolver(<span class="keyword">this</span>.mvcProperties.getLocale());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ¥æ”¶å¤´å›½é™…åŒ–åˆ†è§£</span></span><br><span class="line">    AcceptHeaderLocaleResolver localeResolver = <span class="keyword">new</span> AcceptHeaderLocaleResolver();</span><br><span class="line">    localeResolver.setDefaultLocale(<span class="keyword">this</span>.mvcProperties.getLocale());</span><br><span class="line">    <span class="keyword">return</span> localeResolver;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>AcceptHeaderLocaleResolver</code> è¿™ä¸ªç±»ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Locale <span class="title">resolveLocale</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    Locale defaultLocale = <span class="keyword">this</span>.getDefaultLocale();</span><br><span class="line">    <span class="comment">// é»˜è®¤çš„å°±æ˜¯æ ¹æ®è¯·æ±‚å¤´å¸¦æ¥çš„åŒºåŸŸä¿¡æ¯è·å–Localeè¿›è¡Œå›½é™…åŒ–</span></span><br><span class="line">    <span class="keyword">if</span> (defaultLocale != <span class="keyword">null</span> &amp;&amp; request.getHeader(<span class="string">&quot;Accept-Language&quot;</span>) == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> defaultLocale;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Locale requestLocale = request.getLocale();</span><br><span class="line">        List&lt;Locale&gt; supportedLocales = <span class="keyword">this</span>.getSupportedLocales();</span><br><span class="line">        <span class="keyword">if</span> (!supportedLocales.isEmpty() &amp;&amp; !supportedLocales.contains(requestLocale)) &#123;</span><br><span class="line">            Locale supportedLocale = <span class="keyword">this</span>.findSupportedLocale(request, supportedLocales);</span><br><span class="line">            <span class="keyword">if</span> (supportedLocale != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> supportedLocale;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> defaultLocale != <span class="keyword">null</span> ? defaultLocale : requestLocale;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> requestLocale;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é‚£å‡å¦‚æˆ‘ä»¬ç°åœ¨æƒ³ç‚¹å‡»é“¾æ¥è®©æˆ‘ä»¬çš„å›½é™…åŒ–èµ„æºç”Ÿæ•ˆï¼Œå°±éœ€è¦è®©æˆ‘ä»¬è‡ªå·±çš„Localeç”Ÿæ•ˆï¼</li><li>å†™ä¸€ä¸ªè‡ªå·±çš„<code>LocaleResolver</code>ï¼Œå¯ä»¥åœ¨é“¾æ¥ä¸Šæºå¸¦åŒºåŸŸä¿¡æ¯ï¼</li><li>ä¿®æ”¹ä¸€ä¸‹å‰ç«¯é¡µé¢çš„è·³è½¬è¿æ¥ï¼š</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è¿™é‡Œä¼ å…¥å‚æ•°ä¸éœ€è¦ä½¿ç”¨ ï¼Ÿä½¿ç”¨ ï¼ˆkey=valueï¼‰--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/index.html(l=&#x27;zh_CN&#x27;)&#125;&quot;</span>&gt;</span>ä¸­æ–‡<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/index.html(l=&#x27;en_US&#x27;)&#125;&quot;</span>&gt;</span>English<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å†™ä¸€ä¸ªå¤„ç†çš„ç»„ä»¶ç±»ï¼æ¯”å¦‚åœ¨<code>config</code>åŒ…ä¸‹æ–°å»ºä¸€ä¸ª<code>MyLocaleResolver</code>ç±»Â·</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¯ä»¥åœ¨é“¾æ¥ä¸Šæºå¸¦åŒºåŸŸä¿¡æ¯</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocaleResolver</span> <span class="keyword">implements</span> <span class="title">LocaleResolver</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è§£æè¯·æ±‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Locale <span class="title">resolveLocale</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚ä¸­çš„è¯­è¨€å‚æ•°</span></span><br><span class="line">        String language = request.getParameter(<span class="string">&quot;l&quot;</span>);</span><br><span class="line">        Locale locale = Locale.getDefault(); <span class="comment">// å¦‚æœæ²¡æœ‰è·å–åˆ°å°±ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„</span></span><br><span class="line">        <span class="comment">//å¦‚æœè¯·æ±‚é“¾æ¥ä¸ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(language))&#123;</span><br><span class="line">            <span class="comment">//åˆ†å‰²è¯·æ±‚å‚æ•°</span></span><br><span class="line">            String[] split = language.split(<span class="string">&quot;_&quot;</span>);</span><br><span class="line">            <span class="comment">//å›½å®¶ï¼Œåœ°åŒº</span></span><br><span class="line">            locale = <span class="keyword">new</span> Locale(split[<span class="number">0</span>],split[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> locale;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocale</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Locale locale)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸ºäº†è®©æˆ‘ä»¬çš„åŒºåŸŸåŒ–ä¿¡æ¯èƒ½å¤Ÿç”Ÿæ•ˆï¼Œæˆ‘ä»¬éœ€è¦å†é…ç½®ä¸€ä¸‹è¿™ä¸ªç»„ä»¶ï¼åœ¨æˆ‘ä»¬è‡ªå·±çš„<code>MvcConofig</code>ä¸‹æ·»åŠ <code>bean</code>ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰©å±•springmvc</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LocaleResolver <span class="title">localeResolver</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyLocaleResolver();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span></span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/index.html&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é‡å¯é¡¹ç›®ï¼Œæ¥è®¿é—®ä¸€ä¸‹ï¼Œå‘ç°ç‚¹å‡»æŒ‰é’®å¯ä»¥å®ç°æˆåŠŸåˆ‡æ¢!</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒå‡†å¤‡&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒå‡†å¤‡&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒå‡†å¤‡&quot;&gt;&lt;/a&gt;ç¯å¢ƒå‡†å¤‡&lt;/h1&gt;&lt;h2 id=&quot;é™æ€èµ„æº&quot;&gt;&lt;a href=&quot;#é™æ€èµ„æº&quot; class=&quot;headerlink&quot; title=&quot;é™æ€èµ„æº&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒMVCè‡ªåŠ¨é…ç½®åŸç†</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot08.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot08.html</id>
    <published>2021-06-22T06:33:13.807Z</published>
    <updated>2021-06-22T08:28:25.698Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MVCè‡ªåŠ¨é…ç½®åŸç†"><a href="#MVCè‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="MVCè‡ªåŠ¨é…ç½®åŸç†"></a>MVCè‡ªåŠ¨é…ç½®åŸç†</h1><h2 id="å®˜ç½‘é˜…è¯»"><a href="#å®˜ç½‘é˜…è¯»" class="headerlink" title="å®˜ç½‘é˜…è¯»"></a>å®˜ç½‘é˜…è¯»</h2><ul><li>åœ¨è¿›è¡Œé¡¹ç›®ç¼–å†™å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“ä¸€ä¸ªä¸œè¥¿ï¼Œå°±æ˜¯SpringBootå¯¹æˆ‘ä»¬çš„SpringMVCè¿˜åšäº†å“ªäº›é…ç½®ï¼ŒåŒ…æ‹¬å¦‚ä½•æ‰©å±•ï¼Œå¦‚ä½•å®šåˆ¶</li><li>æˆ‘ä»¬å¯ä»¥æºç åˆ†æï¼Œæˆ–è€…é˜…è¯»<a href="https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#boot-features-spring-mvc-auto-configuration">å®˜æ–¹æ–‡æ¡£</a>è¿›è¡Œå­¦ä¹ </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Spring MVC Auto-configuration</span><br><span class="line"><span class="comment">// Spring Bootä¸ºSpring MVCæä¾›äº†è‡ªåŠ¨é…ç½®ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°ä¸å¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸€èµ·å·¥ä½œã€‚</span></span><br><span class="line">Spring Boot provides auto-configuration <span class="keyword">for</span> Spring MVC that works well with most applications.</span><br><span class="line"><span class="comment">// è‡ªåŠ¨é…ç½®åœ¨Springé»˜è®¤è®¾ç½®çš„åŸºç¡€ä¸Šæ·»åŠ äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</span></span><br><span class="line">The auto-configuration adds the following features on top of Springâ€™s defaults:</span><br><span class="line"><span class="comment">// åŒ…å«è§†å›¾è§£æå™¨</span></span><br><span class="line">Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.</span><br><span class="line"><span class="comment">// æ”¯æŒé™æ€èµ„æºæ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œä»¥åŠwebjars</span></span><br><span class="line">Support <span class="keyword">for</span> serving <span class="keyword">static</span> resources, including support <span class="keyword">for</span> WebJars </span><br><span class="line"><span class="comment">// è‡ªåŠ¨æ³¨å†Œäº†Converterï¼š</span></span><br><span class="line"><span class="comment">// è½¬æ¢å™¨ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ç½‘é¡µæäº¤æ•°æ®åˆ°åå°è‡ªåŠ¨å°è£…æˆä¸ºå¯¹è±¡çš„ä¸œè¥¿ï¼Œæ¯”å¦‚æŠŠ&quot;1&quot;å­—ç¬¦ä¸²è‡ªåŠ¨è½¬æ¢ä¸ºintç±»å‹</span></span><br><span class="line"><span class="comment">// Formatterï¼šã€æ ¼å¼åŒ–å™¨ï¼Œæ¯”å¦‚é¡µé¢ç»™æˆ‘ä»¬äº†ä¸€ä¸ª2019-8-10ï¼Œå®ƒä¼šç»™æˆ‘ä»¬è‡ªåŠ¨æ ¼å¼åŒ–ä¸ºDateå¯¹è±¡ã€‘</span></span><br><span class="line">Automatic registration of Converter, GenericConverter, and Formatter beans.</span><br><span class="line"><span class="comment">// HttpMessageConverters</span></span><br><span class="line"><span class="comment">// SpringMVCç”¨æ¥è½¬æ¢Httpè¯·æ±‚å’Œå“åº”çš„çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æŠŠä¸€ä¸ªUserå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œå¯ä»¥å»çœ‹å®˜ç½‘æ–‡æ¡£è§£é‡Šï¼›</span></span><br><span class="line"><span class="function">Support <span class="keyword">for</span> <span class="title">HttpMessageConverters</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>.</span></span><br><span class="line"><span class="function"><span class="comment">// å®šä¹‰é”™è¯¯ä»£ç ç”Ÿæˆè§„åˆ™çš„</span></span></span><br><span class="line"><span class="function">Automatic registration of <span class="title">MessageCodesResolver</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>.</span></span><br><span class="line"><span class="function"><span class="comment">// é¦–é¡µå®šåˆ¶</span></span></span><br><span class="line"><span class="function">Static index.html support.</span></span><br><span class="line"><span class="function"><span class="comment">// å›¾æ ‡å®šåˆ¶</span></span></span><br><span class="line"><span class="function">Custom Favicon <span class="title">support</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>.</span></span><br><span class="line"><span class="function"><span class="comment">// åˆå§‹åŒ–æ•°æ®ç»‘å®šå™¨ï¼šå¸®æˆ‘ä»¬æŠŠè¯·æ±‚æ•°æ®ç»‘å®šåˆ°JavaBeanä¸­ï¼</span></span></span><br><span class="line"><span class="function">Automatic use of a ConfigurableWebBindingInitializer <span class="title">bean</span> <span class="params">(covered later in <span class="keyword">this</span> document)</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">/*</span></span></span><br><span class="line"><span class="function"><span class="comment">å¦‚æœæ‚¨å¸Œæœ›ä¿ç•™Spring Boot MVCåŠŸèƒ½ï¼Œå¹¶ä¸”å¸Œæœ›æ·»åŠ å…¶ä»–MVCé…ç½®ï¼ˆæ‹¦æˆªå™¨ã€æ ¼å¼åŒ–ç¨‹åºã€è§†å›¾æ§åˆ¶å™¨å’Œå…¶ä»–åŠŸèƒ½ï¼‰ï¼Œåˆ™å¯ä»¥æ·»åŠ è‡ªå·±</span></span></span><br><span class="line"><span class="function"><span class="comment">çš„@configurationç±»ï¼Œç±»å‹ä¸ºwebmvcconfiguerï¼Œä½†ä¸æ·»åŠ @EnableWebMvcã€‚å¦‚æœå¸Œæœ›æä¾›</span></span></span><br><span class="line"><span class="function"><span class="comment">RequestMappingHandlerMappingã€RequestMappingHandlerAdapteræˆ–ExceptionHandlerExceptionResolverçš„è‡ªå®šä¹‰</span></span></span><br><span class="line"><span class="function"><span class="comment">å®ä¾‹ï¼Œåˆ™å¯ä»¥å£°æ˜WebMVCregistrationAdapterå®ä¾‹æ¥æä¾›æ­¤ç±»ç»„ä»¶ã€‚</span></span></span><br><span class="line"><span class="function"><span class="comment">*/</span></span></span><br><span class="line"><span class="function">If you want to keep Spring Boot MVC features and you want to add additional MVC configuration </span></span><br><span class="line"><span class="function"><span class="params">(interceptors, formatters, view controllers, and other features)</span>, you can add your own </span></span><br><span class="line"><span class="function">@Configuration class of type WebMvcConfigurer but without @EnableWebMvc. If you wish to provide </span></span><br><span class="line"><span class="function">custom instances of RequestMappingHandlerMapping, RequestMappingHandlerAdapter, or </span></span><br><span class="line"><span class="function">ExceptionHandlerExceptionResolver, you can declare a WebMvcRegistrationsAdapter instance to provide such components.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// å¦‚æœæ‚¨æƒ³å®Œå…¨æ§åˆ¶Spring MVCï¼Œå¯ä»¥æ·»åŠ è‡ªå·±çš„@Configurationï¼Œå¹¶ç”¨@EnableWebMvcè¿›è¡Œæ³¨é‡Šã€‚</span></span></span><br><span class="line"><span class="function">If you want to take complete control of Spring MVC, you can add your own @Configuration annotated with @EnableWebMvc.</span></span><br></pre></td></tr></table></figure><h2 id="å†…å®¹åå•†è§†å›¾è§£æå™¨"><a href="#å†…å®¹åå•†è§†å›¾è§£æå™¨" class="headerlink" title="å†…å®¹åå•†è§†å›¾è§£æå™¨"></a>å†…å®¹åå•†è§†å›¾è§£æå™¨</h2><ul><li>SpringBootè‡ªåŠ¨é…ç½®äº†ViewResolverï¼Œä¹Ÿå°±æ˜¯SpringMVCçš„è§†å›¾è§£æå™¨ï¼›å³æ ¹æ®æ–¹æ³•çš„è¿”å›å€¼å–å¾—è§†å›¾å¯¹è±¡ï¼ˆViewï¼‰ï¼Œç„¶åç”±è§†å›¾å¯¹è±¡å†³å®šå¦‚ä½•æ¸²æŸ“ï¼ˆè½¬å‘ï¼Œé‡å®šå‘ï¼‰</li><li>æ‰¾åˆ° WebMvcAutoConfiguration ï¼Œ ç„¶åæœç´¢<code>ContentNegotiatingViewResolver</code>ã€‚æ‰¾åˆ°å¦‚ä¸‹æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnBean(ViewResolver.class)</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(name = &quot;viewResolver&quot;, value = ContentNegotiatingViewResolver.class)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ContentNegotiatingViewResolver <span class="title">viewResolver</span><span class="params">(BeanFactory beanFactory)</span> </span>&#123;</span><br><span class="line">    ContentNegotiatingViewResolver resolver = <span class="keyword">new</span> ContentNegotiatingViewResolver();</span><br><span class="line">    resolver.setContentNegotiationManager(beanFactory.getBean(ContentNegotiationManager.class));</span><br><span class="line">    <span class="comment">// ContentNegotiatingViewResolverä½¿ç”¨æ‰€æœ‰å…¶ä»–è§†å›¾è§£æå™¨æ¥å®šä½è§†å›¾ï¼Œå› æ­¤å®ƒåº”è¯¥å…·æœ‰è¾ƒé«˜çš„ä¼˜å…ˆçº§</span></span><br><span class="line">    resolver.setOrder(Ordered.HIGHEST_PRECEDENCE);</span><br><span class="line">    <span class="keyword">return</span> resolver;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯ä»¥ç‚¹è¿›è¿™ç±»çœ‹çœ‹ï¼æ‰¾åˆ°å¯¹åº”çš„è§£æè§†å›¾çš„ä»£ç ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Nullable</span> <span class="comment">// æ³¨è§£è¯´æ˜ï¼š@Nullable å³å‚æ•°å¯ä¸ºnull</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">resolveViewName</span><span class="params">(String viewName, Locale locale)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    RequestAttributes attrs = RequestContextHolder.getRequestAttributes();</span><br><span class="line">    Assert.state(attrs <span class="keyword">instanceof</span> ServletRequestAttributes, <span class="string">&quot;No current ServletRequestAttributes&quot;</span>);</span><br><span class="line">    List&lt;MediaType&gt; requestedMediaTypes = <span class="keyword">this</span>.getMediaTypes(((ServletRequestAttributes)attrs).getRequest());</span><br><span class="line">    <span class="keyword">if</span> (requestedMediaTypes != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// è·å–å€™é€‰çš„è§†å›¾å¯¹è±¡</span></span><br><span class="line">        List&lt;View&gt; candidateViews = <span class="keyword">this</span>.getCandidateViews(viewName, locale, requestedMediaTypes);</span><br><span class="line">        <span class="comment">// é€‰æ‹©ä¸€ä¸ªæœ€é€‚åˆçš„è§†å›¾å¯¹è±¡ï¼Œç„¶åæŠŠè¿™ä¸ªå¯¹è±¡è¿”å›</span></span><br><span class="line">        View bestView = <span class="keyword">this</span>.getBestView(candidateViews, requestedMediaTypes, attrs);</span><br><span class="line">        <span class="keyword">if</span> (bestView != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> bestView;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»§ç»­ç‚¹è¿›å»çœ‹ï¼Œä»–æ˜¯æ€ä¹ˆè·å¾—å€™é€‰çš„è§†å›¾çš„å‘¢ï¼Ÿ<code>getCandidateViews</code>ä¸­çœ‹åˆ°ä»–æ˜¯æŠŠæ‰€æœ‰çš„è§†å›¾è§£æå™¨æ‹¿æ¥ï¼Œè¿›è¡Œ<code>while</code>å¾ªç¯ï¼ŒæŒ¨ä¸ªè§£æï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Iterator var5 = <span class="keyword">this</span>.viewResolvers.iterator();</span><br></pre></td></tr></table></figure><div class="note success simple"><p><strong>å¾—å‡ºç»“è®ºï¼š<code>ContentNegotiatingViewResolver</code> è¿™ä¸ªè§†å›¾è§£æå™¨å°±æ˜¯ç”¨æ¥ç»„åˆæ‰€æœ‰çš„è§†å›¾è§£æå™¨çš„</strong></p></div><ul><li>å†å»ç ”ç©¶ä¸‹ä»–çš„ç»„åˆé€»è¾‘ï¼Œçœ‹åˆ°æœ‰ä¸ªå±æ€§<code>viewResolvers</code>ï¼Œçœ‹çœ‹å®ƒæ˜¯åœ¨å“ªé‡Œè¿›è¡Œèµ‹å€¼çš„ï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initServletContext</span><span class="params">(ServletContext servletContext)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œå®ƒæ˜¯ä»beanFactoryå·¥å…·ä¸­è·å–å®¹å™¨ä¸­çš„æ‰€æœ‰è§†å›¾è§£æå™¨</span></span><br><span class="line">    <span class="comment">// ViewRescolver.class æŠŠæ‰€æœ‰çš„è§†å›¾è§£æå™¨æ¥ç»„åˆçš„</span></span><br><span class="line">    Collection&lt;ViewResolver&gt; matchingBeans = BeanFactoryUtils.beansOfTypeIncludingAncestors(<span class="keyword">this</span>.obtainApplicationContext(), ViewResolver.class).values();</span><br><span class="line">    ViewResolver viewResolver;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.viewResolvers == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.viewResolvers = <span class="keyword">new</span> ArrayList(matchingBeans.size());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...............</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ—¢ç„¶å®ƒæ˜¯åœ¨å®¹å™¨ä¸­å»æ‰¾è§†å›¾è§£æå™¨ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥çŒœæƒ³ï¼Œæˆ‘ä»¬å°±å¯ä»¥å»å®ç°ä¸€ä¸ªè§†å›¾è§£æå™¨äº†å‘¢ï¼Ÿ</li><li>æˆ‘ä»¬å¯ä»¥è‡ªå·±ç»™å®¹å™¨ä¸­å»æ·»åŠ ä¸€ä¸ªè§†å›¾è§£æå™¨ï¼›è¿™ä¸ªç±»å°±ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨çš„å°†å®ƒç»„åˆè¿›æ¥ï¼›æˆ‘ä»¬å»å®ç°ä¸€ä¸‹</li><li>åˆ›å»ºä¸€ä¸ª<code>MyMvcConfig</code>çš„ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰©å±•springmvc</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Beanæ”¾å…¥Spring</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ViewResolver <span class="title">myViewResolver</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyViewResolver();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è‡ªå®šä¹‰ä¸€ä¸ªè‡ªå·±çš„è§†å›¾è§£æå™¨MyViewResolver</span></span><br><span class="line">    <span class="comment">//æˆ‘ä»¬å†™ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œè§†å›¾è§£æå™¨å°±éœ€è¦å®ç°ViewResolveræ¥å£</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewResolver</span> <span class="keyword">implements</span> <span class="title">ViewResolver</span></span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> View <span class="title">resolveViewName</span><span class="params">(String s, Locale locale)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç„¶åé€šè¿‡<code>Ctrl + N</code>æœç´¢<code>dispatcherServlet</code>æºç ï¼Œæ‰¾åˆ°<code>doDispatch</code>ç‚¹è¿›å»æ‰“ä¸ªæ–­ç‚¹ã€‚å› ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½ç»è¿‡<code>doDispatch</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@1fe9baec2f6fd8367c5f169e131d77d72cf6925a/2021/06/22/44537c89bc9cdf02ea768c91b81e4087.png"></p><ul><li>æ‰“å¥½æ–­ç‚¹åè¿›è¡Œ<code>debug</code>ï¼Œé‡å¯åéšä¾¿è®¿é—®ä¸€ä¸ªé¡µé¢ï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡º</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@4d4d38523b162aa7b48444d6ae0f6524670686ed/2021/06/22/0191ef06d5623747c6587ef5b0b62997.png"></p><ul><li>æ‰¾åˆ°è§†å›¾è§£æå™¨<code>ViewResolver</code>,åˆ°æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å°±åœ¨è¿™é‡Œäº†ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@6d4b150d78ba23cd5a05a2f39bea65f2ddf2e711/2021/06/22/8a78a7d35ca2fef143840352ac61b880.png"></p><ul><li>æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦ä½¿ç”¨è‡ªå·±å®šåˆ¶åŒ–çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬åªéœ€è¦ç»™Springå®¹å™¨ä¸­æ·»åŠ è¿™ä¸ªç»„ä»¶(Bean)å°±å¥½äº†ï¼å‰©ä¸‹çš„äº‹æƒ…SpringBootå°±ä¼šå¸®æˆ‘ä»¬åšäº†ï¼</li></ul><h2 id="è½¬æ¢å™¨å’Œæ ¼å¼åŒ–å™¨"><a href="#è½¬æ¢å™¨å’Œæ ¼å¼åŒ–å™¨" class="headerlink" title="è½¬æ¢å™¨å’Œæ ¼å¼åŒ–å™¨"></a>è½¬æ¢å™¨å’Œæ ¼å¼åŒ–å™¨</h2><ul><li><code>Ctrl+N</code>æœç´¢<code>WebMvcAutoConfiguration</code>æ‰¾åˆ°æ ¼å¼åŒ–è½¬æ¢å™¨ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> FormattingConversionService <span class="title">mvcConversionService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ‹¿åˆ°é…ç½®æ–‡ä»¶ä¸­çš„æ ¼å¼åŒ–è§„åˆ™</span></span><br><span class="line">    WebConversionService conversionService = </span><br><span class="line">        <span class="keyword">new</span> WebConversionService(<span class="keyword">this</span>.mvcProperties.getDateFormat());</span><br><span class="line">    addFormatters(conversionService);</span><br><span class="line">    <span class="keyword">return</span> conversionService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç‚¹å¼€<code>mvcProperties</code>ï¼Œå†ç‚¹å¼€<code>WebMvcProperties</code>ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Date format to use. For instance, `dd/MM/yyyy`. é»˜è®¤çš„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> String dateFormat;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getDateFormat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.dateFormat;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Deprecated</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDateFormat</span><span class="params">(String dateFormat)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">this</span>.format.setDate(dateFormat);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯ä»¥çœ‹åˆ°åœ¨æˆ‘ä»¬çš„<code>Properties</code>æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè‡ªåŠ¨é…ç½®å®ƒï¼</li><li>å¦‚æœé…ç½®äº†è‡ªå·±çš„æ ¼å¼åŒ–æ–¹å¼ï¼Œå°±ä¼šæ³¨å†Œåˆ°<code>Bean</code>ä¸­ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®æ—¥æœŸæ ¼å¼åŒ–çš„è§„åˆ™ï¼š</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">mvc:</span></span><br><span class="line">    <span class="attr">format:</span></span><br><span class="line">      <span class="attr">date:</span> <span class="string">dd/MM/yyyy</span></span><br></pre></td></tr></table></figure><h1 id="æ‰©å±•SpringMVC"><a href="#æ‰©å±•SpringMVC" class="headerlink" title="æ‰©å±•SpringMVC"></a>æ‰©å±•SpringMVC</h1><h2 id="ä¿®æ”¹é»˜è®¤é…ç½®"><a href="#ä¿®æ”¹é»˜è®¤é…ç½®" class="headerlink" title="ä¿®æ”¹é»˜è®¤é…ç½®"></a>ä¿®æ”¹é»˜è®¤é…ç½®</h2><ul><li>è¿™ä¹ˆå¤šçš„è‡ªåŠ¨é…ç½®ï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé€šè¿‡è¿™ä¸ª<code>WebMVC</code>çš„è‡ªåŠ¨é…ç½®åŸç†åˆ†æï¼Œæˆ‘ä»¬è¦å­¦ä¼šä¸€ç§å­¦ä¹ æ–¹å¼ï¼Œé€šè¿‡æºç æ¢ç©¶ï¼Œå¾—å‡ºç»“è®ºï¼›è¿™ä¸ªç»“è®ºä¸€å®šæ˜¯å±äºè‡ªå·±çš„ï¼Œè€Œä¸”ä¸€é€šç™¾é€šã€‚</li><li>SpringBootçš„åº•å±‚ï¼Œå¤§é‡ç”¨åˆ°äº†è¿™äº›è®¾è®¡ç»†èŠ‚æ€æƒ³ï¼Œæ‰€ä»¥ï¼Œæ²¡äº‹éœ€è¦å¤šé˜…è¯»æºç ï¼å¾—å‡ºç»“è®ºï¼›</li><li>SpringBootåœ¨è‡ªåŠ¨é…ç½®å¾ˆå¤šç»„ä»¶çš„æ—¶å€™ï¼Œå…ˆçœ‹å®¹å™¨ä¸­æœ‰æ²¡æœ‰ç”¨æˆ·è‡ªå·±é…ç½®çš„ï¼ˆå¦‚æœç”¨æˆ·è‡ªå·±é…ç½®<code>@bean</code>ï¼‰ï¼Œå¦‚æœæœ‰å°±ç”¨ç”¨æˆ·é…ç½®çš„ï¼Œå¦‚æœæ²¡æœ‰å°±ç”¨è‡ªåŠ¨é…ç½®çš„ï¼›</li><li>å¦‚æœæœ‰äº›ç»„ä»¶å¯ä»¥å­˜åœ¨å¤šä¸ªï¼Œæ¯”å¦‚æˆ‘ä»¬çš„è§†å›¾è§£æå™¨ï¼Œå°±å°†ç”¨æˆ·é…ç½®çš„å’Œè‡ªå·±é»˜è®¤çš„ç»„åˆèµ·æ¥ï¼</li><li>æˆ‘ä»¬è¦åšçš„å°±æ˜¯ç¼–å†™ä¸€ä¸ª<code>@Configuration</code>æ³¨è§£ç±»ï¼Œå¹¶ä¸”ç±»å‹è¦ä¸º<code>WebMvcConfigurer</code>ï¼Œè¿˜ä¸èƒ½æ ‡æ³¨<code>@EnableWebMvc</code>æ³¨è§£ï¼›æˆ‘ä»¬å»è‡ªå·±å†™ä¸€ä¸ªï¼›æˆ‘ä»¬æ–°å»ºä¸€ä¸ªåŒ…å«<code>config</code>ï¼Œå†™ä¸€ä¸ªç±»<code>MyMvcConfig</code>:</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åº”ä¸ºç±»å‹è¦æ±‚ä¸ºWebMvcConfigurerï¼Œæ‰€ä»¥æˆ‘ä»¬å®ç°å…¶æ¥å£</span></span><br><span class="line"><span class="comment">//å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ç±»æ‰©å±•MVCçš„åŠŸèƒ½</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span></span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/test&quot;</span>).setViewName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è®¿é—®é¡µé¢æµ‹è¯•ä¸€ä¸‹ã€‚ç¡®å®ä¹Ÿè·³è½¬è¿‡æ¥äº†ï¼æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬è¦æ‰©å±•SpringMVCï¼Œå®˜æ–¹å°±æ¨èæˆ‘ä»¬è¿™ä¹ˆå»ä½¿ç”¨ï¼Œæ—¢ä¿SpringBootç•™æ‰€æœ‰çš„è‡ªåŠ¨é…ç½®ï¼Œä¹Ÿèƒ½ç”¨æˆ‘ä»¬æ‰©å±•çš„é…ç½®ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@21640a704be46f602f642869079ce974fba25d5d/2021/06/22/7c61aa50afc5fdec6b00db92dc766e17.png"></p><h2 id="åŸç†åˆ†æ"><a href="#åŸç†åˆ†æ" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h2><ul><li><code>WebMvcAutoConfiguration</code> æ˜¯ SpringMVCçš„è‡ªåŠ¨é…ç½®ç±»ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªç±»<code>WebMvcAutoConfigurationAdapter</code></li><li>è¿™ä¸ªç±»ä¸Šæœ‰ä¸€ä¸ªæ³¨è§£ï¼Œåœ¨åšå…¶ä»–è‡ªåŠ¨é…ç½®æ—¶ä¼šå¯¼å…¥ï¼š<code>@Import(EnableWebMvcConfiguration.class)</code></li><li>æˆ‘ä»¬ç‚¹è¿›<code>EnableWebMvcConfiguration</code>è¿™ä¸ªç±»çœ‹ä¸€ä¸‹ï¼Œå®ƒç»§æ‰¿äº†ä¸€ä¸ªçˆ¶ç±»ï¼š<code>DelegatingWebMvcConfiguration</code></li><li>è¿™ä¸ªçˆ¶ç±»ä¸­æœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DelegatingWebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurationSupport</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> WebMvcConfigurerComposite configurers = <span class="keyword">new</span> WebMvcConfigurerComposite();</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// ä»å®¹å™¨ä¸­è·å–æ‰€æœ‰çš„webmvcConfigurer</span></span><br><span class="line">    <span class="meta">@Autowired(required = false)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConfigurers</span><span class="params">(List&lt;WebMvcConfigurer&gt; configurers)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!CollectionUtils.isEmpty(configurers)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.configurers.addWebMvcConfigurers(configurers);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªç±»ä¸­å»å¯»æ‰¾ä¸€ä¸ªæˆ‘ä»¬åˆšæ‰è®¾ç½®çš„<code>viewController</code>å½“åšå‚è€ƒï¼Œå‘ç°å®ƒè°ƒç”¨äº†ä¸€ä¸ª</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.configurers.addViewControllers(registry);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬ç‚¹è¿›å»çœ‹ä¸€ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">    Iterator var2 = <span class="keyword">this</span>.delegates.iterator();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(var2.hasNext()) &#123;</span><br><span class="line">        <span class="comment">// å°†æ‰€æœ‰çš„WebMvcConfigurerç›¸å…³é…ç½®æ¥ä¸€èµ·è°ƒç”¨ï¼åŒ…æ‹¬æˆ‘ä»¬è‡ªå·±é…ç½®çš„å’ŒSpringç»™æˆ‘ä»¬é…ç½®çš„</span></span><br><span class="line">        WebMvcConfigurer delegate = (WebMvcConfigurer)var2.next();</span><br><span class="line">        delegate.addViewControllers(registry);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note success simple"><p><strong>æ‰€ä»¥å¾—å‡ºç»“è®ºï¼šæ‰€æœ‰çš„<code>WebMvcConfiguration</code>éƒ½ä¼šè¢«ä½œç”¨ï¼Œä¸æ­¢Springè‡ªå·±çš„é…ç½®ç±»ï¼Œæˆ‘ä»¬è‡ªå·±çš„é…ç½®ç±»å½“ç„¶ä¹Ÿä¼šè¢«è°ƒç”¨ï¼›</strong></p></div><h2 id="å…¨é¢æ¥ç®¡SpringMVC"><a href="#å…¨é¢æ¥ç®¡SpringMVC" class="headerlink" title="å…¨é¢æ¥ç®¡SpringMVC"></a>å…¨é¢æ¥ç®¡SpringMVC</h2><ul><li>å…¨é¢æ¥ç®¡å³ï¼šSpringBootå¯¹SpringMVCçš„è‡ªåŠ¨é…ç½®ä¸éœ€è¦äº†ï¼Œæ‰€æœ‰éƒ½æ˜¯æˆ‘ä»¬è‡ªå·±å»é…ç½®ï¼</li><li>åªéœ€åœ¨æˆ‘ä»¬çš„é…ç½®ç±»ä¸­è¦åŠ ä¸€ä¸ª<code>@EnableWebMvc</code></li><li>å¦‚æœæˆ‘ä»¬å…¨é¢æ¥ç®¡äº†SpringMVCäº†ï¼Œæˆ‘ä»¬ä¹‹å‰SpringBootç»™æˆ‘ä»¬é…ç½®çš„é™æ€èµ„æºæ˜ å°„ä¸€å®šä¼šæ— æ•ˆï¼Œæ¯”å¦‚ç»™é…ç½®ç±»åŠ ä¸Šæ³¨è§£ï¼š<code>@EnableWebMvc</code>ï¼Œå°±æ— æ³•è®¿é—®äº†ï¼Œæ‰€æœ‰çš„SpringMVCè‡ªåŠ¨é…ç½®éƒ½å¤±æ•ˆäº†ï¼å›å½’åˆ°äº†æœ€åˆçš„æ ·å­</li><li><strong>å½“ç„¶ï¼Œæˆ‘ä»¬å¼€å‘ä¸­ï¼Œä¸æ¨èä½¿ç”¨å…¨é¢æ¥ç®¡SpringMVC</strong></li><li>æ€è€ƒé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆåŠ äº†ä¸€ä¸ªæ³¨è§£ï¼Œè‡ªåŠ¨é…ç½®å°±å¤±æ•ˆäº†ï¼æˆ‘ä»¬çœ‹ä¸‹æºç ï¼š</li><li>è¿™é‡Œå‘ç°å®ƒæ˜¯å¯¼å…¥äº†ä¸€ä¸ªç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­è¿›å»çœ‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(&#123;DelegatingWebMvcConfiguration.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableWebMvc &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å®ƒç»§æ‰¿äº†ä¸€ä¸ªçˆ¶ç±» <code>WebMvcConfigurationSupport</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DelegatingWebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurationSupport</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å›é¡¾ä¸€ä¸‹Webmvcè‡ªåŠ¨é…ç½®ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication(type = Type.SERVLET)</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(&#123; Servlet.class, DispatcherServlet.class, WebMvcConfigurer.class &#125;)</span></span><br><span class="line"><span class="comment">// è¿™ä¸ªæ³¨è§£çš„æ„æ€å°±æ˜¯ï¼šå®¹å™¨ä¸­æ²¡æœ‰è¿™ä¸ªç»„ä»¶çš„æ—¶å€™ï¼Œè¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æ‰ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)</span></span><br><span class="line"><span class="meta">@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE + 10)</span></span><br><span class="line"><span class="meta">@AutoConfigureAfter(&#123; DispatcherServletAutoConfiguration.class, TaskExecutionAutoConfiguration.class,</span></span><br><span class="line"><span class="meta">    ValidationAutoConfiguration.class &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcAutoConfiguration</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ€»ç»“ä¸€å¥è¯ï¼š<code>@EnableWebMvc</code>å°†<code>WebMvcConfigurationSupport</code>ç»„ä»¶å¯¼å…¥è¿›æ¥äº†ï¼›è€Œå¯¼å…¥çš„<code>WebMvcConfigurationSupport</code>åªæ˜¯SpringMVCæœ€åŸºæœ¬çš„åŠŸèƒ½ï¼</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MVCè‡ªåŠ¨é…ç½®åŸç†&quot;&gt;&lt;a href=&quot;#MVCè‡ªåŠ¨é…ç½®åŸç†&quot; class=&quot;headerlink&quot; title=&quot;MVCè‡ªåŠ¨é…ç½®åŸç†&quot;&gt;&lt;/a&gt;MVCè‡ªåŠ¨é…ç½®åŸç†&lt;/h1&gt;&lt;h2 id=&quot;å®˜ç½‘é˜…è¯»&quot;&gt;&lt;a href=&quot;#å®˜ç½‘é˜…è¯»&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒThymeleafæ¨¡æ¿å¼•æ“</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot07.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot07.html</id>
    <published>2021-06-21T12:54:00.078Z</published>
    <updated>2021-06-25T12:06:14.833Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Thymeleaf"><a href="#Thymeleaf" class="headerlink" title="Thymeleaf"></a>Thymeleaf</h1><h2 id="æ¨¡æ¿å¼•æ“"><a href="#æ¨¡æ¿å¼•æ“" class="headerlink" title="æ¨¡æ¿å¼•æ“"></a>æ¨¡æ¿å¼•æ“</h2><ul><li>å‰ç«¯äº¤ç»™æˆ‘ä»¬çš„é¡µé¢ï¼Œæ˜¯htmlé¡µé¢ã€‚å¦‚æœæ˜¯æˆ‘ä»¬ä»¥å‰å¼€å‘ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä»–ä»¬è½¬æˆjspé¡µé¢ï¼Œjspå¥½å¤„å°±æ˜¯å½“æˆ‘ä»¬æŸ¥å‡ºä¸€äº›æ•°æ®è½¬å‘åˆ°JSPé¡µé¢ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨jspè½»æ¾å®ç°æ•°æ®çš„æ˜¾ç¤ºï¼ŒåŠäº¤äº’ç­‰ã€‚</li><li>jspæ”¯æŒéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬èƒ½å†™Javaä»£ç ï¼Œä½†æ˜¯å‘¢ï¼Œæˆ‘ä»¬ç°åœ¨çš„è¿™ç§æƒ…å†µï¼ŒSpringBootè¿™ä¸ªé¡¹ç›®é¦–å…ˆæ˜¯ä»¥jarçš„æ–¹å¼ï¼Œä¸æ˜¯warï¼Œç¬¬äºŒï¼Œæˆ‘ä»¬ç”¨çš„è¿˜æ˜¯åµŒå…¥å¼çš„Tomcatï¼Œæ‰€ä»¥å‘¢ï¼Œä»–ç°åœ¨é»˜è®¤æ˜¯ä¸æ”¯æŒjspçš„ã€‚</li><li>é‚£ä¸æ”¯æŒjspï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ç”¨çº¯é™æ€é¡µé¢çš„æ–¹å¼ï¼Œé‚£ç»™æˆ‘ä»¬å¼€å‘ä¼šå¸¦æ¥éå¸¸å¤§çš„éº»çƒ¦ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ</li><li>SpringBootæ¨èä½¿ç”¨æ¨¡æ¿å¼•æ“ï¼Œæˆ‘ä»¬å…¶å®å¤§å®¶å¬åˆ°å¾ˆå¤šï¼Œå…¶å®jspå°±æ˜¯ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œè¿˜æœ‰ç”¨çš„æ¯”è¾ƒå¤šçš„freemarkerï¼ŒåŒ…æ‹¬SpringBootç»™æˆ‘ä»¬æ¨èçš„<code>Thymeleaf</code>ï¼Œæ¨¡æ¿å¼•æ“æœ‰éå¸¸å¤šï¼Œä½†å†å¤šçš„æ¨¡æ¿å¼•æ“ï¼Œä»–ä»¬çš„æ€æƒ³éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä»€ä¹ˆæ ·ä¸€ä¸ªæ€æƒ³å‘¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™å¼ å›¾ï¼š<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@cfa20fa2bd1a2961f359d3c420bc112f231168ee/2021/06/22/8495420c6b78736f9495761f4954a868.png"></li><li>æ¨¡æ¿å¼•æ“çš„ä½œç”¨å°±æ˜¯æˆ‘ä»¬æ¥å†™ä¸€ä¸ªé¡µé¢æ¨¡æ¿ï¼Œæ¯”å¦‚æœ‰äº›å€¼å‘¢ï¼Œæ˜¯åŠ¨æ€çš„ï¼Œæˆ‘ä»¬å†™ä¸€äº›è¡¨è¾¾å¼ã€‚è€Œè¿™äº›å€¼ï¼Œä»å“ªæ¥å‘¢ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨åå°å°è£…ä¸€äº›æ•°æ®ã€‚ç„¶åæŠŠè¿™ä¸ªæ¨¡æ¿å’Œè¿™ä¸ªæ•°æ®äº¤ç»™æˆ‘ä»¬æ¨¡æ¿å¼•æ“ï¼Œæ¨¡æ¿å¼•æ“æŒ‰ç…§æˆ‘ä»¬è¿™ä¸ªæ•°æ®å¸®ä½ æŠŠè¿™è¡¨è¾¾å¼è§£æã€å¡«å……åˆ°æˆ‘ä»¬æŒ‡å®šçš„ä½ç½®ï¼Œç„¶åæŠŠè¿™ä¸ªæ•°æ®æœ€ç»ˆç”Ÿæˆä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„å†…å®¹ç»™æˆ‘ä»¬å†™å‡ºå»ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¿™ä¸ªæ¨¡æ¿å¼•æ“ï¼Œä¸ç®¡æ˜¯jspè¿˜æ˜¯å…¶ä»–æ¨¡æ¿å¼•æ“ï¼Œéƒ½æ˜¯è¿™ä¸ªæ€æƒ³ã€‚</li></ul><h2 id="å¼•å…¥Thymeleaf"><a href="#å¼•å…¥Thymeleaf" class="headerlink" title="å¼•å…¥Thymeleaf"></a>å¼•å…¥Thymeleaf</h2><ul><li>Thymeleaf å®˜ç½‘ï¼š<a href="https://www.thymeleaf.org/">https://www.thymeleaf.org/</a></li><li>Thymeleaf åœ¨Github çš„ä¸»é¡µï¼š<a href="https://github.com/thymeleaf/thymeleaf">https://github.com/thymeleaf/thymeleaf</a></li><li>Springå®˜æ–¹æ–‡æ¡£ï¼šæ‰¾åˆ°æˆ‘ä»¬å¯¹åº”çš„ç‰ˆæœ¬ï¼š<a href="https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#using-boot-starter">https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#using-boot-starter</a></li><li>å¯¹äºspringbootæ¥è¯´ï¼Œä»€ä¹ˆäº‹æƒ…ä¸éƒ½æ˜¯ä¸€ä¸ªstartçš„äº‹æƒ…å˜›ï¼Œæˆ‘ä»¬å»åœ¨é¡¹ç›®ä¸­å¼•å…¥ä¸€ä¸‹</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--thymeleaf--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@15a63e189b308d43e46f2b305d7f6e9b9a23fcbd/2021/06/22/51c759db52da5bd7b98baf3e9f17af77.png"></p><h2 id="Thymeleafåˆ†æ"><a href="#Thymeleafåˆ†æ" class="headerlink" title="Thymeleafåˆ†æ"></a>Thymeleafåˆ†æ</h2><ul><li>é¦–å…ˆå¾—æŒ‰ç…§SpringBootçš„è‡ªåŠ¨é…ç½®åŸç†çœ‹ä¸€ä¸‹æˆ‘ä»¬è¿™ä¸ªThymeleafçš„è‡ªåŠ¨é…ç½®è§„åˆ™ï¼Œåœ¨æŒ‰ç…§é‚£ä¸ªè§„åˆ™ï¼Œæˆ‘ä»¬è¿›è¡Œä½¿ç”¨ã€‚</li><li>æˆ‘ä»¬å»æ‰¾ä¸€ä¸‹Thymeleafçš„è‡ªåŠ¨é…ç½®ç±»ï¼š<code>ThymeleafProperties</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@ConfigurationProperties(</span></span><br><span class="line"><span class="meta">    prefix = &quot;spring.thymeleaf&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThymeleafProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset DEFAULT_ENCODING;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_PREFIX = <span class="string">&quot;classpath:/templates/&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SUFFIX = <span class="string">&quot;.html&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> checkTemplate = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> checkTemplateLocation = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">private</span> String prefix = <span class="string">&quot;classpath:/templates/&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> String suffix = <span class="string">&quot;.html&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> String mode = <span class="string">&quot;HTML&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> Charset encoding;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­çœ‹åˆ°é»˜è®¤çš„å‰ç¼€å’Œåç¼€ï¼</li><li>æˆ‘ä»¬åªéœ€è¦æŠŠæˆ‘ä»¬çš„htmlé¡µé¢æ”¾åœ¨ç±»è·¯å¾„ä¸‹çš„<code>templates</code>ä¸‹ï¼Œ<code>thymeleaf</code>å°±å¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨æ¸²æŸ“äº†</li><li>ä½¿ç”¨<code>thymeleaf</code>ä»€ä¹ˆéƒ½ä¸éœ€è¦é…ç½®ï¼Œåªéœ€è¦å°†ä»–æ”¾åœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸‹å³å¯ï¼</li></ul><h2 id="æµ‹è¯•Thymeleaf"><a href="#æµ‹è¯•Thymeleaf" class="headerlink" title="æµ‹è¯•Thymeleaf"></a>æµ‹è¯•Thymeleaf</h2><ul><li>ç¼–å†™ä¸€ä¸ªæµ‹è¯•é¡µé¢  <code>test.html</code> æ”¾åœ¨<code>templates</code> ç›®å½•ä¸‹</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æµ‹è¯•é¡µé¢<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;/xxx&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•é¡µé¢<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™ä¸€ä¸ª<code>TestController</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/t1&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//classpath:/templates/test.html</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨é¡¹ç›®</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@7bbdfb0822574aa436a46bde74f9bb7cb1b47ffa/2021/06/22/650b094f475c4cc649a6bb421b33d4ab.png"></p><h1 id="Thymeleafè¯­æ³•"><a href="#Thymeleafè¯­æ³•" class="headerlink" title="Thymeleafè¯­æ³•"></a>Thymeleafè¯­æ³•</h1><ul><li>å­¦ä¹ è¯­æ³•å¯ä»¥å‚è€ƒThymeleaf å®˜ç½‘ï¼š<a href="https://www.thymeleaf.org/">https://www.thymeleaf.org/</a>ï¼Œä¸‹è½½Thymeleafçš„å®˜æ–¹æ–‡æ¡£ï¼</li><li>å®˜ç½‘ç®€å•çš„Thymeleafæ¨¡æ¿</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>Good Thymes Virtual Grocery<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">media</span>=<span class="string">&quot;all&quot;</span> <span class="attr">href</span>=<span class="string">&quot;../../css/gtvg.css&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/css/gtvg.css&#125;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;#&#123;home.welcome&#125;&quot;</span>&gt;</span>Welcome to our grocery store!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è·å–æ•°æ®"><a href="#è·å–æ•°æ®" class="headerlink" title="è·å–æ•°æ®"></a>è·å–æ•°æ®</h2><ul><li>åšä¸€ä¸ªç®€å•çš„ç»ƒä¹ ï¼šæŸ¥å‡ºä¸€äº›æ•°æ®ï¼Œåœ¨é¡µé¢ä¸­å±•ç¤º</li><li>ä¿®æ”¹æµ‹è¯•è¯·æ±‚ï¼Œå¢åŠ æ•°æ®ä¼ è¾“ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/t1&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å­˜å…¥æ•°æ®</span></span><br><span class="line">    model.addAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;Hello,Thymeleaf&quot;</span>);</span><br><span class="line">    <span class="comment">//classpath:/templates/test.html</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™å‰ç«¯é¡µé¢ã€‚è¦ä½¿ç”¨thymeleafï¼Œéœ€è¦åœ¨htmlæ–‡ä»¶ä¸­å¯¼å…¥å‘½åç©ºé—´çš„çº¦æŸï¼Œæ–¹ä¾¿æç¤º</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æµ‹è¯•é¡µé¢<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;/xxx&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•é¡µé¢<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--th:textå°±æ˜¯å°†divä¸­çš„å†…å®¹è®¾ç½®ä¸ºå®ƒæŒ‡å®šçš„å€¼ï¼Œå’Œä¹‹å‰å­¦ä¹ çš„Vueä¸€æ ·--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@1e90252459c60c406457075df2afe97492cb84ad/2021/06/22/ee6698020772ef8fe39136b1812de06a.png"></p><div class="note success simple"><p>æ‰€æœ‰çš„HTMLå…ƒç´ éƒ½å¯ä»¥è¢«thymeleafæ›¿æ¢æ¥ç®¡ï¼Œè¯­æ³•<code>th:å…ƒç´ å</code></p></div><h2 id="Thymeleafè¯­æ³•-1"><a href="#Thymeleafè¯­æ³•-1" class="headerlink" title="Thymeleafè¯­æ³•"></a>Thymeleafè¯­æ³•</h2><ul><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„çš„ <code>th:attr</code> æ¥æ›¿æ¢HTMLä¸­åŸç”Ÿå±æ€§çš„å€¼ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@c4d471d42b5d7ba43afbfd3d2080058fa1014972/2021/06/22/79762d4b558d4dcd7615035652de2dd2.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/t1&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(Map&lt;String,Object&gt; map)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å­˜å…¥æ•°æ®</span></span><br><span class="line">        map.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;&lt;h1&gt;Hello&lt;/h1&gt;&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;users&quot;</span>, Arrays.asList(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">        <span class="comment">//classpath:/templates/test.html</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•é¡µé¢å–å‡ºæ•°æ®</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æµ‹è¯•é¡µé¢<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;/xxx&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>æµ‹è¯•é¡µé¢<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ä¸è½¬ä¹‰--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:utext</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--éå†æ•°æ®--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--th:eachæ¯æ¬¡éå†éƒ½ä¼šç”Ÿæˆå½“å‰è¿™ä¸ªæ ‡ç­¾ï¼šå®˜ç½‘#9--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span> <span class="attr">th:each</span>=<span class="string">&quot;user :$&#123;users&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è¡Œå†…å†™æ³•ï¼šå®˜ç½‘#12--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:each</span>=<span class="string">&quot;user:$&#123;users&#125;&quot;</span>&gt;</span>[[$&#123;user&#125;]]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@2863d1f934ae0393f3820b9bbbc297b9cb6340a7/2021/06/22/b1c4ddde50cb55a5a6624e4f3bde6265.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Thymeleaf&quot;&gt;&lt;a href=&quot;#Thymeleaf&quot; class=&quot;headerlink&quot; title=&quot;Thymeleaf&quot;&gt;&lt;/a&gt;Thymeleaf&lt;/h1&gt;&lt;h2 id=&quot;æ¨¡æ¿å¼•æ“&quot;&gt;&lt;a href=&quot;#æ¨¡æ¿å¼•æ“&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    <category term="Thymeleaf" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/Thymeleaf/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
    <category term="Thymeleaf" scheme="http://xiaoliblog.cn/tags/Thymeleaf/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒWebå¼€å‘é™æ€èµ„æºå¤„ç†</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot06.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot06.html</id>
    <published>2021-06-21T11:39:40.615Z</published>
    <updated>2021-06-21T12:47:32.736Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é™æ€èµ„æºå¤„ç†"><a href="#é™æ€èµ„æºå¤„ç†" class="headerlink" title="é™æ€èµ„æºå¤„ç†"></a>é™æ€èµ„æºå¤„ç†</h1><h2 id="æ˜ å°„è§„åˆ™"><a href="#æ˜ å°„è§„åˆ™" class="headerlink" title="æ˜ å°„è§„åˆ™"></a>æ˜ å°„è§„åˆ™</h2><ul><li>é™æ€èµ„æºæ˜ å°„è§„åˆ™ï¼šSpringBootä¸­ï¼ŒSpringMVCçš„webé…ç½®éƒ½åœ¨<code>WebMvcAutoConfiguration</code> è¿™ä¸ªé…ç½®ç±»é‡Œé¢ï¼›</li><li><code>WebMvcAutoConfigurationAdapter</code> ä¸­æœ‰å¾ˆå¤šé…ç½®æ–¹æ³•ï¼›æœ‰ä¸€ä¸ªæ–¹æ³•ï¼š<code>addResourceHandlers</code> æ·»åŠ èµ„æºå¤„ç†</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.resourceProperties.isAddMappings()) &#123;</span><br><span class="line">        <span class="comment">// å·²ç¦ç”¨é»˜è®¤èµ„æºå¤„ç†</span></span><br><span class="line">        logger.debug(<span class="string">&quot;Default resource handling disabled&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç¼“å­˜æ§åˆ¶</span></span><br><span class="line">    Duration cachePeriod = <span class="keyword">this</span>.resourceProperties.getCache().getPeriod();</span><br><span class="line">    CacheControl cacheControl = <span class="keyword">this</span>.resourceProperties.getCache().getCachecontrol().toHttpCacheControl();</span><br><span class="line">    <span class="comment">// webjars é…ç½®</span></span><br><span class="line">    <span class="keyword">if</span> (!registry.hasMappingForPattern(<span class="string">&quot;/webjars/**&quot;</span>)) &#123;</span><br><span class="line">        customizeResourceHandlerRegistration(registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>)</span><br><span class="line">                                             .addResourceLocations(<span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>)</span><br><span class="line">                                             .setCachePeriod(getSeconds(cachePeriod)).setCacheControl(cacheControl));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é™æ€èµ„æºé…ç½®</span></span><br><span class="line">    String staticPathPattern = <span class="keyword">this</span>.mvcProperties.getStaticPathPattern();</span><br><span class="line">    <span class="keyword">if</span> (!registry.hasMappingForPattern(staticPathPattern)) &#123;</span><br><span class="line">        customizeResourceHandlerRegistration(registry.addResourceHandler(staticPathPattern)</span><br><span class="line">                                             .addResourceLocations(getResourceLocations(<span class="keyword">this</span>.resourceProperties.getStaticLocations()))</span><br><span class="line">                                             .setCachePeriod(getSeconds(cachePeriod)).setCacheControl(cacheControl));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä»æºä»£ç ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„ <code>/webjars/**</code> ï¼Œ éƒ½éœ€è¦å» <code>classpath:/META-INF/resources/webjars/</code> æ‰¾å¯¹åº”çš„èµ„æºï¼›</li></ul><h2 id="webjars"><a href="#webjars" class="headerlink" title="webjars"></a>webjars</h2><ul><li><code>Webjars</code>æœ¬è´¨å°±æ˜¯ä»¥<code>jar</code>åŒ…çš„æ–¹å¼å¼•å…¥æˆ‘ä»¬çš„é™æ€èµ„æº ï¼Œ æˆ‘ä»¬ä»¥å‰è¦å¯¼å…¥ä¸€ä¸ªé™æ€èµ„æºæ–‡ä»¶ï¼Œç›´æ¥å¯¼å…¥å³å¯</li><li>ä½¿ç”¨SpringBootéœ€è¦ä½¿ç”¨<code>Webjars</code>ï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘ï¼š<a href="https://www.webjars.org/">https://www.webjars.org</a></li><li>è¦ä½¿ç”¨<code>jQuery</code>ï¼Œæˆ‘ä»¬åªè¦è¦å¼•å…¥jQueryå¯¹åº”ç‰ˆæœ¬çš„pomä¾èµ–å³å¯ï¼</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.webjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jquery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@0e251dad9d03947496d3a26171d6cda5f7ea6033/2021/06/21/7a8db79bb19486dd3a8119cbf51ae59a.png"></p><ul><li>å¯ä»¥é€šè¿‡é‡å¯æœåŠ¡å™¨è®¿é—®ä¸€ä¸‹é™æ€èµ„æºï¼Œ<code>/webjars/</code>åé¢é»˜è®¤è·Ÿä¸‰çº§ç›®å½•<code>/META-INF/resources/webjars/</code>ï¼Œæ¯”å¦‚ä½¿ç”¨å¦‚ä¸‹åœ°å€è®¿é—®</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:8080&#x2F;webjars&#x2F;jquery&#x2F;3.6.0&#x2F;jquery.js</span><br></pre></td></tr></table></figure><h2 id="ResourceProperties"><a href="#ResourceProperties" class="headerlink" title="ResourceProperties"></a>ResourceProperties</h2><ul><li>å®é™…å¼€å‘ä¸­ä½¿ç”¨<code>webjar</code>æ–¹å¼å¯¼å…¥é™æ€èµ„æºå¹¶ä¸å®ç”¨ã€‚æˆ‘ä»¬å»æ‰¾<code>staticPathPattern</code>å‘ç°ç¬¬äºŒç§æ˜ å°„è§„åˆ™ ï¼š<code>/**</code> , è®¿é—®å½“å‰çš„é¡¹ç›®ä»»æ„èµ„æºï¼Œå®ƒä¼šå»æ‰¾ <code>resourceProperties</code> è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç‚¹è¿›å»çœ‹ä¸€ä¸‹åˆ†æï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/ è¿›å…¥æ–¹æ³•</span><br><span class="line"><span class="keyword">public</span> String[] getStaticLocations() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.staticLocations;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰¾åˆ°å¯¹åº”çš„å€¼</span></span><br><span class="line"><span class="keyword">private</span> String[] staticLocations = CLASSPATH_RESOURCE_LOCATIONS;</span><br><span class="line"><span class="comment">// æ‰¾åˆ°è·¯å¾„</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] CLASSPATH_RESOURCE_LOCATIONS = &#123; </span><br><span class="line">    <span class="string">&quot;classpath:/META-INF/resources/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;classpath:/resources/&quot;</span>, </span><br><span class="line">    <span class="string">&quot;classpath:/static/&quot;</span>, </span><br><span class="line">    <span class="string">&quot;classpath:/public/&quot;</span> </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><code>ResourceProperties</code> å¯ä»¥è®¾ç½®å’Œæˆ‘ä»¬é™æ€èµ„æºæœ‰å…³çš„å‚æ•°ï¼›è¿™é‡Œé¢æŒ‡å‘äº†å®ƒä¼šå»å¯»æ‰¾èµ„æºçš„æ–‡ä»¶å¤¹ï¼Œå³ä¸Šé¢æ•°ç»„çš„å†…å®¹ã€‚</li><li>æ‰€ä»¥å¾—å‡ºç»“è®ºï¼Œä»¥ä¸‹å››ä¸ªç›®å½•å­˜æ”¾çš„é™æ€èµ„æºå¯ä»¥è¢«æˆ‘ä»¬è¯†åˆ«ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;classpath:/META-INF/resources/&quot;</span></span><br><span class="line"><span class="string">&quot;classpath:/resources/&quot;</span></span><br><span class="line"><span class="string">&quot;classpath:/static/&quot;</span></span><br><span class="line"><span class="string">&quot;classpath:/public/&quot;</span></span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬å¯ä»¥åœ¨<code>resources</code>æ ¹ç›®å½•ä¸‹æ–°å»ºå¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œéƒ½å¯ä»¥å­˜æ”¾æˆ‘ä»¬çš„é™æ€æ–‡ä»¶ï¼›</li><li>æ¯”å¦‚æˆ‘ä»¬è®¿é—® <code>http://localhost:8080/1.js</code> , ä»–å°±ä¼šå»è¿™äº›æ–‡ä»¶å¤¹ä¸­å¯»æ‰¾å¯¹åº”çš„é™æ€èµ„æºæ–‡ä»¶ï¼›</li><li>å½“å‡ºç°é‡å¤é™æ€èµ„æºæ—¶<code>resources</code>ä¸‹çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œ<code>static</code>å…¶æ¬¡ï¼Œç„¶å<code>public</code>ä¼˜å…ˆçº§æœ€ä½</li><li>ä¸€èˆ¬åœ¨<code>public</code>ä¸‹æ”¾ä¸€ä¸‹å…¬å…±çš„èµ„æºï¼Œæ¯”å¦‚Jsã€Cssã€‚åœ¨<code>static</code>ä¸‹æ”¾ä¸€ä¸‹é™æ€èµ„æºï¼Œæ¯”å¦‚å›¾ç‰‡ã€‚<code>resources</code>ä¸‹å¯ä»¥å­˜æ”¾ä¸€äº›uploadä¸Šä¼ çš„æ–‡ä»¶</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@b37fdd67e5ab152cf6210d9c9a06d6206ffb68f1/2021/06/21/045ce9d0a441f40ed690030ef0096998.png"></p><h2 id="è‡ªå®šä¹‰èµ„æºè·¯å¾„"><a href="#è‡ªå®šä¹‰èµ„æºè·¯å¾„" class="headerlink" title="è‡ªå®šä¹‰èµ„æºè·¯å¾„"></a>è‡ªå®šä¹‰èµ„æºè·¯å¾„</h2><ul><li>æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±é€šè¿‡é…ç½®æ–‡ä»¶æ¥æŒ‡å®šä¸€ä¸‹ï¼Œå“ªäº›æ–‡ä»¶å¤¹æ˜¯éœ€è¦æˆ‘ä»¬æ”¾é™æ€èµ„æºæ–‡ä»¶çš„ï¼Œåœ¨<code>application.properties</code>ä¸­é…ç½®ï¼›</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.resources.static-locations</span>=<span class="string">classpath:/coding/,classpath:/lzy/</span></span><br></pre></td></tr></table></figure><ul><li>ä¸€æ—¦è‡ªå·±å®šä¹‰äº†é™æ€æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼ŒåŸæ¥çš„è‡ªåŠ¨é…ç½®å°±éƒ½ä¼šå¤±æ•ˆäº†ï¼</li></ul><h1 id="é¦–é¡µå¤„ç†"><a href="#é¦–é¡µå¤„ç†" class="headerlink" title="é¦–é¡µå¤„ç†"></a>é¦–é¡µå¤„ç†</h1><h2 id="æ¬¢è¿é¡µæ˜ å°„"><a href="#æ¬¢è¿é¡µæ˜ å°„" class="headerlink" title="æ¬¢è¿é¡µæ˜ å°„"></a>æ¬¢è¿é¡µæ˜ å°„</h2><ul><li>ç»§ç»­æŸ¥çœ‹<code>WebMvcAutoConfiguration</code>æºç </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> WelcomePageHandlerMapping <span class="title">welcomePageHandlerMapping</span><span class="params">(ApplicationContext applicationContext,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                           FormattingConversionService mvcConversionService,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                           ResourceUrlProvider mvcResourceUrlProvider)</span> </span>&#123;</span><br><span class="line">    WelcomePageHandlerMapping welcomePageHandlerMapping = <span class="keyword">new</span> WelcomePageHandlerMapping(</span><br><span class="line">        <span class="keyword">new</span> TemplateAvailabilityProviders(applicationContext), applicationContext, getWelcomePage(), <span class="comment">// getWelcomePage è·å¾—æ¬¢è¿é¡µ</span></span><br><span class="line">        <span class="keyword">this</span>.mvcProperties.getStaticPathPattern());</span><br><span class="line">    welcomePageHandlerMapping.setInterceptors(getInterceptors(mvcConversionService, mvcResourceUrlProvider));</span><br><span class="line">    <span class="keyword">return</span> welcomePageHandlerMapping;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç‚¹è¿›å»ç»§ç»­çœ‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Optional&lt;Resource&gt; <span class="title">getWelcomePage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String[] locations = getResourceLocations(<span class="keyword">this</span>.resourceProperties.getStaticLocations());</span><br><span class="line">    <span class="comment">// ::æ˜¯java8 ä¸­æ–°å¼•å…¥çš„è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="comment">// Class::functionçš„æ—¶å€™functionæ˜¯å±äºClassçš„ï¼Œåº”è¯¥æ˜¯é™æ€æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment">// this::functionçš„funtionæ˜¯å±äºè¿™ä¸ªå¯¹è±¡çš„ã€‚</span></span><br><span class="line">    <span class="comment">// ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯ä¸€ç§è¯­æ³•ç³–è€Œå·²ï¼Œæ˜¯ä¸€ç§ç®€å†™</span></span><br><span class="line">    <span class="keyword">return</span> Arrays.stream(locations).map(<span class="keyword">this</span>::getIndexHtml).filter(<span class="keyword">this</span>::isReadable).findFirst();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¬¢è¿é¡µå°±æ˜¯ä¸€ä¸ªlocationä¸‹çš„çš„ index.html è€Œå·²</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> Resource <span class="title">getIndexHtml</span><span class="params">(String location)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.resourceLoader.getResource(location + <span class="string">&quot;index.html&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ¬¢è¿é¡µï¼Œé™æ€èµ„æºæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰ <code>index.html</code> é¡µé¢ï¼›è¢« <code>/**</code> æ˜ å°„ã€‚</li><li>æ¯”å¦‚åœ¨ä»¥ä¸Šé™æ€èµ„æºçš„<code>public</code>æ–‡ä»¶å¤¹åœ¨æ–°å»ºé¦–é¡µ<code>index.html</code>ã€‚è®¿é—®  <code>http://localhost:8080/</code> ï¼Œå°±ä¼šæ‰¾é™æ€èµ„æºæ–‡ä»¶å¤¹ä¸‹çš„ <code>index.html</code></li></ul><div class="note success simple"><p>å…¶å®è¿˜æœ‰ä¸€ä¸ª<code>templates</code>æ–‡ä»¶å¤¹ï¼Œä¹Ÿå¯ä»¥ç”¨äºå­˜æ”¾é™æ€èµ„æºã€‚ä½†å…¶åªèƒ½æœ‰Controllerå±‚è®¿é—®ï¼Œç›¸å½“äºWEB-INFï¼Œé¦–é¡µ<code>index.html</code>ä¸€èˆ¬å­˜æ”¾åœ¨<code>templates</code>æ–‡ä»¶å¤¹ä¸­</p></div><h2 id="ç½‘ç«™å›¾æ ‡"><a href="#ç½‘ç«™å›¾æ ‡" class="headerlink" title="ç½‘ç«™å›¾æ ‡"></a>ç½‘ç«™å›¾æ ‡</h2><ul><li>ä¸å…¶ä»–é™æ€èµ„æºä¸€æ ·ï¼ŒSpring Bootåœ¨é…ç½®çš„é™æ€å†…å®¹ä½ç½®ä¸­æŸ¥æ‰¾ <code>favicon.ico</code>ã€‚å¦‚æœå­˜åœ¨è¿™æ ·çš„æ–‡ä»¶ï¼Œå®ƒå°†è‡ªåŠ¨ç”¨ä½œåº”ç”¨ç¨‹åºçš„<code>favicon</code></li><li>å…³é—­SpringBooté»˜è®¤å›¾æ ‡</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å…³é—­é»˜è®¤å›¾æ ‡</span></span><br><span class="line"><span class="meta">spring.mvc.favicon.enabled</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure><ul><li>è‡ªå·±æ”¾ä¸€ä¸ªå›¾æ ‡åœ¨é™æ€èµ„æºç›®å½•ä¸‹ï¼Œæ¯”å¦‚ <code>public</code> ç›®å½•ä¸‹</li><li>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼åˆ·æ–°ç½‘é¡µï¼Œå‘ç°å›¾æ ‡å·²ç»å˜æˆè‡ªå·±çš„äº†ï¼</li></ul><div class="note success simple"><p>é™ç‰ˆæœ¬åªéœ€è¦ä¿®æ”¹<code>pom.xml</code>çš„<code>parent</code>çš„ç‰ˆæœ¬å³å¯</p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;é™æ€èµ„æºå¤„ç†&quot;&gt;&lt;a href=&quot;#é™æ€èµ„æºå¤„ç†&quot; class=&quot;headerlink&quot; title=&quot;é™æ€èµ„æºå¤„ç†&quot;&gt;&lt;/a&gt;é™æ€èµ„æºå¤„ç†&lt;/h1&gt;&lt;h2 id=&quot;æ˜ å°„è§„åˆ™&quot;&gt;&lt;a href=&quot;#æ˜ å°„è§„åˆ™&quot; class=&quot;headerlink&quot; title=&quot;æ˜ </summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootğŸƒè‡ªåŠ¨é…ç½®åŸç†åŠè‡ªå®šä¹‰starter</title>
    <link href="http://xiaoliblog.cn/page/SpringBoot05.html"/>
    <id>http://xiaoliblog.cn/page/SpringBoot05.html</id>
    <published>2021-06-21T10:15:25.113Z</published>
    <updated>2021-06-21T11:39:33.961Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è‡ªåŠ¨é…ç½®åŸç†"><a href="#è‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="è‡ªåŠ¨é…ç½®åŸç†"></a>è‡ªåŠ¨é…ç½®åŸç†</h1><h2 id="åˆ†æåŸç†"><a href="#åˆ†æåŸç†" class="headerlink" title="åˆ†æåŸç†"></a>åˆ†æåŸç†</h2><ul><li>ä»¥<code>HttpEncodingAutoConfiguration</code>ï¼ˆHttpç¼–ç è‡ªåŠ¨é…ç½®ï¼‰ä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œå’Œä»¥å‰ç¼–å†™çš„é…ç½®æ–‡ä»¶ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼›</span></span><br><span class="line"><span class="meta">@Configuration</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯åŠ¨æŒ‡å®šç±»çš„ConfigurationPropertiesåŠŸèƒ½ï¼›</span></span><br><span class="line">  <span class="comment">//è¿›å…¥è¿™ä¸ªHttpPropertiesæŸ¥çœ‹ï¼Œå°†é…ç½®æ–‡ä»¶ä¸­å¯¹åº”çš„å€¼å’ŒHttpPropertiesç»‘å®šèµ·æ¥ï¼›</span></span><br><span class="line">  <span class="comment">//å¹¶æŠŠHttpPropertiesåŠ å…¥åˆ°iocå®¹å™¨ä¸­</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(&#123;HttpProperties.class&#125;)</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">//Springåº•å±‚@Conditionalæ³¨è§£</span></span><br><span class="line">  <span class="comment">//æ ¹æ®ä¸åŒçš„æ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœæ»¡è¶³æŒ‡å®šçš„æ¡ä»¶ï¼Œæ•´ä¸ªé…ç½®ç±»é‡Œé¢çš„é…ç½®å°±ä¼šç”Ÿæ•ˆï¼›</span></span><br><span class="line">  <span class="comment">//è¿™é‡Œçš„æ„æ€å°±æ˜¯åˆ¤æ–­å½“å‰åº”ç”¨æ˜¯å¦æ˜¯webåº”ç”¨ï¼Œå¦‚æœæ˜¯ï¼Œå½“å‰é…ç½®ç±»ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication(</span></span><br><span class="line"><span class="meta">    type = Type.SERVLET</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­å½“å‰é¡¹ç›®æœ‰æ²¡æœ‰è¿™ä¸ªç±»CharacterEncodingFilterï¼›SpringMVCä¸­è¿›è¡Œä¹±ç è§£å†³çš„è¿‡æ»¤å™¨ï¼›</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(&#123;CharacterEncodingFilter.class&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé…ç½®ï¼šspring.http.encoding.enabledï¼›</span></span><br><span class="line">  <span class="comment">//å¦‚æœä¸å­˜åœ¨ï¼Œåˆ¤æ–­ä¹Ÿæ˜¯æˆç«‹çš„</span></span><br><span class="line">  <span class="comment">//å³ä½¿æˆ‘ä»¬é…ç½®æ–‡ä»¶ä¸­ä¸é…ç½®pring.http.encoding.enabled=trueï¼Œä¹Ÿæ˜¯é»˜è®¤ç”Ÿæ•ˆçš„ï¼›</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty(</span></span><br><span class="line"><span class="meta">    prefix = &quot;spring.http.encoding&quot;,</span></span><br><span class="line"><span class="meta">    value = &#123;&quot;enabled&quot;&#125;,</span></span><br><span class="line"><span class="meta">    matchIfMissing = true</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpEncodingAutoConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ä»–å·²ç»å’ŒSpringBootçš„é…ç½®æ–‡ä»¶æ˜ å°„äº†</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Encoding properties;</span><br><span class="line">    <span class="comment">//åªæœ‰ä¸€ä¸ªæœ‰å‚æ„é€ å™¨çš„æƒ…å†µä¸‹ï¼Œå‚æ•°çš„å€¼å°±ä¼šä»å®¹å™¨ä¸­æ‹¿</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HttpEncodingAutoConfiguration</span><span class="params">(HttpProperties properties)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.properties = properties.getEncoding();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ç»™å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶çš„æŸäº›å€¼éœ€è¦ä»propertiesä¸­è·å–</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span> <span class="comment">//åˆ¤æ–­å®¹å™¨æ²¡æœ‰è¿™ä¸ªç»„ä»¶ï¼Ÿ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CharacterEncodingFilter <span class="title">characterEncodingFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        CharacterEncodingFilter filter = <span class="keyword">new</span> OrderedCharacterEncodingFilter();</span><br><span class="line">        filter.setEncoding(<span class="keyword">this</span>.properties.getCharset().name());</span><br><span class="line">        filter.setForceRequestEncoding(<span class="keyword">this</span>.properties.shouldForce(org.springframework.boot.autoconfigure.http.HttpProperties.Encoding.Type.REQUEST));</span><br><span class="line">        filter.setForceResponseEncoding(<span class="keyword">this</span>.properties.shouldForce(org.springframework.boot.autoconfigure.http.HttpProperties.Encoding.Type.RESPONSE));</span><br><span class="line">        <span class="keyword">return</span> filter;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note success simple"><p><strong>ä¸€å¥è¯æ€»ç»“ ï¼šæ ¹æ®å½“å‰ä¸åŒçš„æ¡ä»¶åˆ¤æ–­ï¼Œå†³å®šè¿™ä¸ªé…ç½®ç±»æ˜¯å¦ç”Ÿæ•ˆï¼</strong></p></div><ul><li>ä¸€ä½†è¿™ä¸ªé…ç½®ç±»ç”Ÿæ•ˆï¼›è¿™ä¸ªé…ç½®ç±»å°±ä¼šç»™å®¹å™¨ä¸­æ·»åŠ å„ç§ç»„ä»¶ï¼›</li><li>è¿™äº›ç»„ä»¶çš„å±æ€§æ˜¯ä»å¯¹åº”çš„<code>properties</code>ç±»ä¸­è·å–çš„ï¼Œè¿™äº›ç±»é‡Œé¢çš„æ¯ä¸€ä¸ªå±æ€§åˆæ˜¯å’Œé…ç½®æ–‡ä»¶ç»‘å®šçš„ï¼›</li><li>æ‰€æœ‰åœ¨é…ç½®æ–‡ä»¶ä¸­èƒ½é…ç½®çš„å±æ€§éƒ½æ˜¯åœ¨<code>xxxxProperties</code>ç±»ä¸­å°è£…ç€ï¼›</li><li>é…ç½®æ–‡ä»¶èƒ½é…ç½®ä»€ä¹ˆå°±å¯ä»¥å‚ç…§æŸä¸ªåŠŸèƒ½å¯¹åº”çš„è¿™ä¸ªå±æ€§ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»é…ç½®æ–‡ä»¶ä¸­è·å–æŒ‡å®šçš„å€¼å’Œbeançš„å±æ€§è¿›è¡Œç»‘å®š</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;spring.http&quot;)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpProperties</span> </span>&#123;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å»<code>.yml</code>é…ç½®æ–‡ä»¶é‡Œé¢è¯•è¯•å‰ç¼€ï¼Œçœ‹æç¤ºï¼</li></ul><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@c17a996ac6b346c9f55c46c619655fc4ac6c5a33/2021/06/21/6bd9bff64cc34ca22a2a055e2542ca41.png" width="50%"><ul><li>SpringBootå¯åŠ¨ä¼šåŠ è½½å¤§é‡çš„è‡ªåŠ¨é…ç½®ç±»</li><li>æˆ‘ä»¬çœ‹æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½æœ‰æ²¡æœ‰åœ¨SpringBooté»˜è®¤å†™å¥½çš„è‡ªåŠ¨é…ç½®ç±»å½“ä¸­ï¼›</li><li>æˆ‘ä»¬å†æ¥çœ‹è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»ä¸­åˆ°åº•é…ç½®äº†å“ªäº›ç»„ä»¶ï¼›ï¼ˆåªè¦æˆ‘ä»¬è¦ç”¨çš„ç»„ä»¶å­˜åœ¨åœ¨å…¶ä¸­ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å†æ‰‹åŠ¨é…ç½®äº†ï¼‰</li><li>ç»™å®¹å™¨ä¸­è‡ªåŠ¨é…ç½®ç±»æ·»åŠ ç»„ä»¶çš„æ—¶å€™ï¼Œä¼šä»<code>properties</code>ç±»ä¸­è·å–æŸäº›å±æ€§ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šè¿™äº›å±æ€§çš„å€¼å³å¯ï¼›<ul><li><code>xxxxAutoConfigurartion</code>ï¼šè‡ªåŠ¨é…ç½®ç±»ï¼›ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶</li><li><code>xxxxProperties</code>ï¼šå°è£…é…ç½®æ–‡ä»¶ä¸­ç›¸å…³å±æ€§ï¼›</li></ul></li></ul><h2 id="Conditional"><a href="#Conditional" class="headerlink" title="@Conditional"></a>@Conditional</h2><ul><li>è‡ªåŠ¨é…ç½®ç±»å¿…é¡»åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹æ‰èƒ½ç”Ÿæ•ˆï¼›<code>@Conditional</code>æ´¾ç”Ÿæ³¨è§£ï¼ˆSpringæ³¨è§£ç‰ˆåŸç”Ÿçš„@Conditionalä½œç”¨ï¼‰</li><li>ä½œç”¨ï¼šå¿…é¡»æ˜¯<code>@Conditional</code>æŒ‡å®šçš„æ¡ä»¶æˆç«‹ï¼Œæ‰ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼Œé…ç½®é…é‡Œé¢çš„æ‰€æœ‰å†…å®¹æ‰ç”Ÿæ•ˆï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@dd2d9f69ac0099b107f9a29a92ee55a9547bbf39/2021/06/21/7cce9e37eaf2d76bde0b8bec5bf70422.png"></p><ul><li>é‚£ä¹ˆå¤šçš„è‡ªåŠ¨é…ç½®ç±»ï¼Œå¿…é¡»åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹æ‰èƒ½ç”Ÿæ•ˆï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åŠ è½½äº†è¿™ä¹ˆå¤šçš„é…ç½®ç±»ï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„éƒ½ç”Ÿæ•ˆäº†</li><li>é‚£å¦‚ä½•çŸ¥é“å“ªäº›è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆï¼Ÿå¯ä»¥é€šè¿‡å¯ç”¨ <code>debug=true</code>å±æ€§ï¼›æ¥è®©æ§åˆ¶å°æ‰“å°è‡ªåŠ¨é…ç½®æŠ¥å‘Šï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„çŸ¥é“å“ªäº›è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆï¼›</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¼€å¯springbootçš„è°ƒè¯•ç±»</span></span><br><span class="line"><span class="attr">debug:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹è¾“å‡ºçš„æ—¥å¿—ï¼Œè¾“å‡ºåˆ†ä»¥ä¸‹ä¸‰ç±»<ul><li><code>Positive matches</code>:ï¼ˆè‡ªåŠ¨é…ç½®ç±»å¯ç”¨çš„ï¼šæ­£åŒ¹é…ï¼‰</li><li><code>Negative matches</code>:ï¼ˆæ²¡æœ‰å¯åŠ¨ï¼Œæ²¡æœ‰åŒ¹é…æˆåŠŸçš„è‡ªåŠ¨é…ç½®ç±»ï¼šè´ŸåŒ¹é…ï¼‰</li><li><code>Unconditional classes</code>: ï¼ˆæ²¡æœ‰æ¡ä»¶çš„ç±»ï¼‰</li></ul></li></ul><h1 id="è‡ªå®šä¹‰Starter"><a href="#è‡ªå®šä¹‰Starter" class="headerlink" title="è‡ªå®šä¹‰Starter"></a>è‡ªå®šä¹‰Starter</h1><h2 id="å¯åŠ¨å™¨è¯´æ˜"><a href="#å¯åŠ¨å™¨è¯´æ˜" class="headerlink" title="å¯åŠ¨å™¨è¯´æ˜"></a>å¯åŠ¨å™¨è¯´æ˜</h2><ul><li>å¯åŠ¨å™¨æ¨¡å—æ˜¯ä¸€ä¸ª ç©º <code>jar</code> æ–‡ä»¶ï¼Œä»…æä¾›è¾…åŠ©æ€§ä¾èµ–ç®¡ç†ï¼Œè¿™äº›ä¾èµ–å¯èƒ½ç”¨äºè‡ªåŠ¨è£…é…æˆ–è€…å…¶ä»–ç±»åº“ï¼›</li><li>å®˜æ–¹å‘½å<ul><li>å‰ç¼€ï¼š<code>spring-boot-starter-xxx</code></li><li>æ¯”å¦‚ï¼šspring-boot-starter-webâ€¦.</li></ul></li><li>è‡ªå®šä¹‰å‘½åï¼š<ul><li><code>xxx-spring-boot-starter</code></li><li>æ¯”å¦‚ï¼šmybatis-spring-boot-starter</li></ul></li></ul><h2 id="å¯åŠ¨å™¨å‡†å¤‡"><a href="#å¯åŠ¨å™¨å‡†å¤‡" class="headerlink" title="å¯åŠ¨å™¨å‡†å¤‡"></a>å¯åŠ¨å™¨å‡†å¤‡</h2><ul><li>æ–°å»ºä¸€ä¸ªç©ºé¡¹ç›® <code>spring-boot-starter-diy</code></li><li>å†æ–°å»ºä¸€ä¸ªæ™®é€šMavenæ¨¡å—ï¼š<code>lzy-spring-boot-starter</code></li><li>å†æ–°å»ºä¸€ä¸ªSpringBootæ¨¡å—ï¼š<code>lzy-spring-boot-starter-autoconfigure</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@99746fd9ed84f59f348ef3fbbfbb6238d601d4c3/2021/06/21/300bd95530a62d45cc103090e9c24419.png"></p><ul><li><p>åŸºæœ¬ç»“æ„å¦‚ä¸‹<img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@c636f358db9cd39bea9959164134d2ef5c987b21/2021/06/21/fbba6ededad338639191f0c8f15dba58.png"></p></li><li><p> åœ¨çˆ¶å·¥ç¨‹ä¸­ å¯¼å…¥  <code>autoconfigure</code> çš„ä¾èµ–ï¼</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.lzy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lzy-spring-boot-starter-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å°† <code>autoconfigure</code> é¡¹ç›®ä¸‹å¤šä½™çš„æ–‡ä»¶éƒ½åˆ æ‰ï¼Œ<code>pom.xml</code>ä¸­åªç•™ä¸‹ä¸€ä¸ª <code>starter</code>ï¼Œè¿™æ˜¯æ‰€æœ‰çš„å¯åŠ¨å™¨åŸºæœ¬é…ç½®ï¼</li></ul><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@a3e45d4a46d21c24d91e0e1ae8f23a4d3abcdf49/2021/06/21/0dc8c5c76f9115447009d01daae2e7e4.png"></p><h2 id="å¯åŠ¨å™¨é…ç½®"><a href="#å¯åŠ¨å™¨é…ç½®" class="headerlink" title="å¯åŠ¨å™¨é…ç½®"></a>å¯åŠ¨å™¨é…ç½®</h2><ul><li>ç¼–å†™ä¸€ä¸ªè‡ªå·±çš„æœåŠ¡</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è‡ªåŠ¨é…ç½®åŸç†&quot;&gt;&lt;a href=&quot;#è‡ªåŠ¨é…ç½®åŸç†&quot; class=&quot;headerlink&quot; title=&quot;è‡ªåŠ¨é…ç½®åŸç†&quot;&gt;&lt;/a&gt;è‡ªåŠ¨é…ç½®åŸç†&lt;/h1&gt;&lt;h2 id=&quot;åˆ†æåŸç†&quot;&gt;&lt;a href=&quot;#åˆ†æåŸç†&quot; class=&quot;headerlink&quot; title=&quot;åˆ†</summary>
      
    
    
    
    <category term="Javaåç«¯" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/"/>
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/categories/Java%E5%90%8E%E7%AB%AF/SpringBoot/"/>
    
    
    <category term="SpringBoot" scheme="http://xiaoliblog.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SSMé¡¹ç›®ğŸ¯ç½‘æ˜“äº‘éŸ³ä¹å®æˆ˜ä¹‹ç™»å½•æ¨¡å—å’Œæ–‡ä»¶ä¸Šä¼ </title>
    <link href="http://xiaoliblog.cn/page/neteaseshop04.html"/>
    <id>http://xiaoliblog.cn/page/neteaseshop04.html</id>
    <published>2021-06-19T14:09:26.213Z</published>
    <updated>2021-06-21T08:57:56.754Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç™»å½•è§†å›¾"><a href="#ç™»å½•è§†å›¾" class="headerlink" title="ç™»å½•è§†å›¾"></a>ç™»å½•è§†å›¾</h1><ul><li>ç™»å½•é¡µé¢å½“ç”¨æˆ·åå¤±å»ç„¦ç‚¹åä¼šå¼‚æ­¥è·å–ç”¨æˆ·å¤´åƒä¿¡æ¯</li><li>ç™»å½•è°ƒç”¨äº†è…¾è®¯äº‘çš„æ»‘åŠ¨éªŒè¯ç æ¥å£</li></ul><h2 id="HTMLè§†å›¾"><a href="#HTMLè§†å›¾" class="headerlink" title="HTMLè§†å›¾"></a>HTMLè§†å›¾</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login layui-anim layui-anim-scaleSpring&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ç½‘æ˜“äº‘ç”¨æˆ·ç™»å½•<span class="tag">&lt;/<span class="name">h2</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;$&#123;APP_PATH &#125;/../../static/images/logo/sign-in-avatar.svg&quot;</span> <span class="attr">id</span>=<span class="string">&quot;avatar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;color:#7f8085;&quot;</span>&gt;</span> éŸ³ä¹çš„åŠ›é‡<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;r-form&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">size</span>=<span class="string">&quot;30&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¯·ç”¨æˆ·å/é‚®ç®±&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">required</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">size</span>=<span class="string">&quot;30&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¯·è¾“å…¥å¯†ç &quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">required</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span> è®°ä½å¯†ç <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;APP_PATH&#125;/user/findpw&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;forgetps&quot;</span>&gt;</span>å¿˜è®°å¯†ç ?<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-danger&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;loginSubmit()&quot;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;APP_PATH &#125;/admin/tologin&quot;</span>&gt;</span>ç®¡ç†å‘˜ç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;APP_PATH&#125;/user/register&quot;</span> <span class="attr">class</span>=<span class="string">&quot;register&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>ç«‹å³æ³¨å†Œ<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/xiaoliblog/image@7eeea5450a9bee0261a5f9df0413920efa3172f2/2021/06/19/0d484cf4d6df1974d7f19b2f007fab3d.png"></p><h2 id="JSéƒ¨åˆ†"><a href="#JSéƒ¨åˆ†" class="headerlink" title="JSéƒ¨åˆ†"></a>JSéƒ¨åˆ†</h2><ul><li>å¼‚æ­¥è·å–å¤´åƒä¿¡æ¯</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–è¡¨å•å…ƒç´ </span></span><br><span class="line"><span class="keyword">var</span> $username = $(<span class="string">&#x27;#username&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> $password = $(<span class="string">&#x27;#password&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> $btn = $(<span class="string">&#x27;#submit&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> $form = $(<span class="string">&#x27;#r-form&#x27;</span>);</span><br><span class="line"><span class="comment">//å¦‚æœå¤±å»ç„¦ç‚¹ å»åå°æ‹¿å–å¤´åƒæ•°æ®</span></span><br><span class="line">$username.blur(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">&#x27;$&#123;APP_PATH&#125;/getUserAvatar&#x27;</span>,</span><br><span class="line">        data:&#123;<span class="attr">username</span>:$username.val()&#125;,</span><br><span class="line">        type:<span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">        success:<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123; <span class="comment">//flag = 0,è¯´æ˜å­˜åœ¨ï¼Œå¾—åˆ°userå¯¹è±¡</span></span><br><span class="line">            <span class="function"><span class="title">if</span>(<span class="params">res.flag == <span class="number">1</span> </span>)</span>&#123;</span><br><span class="line">                $(<span class="string">&#x27;#avatar&#x27;</span>).attr(<span class="string">&#x27;src&#x27;</span>,res.hashMap.user.avatar)</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                layer.msg(res.message,&#123;<span class="attr">icon</span>:<span class="number">2</span>,<span class="attr">time</span>:<span class="number">600</span>&#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>è¯·æ±‚æ»‘åŠ¨éªŒè¯ç </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">/éªŒè¯ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦ä¸ºç©ºçš„å‡½æ•°</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IsNull</span>(<span class="params">username, password</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> val1 = username.val();</span><br><span class="line">    <span class="keyword">var</span> val2 = password.val();</span><br><span class="line">    <span class="keyword">if</span> (val1 == <span class="string">&#x27;&#x27;</span> || val2 == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æäº¤æ»‘åŠ¨éªŒè¯ç </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loginSubmit</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//è¡¨å•ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">if</span> (IsNull($username, $password)) &#123;</span><br><span class="line">        layer.msg(<span class="string">&#x27;ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©º&#x27;</span>,&#123;<span class="attr">time</span>:<span class="number">600</span>,<span class="attr">icon</span>:<span class="number">2</span>&#125;);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> loadIndex = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">//åˆ›å»ºæ»‘åŠ¨éªŒè¯ç å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">var</span> slideCode = <span class="keyword">new</span> TencentCaptcha(<span class="string">&#x27;2037160931&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// resï¼ˆç”¨æˆ·ä¸»åŠ¨å…³é—­éªŒè¯ç ï¼‰= &#123;ret: 2, ticket: null&#125;</span></span><br><span class="line">        <span class="comment">// resï¼ˆéªŒè¯æˆåŠŸï¼‰ = &#123;ret: 0, ticket: &quot;String&quot;, randstr: &quot;String&quot;&#125;</span></span><br><span class="line">        <span class="keyword">if</span> (res.ret === <span class="number">0</span>) &#123;</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                type: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">                url: <span class="string">&quot;$&#123;APP_PATH&#125;/login&quot;</span>,</span><br><span class="line">                data: &#123;<span class="attr">username</span>:$username.val(),<span class="attr">password</span>:$password.val(),<span class="attr">ticket</span>:res.ticket,<span class="attr">randstr</span>:res.randstr&#125;, <span class="comment">//æäº¤çš„æ•°æ®</span></span><br><span class="line">                dataType: <span class="string">&quot;json&quot;</span>,  <span class="comment">//æœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹,ç”¨äºè§£å†³è·¨åŸŸé—®é¢˜</span></span><br><span class="line">                beforeSend:<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">                    loadIndex = layer.load(<span class="number">0</span>,&#123;<span class="attr">shade</span>:[<span class="number">0.1</span>,<span class="string">&#x27;#fff&#x27;</span>]&#125;) <span class="comment">//0.1é€æ˜åº¦çš„ç™½è‰²èƒŒæ™¯</span></span><br><span class="line">                &#125;,</span><br><span class="line">                complete:<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">                    layer.close(loadIndex)</span><br><span class="line">                &#125;,</span><br><span class="line">                success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>)</span>&#123;</span><br><span class="line">                    <span class="function"><span class="title">if</span>(<span class="params">res.flag == <span class="number">1</span></span>)</span>&#123;</span><br><span class="line">                        layer.msg(<span class="string">&quot;ç™»å½•éªŒè¯æˆåŠŸ&quot;</span>,&#123;<span class="attr">time</span>:<span class="number">600</span>,<span class="attr">icon</span>:<span class="number">1</span>&#125;);</span><br><span class="line">                        <span class="built_in">window</span>.location.href = <span class="string">&quot;$&#123;APP_PATH&#125;/index&quot;</span></span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        layer.msg(res.message,&#123;<span class="attr">time</span>:<span class="number">600</span>,<span class="attr">icon</span>:<span class="number">2</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                error: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>)</span>&#123;</span><br><span class="line">                    <span class="comment">//è¯·æ±‚å¤±è´¥</span></span><br><span class="line">                    <span class="built_in">console</span>.log(e.status)</span><br><span class="line">                    <span class="built_in">console</span>.log(e.responseText)</span><br><span class="line">                    layer.msg(<span class="string">&quot;ä¸å¥½æ„æ€ï¼ŒæœåŠ¡å™¨è·‘åˆ°ç«æ˜Ÿå»äº†ï¼Œç™»å½•å¼‚å¸¸ï¼&quot;</span>,&#123;<span class="attr">time</span>:<span class="number">600</span>,<span class="attr">icon</span>:<span class="number">2</span>&#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            layer.msg(<span class="string">&#x27;éªŒè¯é”™è¯¯&#x27;</span>,&#123;<span class="attr">time</span>:<span class="number">600</span>,<span class="attr">icon</span>:<span class="number">2</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    slideCode.show(); <span class="comment">//æ˜¾ç¤ºæ»‘åŠ¨éªŒè¯ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åç«¯å¤„ç†"><a href="#åç«¯å¤„ç†" class="headerlink" title="åç«¯å¤„ç†"></a>åç«¯å¤„ç†</h1><h2 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><ul><li>é¦–å…ˆæ˜¯å¤„ç†å¼‚æ­¥è·å–å¤´åƒä¿¡æ¯</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼‚æ­¥éªŒè¯ç”¨æˆ·å¤´åƒ</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/getUserAvatar&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ReturnMsg <span class="title">getUserAvatar</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">   <span class="comment">//åç«¯æ ¡éªŒ</span></span><br><span class="line">   String regName = <span class="string">&quot;(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\\u2E80-\\u9FFF]&#123;2,5&#125;)&quot;</span>;</span><br><span class="line">   <span class="comment">//å¦‚æœä¸åŒ¹é…</span></span><br><span class="line">   ReturnMsg returnMsg = <span class="keyword">new</span> ReturnMsg();</span><br><span class="line">   <span class="keyword">if</span>(!username.matches(regName))&#123;</span><br><span class="line">      returnMsg.fail(<span class="string">&quot;ç”¨æˆ·åå¿…é¡»æ˜¯6-16æ•°å­—æˆ–å­—æ¯çš„ç»„åˆï¼Œæˆ–è€…2-5ä½æ±‰å­—&quot;</span>);</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      User user = userService.queryUserByUsername(username);</span><br><span class="line">      <span class="keyword">if</span> (user != <span class="keyword">null</span>) &#123;</span><br><span class="line">         <span class="comment">//ç”¨æˆ·å­˜åœ¨</span></span><br><span class="line">         returnMsg.isSuccess().add(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         returnMsg.fail(<span class="string">&quot;ç”¨æˆ·åä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span>  returnMsg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¤„ç†æ»‘åŠ¨éªŒè¯ç è¯·æ±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/login&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ReturnMsg <span class="title">login</span><span class="params">(HttpServletRequest request, String ticket, String randstr)</span> </span>&#123;</span><br><span class="line">   String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">   String password = request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">   DescribeCaptchaResult describeCaptchaResult = <span class="keyword">new</span> DescribeCaptchaResult();</span><br><span class="line">   User user1 = userService.queryUserBynameAndpwd(username, password);</span><br><span class="line">   ReturnMsg returnMsg = <span class="keyword">new</span> ReturnMsg();</span><br><span class="line">   <span class="comment">//System.out.println(&quot;éªŒè¯ç ç»“æœ:&quot;+describeCaptchaResult.codeResponse(ticket,randstr));</span></span><br><span class="line">   <span class="comment">//å¦‚æœéªŒè¯ç è¯»å–éªŒè¯æˆåŠŸ</span></span><br><span class="line">   <span class="keyword">if</span> (describeCaptchaResult.codeResponse(ticket, randstr) &amp;&amp; user1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="comment">//ä¼ ä¸€ä¸ªç”¨æˆ·å¯¹è±¡</span></span><br><span class="line">      <span class="comment">//ç”¨æˆ·ä¿¡æ¯ä¿å­˜åˆ°Session</span></span><br><span class="line">      request.getSession().setAttribute(SessionConstants.USER_SESSION, user1);</span><br><span class="line">      returnMsg.isSuccess(); <span class="comment">//æˆåŠŸflag=1</span></span><br><span class="line">      <span class="keyword">return</span> returnMsg;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      returnMsg.fail(<span class="string">&quot;ç™»å½•éªŒè¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•!&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> returnMsg;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;d</span><br></pre></td></tr></table></figure><ul><li>è¿™é‡Œä½¿ç”¨äº†å¸¸é‡å°è£…ç”¨æˆ·Sessionï¼Œå¯¹ä¸€äº›å…¨å±€ä½¿ç”¨çš„å¸¸é‡è¿›è¡Œå°è£…æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ä¹ æƒ¯ã€‚ä¾¿äºåæœŸç»´æŠ¤</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.netease.utils;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰å…¨å±€Sessionå¸¸é‡</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SessionConstants</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç”¨æˆ·ç™»å½•Session</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String USER_SESSION = <span class="string">&quot;userInfo&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ»‘åŠ¨éªŒè¯ç å·¥å…·ç±»"><a href="#æ»‘åŠ¨éªŒè¯ç å·¥å…·ç±»" class="headerlink" title="æ»‘åŠ¨éªŒè¯ç å·¥å…·ç±»"></a>æ»‘åŠ¨éªŒè¯ç å·¥å…·ç±»</h2><div class="note success simple"><p>ç”±äºä»£ç ä¸­éœ€è¦è·å–ç‰¹åœ°å‚æ•°ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ä¸äºˆå…¬å¸ƒï¼Œè¯·è¯»è€…è‡ªè¡Œè·å–å‚æ•°</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.netease.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.tencentcloudapi.captcha.v20190722.CaptchaClient;</span><br><span class="line"><span class="keyword">import</span> com.tencentcloudapi.captcha.v20190722.models.DescribeCaptchaResultRequest;</span><br><span class="line"><span class="keyword">import</span> com.tencentcloudapi.captcha.v20190722.models.DescribeCaptchaResultResponse;</span><br><span class="line"><span class="keyword">import</span> com.tencentcloudapi.common.Credential;</span><br><span class="line"><span class="keyword">import</span> com.tencentcloudapi.common.exception.TencentCloudSDKException;</span><br><span class="line"><span class="keyword">import</span> com.tencentcloudapi.common.profile.ClientProfile;</span><br><span class="line"><span class="keyword">import</span> com.tencentcloudapi.common.profile.HttpProfile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DescribeCaptchaResult</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DescribeCaptchaResult</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å»è…¾è®¯äº‘æœåŠ¡è·å–ç»“æœ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">codeResponse</span><span class="params">(String ticket,String randstr)</span></span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//å®ä¾‹åŒ–ä¸€ä¸ªè®¤è¯å¯¹è±¡ï¼Œå…¥å‚éœ€è¦ä¼ å…¥è…¾è®¯äº‘è´¦æˆ·å¯†é’¥å¯¹ secretId å’Œ secretKey</span></span><br><span class="line">            Credential cred = <span class="keyword">new</span> Credential(<span class="string">&quot;AKIDyhngMxxxxf3KR&quot;</span>,<span class="string">&quot;Zu1tqeEZbMvxxxYBYeBOO7&quot;</span>);</span><br><span class="line">            <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ª http é€‰é¡¹ï¼Œå¯é€‰ï¼Œæ— ç‰¹æ®Šéœ€æ±‚æ—¶å¯ä»¥è·³è¿‡</span></span><br><span class="line">            HttpProfile httpProfile = <span class="keyword">new</span> HttpProfile();</span><br><span class="line">            <span class="comment">//æ¥å£è¯·æ±‚åŸŸåï¼š captcha.tencentcloudapi.com</span></span><br><span class="line">            httpProfile.setEndpoint(<span class="string">&quot;captcha.tencentcloudapi.com&quot;</span>);</span><br><span class="line">            <span class="comment">/* å®ä¾‹åŒ–ä¸€ä¸ªå®¢æˆ·ç«¯é…ç½®å¯¹è±¡ */</span></span><br><span class="line">            ClientProfile clientProfile = <span class="keyword">new</span> ClientProfile();</span><br><span class="line">            clientProfile.setHttpProfile(httpProfile);</span><br><span class="line">            <span class="comment">/* å®ä¾‹åŒ– SMS çš„ client å¯¹è±¡</span></span><br><span class="line"><span class="comment">             * ç¬¬äºŒä¸ªå‚æ•°æ˜¯åœ°åŸŸä¿¡æ¯ï¼Œå¯ä»¥ç›´æ¥å¡«å†™å­—ç¬¦ä¸² ap-beijingï¼Œæˆ–è€…å¼•ç”¨é¢„è®¾çš„å¸¸é‡ */</span></span><br><span class="line">            CaptchaClient client = <span class="keyword">new</span> CaptchaClient(cred,<span class="string">&quot;ap-beijing&quot;</span>,clientProfile);</span><br><span class="line">            <span class="comment">//éœ€è¦UserIP,CaptchaAppIdå’ŒAppSecretKey</span></span><br><span class="line">            String params = <span class="string">&quot;&#123;\&quot;CaptchaType\&quot;:9,\&quot;Ticket\&quot;:\&quot;&quot;</span></span><br><span class="line">                    + ticket + <span class="string">&quot;\&quot;,\&quot;UserIp\&quot;:\&quot;127.0.0.1\&quot;,\&quot;Randstr\&quot;:\&quot;&quot;</span></span><br><span class="line">                    + randstr + <span class="string">&quot;\&quot;,\&quot;CaptchaAppId\&quot;:20xxx931,\&quot;AppSecretKey\&quot;:\&quot;0Sih3-_w8dsr1xxx**\&quot;&#125;&quot;</span>;</span><br><span class="line">            DescribeCaptchaResultRequest req = DescribeCaptchaResultRequest.fromJsonString(params,DescribeCaptchaResultRequest.class);</span><br><span class="line">            DescribeCaptchaResultResponse resp = client.DescribeCaptchaResult(req);</span><br><span class="line">            str = DescribeCaptchaResultRequest.toJsonString(resp);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (TencentCloudSDKException e)&#123;</span><br><span class="line">            System.out.println(e.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ‰“å°JSONå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;JSONå¯¹è±¡:&quot;</span>+str);</span><br><span class="line">        <span class="keyword">if</span>(str.indexOf(<span class="string">&quot;OK&quot;</span>)&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><ul><li>å…¶ä»–åŠŸèƒ½æ²¡æœ‰å¯è®²æ€§ï¼Œè®²ä¸€ä¸‹è°ƒç”¨LayUIçš„æ–‡ä»¶ä¸Šä¼ ç»„ä»¶+é˜¿é‡Œäº‘OSSå¯¹è±¡å­˜å‚¨å­˜å‚¨å›¾ç‰‡</li></ul><h2 id="LayUIç»„ä»¶"><a href="#LayUIç»„ä»¶" class="headerlink" title="LayUIç»„ä»¶"></a>LayUIç»„ä»¶</h2><ul><li>è¿™é‡Œç”¨åˆ°äº†LayUIæ–‡ä»¶ä¸Šä¼ ç»„ä»¶ï¼ŒHTMLç»“æ„å¦‚ä¸‹</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-upload&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn&quot;</span> <span class="attr">id</span>=<span class="string">&quot;test1&quot;</span>&gt;</span>ä¸Šä¼ å›¾ç‰‡<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-upload-list&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;layui-upload-img&quot;</span> <span class="attr">id</span>=<span class="string">&quot;demo1&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:90px;height: 90px;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;demoText&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 95px;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-progress layui-progress-big&quot;</span> <span class="attr">lay-showpercent</span>=<span class="string">&quot;yes&quot;</span> <span class="attr">lay-filter</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-progress-bar&quot;</span> <span class="attr">lay-percent</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">name</span>=<span class="string">&quot;list-progress&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>JSä»£ç å¦‚ä¸‹</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//layui ç”¨æˆ·æ·»åŠ ä¸Šä¼ å›¾ç‰‡</span></span><br><span class="line">layui.use([<span class="string">&#x27;upload&#x27;</span>, <span class="string">&#x27;element&#x27;</span>, <span class="string">&#x27;layer&#x27;</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//å¼•å…¥æ¨¡å—</span></span><br><span class="line">    <span class="keyword">var</span> $ = layui.jquery,</span><br><span class="line">        upload = layui.upload,</span><br><span class="line">        element = layui.element,</span><br><span class="line">        layer = layui.layer;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¸²æŸ“æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">var</span> uploadInst = upload.render(&#123;</span><br><span class="line">        elem: <span class="string">&#x27;#test1&#x27;</span> <span class="comment">//ä¸Šä¼ æ–‡ä»¶æŒ‰é’®id</span></span><br><span class="line">            ,</span><br><span class="line">        url: <span class="string">&#x27;$&#123;APP_PATH&#125;/admin/upload&#x27;</span> <span class="comment">//æ–‡ä»¶ä¸Šä¼ æ¥å£</span></span><br><span class="line">            ,</span><br><span class="line">        accept: <span class="string">&#x27;images&#x27;</span> <span class="comment">//ç›´æ¥æ”¶å›¾ç‰‡</span></span><br><span class="line">            ,</span><br><span class="line">        auto: <span class="literal">true</span> <span class="comment">//æ˜¯å¦é€‰æ‹©æ–‡ä»¶ä»¥åè‡ªåŠ¨ä¸Šä¼  å¯ä»¥ç»™ä¸€ä¸ªå±æ€§æ·»åŠ æŒ‰é’®ç»‘å®š</span></span><br><span class="line">            ,</span><br><span class="line">        multipe: <span class="literal">true</span> <span class="comment">//å¤šæ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">            <span class="comment">//,size: //è®¾ç½®æœ€å¤§å…è®¸ä¸Šä¼ çš„å¤§å° å•ä½kb</span></span><br><span class="line">            ,</span><br><span class="line">        acceptMime: <span class="string">&#x27;image/*&#x27;</span> <span class="comment">//æ‰“å¼€æ–‡ä»¶é€‰æ‹©æŒ‡å®šåªå‡ºç°å›¾ç‰‡ç±»å‹åç¼€çš„æ–‡ä»¶</span></span><br><span class="line">            ,</span><br><span class="line">        before: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//é¢„è¯»æœ¬åœ°æ–‡ä»¶ç¤ºä¾‹ï¼Œä¸æ”¯æŒie8</span></span><br><span class="line">            obj.preview(<span class="function"><span class="keyword">function</span> (<span class="params">index, file, result</span>) </span>&#123;</span><br><span class="line">                <span class="comment">//#demo1ä¸ºimgæ ‡ç­¾</span></span><br><span class="line">                $(<span class="string">&#x27;#demo1&#x27;</span>).attr(<span class="string">&#x27;src&#x27;</span>, result); <span class="comment">//å›¾ç‰‡é“¾æ¥ï¼ˆbase64ï¼‰</span></span><br><span class="line">            &#125;);</span><br><span class="line">            element.progress(<span class="string">&#x27;demo&#x27;</span>, <span class="string">&#x27;0%&#x27;</span>); <span class="comment">//è¿›åº¦æ¡å¤ä½</span></span><br><span class="line">            layer.msg(<span class="string">&#x27;ä¸Šä¼ ä¸­&#x27;</span>, &#123;</span><br><span class="line">                icon: <span class="number">16</span>,</span><br><span class="line">                time: <span class="number">0</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        done: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123; <span class="comment">//ä¸Šä¼ æˆåŠŸçš„å›è°ƒ</span></span><br><span class="line">            <span class="comment">//å¦‚æœä¸Šä¼ å¤±è´¥</span></span><br><span class="line">            <span class="keyword">if</span> (res.flag == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> layer.msg(<span class="string">&#x27;ä¸Šä¼ æˆåŠŸ&#x27;</span>, &#123;</span><br><span class="line">                    icon: <span class="number">1</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> layer.msg(<span class="string">&#x27;ä¸Šä¼ å¤±è´¥&#x27;</span>, &#123;</span><br><span class="line">                    icon: <span class="number">2</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//ä¸Šä¼ æˆåŠŸçš„ä¸€äº›æ“ä½œ</span></span><br><span class="line">            <span class="comment">//â€¦â€¦</span></span><br><span class="line">            $(<span class="string">&#x27;#demoText&#x27;</span>).html(<span class="string">&#x27;&#x27;</span>); <span class="comment">//ç½®ç©ºä¸Šä¼ å¤±è´¥çš„çŠ¶æ€</span></span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">//ä¸Šä¼ å¤±è´¥çš„å›è°ƒ</span></span><br><span class="line">                <span class="comment">//æ¼”ç¤ºå¤±è´¥çŠ¶æ€ï¼Œå¹¶å®ç°é‡ä¼ </span></span><br><span class="line">                <span class="keyword">var</span> demoText = $(<span class="string">&#x27;#demoText&#x27;</span>);</span><br><span class="line">                demoText.html(<span class="string">&#x27;&lt;span style=&quot;color: #ff5722;&quot;&gt;ä¸Šä¼ å¤±è´¥&lt;/span&gt; &lt;a class=&quot;layui-btn layui-btn-xs demo-reload&quot;&gt;é‡è¯•&lt;/a&gt;&#x27;</span>);</span><br><span class="line">                demoText.find(<span class="string">&#x27;.demo-reload&#x27;</span>).on(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    uploadInst.upload();</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//è¿›åº¦æ¡</span></span><br><span class="line">            ,</span><br><span class="line">        progress: <span class="function"><span class="keyword">function</span> (<span class="params">n, elem, e</span>) </span>&#123;</span><br><span class="line">            element.progress(<span class="string">&#x27;demo&#x27;</span>, n + <span class="string">&#x27;%&#x27;</span>); <span class="comment">//å¯é…åˆ layui è¿›åº¦æ¡å…ƒç´ ä½¿ç”¨</span></span><br><span class="line">            <span class="keyword">if</span> (n == <span class="number">100</span>) &#123;</span><br><span class="line">                layer.msg(<span class="string">&#x27;ä¸Šä¼ å®Œæ¯•&#x27;</span>, &#123;</span><br><span class="line">                    icon: <span class="number">1</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æ§åˆ¶å™¨-1"><a href="#æ§åˆ¶å™¨-1" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">AliyunOSSClientUtil ossClientUtil;</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(value=&quot;/upload&quot;,method = RequestMethod.POST)</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> ReturnMsg <span class="title">upload</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile multipartFile)</span> </span>&#123;</span><br><span class="line">   user.setAvatar(<span class="string">&quot;&quot;</span>); <span class="comment">//ä¸Šä¼ ä¸€æ¬¡å…ˆæ¸…ç©ºåŸç…§ç‰‡</span></span><br><span class="line">   String FileType= ossClientUtil.getContentType(multipartFile);</span><br><span class="line">   String url = ossClientUtil.uploadDocument(multipartFile,FileType);</span><br><span class="line">   System.out.println(<span class="string">&quot;è·¯å¾„ï¼š&quot;</span>+url);</span><br><span class="line">   ReturnMsg returnMsg = <span class="keyword">new</span> ReturnMsg();</span><br><span class="line">   <span class="keyword">if</span>(url!=<span class="keyword">null</span>)&#123;</span><br><span class="line">      returnMsg.isSuccess(url);</span><br><span class="line">      user.setAvatar(url);</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      returnMsg.fail(<span class="string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span>  returnMsg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¯¹è±¡å­˜å‚¨å·¥å…·ç±»"><a href="#å¯¹è±¡å­˜å‚¨å·¥å…·ç±»" class="headerlink" title="å¯¹è±¡å­˜å‚¨å·¥å…·ç±»"></a>å¯¹è±¡å­˜å‚¨å·¥å…·ç±»</h2><ul><li>é¦–å…ˆå°è£…ä¸€äº›éœ€è¦çš„å‚æ•°ï¼ˆç‰¹å®šå‚æ•°éœ€è‡ªè¡ŒæŸ¥æ‰¾ï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.netease.utils;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é˜¿é‡Œäº‘OSSå‚æ•°å¸¸é‡ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OSSClientConstants</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é˜¿é‡Œäº‘APIçš„å¤–ç½‘åŸŸå ä»¥ä¸Šæµ·ä¸ºä¾‹ï¼Œå…¶ä»–æŒ‰æƒ…å†µå¡«å†™</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ENDPOINT = <span class="string">&quot;oss-cn-shanghai.aliyuncs.com&quot;</span>;</span><br><span class="line">    <span class="comment">//é˜¿é‡Œäº‘APIçš„å¯†é’¥Access Key ID</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ACCESS_KEY_ID = <span class="string">&quot;LTAI5tGkaLxxxxZm&quot;</span>;</span><br><span class="line">    <span class="comment">//é˜¿é‡Œäº‘APIçš„å¯†é’¥Access Key Secret</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ACCESS_KEY_SECRET = <span class="string">&quot;FG6ttcllvChgxxxytzJu&quot;</span>;</span><br><span class="line">    <span class="comment">//é˜¿é‡Œäº‘APIçš„bucketåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BUCKET_NAME = <span class="string">&quot;origins-xiaoliblog&quot;</span>;</span><br><span class="line">    <span class="comment">//Bucket åŸŸåå³å¤–ç½‘è®¿é—®çš„åŸŸå</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BUCKET_URL= <span class="string">&quot;http://origins-xiaoliblog.oss-cn-shanghai.aliyuncs.com/&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºOSSå·¥å…·ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.netease.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSSClient;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.model.CannedAccessControlList;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.model.CreateBucketRequest;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.model.OSSObject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">//å®ä¾‹åŒ– ä¾¿äºåœ¨æ§åˆ¶å™¨ä¸­è‡ªåŠ¨è£…é…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AliyunOSSClientUtil</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é˜¿é‡Œäº‘APIçš„å†…æˆ–å¤–ç½‘åŸŸå</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String ENDPOINT;</span><br><span class="line">    <span class="comment">//é˜¿é‡Œäº‘APIçš„å¯†é’¥Access Key ID</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String ACCESS_KEY_ID;</span><br><span class="line">    <span class="comment">//é˜¿é‡Œäº‘APIçš„å¯†é’¥Access Key Secret</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span>  String ACCESS_KEY_SECRET;</span><br><span class="line">    <span class="comment">//é˜¿é‡Œäº‘APIçš„bucketåç§°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String BUCKET_NAME;</span><br><span class="line">    <span class="comment">//Bucket åŸŸåå³å¤–ç½‘è®¿é—®çš„åŸŸå</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String BUCKET_URL;</span><br><span class="line">    <span class="comment">//æ—¥æœŸæ ¼å¼åŒ–å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SimpleDateFormat SDF = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyymmdd&quot;</span>); <span class="comment">//æ—¥æœŸæ ¼å¼åŒ–å¯¹è±¡</span></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–å±æ€§</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        ENDPOINT = OSSClientConstants.ENDPOINT;</span><br><span class="line">        ACCESS_KEY_ID = OSSClientConstants.ACCESS_KEY_ID;</span><br><span class="line">        ACCESS_KEY_SECRET = OSSClientConstants.ACCESS_KEY_SECRET;</span><br><span class="line">        BUCKET_NAME = OSSClientConstants.BUCKET_NAME;</span><br><span class="line">        BUCKET_URL = OSSClientConstants.BUCKET_URL;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é˜¿é‡Œäº‘OSSå®¢æˆ·ç«¯å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ossClient</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> OSSClient <span class="title">getOSSClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªOSSClientå¯¹è±¡</span></span><br><span class="line">        OSSClient ossClient = <span class="keyword">new</span> OSSClient(ENDPOINT, ACCESS_KEY_ID, ACCESS_KEY_SECRET);</span><br><span class="line">        <span class="comment">//é€šè¿‡è¿æ¥å¯¹è±¡åˆ¤æ–­Bucketä»“åº“æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span>(ossClient.doesBucketExist(BUCKET_NAME))&#123;</span><br><span class="line">            System.out.println(BUCKET_NAME+<span class="string">&quot;ä»“åº“å­˜åœ¨&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//å¦‚æœæ²¡æœ‰å°±é€šè¿‡APIæ¥å£åˆ›å»ºBucketä»“åº“</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Bucketä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„Bucket:&quot;</span>+BUCKET_NAME);</span><br><span class="line">            CreateBucketRequest bucketRequest = <span class="keyword">new</span> CreateBucketRequest(<span class="keyword">null</span>);</span><br><span class="line">            <span class="comment">//è®¾ç½®Bucketåç§°</span></span><br><span class="line">            bucketRequest.setBucketName(BUCKET_NAME);</span><br><span class="line">            <span class="comment">//è®¾ç½®æƒé™:å…¬å…±è¯»</span></span><br><span class="line">            bucketRequest.setCannedACL(CannedAccessControlList.PublicRead);</span><br><span class="line">            <span class="comment">//åˆ›å»ºæ–°Bucket</span></span><br><span class="line">            ossClient.createBucket(bucketRequest);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ossClient;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ¨¡æ‹Ÿæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ossClient ossè¿æ¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bucketName å­˜å‚¨ç©ºé—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> folder   æ¨¡æ‹Ÿæ–‡ä»¶å¤¹åå¦‚&quot;qj_nanjing/&quot;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  æ–‡ä»¶å¤¹å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  String <span class="title">createFolder</span><span class="params">(OSSClient ossClient,String bucketName,String folder)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">        <span class="keyword">if</span>(!ossClient.doesObjectExist(bucketName,folder))&#123;</span><br><span class="line">            <span class="comment">//åˆ›å»ºæ–‡ä»¶å¤¹</span></span><br><span class="line">            ossClient.putObject(bucketName,folder,<span class="keyword">new</span> ByteArrayInputStream(<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">0</span>]));</span><br><span class="line">            System.out.println(<span class="string">&quot;åˆ›å»ºæ–‡ä»¶å¤¹æˆåŠŸ&quot;</span>);</span><br><span class="line">            <span class="comment">//å¾—åˆ°æ–‡ä»¶å¤¹å</span></span><br><span class="line">            OSSObject ossObject = ossClient.getObject(bucketName,folder);</span><br><span class="line">            String fileDir = ossObject.getKey();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ–‡ä»¶åä¸ºï¼š&quot;</span>+fileDir);</span><br><span class="line">            <span class="keyword">return</span> fileDir;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> folder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ å›¾ç‰‡è‡³OSS</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> multipartFile æ–‡ä»¶å¯¹è±¡F</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> FileType  æ–‡ä»¶ç±»å‹F</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> url è¿”å›æ–‡ä»¶è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//MultipartFileæ˜¯ä¸€ä¸ªå°è£…äº†æ–‡ä»¶ä¿¡æ¯çš„å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">uploadDocument</span><span class="params">(MultipartFile multipartFile, String FileType)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è·å¾—OSSè¿æ¥</span></span><br><span class="line">        OSSClient ossClient = <span class="keyword">this</span>.getOSSClient();</span><br><span class="line">        <span class="comment">//è·å–æ–‡ä»¶çš„åç¼€</span></span><br><span class="line">        String suffix = multipartFile.getOriginalFilename();</span><br><span class="line">        suffix = suffix.substring(suffix.lastIndexOf(<span class="string">&quot;.&quot;</span>)); <span class="comment">//.åé¢çš„</span></span><br><span class="line">        <span class="comment">//è·å¾—å½“å‰ä¸Šä¼ æ—¥æœŸ</span></span><br><span class="line">        String date = SDF.format(<span class="keyword">new</span> Date());</span><br><span class="line">        <span class="comment">//é€šè¿‡UUIDåæ¥é¿å…æ–‡ä»¶é‡å</span></span><br><span class="line">        String uuid = UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">//ç»„åˆæ–‡ä»¶åç§°</span></span><br><span class="line">        String filename = FileType + <span class="string">&quot;/&quot;</span> + date  + <span class="string">&quot;/&quot;</span> + uuid + suffix;</span><br><span class="line">        String url = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//é€šè¿‡OSSClientè·å¾—ä¸Šä¼ æ–‡ä»¶åè¿”å›çš„url</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ossClient.putObject(BUCKET_NAME,filename,<span class="keyword">new</span> ByteArrayInputStream(multipartFile.getBytes()));</span><br><span class="line">            url = BUCKET_URL + filename;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">            ossClient.shutdown();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡æ–‡ä»¶ååˆ¤æ–­å¹¶è·å–OSSæœåŠ¡æ–‡ä»¶ä¸Šä¼ æ—¶æ–‡ä»¶çš„contentType</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> multipartFile æ–‡ä»¶å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–‡ä»¶çš„contentType</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  String <span class="title">getContentType</span><span class="params">(MultipartFile multipartFile)</span></span>&#123;</span><br><span class="line">        <span class="comment">//è·å–æ–‡ä»¶çš„åç¼€</span></span><br><span class="line">        String suffix = multipartFile.getOriginalFilename();</span><br><span class="line">        suffix = suffix.substring(suffix.lastIndexOf(<span class="string">&quot;.&quot;</span>)); <span class="comment">//.åé¢çš„</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.bmp&quot;</span>.equalsIgnoreCase(suffix)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;image/bmp&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.gif&quot;</span>.equalsIgnoreCase(suffix)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;image/gif&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.jpeg&quot;</span>.equalsIgnoreCase(suffix) || <span class="string">&quot;.jpg&quot;</span>.equalsIgnoreCase(suffix)  || <span class="string">&quot;.png&quot;</span>.equalsIgnoreCase(suffix) ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;image/jpeg&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.html&quot;</span>.equalsIgnoreCase(suffix)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.txt&quot;</span>.equalsIgnoreCase(suffix)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;text/plain&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.vsd&quot;</span>.equalsIgnoreCase(suffix)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;application/vnd.visio&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.ppt&quot;</span>.equalsIgnoreCase(suffix) || <span class="string">&quot;pptx&quot;</span>.equalsIgnoreCase(suffix)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;application/vnd.ms-powerpoint&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.doc&quot;</span>.equalsIgnoreCase(suffix) || <span class="string">&quot;docx&quot;</span>.equalsIgnoreCase(suffix)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;application/msword&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;.xml&quot;</span>.equalsIgnoreCase(suffix)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;text/xml&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//é»˜è®¤è¿”å›ç±»å‹</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;image/jpeg&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="JSå·¥å…·æ–¹æ³•"><a href="#JSå·¥å…·æ–¹æ³•" class="headerlink" title="JSå·¥å…·æ–¹æ³•"></a>JSå·¥å…·æ–¹æ³•</h1><ul><li>è·å–åœ°å€æ å‚æ•°</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–åœ°å€æ å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUrlParams</span>(<span class="params">param</span>)</span>&#123;</span><br><span class="line">   <span class="comment">// ç”¨è¯¥å±æ€§è·å–é¡µé¢ URL åœ°å€ä»é—®å· (?) å¼€å§‹çš„ URLï¼ˆæŸ¥è¯¢éƒ¨åˆ†ï¼‰</span></span><br><span class="line">   <span class="keyword">var</span> url = <span class="built_in">window</span>.location.search;</span><br><span class="line">   <span class="comment">// æ­£åˆ™ç­›é€‰åœ°å€æ </span></span><br><span class="line">   <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;(^|&amp;)&quot;</span> + param + <span class="string">&quot;=([^&amp;]*)(&amp;|$)&quot;</span>);</span><br><span class="line">   <span class="comment">// åŒ¹é…ç›®æ ‡å‚æ•°</span></span><br><span class="line">   <span class="keyword">var</span> result = url.substr(<span class="number">1</span>).match(reg);</span><br><span class="line">   <span class="comment">//è¿”å›å‚æ•°å€¼</span></span><br><span class="line">   <span class="keyword">return</span> result ? <span class="built_in">decodeURIComponent</span>(result[<span class="number">2</span>]) : <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¯”å¦‚localhost:8080/query?keywords=å‘¨æ°ä¼¦</span></span><br><span class="line"><span class="keyword">var</span> query = getUrlParams(<span class="string">&quot;keywords&quot;</span>); <span class="comment">//å‘¨æ°ä¼¦</span></span><br></pre></td></tr></table></figure><ul><li>å›è½¦è·³è½¬</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;search_input&quot;</span> <span class="attr">onkeypress</span>=<span class="string">&quot;return EnterSongList()&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æœç´¢æ¡†å›è½¦è·³è½¬</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">EnterSongList</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="function"><span class="title">if</span>(<span class="params">event.keyCode == <span class="number">13</span></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> keywords = $(<span class="string">&#x27;#search_input&#x27;</span>).val();</span><br><span class="line">      <span class="built_in">window</span>.location.href=<span class="string">&quot;$&#123;APP_PATH&#125;/user/songlist?keywords=&quot;</span>+keywords;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç™»å½•è§†å›¾&quot;&gt;&lt;a href=&quot;#ç™»å½•è§†å›¾&quot; class=&quot;headerlink&quot; title=&quot;ç™»å½•è§†å›¾&quot;&gt;&lt;/a&gt;ç™»å½•è§†å›¾&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ç™»å½•é¡µé¢å½“ç”¨æˆ·åå¤±å»ç„¦ç‚¹åä¼šå¼‚æ­¥è·å–ç”¨æˆ·å¤´åƒä¿¡æ¯&lt;/li&gt;
&lt;li&gt;ç™»å½•è°ƒç”¨äº†è…¾è®¯äº‘çš„æ»‘åŠ¨éªŒè¯ç æ¥å£&lt;/li&gt;
</summary>
      
    
    
    
    <category term="é¡¹ç›®æ¡ˆä¾‹" scheme="http://xiaoliblog.cn/categories/%E9%A1%B9%E7%9B%AE%E6%A1%88%E4%BE%8B/"/>
    
    <category term="å…¨æ ˆå®ä¾‹" scheme="http://xiaoliblog.cn/categories/%E9%A1%B9%E7%9B%AE%E6%A1%88%E4%BE%8B/%E5%85%A8%E6%A0%88%E5%AE%9E%E4%BE%8B/"/>
    
    
    <category term="é¡¹ç›®æ¡ˆä¾‹" scheme="http://xiaoliblog.cn/tags/%E9%A1%B9%E7%9B%AE%E6%A1%88%E4%BE%8B/"/>
    
  </entry>
  
</feed>
